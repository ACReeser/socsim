(this.webpackJsonpsocsim=this.webpackJsonpsocsim||[]).push([[0],{19:function(e,t,n){e.exports=n(38)},24:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(12),s=n.n(r),c=(n(24),n(1)),o=n(2),l=n(4),u=n(3),m=n(8),d=n(17),h=(n(29),n(30),n(7)),y=function(){function e(t){Object(c.a)(this,e),this.onPublish=t,this.callbacks=[],this.current=void 0}return Object(o.a)(e,[{key:"publish",value:function(e){this.onPublish&&this.onPublish(e),this.current=e,this.callbacks.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e){this.callbacks.push(e)}},{key:"unsubscribe",value:function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)}}]),e}(),p=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return n}(y);var f,b=new(function(){function e(){Object(c.a)(this,e),this.Dirty=new y,this.Saving=new y}return Object(o.a)(e,[{key:"HasContinueGame",value:function(){var e=localStorage.getItem("last-game-id");if(null!=e){var t=parseInt(e);if(!isNaN(t))return null!=localStorage.getItem("".concat("game-").concat(t))?t:void 0}}},{key:"GetGameSlots",value:function(){for(var e=[],t=0;t<3;t++){var n=localStorage.getItem("".concat("game-brief-").concat(t+1));e.push({id:t+1,brief:n?JSON.parse(n):void 0})}return e}},{key:"GetGame",value:function(e){var t=localStorage.getItem("".concat("game-").concat(e));if(!t)return{errors:["Cannot find game"]};try{return{game:JSON.parse(t)}}catch(n){return{errors:[n]}}}},{key:"SaveGame",value:function(e){var t=JSON.stringify(e),n={Name:e.cities.byID[0].name,Population:e.beans.allIDs.map((function(t){return e.beans.byID[t]})).filter((function(e){return"dead"!=e.lifecycle})).length,Age:{day:e.date.day,hour:e.date.hour,season:e.date.season,year:e.date.year}};localStorage.setItem("".concat("game-").concat(e.saveSlot),t),localStorage.setItem("".concat("game-brief-").concat(e.saveSlot),JSON.stringify(n)),localStorage.setItem("last-game-id",e.saveSlot.toString()),this.Dirty.publish(!1),this.Saving.publish()}}]),e}()),v=n(10),g={x:.94,y:.94},E=60,k=9,w=10,x={x:.94,y:.94},D=10,N=4,S=10,j={state:"\ud83d\udd4a\ufe0f",ego:"\ud83e\udd85",prog:"\u2696\ufe0f",trad:"\ud83d\udc51",circle:"\ud83e\udd0e",square:"\ud83d\udc9b",triangle:"\ud83e\udde1",rocket:"\ud83d\ude80",music:"\ud83c\udfb5",dragon:"\ud83d\udc32",noFaith:"\u26ab\ufe0f",starving:"\ud83c\udf74",hungry:"\ud83c\udf7d\ufe0f",sated:"\ud83e\udd5c",stuffed:"\ud83e\udd69",homeless:"\ud83c\udf28\ufe0f",sleepy:"\ud83c\udf19",awake:"\u2600\ufe0f",rested:"\ud83c\udf1e",sick:"\ud83e\udd22",sickly:"\ud83d\ude37",bruised:"\ud83e\ude79",fresh:"\ud83d\udcaa",psychotic:"\ud83e\udd2a",disturbed:"\ud83e\udd24",stressed:"",sane:"\ud83e\udde0"};!function(e){e[e.Deficient=-.25]="Deficient",e[e.Sufficient=0]="Sufficient",e[e.Abundant=.15]="Abundant"}(f||(f={}));var K={homeless:{reason:"Homeless",mod:f.Deficient},sleepy:{reason:"Renting",mod:f.Sufficient},awake:{reason:"Homeowner",mod:f.Sufficient},rested:{reason:"Homeowner",mod:f.Abundant},sick:{reason:"Sick",mod:f.Deficient},sickly:{reason:"Sick",mod:f.Sufficient},bruised:{reason:"Bruised",mod:f.Sufficient},fresh:{reason:"Healthy",mod:f.Abundant},starving:{reason:"Hungry",mod:f.Deficient},hungry:{reason:"Hungry",mod:f.Sufficient},sated:{reason:"Sated",mod:f.Sufficient},stuffed:{reason:"Stuffed",mod:f.Abundant}},I={warning:.5,sufficient:1,abundant:3},C={warning:.5,sufficient:1,abundant:3};function _(e){switch(e){case"builder":return"shelter";case"doc":return"medicine";case"entertainer":return"fun";default:case"farmer":return"food"}}function M(e){switch(e){case"shelter":return"builder";case"medicine":return"doc";case"fun":return"entertainer";default:case"food":return"farmer"}}var O={food:"\ud83e\udd6a",shelter:"\ud83c\udfe0",medicine:"\ud83d\udc8a",fun:"\ud83d\udc4f"},B={love:"\ud83d\udc9b",happiness:"\ud83d\udc4d",unhappiness:"\ud83d\udca2",hate:"\ud83d\udc94"},A={love:5,happiness:1,unhappiness:-1,hate:-5},P={love:1,happiness:.2,unhappiness:0,hate:-1};var T={common:3,uncommon:2,rare:1},H={prog:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"Strives to help others",rarity:"common"},trad:{noun:"Elitism",adj:"Elitist",icon:"\ud83d\udc51",description:"Strives for individual power",rarity:"common"},state:{noun:"Collectivism",adj:"Collectivist",icon:"\ud83d\udd4a\ufe0f",description:"Trusts in the social group",rarity:"common"},ego:{noun:"Independence",adj:"Independent",icon:"\ud83e\udd85",description:"Trusts only in oneself",rarity:"common"}},G={rocket:{noun:"Futurism",adj:"Futuristic",icon:"\ud83d\ude80",description:"Loves stories of the far future",rarity:"common"},dragon:{noun:"Mythology",adj:"Mythical",icon:"\ud83d\udc32",description:"Loves stories of the legendary past",rarity:"common"},music:{noun:"Drama",adj:"Dramatic",icon:"\ud83c\udfb5",description:"Loves stories of emotional bonding",rarity:"common"},noFaith:{noun:"Nihilism",adj:"Nihilist",icon:"\u26ab\ufe0f",description:"Hates fairy tales",rarity:"common"}},F={Diligence:{noun:"Diligence",adj:"Diligence",icon:"\ud83d\udcaa",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udc4d while working"},Natalism:{noun:"Natalism",adj:"Natalist",icon:"\ud83d\udc76",rarity:"common",description:"Extra \ud83c\udfb2 for \ud83d\udc76;Extra \ud83d\udc4d after birth"},Antinatalism:{noun:"Antinatalism",adj:"Antinatalist",icon:"\ud83d\udeb7",rarity:"uncommon",description:"Less \ud83c\udfb2 for \ud83d\udc76;\ud83d\udca2 after birth"},Charity:{noun:"Charity",adj:"Charitable",icon:"\ud83d\ude07",rarity:"uncommon",description:"\ud83c\udfb2 to gift \ud83d\udcb0 to the penniless; and spread \ud83d\udc4d"},Progressivism:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when paying taxes"},Libertarianism:{noun:"Libertarianism",adj:"Libertarian",icon:"\ud83d\udd2b",rarity:"rare",description:"\ud83c\udfb2 to \ud83d\udca2 when paying taxes"},Wanderlust:{noun:"Wanderlust",adj:"Wanderer",icon:"\ud83d\udd2d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when travelling"},Germophobia:{noun:"Germophobia",adj:"Germophobic",icon:"\ud83e\udd27",rarity:"rare",description:"\ud83d\udca2 when sick or working in hospital"},Parochialism:{noun:"Parochialism",adj:"Parochial",icon:"\ud83d\udc2e",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udf3e; \ud83d\udca2 from dense houses"},Cosmopolitanism:{noun:"Cosmopolitanism",adj:"Cosmopolitan",icon:"\ud83c\udf78",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udfbb; \ud83d\udca2 from rural houses"},Capitalism:{noun:"Capitalism",adj:"Capitalist",icon:"\ud83c\udfa9",rarity:"common",description:"\ud83d\udca2 working in co-ops and communes; Extra \ud83d\udc4d when owner"},Socialism:{noun:"Socialism",adj:"Socialist",icon:"\ud83e\udd1d",rarity:"common",description:"Extra \ud83d\udc4d working in co-ops"},Communism:{noun:"Communism",adj:"Communist",icon:"\u2692\ufe0f",rarity:"common",description:"\ud83d\udca2 working in companies"},Fraud:{noun:"Fraud",adj:"Fraudulent",icon:"\ud83e\udd25",rarity:"uncommon",description:"\ud83c\udfb2 to avoid taxes; Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime"},Naturalism:{noun:"Naturalism",adj:"Naturalist",icon:"\ud83d\udef6",rarity:"uncommon",description:"Extra \ud83d\udc4d from \ud83d\ude0e; \ud83d\ude0e 3x longer"},Hedonism:{noun:"Hedonism",adj:"Hedonistic",icon:"\ud83d\udc8b",rarity:"uncommon",description:"\ud83c\udfb2 to emote extra \ud83d\udc4d;\ud83c\udfb2 to \ud83d\udca2 when working;"},Gluttony:{noun:"Gluttony",adj:"Glutton",icon:"\ud83c\udf83",rarity:"common",description:"Extra \ud83d\udc4d when stuffed; Extra \ud83d\udca2 when hungry;"},Paranoia:{noun:"Paranoia",adj:"Paranoid",icon:"\ud83d\udc7d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udca2 at any time"},Depression:{noun:"Depression",adj:"Depressive",icon:"\ud83d\ude13",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udca2 when unhappy"},Optimism:{noun:"Optimism",adj:"Optimistic",icon:"\ud83d\ude3a",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when happy"},Authority:{noun:"Authority",adj:"Authoritarian",icon:"\ud83d\udc62",rarity:"common",description:"Less \ud83c\udfb2 for all \ud83d\ude08 Crime"},Anarchism:{noun:"Anarchism",adj:"Anarchist",icon:"\ud83d\udd95",rarity:"uncommon",description:"Extra \ud83c\udfb2 for all \ud83d\ude08 Crime"},Greed:{noun:"Greed",adj:"Greedy",icon:"\ud83e\udd11",rarity:"common",description:"Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime; Extra \ud83d\udc4d when rich"},Bloodthirst:{noun:"Bloodthirst",adj:"Bloodthirsty",icon:"\ud83e\ude78",rarity:"rare",description:"High \ud83c\udfb2 to \u2620\ufe0f Kill during \ud83d\ude08 Crime"},Extroversion:{noun:"Extroversion",adj:"Extroverted",icon:"\ud83e\udd29",rarity:"common",description:"Extra \ud83c\udfb2 to start a \ud83d\udde3\ufe0f"},Introversion:{noun:"Introversion",adj:"Introverted",icon:"\ud83e\udd13",rarity:"uncommon",description:"Less \ud83c\udfb2 to be in a \ud83d\udde3\ufe0f"},Charisma:{noun:"Charisma",adj:"Charismatic",icon:"\ud83d\ude0f",rarity:"uncommon",description:"More \ud83c\udfb2 to persuade in a \ud83d\udde3\ufe0f"},Gossip:{noun:"Gossip",adj:"Gossipy",icon:"\ud83d\udcde",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f; \ud83c\udfb2 to \ud83d\udc4d after \ud83d\udde3\ufe0f"},Antagonism:{noun:"Antagonism",adj:"Antagonistic",icon:"\ud83e\udd2c",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f"},Enthusiasm:{noun:"Enthusiasm",adj:"Enthusiastic",icon:"\ud83e\udd73",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udc4d in a \ud83d\udde3\ufe0f"},Sadism:{noun:"Sadism",adj:"Sadistic",icon:"\ud83d\ude08",rarity:"rare",description:"\ud83c\udfb2 to \u2620\ufe0f Kill in a \ud83d\udde3\ufe0f;\ud83d\udc4d from \u2620\ufe0f Kill"},Vandalism:{noun:"Vandalism",adj:"Vandal",icon:"\ud83d\udca9",rarity:"rare",description:"\ud83c\udfb2 to destroy goods;\ud83d\udc4d from \ud83d\ude08 Theft Crime"},Neuroticism:{noun:"Neuroticism",adj:"Neurotic",icon:"\ud83d\ude31",rarity:"rare",description:"+100% \ud83e\udde0 damage"},Dogmatism:{noun:"Dogmatism",adj:"Dogmatic",icon:"\ud83d\udc36",rarity:"uncommon",description:"Cannot change beliefs"}};var q=Object.keys(F).map((function(e){return e})),R=Object.keys(F).reduce((function(e,t){for(var n=t,a=T[F[n].rarity],i=0;i<a;i++)e.push(n);return e}),[]);function L(e){if(0===e.length)return{all:{},flatAverage:0,weightedAverage:0,maxSource:"",minSource:""};for(var t={},n=0,a=0,i=0;i<e.length;i++){for(var r=e[i],s=0,c=Object.keys(r),o=0;o<c.length;o++){var l=c[o];s+=r[l],t[l]||(t[l]=0),t[l]+=r[l]}n+=s/(i+1),a+=s}var u=Object.keys(t);return{flatAverage:a/e.length,weightedAverage:n,maxSource:u.reduce((function(e,n){return t[n]>e.val?{source:n,val:t[n]}:e}),{source:"",val:0}).source,minSource:u.reduce((function(e,n){return t[n]<e.val?{source:n,val:t[n]}:e}),{source:"",val:0}).source,all:t}}var z=n(5),W=n(6);function U(e,t){return Array.isArray(e)?e.some((function(e){return J(e,t)})):J(e,t)}function J(e,t){return t[e]}function V(e){return F[e].icon+" "+F[e].noun}var $={food_aid:{key:"food_aid",group:"Welfare",name:"Food Aid",axis:"wel_food",icon:"\ud83d\udc68\u200d\ud83c\udf3e",description:"The government buys Hungry Subjects food.",prereqs:[["Gluttony","Parochialism"],["Charity","Socialism"]]},medical_aid:{key:"medical_aid",group:"Welfare",name:"Med Aid",axis:"wel_health",icon:"\ud83d\udc69\u200d\u2695\ufe0f",description:"The government buys Sick Subjects medicine.",prereqs:["Charity","Cosmopolitanism"]},poll_tax:{key:"poll_tax",group:"Taxation",name:"Head Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udc51",description:"Subjects must pay a flat tax."},sales_tax:{key:"sales_tax",group:"Taxation",name:"Sales Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udcb8",description:"Subjects must pay a percentage tax for every transaction."},death_tax:{key:"death_tax",group:"Taxation",name:"Death Tax",axis:"tax_second",prereqs:[],icon:"\u2620\ufe0f",description:"Dead subjects pay a portion of their cash to the government."}};function X(e,t){var n;return(null===(n=e.lawTree[$[t].axis])||void 0===n?void 0:n.key)===t}function Y(e,t,n){if(void 0!=(a=t).food&&void 0!=a.sick)switch(n){case"food":return("starving"===t.food||"hungry"===t.food)&&X(e,"food_aid");case"medicine":return("sick"===t.health||"sickly"===t.health)&&X(e,"medical_aid")}var a;return!1}function Z(e,t){return e.cash>=t}var Q=["food","shelter","medicine","fun"];function ee(e,t,n,a,i,r,s){ne(e,t,n,a);var c=t.price*a,o=c*s,l=c+o;return i.cash-=l,r.cash+=c,r.ticksSinceLastSale=0,{bought:a,price:c,tax:o}}function te(e,t,n,a,i,r){ne(e,n,a,i);var s=n.price*i,c=s;return t.cash-=c,r.cash+=s,r.ticksSinceLastSale=0,{bought:i,price:s,tax:0}}function ne(e,t,n,a){t.quantity-=a,t.quantity<=0&&e.listings[n].splice(0,1)}function ae(e,t,n,a,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;e.monthlyDemand[a]+=s;var c=se(e.market,a,r);if(null!=c){var o=Math.min(c.quantity,s),l=X(t,"sales_tax")?.05:0;if(c.price*(1+l)<=n.cash*o){var u=ee(e.market,c,a,o,n,i(c),l);return u.tax&&(t.cash+=u.tax),u}if(Y(t,n,a)&&Z(t,c.price))return te(e.market,t,c,a,o,i(c));e.unfulfilledMonthlyDemand[a]+=o}else e.unfulfilledMonthlyDemand[a]+=s}function ie(e,t){var n=e.monthlySupply[t]||1,a=e.monthlyDemand[t];return.25+.75*Math.min(a/n,1)}function re(e){return ie(e,"food")+ie(e,"shelter")+ie(e,"medicine")}function se(e,t,n){var a=e.listings[t].filter((function(e){return e.quantity>=n}));if(a.length>0){for(var i=1,r=a[0].price,s=1;s<a.length;s++){if(a[s].price>r)break;i++}var c=Math.floor(Math.random()*i);if(c>=a.length)throw"invalid index";return a[c]}return null}function ce(e){for(var t=e.length;t>0;){var n=Math.floor(Math.random()*t),a=e[--t];e[t]=e[n],e[n]=a}return e}function oe(e,t,n){return Math.max(Math.min(e,n),t)}var le=function e(t,n){Object(c.a)(this,e),this.q=t,this.r=n},ue=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}];function me(e){return ue[e]}function de(e,t){var n=me(t);return{q:e.q+n.q,r:e.r+n.r}}function he(e,t){for(var n,a,i=[],r=function(e,t){return{q:e.q+t.q,r:e.r+t.r}}(e,(n=me(4),a=t,{q:n.q*a,r:n.r*a})),s=0;s<6;s++)for(var c=0;c<t;c++)i.push(r),r=de(r,s);return i}function ye(e,t){for(var n=[e],a=0;a<t;a++)n=n.concat(he(e,a));return n}var pe={point:{x:0,y:0},velocity:{x:0,y:0}};function fe(e,t,n,a,i,r){var s={x:t.x-e.point.x,y:t.y-e.point.y},c=Math.sqrt(s.x*s.x+s.y*s.y);return c<=i||(s.x/=c,s.y/=c,e.velocity.x+=s.x*n,e.velocity.y+=s.y*n,e.velocity.x=oe(e.velocity.x,-a,a),e.velocity.y=oe(e.velocity.y,-a,a),be(e,r),!1)}function be(e,t){e.velocity.x*=t.x,e.velocity.y*=t.y,e.point.x+=e.velocity.x,e.point.y+=e.velocity.y}function ve(e,t,n){return e+(t-e)*n}function ge(e,t,n){return{x:ve(e.x,t.x,n),y:ve(e.y,t.y,n),z:ve(e.z,t.z,n)}}function Ee(e){var t=Math.round(e.x),n=Math.round(e.y),a=Math.round(e.z),i=Math.abs(t-e.x),r=Math.abs(n-e.y),s=Math.abs(a-e.z);return i>r&&i>s?t=-n-a:r>s?n=-t-a:a=-t-n,{x:t,y:n,z:a}}function ke(e){var t=e.x,n=e.z;return new le(t,n)}function we(e){return{x:e.q,z:e.r,y:-e.q-e.r}}function xe(e,t){for(var n=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z))/2}(e,t),a=[],i=0;i<=n;i++)a.push(ke(Ee(ge(e,t,1/n*i))));return a}var De=new function e(t,n,a,i,r,s,o,l,u){Object(c.a)(this,e),this.f0=t,this.f1=n,this.f2=a,this.f3=i,this.b0=r,this.b1=s,this.b2=o,this.b3=l,this.start_angle=u}(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0),Ne={x:0,y:0};function Se(e,t,n){var a=De,i=(a.f0*n.q+a.f1*n.r)*e.x,r=(a.f2*n.q+a.f3*n.r)*e.y;return{x:i+t.x,y:r+t.y}}function je(e){return{x:e.r*Math.cos(e.az),y:e.r*Math.sin(e.az)}}function Ke(e){return{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}}var Ie={farm:"\ud83d\udc04",house:"\ud83c\udfe1",hospital:"\ud83c\udfe5",church:"\u26ea",theater:"\ud83c\udfaa",courthouse:"\ud83c\udfeb",park:"\u26f2\ufe0f",nature:"\ud83c\udfde\ufe0f"},Ce={farm:"\ud83d\ude9c",house:"\ud83c\udfd8\ufe0f",hospital:"\ud83c\udfd9\ufe0f",church:"\u26ea",theater:"\ud83c\udfdf\ufe0f",courthouse:"\ud83c\udfeb",park:"\ud83c\udfa1",nature:"\ud83c\udfde\ufe0f"},_e={farm:"\ud83c\udf3e",house:"\ud83d\udcea",hospital:"\ud83d\udecf\ufe0f",church:"\u26ea",theater:"\ud83e\ude91",courthouse:"\ud83c\udfeb",park:"\ud83d\udc90",nature:"\u2668\ufe0f"},Me={farm:"food",house:"shelter",hospital:"medicine",church:"fun",theater:"fun",courthouse:"fun",park:"fun",nature:"fun"},Oe={food:"farm",shelter:"house",medicine:"hospital",fun:"theater"},Be={farmer:"farm",builder:"house",doc:"hospital",entertainer:"theater",cleric:"church",jobless:"house",polit:"house"},Ae={farm:"farmer",house:"builder",hospital:"doc",theater:"entertainer",church:"cleric",park:"entertainer",nature:"entertainer",courthouse:"polit"};function Pe(){return{numberOfRings:5,hexes:ye({q:0,r:0},5),hex_size:{x:70,y:70},petriRadius:545,petriOrigin:{x:545,y:545}}}var Te=["farm","hospital","house","theater"];function He(e){return[0,1,2,3,4,5].filter((function(t,n){return null==e.jobs[+t]&&(n<3||e.upgraded)})).map((function(e){return+e}))}function Ge(e,t){var n=e.jobs.length;return e.jobs=e.jobs.filter((function(e){return e!=t})),n===e.jobs.length+1}function Fe(e,t,n,a,i){var r={type:n,key:e.buildings.nextID++,address:a,jobs:[],upgraded:!1};e.buildings.allIDs.push(r.key),e.buildings.byID[r.key]=r,t.buildingKeys.push(r.key),t.buildingMap["".concat(a.q,",").concat(a.r)]=r.key,Te.some((function(e){return n}))&&(r.enterpriseKey=r.key,e.enterprises.allIDs.push(r.key),e.enterprises.byID[r.key]={cash:0,cityKey:t.key,enterpriseType:"company",key:r.key,ticksSinceLastSale:0});var s=Me[n];return"fun"!=s&&e.economy.market.listings[s].push({price:1,quantity:3,sellerCityKey:t.key,sellerEnterpriseKey:r.key}),r}var qe=new(function(){function e(){Object(c.a)(this,e),this.cache={ufo:{},bean:{},pickup:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]=new y),this.cache[e][t]}}]),e}());function Re(e,t){"jobless"!==t.job&&Ge(e,t.key)&&(t.employerEnterpriseKey=void 0,t.job="jobless")}function Le(e,t){var n=new Uint32Array(1);window.crypto.getRandomValues(n);var a=n[0]/4294967296;return e=Math.ceil(e),t=Math.floor(t),Math.floor(a*(t-e+1))+e}function ze(e){return function(){var e=new ArrayBuffer(8),t=new Int8Array(e);return window.crypto.getRandomValues(t),t[7]=63,t[6]|=240,new DataView(e).getFloat64(0,!0)-1}()<=e}function We(e){return 1==e.length?e[0]:e[Le(0,e.length-1)]}function Ue(){return We(["circle","square","triangle"])}Math.PI;var Je=["New ","Old ","Fort ","St. ","Mount ","Grand ","","","","","","","","","",""],Ve=["Spring","Timber","Over","West","East","North","South","Rock","Sand","Clay","Iron","Ore","Coal","Liver","Hawk","Red","Yellow","Gold","Blue","Black","White","Sunny","Reed","Ox","Mill","Fern","Down","Bel","Bald","Ash"],$e=["water "," Springs","ville","dale","lane","peak","coast","beach","port","market","ton","brook"," Creek","land","burgh","bridge","ford","bury","chester","son","vale"," Valley","hill","more","wood"," Oaks"," Cove","mouth","way","crest"];function Xe(){return"".concat(We(Je)).concat(We(Ve)).concat(We($e))}function Ye(e,t,n,a,i){var r={key:e.beans.nextID++,cityKey:t.key,name:"",ethnicity:Ue(),community:We(["state","ego"]),ideals:We(["prog","trad"]),faith:We(["rocket","music","dragon","noFaith"]),stamina:"awake",health:"fresh",food:"sated",discrete_food:3,discrete_health:2,discrete_sanity:10,discrete_stamina:7,discrete_fun:0,graceTicks:0,dob:{year:e.date.year,season:e.date.season,day:e.date.day,hour:e.date.hour},sanity:"sane",beliefs:[],lifecycle:"alive",hedonHistory:[{},{},{},{},{}],job:"jobless",happiness:{flatAverage:0,all:{},maxSource:"",minSource:"",weightedAverage:0},lastHappiness:0,hedonFiveDayRecord:{max:0,min:0},fairGoodPrice:0,bornInPetri:null!=n,cash:3,ticksSinceLastSale:0,ticksSinceLastRelax:0,lastChatMS:0,action:"idle",actionData:{act:"idle"},activity_duration:{buy:0,chat:0,craze:0,crime:0,idle:0,relax:0,sleep:0,soapbox:0,travel:0,work:0}};r.name=We(["Joe","Frank","Jill","Jose","Johnny","Isabelle","Carmen","Ace","Carl","Zander","Jean","Anne","Leslie","Ben","Ron","Ellen","Dallas","Kane","Ash","Jim","James","Leonard","Nyota","Christine","Scotty","Tasha","Geordi","Beverly","Deanna","Wesley","Majel","Malcolm","River","Luke","Han","Owen","Rey","Mace","Cody","Dana","Walter","Rick","Holden","Roy","Pris","Eldon","Rachael","Rose","Donna","Jack","Amy","Rory","Martha","Clara","Arnold","Dave","Holly","Kara","Gaius","William","Lee","Laura","Saul","Max","Edison","Theora","Bryce","Murray","Ned","Daniel","Samantha","Logan","Francis","Jessica","Thomas","Benny","James","John Henry","Sarah","Piper","Nick","Shaun","Preston"])+" ",r.name+=We(["Ripley","Bishop","Hicks","Vasquez","Hudson","Rico","Flores","Ibanez","Levy","Jenkins","Barlow","Zim","Rasczak","Kirk","McCoy","Sulu","Uhura","Chekov","Chapel","Rand","Riker","Crusher","Barret","O'Brien","Reynolds","Tam","Scully","Mulder","Skinner","Connor","Rex","Thrace","Baltar","Smith","Adama","Roslin","Tigh","Song","Oswald","Deckard","Bryant","Tyrell","Sebastian","Voight","Kampff","Tyler","Harkness","Jones","Noble","Pond","Williams","Rimmer","Lister","Head","Carter","Lynch","McKenzie","Grossberg","O'Neil","Jackson","Carter","Whitmore","House","Mitchell","Eden","Lyons","Valentine","Garvey"]);for(var s=Math.ceil(3*Math.random());r.beliefs.length<s;){var c=We(R);r.beliefs.includes(c)||r.beliefs.push(c)}return n&&(r.ethnicity=n.ethnicity,r.name=r.name.split(" ")[0]+" "+n.name.split(" ")[1],r.cash=n.cash/2,n.cash/=2),r}function Ze(e,t){return{key:0,point:Object(W.a)({},(qe.Get("bean",e.key).current||pe).point),type:t,velocity:{x:0,y:0}}}var Qe=.1,et=.1,tt=function(){function e(){var t=this;Object(c.a)(this,e),this.actionData={act:"idle"},this.key=0,this.cityKey=0,this.dob={year:0,season:0,day:1,hour:0},this.bornInPetri=!1,this.name="Human Bean",this.discrete_sanity=10,this.discrete_fun=0,this.lifecycle="alive",this.activity_queue=[],this.activity_duration={buy:0,chat:0,craze:0,crime:0,idle:0,relax:0,sleep:0,soapbox:0,travel:0,work:0},this.speed=60,this.point={x:0,y:0},this.velocity={x:0,y:0},this.onMove=new y,this.destinationKey=0,this.city=null,this.action="idle",this.ethnicity=Ue(),this.discrete_food=1,this.stamina="awake",this.discrete_health=2,this.community="ego",this.ideals="trad",this.job="jobless",this.employerEnterpriseKey=void 0,this.faith="noFaith",this.beliefs=[],this.cash=3,this.graceTicks=6,this.hedonHistory=[{}],this.happiness=L(this.hedonHistory),this.hedonFiveDayRecord={min:0,max:0},this.lastHappiness=0,this.ticksSinceLastSale=0,this.ticksSinceLastRelax=0,this.discrete_stamina=7,this.fairGoodPrice=1,this.lastChatMS=Date.now(),this.buy={food:function(e){return null!=t.buyFood(e)},medicine:function(e){return null!=t.buyMeds(e)},fun:function(e){return t.buyFun(e)},shelter:function(e){return t.buyHousing(e)}}}return Object(o.a)(e,[{key:"believesIn",value:function(e){return ct(this,e)}},{key:"getHappinessModifiers",value:function(e,t,n){var a,i=[K[this.food],K[this.stamina],K[this.health],{reason:"Entertainment",mod:.4*this.discrete_fun}];return"trad"===this.ideals&&this.ethnicity!=t.majorityEthnicity&&i.push({reason:"Xenophobic",mod:-.1}),"ego"===this.community&&"jobless"!=this.job&&this.employerEnterpriseKey&&(null===(a=t.book.db.get.get(this.employerEnterpriseKey))||void 0===a?void 0:a.upgraded)&&i.push({reason:"Hates Building Density",mod:-.1}),this.cash<1?i.push({reason:"Penniless",mod:f.Deficient}):this.cash>3*e.getCostOfLiving()?i.push({reason:"Upper Class",mod:.3}):this.cash>2*e.getCostOfLiving()&&i.push({reason:"Middle Class",mod:.15}),"jobless"===this.job&&i.push({reason:"Unemployed",mod:f.Deficient}),i}},{key:"getSentimentModifiers",value:function(e,t,n,a){var i={party:[],law:[]};return this.community===a.community&&i.party.push({reason:"Same Community",mod:.15}),this.ideals===a.ideals?i.party.push({reason:"Same Ideals",mod:.15}):this.community!=a.community&&i.party.push({reason:"Incompatible Values",mod:-.15}),i}},{key:"calculateBeliefs",value:function(e,t,n,a){if(this.hedonFiveDayRecord={min:Math.min(this.hedonFiveDayRecord.min,this.happiness.flatAverage),max:Math.max(this.hedonFiveDayRecord.max,this.happiness.flatAverage)},0===this.happiness.flatAverage?this.lastHappiness=0:this.lastHappiness=this.happiness.flatAverage>=0?this.happiness.flatAverage/this.hedonFiveDayRecord.max*100:this.happiness.flatAverage/this.hedonFiveDayRecord.min*100,"jobless"===this.job)this.fairGoodPrice=1;else{var i=_(this.job);this.fairGoodPrice=e.getFairGoodPrice(i)}}},{key:"getSentimentPolicies",value:function(e,t){var n=100;return t.forEach((function(t){t.fx.forEach((function(t){e[t.key]&&(n+=10*t.mag)}))})),n/100}},{key:"_getTraitMap",value:function(){var e,t=(e={},Object(v.a)(e,this.community,!0),Object(v.a)(e,this.ideals,!0),Object(v.a)(e,this.ethnicity,!0),e);return"noFaith"!=this.faith&&(t[this.faith]=!0),t}},{key:"getIdea",value:function(e){return"hungry"===this.food?{bad:!0,idea:"\ud83c\udf57"}:"sickly"===this.health?{bad:!0,idea:"\ud83d\udc8a"}:"homeless"===this.stamina?{bad:!0,idea:"\ud83c\udfe0"}:this.canBaby(e)?{bad:!1,idea:"\ud83d\udc76"}:null}},{key:"getSpeech",value:function(){var e;if("chat"===this.action&&("speaker"===(null===(e=this.actionData.chat)||void 0===e?void 0:e.participation)&&this.actionData.chat.preachBelief))return"\ud83d\udcac"+F[this.actionData.chat.preachBelief].icon}},{key:"getCrimeDecision",value:function(e,t){var n=Math.random(),a=.05;return"ego"===this.community&&(a+=.1),("desperation"===t&&"sick"===this.health||"starving"===this.food)&&(a+=.15),a<=n}},{key:"tryFindRandomJob",value:function(e){We(["builder","doc","farmer","entertainer"])}},{key:"canPurchase",value:function(e,t){return void 0===e.sanity||this.discrete_sanity>=e.sanity+t}},{key:"maybeParanoid",value:function(){this.ifBelievesInMaybeEmote("Paranoia","unhappiness",.05)}},{key:"maybeAntagonised",value:function(){this.emote("unhappiness","Antagonism")}},{key:"maybeEnthused",value:function(){this.emote("happiness","Enthusiasm")}},{key:"maybePersuade",value:function(e,t){if(!this.believesIn("Dogmatism")&&!this.beliefs.includes(e)){var n,a,i=10+Le(1,6);if(i+=this.beliefs.length-2,Le(1,20)+t>i)this.beliefs=[].concat(Object(h.a)(this.beliefs),[e]),null===(n=this.city)||void 0===n||null===(a=n.eventBus)||void 0===a||a.persuasion.publish({key:0,icon:"\ud83d\udde3\ufe0f",trigger:"persuasion",message:"".concat(this.name," now believes in ").concat(F[e].icon," ").concat(F[e].noun,"!"),beanKey:this.key,cityKey:this.cityKey,point:this.point})}}},{key:"maybeChat",value:function(){if(this.lastChatMS+4e3>Date.now())return!1;if("chat"===this.action)return!1;var e=Math.random(),t="state"===this.community?.2:.1;return this.believesIn("Extroversion")&&(t+=.25),this.believesIn("Introversion")&&(t+=-.15),e<t}},{key:"getRandomChat",value:function(e){var t=this;if(this.beliefs.length){if(this.believesIn("Charity")&&this.cash>=2){var n=e.filter((function(e){return e.cash<=t.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),null);if(n)return this.cash-=.5,this.emote("happiness","Charity"),n.cash+=.5,n.emote("happiness","Charity"),{participation:"speaker",type:"gift",targetBeanKey:n.key}}else{if(this.believesIn("Enthusiasm")&&Math.random()<.45)return{participation:"speaker",type:"praise",preachBelief:"Enthusiasm"};if(this.believesIn("Antagonism")&&Math.random()<.45)return{participation:"speaker",type:"bully",preachBelief:"Antagonism"};if(this.believesIn("Gossip")&&Math.random()<.35)return{participation:"speaker",type:"bully",preachBelief:"Gossip"}}return{participation:"speaker",type:"preach",preachBelief:We(this.beliefs),persuasionStrength:1+(this.believesIn("Charisma")?2:0)}}return{participation:"speaker",type:"praise"}}},{key:"work",value:function(e,t){var n=this;if("jobless"===this.job);else{switch(this.job){case"farmer":this.discrete_food=Math.min(this.discrete_food+1,2*I.sufficient),this.ifBelievesInMaybeEmote("Parochialism","happiness",.25);break;case"doc":this.discrete_health=Math.min(this.discrete_health+1,2*C.sufficient),this.ifBelievesInMaybeEmote("Germophobia","unhappiness",.25);break;case"builder":this.stamina="awake",this.discrete_stamina=7;break;case"entertainer":this.ifBelievesInMaybeEmote("Cosmopolitanism","happiness",.25)}if(this.ifBelievesInMaybeEmote("Diligence","happiness",.25),this.ifBelievesInMaybeEmote("Hedonism","unhappiness",.15),this.ticksSinceLastSale++,this.ticksSinceLastSale>7)if(!!this.city&&this.city.beans.get.filter((function(e){return e.job===n.job})).length>1&&Math.random()>.5)t.mostInDemandJob();var a=!1;if(this.city&&this.employerEnterpriseKey){var i=this.city.getEnterprise(this.employerEnterpriseKey);if(i)switch(t.employAndPrice(i,_(this.job),4,this.fairGoodPrice),a=!0,i.enterpriseType){case"company":this.ifBelievesInMaybeEmote("Communism","unhappiness",.1),i.ownerBeanKey===this.key&&this.ifBelievesInMaybeEmote("Capitalism","happiness",.1);break;case"co-op":this.ifBelievesInMaybeEmote("Capitalism","unhappiness",.1),this.ifBelievesInMaybeEmote("Socialism","happiness",.1);break;case"commune":this.ifBelievesInMaybeEmote("Capitalism","unhappiness",.1)}}a||t.produceAndPrice(this,_(this.job),4,this.fairGoodPrice)}}},{key:"buyFood",value:function(e){var t=e.tryTransact(this,"food",.5,3);return t&&(this.discrete_food+=t.bought,"stuffed"===this.food&&(this.emote("happiness","Stuffed"),this.ifBelievesInMaybeEmote("Gluttony","happiness",1))),t}},{key:"steal",value:function(e,t){var n=t.steal(e,3);if(null!=n)switch(e){case"food":this.discrete_food+=n;break;case"medicine":this.discrete_health+=n}}},{key:"buyHousing",value:function(e){var t=e.tryTransact(this,"shelter");return t?(this.discrete_stamina=10,this.stamina="awake"):this.discrete_stamina<=0&&(this.stamina="homeless"),null!=t}},{key:"buyFun",value:function(e){var t=e.tryTransact(this,"fun");return t&&(this.discrete_fun=1,this.emote("happiness","Entertainment"),this.emote("happiness","Entertainment")),null!=t}},{key:"age",value:function(e,t){if(!this.alive)return null;var n="starving"!==this.food,a="sick"!==this.health;return this.discrete_food-=t.bean_life.degrade_per_tick.food,this.discrete_food<0&&(this.discrete_health-=.2),this.maybeDie("starvation","starving"===this.food,.6)?null:("starving"===this.food&&n&&(this.emote("unhappiness","Starving"),this.believesIn("Gluttony")&&(this.emote("unhappiness","Gluttony"),this.emote("unhappiness","Gluttony"))),this.discrete_stamina-=t.bean_life.degrade_per_tick.stamina,this.maybeDie("exposure","homeless"===this.stamina,.2)||(this.discrete_health-=t.bean_life.degrade_per_tick.health,this.discrete_health=Math.min(this.discrete_health,3),this.maybeDie("sickness","sick"===this.health,.4)||("sick"===this.health&&a&&(this.emote("unhappiness","sick"),this.believesIn("Germophobia")&&this.emote("unhappiness","Germophobia")),this.discrete_fun-=t.bean_life.degrade_per_tick.fun,this.discrete_fun=Math.max(0,this.discrete_fun),this.isInCrisis||(this.graceTicks=oe(this.graceTicks+1,0,6)))),null)}},{key:"buyMeds",value:function(e){var t=e.tryTransact(this,"medicine",.5,3);return t&&(this.discrete_health+=t.bought,"fresh"===this.health&&this.emote("happiness","Robust")),t}},{key:"maybeBaby",value:function(e){if(this.canBaby(e.getCostOfLiving())&&ze(this.babyChance)){if(!this.city)throw"bean does not have city object";return this.city.breedBean(this),this.believesIn("Natalism")?this.emote("love","Natalist Parent"):this.believesIn("Antinatalism")?this.emote("hate","Antinatalism"):this.emote("happiness","Proud Parent"),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(this.name," has a baby!"),key:0}}return null}},{key:"canBaby",value:function(e){return this.alive&&this.cash>3*e&&!this.isInCrisis}},{key:"maybeCrime",value:function(e){if("shelter"===e)return!1;if("fun"===e)return!1;var t=Math.random(),n=.05;return"ego"===this.community&&(n+=.1),this.isInCrisis&&(n+=.1),this.believesIn("Greed")&&(n+=.25),this.believesIn("Anarchism")&&(n+=.33),this.believesIn("Authority")&&(n+=-.25),("food"===e&&"starving"===this.food||"medicine"===e&&"sick"===this.health)&&(n+=.25),n<=t}},{key:"ifBelievesInMaybeEmote",value:function(e,t,n){this.believesIn(e)&&Math.random()<n&&this.emote(t,e)}},{key:"emote",value:function(e,t){var n,a;(this.discrete_sanity=oe(this.discrete_sanity+P[e],0,10),this.hedonHistory[0][t]=(this.hedonHistory[0][t]||0)+A[e],null===(n=this.city)||void 0===n||n.addEmotePickup(this.point,e),this.believesIn("Hedonism")&&("happiness"===e||"love"===e)&&Math.random()<.1)&&(null===(a=this.city)||void 0===a||a.addEmotePickup(this.point,e))}},{key:"canBuy",value:function(e){var t,n;return(null===(t=this.city)||void 0===t||null===(n=t.economy)||void 0===n?void 0:n.canBuy(this,e))||"nosupply"}},{key:"maybeDie",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;if(t&&Math.random()<=n){if(this.graceTicks<=0)return this.die(e),!0;this.graceTicks--}return!1}},{key:"die",value:function(e){var t,n,a,i;this.alive=!1;for(var r=Le(2,3),s=0;s<r;s++)this.emote("hate","death");null===(t=this.city)||void 0===t||t.beans.remove(this),null===(n=this.city)||void 0===n||n.historicalBeans.push(this),null===(a=this.city)||void 0===a||null===(i=a.eventBus)||void 0===i||i.death.publish({icon:"\u2620\ufe0f",trigger:"death",message:"".concat(this.name," died of ").concat(e,"!"),beanKey:this.key,cityKey:this.cityKey,point:this.point,key:0})}},{key:"maybeScarcity",value:function(e){var t=!1;("food"!==e||"starving"!==this.food&&"hungry"!==this.food)&&("shelter"!==e||"homeless"!==this.stamina&&"sleepy"!==this.stamina)&&("medicine"!==e||"sick"!==this.health&&"sickly"!==this.health)||(t=!0),t&&this.emote("unhappiness","Scarcity")}},{key:"abduct",value:function(e){this.lifecycle="abducted"}},{key:"sanity",get:function(){return this.discrete_sanity>=8?"sane":this.discrete_sanity>=5?"stressed":this.discrete_sanity>=3?"disturbed":"psychotic"}},{key:"alive",get:function(){return"alive"===this.lifecycle},set:function(e){this.lifecycle=!0===e?"alive":"dead"}},{key:"food",get:function(){return this.discrete_food>=I.abundant?"stuffed":this.discrete_food>=I.sufficient?"sated":this.discrete_food>=I.warning?"hungry":"starving"}},{key:"health",get:function(){return this.discrete_health>=C.abundant?"fresh":this.discrete_health>=C.sufficient?"bruised":this.discrete_health>=C.warning?"sickly":"sick"}},{key:"isInCrisis",get:function(){return ht(this)}},{key:"babyChance",get:function(){var e=.008;return this.believesIn("Natalism")&&(e+=.04),this.believesIn("Antinatalism")&&(e+=-.002),e}}]),e}();function nt(e,t){return e.discrete_health>=C.abundant?e.health="fresh":e.discrete_health>=C.sufficient?e.health="bruised":e.discrete_health>=C.warning?e.health="sickly":e.health="sick",e.health}function at(e,t){return e.discrete_stamina<0?e.stamina="homeless":e.stamina="rested",e.stamina}function it(e,t){return e.discrete_food>=I.abundant?e.food="stuffed":e.discrete_food>=I.sufficient?e.food="sated":e.discrete_food>=I.warning?e.food="hungry":e.food="starving",e.food}function rt(e){if(e.lastChatMS+4e3>Date.now())return!1;if("chat"===e.action)return!1;var t=Math.random(),n="state"===e.community?.2:.1;return ct(e,"Extroversion")&&(n+=.25),ct(e,"Introversion")&&(n+=-.15),t<n}function st(e,t,n){e.discrete_sanity=oe(e.discrete_sanity+P[t],0,10),e.hedonHistory[0][n]=(e.hedonHistory[0][n]||0)+A[t];var a=[Ze(e,t)];return ct(e,"Hedonism")&&("happiness"===t||"love"===t)&&Math.random()<.1&&a.push.apply(a,Object(h.a)(st(e,"happiness","Hedonism"))),a}function ct(e,t){return-1!==e.beliefs.indexOf(t)}function ot(e,t){return function(e,t){return"alive"===e.lifecycle&&e.cash>3*t&&!ht(e)}(e,t)&&ze(function(e){var t=.008;ct(e,"Natalism")&&(t+=.04);ct(e,"Antinatalism")&&(t+=-.002);return t}(e))?(ct(e,"Natalism")?st(e,"love","Natalist Parent"):ct(e,"Antinatalism")?st(e,"hate","Antinatalism"):st(e,"happiness","Proud Parent"),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(e.name," has a baby!"),key:0}):void 0}function lt(e,t,n,a){if(n&&Math.random()<=a){if(e.graceTicks<=0)return ut(e,t);e.graceTicks--}}function ut(e,t){e.lifecycle="dead";var n=Le(2,3),a=new Array(n).map((function(t){return Ze(e,"hate")}));return{death:{icon:"\u2620\ufe0f",trigger:"death",message:"".concat(e.name," died of ").concat(t,"!"),beanKey:e.key,cityKey:e.cityKey,point:(qe.Get("bean",e.key).current||pe).point,key:0},emotes:a}}function mt(e,t){var n=ct(e,"Neuroticism")?2:1;e.discrete_sanity-=n*t}function dt(e){var t;if("chat"===e.action&&("speaker"===(null===(t=e.actionData.chat)||void 0===t?void 0:t.participation)&&e.actionData.chat.preachBelief))return"\ud83d\udcac"+F[e.actionData.chat.preachBelief].icon}function ht(e){return"starving"===e.food||"homeless"===e.stamina||"sick"===e.health}function yt(e,t,n){return void 0===t.sanity||e.discrete_sanity>=t.sanity+n}function pt(e){var t,n;if("dead"===e.lifecycle)return"\ud83d\udc80";if("sleep"===e.actionData.act)return"\ud83d\ude34";if("crime"===e.actionData.act)return"\ud83d\ude08";if("relax"===e.actionData.act)return"\ud83d\ude0e";if("chat"===e.actionData.act){var a;if("speaker"===(null===(a=e.actionData.chat)||void 0===a?void 0:a.participation))switch(null===(t=e.actionData)||void 0===t||null===(n=t.chat)||void 0===n?void 0:n.type){default:return"\ud83d\ude03";case"gift":return"\ud83d\ude07";case"praise":return"\ud83e\udd73";case"bully":return"\ud83d\ude08"}return"\ud83e\udd28"}return"starving"===e.food?"\ud83d\ude2b":"sick"===e.health?"\ud83e\udd22":"homeless"===e.stamina?"\ud83e\udd76":"jobless"===e.job?"\ud83d\ude27":e.lastHappiness<0?"\u2639\ufe0f":e.lastHappiness>=50?"\ud83d\ude42":"\ud83d\ude10"}var ft=new function e(){Object(c.a)(this,e),this.alienEnergy=new p,this.alienBots=new p,this.alienHedons=new p,this.newTraitSeen=new y,this.events=new y,this.autosave=new y},bt={found_utopia:{key:"found_utopia",text:"Found your Utopia",check:function(e){return e.buildings.allIDs.length>0}},build_house_n_farm:{key:"build_house_n_farm",text:"Build a house and farm",check:function(e){return null!=e.buildings.allIDs.find((function(t){return"farm"==e.buildings.byID[t].type}))&&null!=e.buildings.allIDs.find((function(t){return"house"==e.buildings.byID[t].type}))},reward:{energy:3,bots:3}},beam_3:{key:"beam_3",text:"Beam in 3 new beings",check:function(e){return e.beans.allIDs.filter((function(t){return!e.beans.byID[t].bornInPetri})).length>=3}},scan:{key:"scan",text:"Scan a Subject",check:function(e){return Object.keys(e.alien.scanned_bean).length>0}},set_policy:{key:"set_policy",text:"Set a Gov Policy",check:function(e){return!1}},brainwash:{key:"brainwash",text:"Brainwash a Subject",check:function(e){return!1}},"c+_grade":{key:"c+_grade",text:"Receive a C+ Grade",check:function(e){return!1}}},vt={GradeWorld:function(e){return{Happiness:Et(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return e.lastHappiness>-.2})),Prosperity:Et(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"hungry"!==e.food})),Stability:Et(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"sane"===e.sanity})),Dogma:gt(e.alien.speechcrimes[e.date.year]||0,10,10)}},RubricDescription:{Happiness:"Subjects are at least 20% happy",Prosperity:"Subjects are not hungry",Stability:"Subjects are all sane",Dogma:"Up to 10 Speechcrimes"}};function gt(e,t,n){return kt(1-Math.min(1,Math.max(0,e-t)/n))}function Et(e,t){return e.length<1?"F":kt(e.filter(t).length/e.length)}function kt(e){return e<.58?"F":e<.68?"D":e<.78?"C":e<.88?"B":"A"}var wt={A:5,B:4,C:3,D:2,F:1};var xt={sanity_bonus:{tech:"sanity_bonus",name:"Surgical Psychops",techPoints:30,description:"Brainwashing causes -1 \ud83e\udde0 Sanity damage"},fast_resources:{tech:"fast_resources",name:"0 Dimensional Supersiphons",techPoints:30,description:"Faster \u26a1\ufe0f and \ud83e\udd16 accumulation"},trauma_nanobots:{tech:"trauma_nanobots",name:"Trauma Nanobots",techPoints:30,description:"Spend \ud83e\udd16 to stop Subject from dying"},neural_duplicator:{tech:"neural_duplicator",name:"Level 2 Neural Duplication",techPoints:30,description:"Copy \ud83e\udde0 Traits 1 additional time"}};function Dt(e,t){t.bots&&(e.bots.amount+=t.bots,ft.alienBots.publish({change:t.bots})),t.energy&&(e.energy.amount+=t.energy,ft.alienEnergy.publish({change:t.energy})),t.hedons&&(e.hedons.amount+=t.hedons,ft.alienHedons.publish({change:t.hedons}))}function Nt(e,t){return null!=e[t]&&e[t].researchPoints>=xt[t].techPoints}function St(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(void 0===t.bots||e.bots.amount>=t.bots*n)&&(void 0===t.energy||e.energy.amount>=t.energy*n)&&(void 0===t.hedons||e.hedons.amount>=t.hedons*n)}function jt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!!St(e,t,n)&&(Kt(e,t,n),!0)}function Kt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.bots&&(e.bots.amount-=t.bots*n,ft.alienBots.publish({change:-t.bots*n})),t.energy&&(e.energy.amount-=t.energy*n,ft.alienEnergy.publish({change:-t.energy*n})),t.hedons&&(e.hedons.amount-=t.hedons*n,ft.alienHedons.publish({change:-t.hedons*n}))}var It=n(9),Ct=n(13),_t=new(function(){function e(){Object(c.a)(this,e),this.cache={bean:{},ufo:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]={elapsed:0,duration:0}),this.cache[e][t]}}]),e}());function Mt(e,t,n){t.jobs.push(e.key),e.employerEnterpriseKey=t.key,n&&null==n.ownerBeanKey&&(n.ownerBeanKey=e.key),e.job=Ae[t.type]}function Ot(e,t){var n=e.nextID++;t.key=n,e.allIDs.push(n),e.byID[n]=t}var Bt="drop.mp3",At="ding_soft.mp3",Pt="ding_bad.wav",Tt="death_bell.wav",Ht="scan.mp3",Gt="squish_pop.mp3",Ft="squish_suck.mp3",qt="baby_squeak.wav",Rt="mhmm.mp3",Lt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.file=t,this.volume=n,this.buffer=[]}return Object(o.a)(e,[{key:"play",value:function(){if(this.buffer.length>0&&this.buffer[0].ended){var e=this.buffer.shift();null===e||void 0===e||e.play(),e&&this.buffer.push(e)}else{var t=new Audio("/socsim/"+this.file);t.volume=this.volume,t.play(),this.buffer.push(t)}}}]),e}(),zt=new(function(){function e(){Object(c.a)(this,e),this.lib={drop:new Lt(Bt,.2),love:new Lt(At),happiness:new Lt(At),unhappiness:new Lt(Pt),hate:new Lt(Pt),death:new Lt(Tt),scan:new Lt(Ht,.3),wash_in:new Lt(Gt),wash_out:new Lt(Ft),squeak:new Lt(qt,.3),mhmm:new Lt(Rt,.5)}}return Object(o.a)(e,[{key:"play",value:function(e){this.lib[e].play()}}]),e}()),Wt=(n(31),{x:25,y:25});function Ut(e){return Se(Wt,Ne,e)}function Jt(e){return Ke(Ut(e))}var Vt={2:0,0:1,4:2,1:3,5:4,3:5},$t=function(e){return i.a.createElement(Xt,{building:e.building,style:{},cityName:e.city.name,getStyle:Jt})},Xt=function(e){return i.a.createElement("div",{key:e.building.type+e.building.key,style:e.style,className:"building "+e.building.type},e.building.upgraded?Ce[e.building.type]:Ie[e.building.type],i.a.createElement(Yt,{building:e.building,getStyle:e.getStyle}),"courthouse"===e.building.type?i.a.createElement("span",{className:"tile-label"},e.cityName):null)},Yt=function(e){return i.a.createElement(i.a.Fragment,null,ue.map((function(t,n){var a=Vt[n],r=null!=e.building.jobs[a];return i.a.createElement("span",{key:n,className:"slot",style:e.getStyle(t)},r?_e[e.building.type]:null)})))},Zt=function e(t,n){Object(c.a)(this,e),this.value=t,this.priority=n},Qt=function(){function e(t){Object(c.a)(this,e),this.values=[],this.values=t}return Object(o.a)(e,[{key:"enqueue",value:function(e){this.values.push(e),this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"enqueueMany",value:function(e){this.values=e,this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"dequeue",value:function(){return this.values.shift()}}]),e}(),en={travel:{enter:function(e){},act:function(e,t,n,a){var i=t.cities.byID[e.cityKey],r=e.actionData.destinationIndex||0;if(null==e.actionData.destinations||0===e.actionData.destinations.length||r>=e.actionData.destinations.length)return e.actionData.intent?{newActivity:e.actionData.intent}:{newActivity:{act:"idle"}};var s=e.actionData.destinations[r];if(isNaN(s.x)||isNaN(s.y))return console.warn("NaN destination, resetting to idle"),{newActivity:{act:"idle"}};var c=Object(W.a)({},qe.Get("bean",e.key).current||pe),o=fe(c,s,D*a/1e3,N,S,x);if(qe.Get("bean",e.key).publish(c),o)return{action:Jn({beanKey:e.key})};if(i){var l=function(e,t){var n=qe.Get("bean",t.key).current;return n?e.beanKeys.filter((function(e){if(e==t.key)return!1;var a=qe.Get("bean",e).current;if(!a)return!1;var i=Math.pow(a.point.x-n.point.x,2)+Math.pow(a.point.y-n.point.y,2);return i<1600&&i>600})):[]}(i,e);if(l.length&&rt(e)){var u=l.filter((function(e){return rt(t.beans.byID[e])}));if(u.length<1)return{};var m=function(e,t){if(e.beliefs.length){if(ct(e,"Charity")&&e.cash>=2){var n=t();if(n)return{participation:"speaker",type:"gift",targetBeanKey:n.key}}else{if(ct(e,"Enthusiasm")&&Math.random()<.45)return{participation:"speaker",type:"praise",preachBelief:"Enthusiasm"};if(ct(e,"Antagonism")&&Math.random()<.45)return{participation:"speaker",type:"bully",preachBelief:"Antagonism"};if(ct(e,"Gossip")&&Math.random()<.35)return{participation:"speaker",type:"bully",preachBelief:"Gossip"}}return{participation:"speaker",type:"preach",preachBelief:We(e.beliefs),persuasionStrength:1+(ct(e,"Charisma")?2:0)}}return{participation:"speaker",type:"praise"}}(e,(function(){return u.map((function(e){return t.beans.byID[e]})).filter((function(t){return t.cash<=e.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),void 0)}));return{newActivity:{act:"chat",chat:m,intent:e.actionData},action:u.map((function(e){return Wn({beanKey:e,newState:{act:"chat",chat:Object(W.a)(Object(W.a)({},m),{},{participation:"listener"}),intent:t.beans.byID[e].actionData}})}))}}if(ct(e,"Wanderlust")&&Math.random()<rn)return{action:Un({beanKey:e.key,emote:"happiness",source:"Wanderlust"})}}return{}},exit:function(e){}},work:{enter:function(e){},act:function(e,t,n){return n>3e3&&e.actionData.good?{action:Vn({beanKey:e.key}),newActivity:{act:"idle"}}:{}},exit:function(e){}},sleep:{enter:function(e){},act:function(e,t,n){return n>3e3?{newActivity:{act:"idle"}}:{}},exit:function(e){}},chat:{enter:function(e){},act:function(e,t,n){return n>1e3&&e.actionData.intent?{newActivity:{act:"travel",intent:e.actionData.intent}}:{}},exit:function(e){if(e.actionData.chat&&"listener"===e.actionData.chat.participation)switch(e.actionData.chat.type){case"bully":return Un({beanKey:e.key,emote:"unhappiness",source:"Antagonism"});case"praise":return Un({beanKey:e.key,emote:"happiness",source:"Enthusiasm"});case"preach":if(e.actionData.chat.preachBelief&&e.actionData.chat.persuasionStrength&&function(e,t,n){if(ct(e,"Dogmatism"))return!1;if(!e.beliefs.includes(t)){var a=10+Le(1,6);return a+=e.beliefs.length-2,Le(1,20)+n>a}return!1}(e,e.actionData.chat.preachBelief,e.actionData.chat.persuasionStrength))return Zn({beanKey:e.key,belief:e.actionData.chat.preachBelief})}}},soapbox:{enter:function(e){},act:function(e){return{}},exit:function(e){}},craze:{enter:function(e){},act:function(e){return{}},exit:function(e){}},idle:{enter:function(e){},act:function(e,t,n){if(n<200)return{};for(var a=mn(e,t.cities.byID[e.cityKey],t.alien.difficulty),i=a.dequeue(),r=void 0,s=void 0;i&&null==r;){var c=tn(e,t,i.value);if(null===c||void 0===c?void 0:c.intent){if(null!=(r=an(e,t.cities.byID[e.cityKey],c.intent,t)))return{newActivity:r,action:s}}else(null===c||void 0===c?void 0:c.sideEffect)&&(s=c.sideEffect);i=a.dequeue()}return{action:s}},exit:function(e){if(function(e){if(ct(e,"Paranoia")&&Math.random()<.05)return!0}(e))return Un({beanKey:e.key,emote:"unhappiness",source:"Paranoia"})}},buy:{enter:function(e){},act:function(e,t,n){return e.actionData.buyReceipt?{newActivity:{act:"shelter"===e.actionData.good?"sleep":"idle"}}:n>1100||(e.actionData.buyAttempts||0)>=3?{newActivity:{act:"idle"}}:n>250&&e.actionData.good?{action:Xn({beanKey:e.key,good:e.actionData.good})}:{}},exit:function(e){}},crime:{enter:function(e){},act:function(e,t,n){return n>1500?{newActivity:{act:"idle"},action:Yn({beanKey:e.key,good:e.actionData.crimeGood||"food"})}:{}},exit:function(e){}},relax:{enter:function(e){},act:function(e,t,n){var a=1e3;return ct(e,"Naturalism")&&(a*=3),n>a?{newActivity:{act:"idle"}}:{}},exit:function(e){return $n({beanKey:e.key})}}};function tn(e,t,n){if("buy"===n.act&&null!=n.good){var a=function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=se(e.market,a,i);if(null==s)return"nosupply";var c=Math.min(s.quantity,r);return s.price<=n.cash*c||n instanceof tt&&Y(t,n,a)&&Z(t,s.price)?"yes":"pricedout"}(t.economy,t.law,e,n.good);if("yes"!=a&&"fun"===n.good)n.act="relax";else if("pricedout"===a){if("food"!=n.good&&"medicine"!=n.good||!function(e,t){if("shelter"===t)return!1;if("fun"===t)return!1;var n=Math.random(),a=.05;return"ego"===e.community&&(a+=.1),ht(e)&&(a+=.1),ct(e,"Greed")&&(a+=.25),ct(e,"Anarchism")&&(a+=.33),ct(e,"Authority")&&(a+=-.25),("food"===t&&"starving"===e.food||"medicine"===t&&"sick"===e.health)&&(a+=.25),a<=n}(e,n.good))return"food"===n.good||"medicine"===n.good||"shelter"===n.good?{sideEffect:Un({beanKey:e.key,emote:"unhappiness",source:"Poverty"})}:void 0;n.act="crime",n.crimeGood=n.good}else if("nosupply"===a)return n.good&&function(e,t){var n=!1;return("food"!==t||"starving"!==e.food&&"hungry"!==e.food)&&("shelter"!==t||"homeless"!==e.stamina&&"sleepy"!==e.stamina)&&("medicine"!==t||"sick"!==e.health&&"sickly"!==e.health)||(n=!0),n}(e,n.good)?{sideEffect:Un({beanKey:e.key,emote:"unhappiness",source:"Scarcity"})}:void 0;n.buyAttempts=0}return{intent:n}}function nn(e,t,n,a){switch(n.act){case"buy":if(n.good)return dn(t,a,e,Oe[n.good]);case"work":return dn(t,a,e,Be[e.job]);case"relax":var i=function(e,t){var n=e.buildingKeys.filter((function(e){return"nature"===t.buildings.byID[e].type||"park"===t.buildings.byID[e].type||"theater"===t.buildings.byID[e].type}));if(!(n.length<1)){var a=We(n);return t.buildings.byID[a]}}(t,a);if(i)return hn(t,e,i)}return[]}function an(e,t,n,a){var i=nn(e,t,n,a);return i?{act:"travel",destinations:i,destinationIndex:0,intent:n}:void 0}var rn=.002,sn=function(e,t){if("jobless"==e.job)return 9;if(t){var n=e.cash/t.costOfLiving/2;return.5+Math.min(99,n)}return.5},cn=function(e,t){return e.discrete_food<=t.bean_life.vital_thresh.food.warning?e.discrete_food:.5+e.discrete_food/t.bean_life.vital_thresh.food.sufficient},on=function(e,t){return e.discrete_health<=t.bean_life.vital_thresh.medicine.warning?.25+e.discrete_health:.75+e.discrete_health/t.bean_life.vital_thresh.medicine.sufficient},ln=function(e,t){return e.discrete_stamina<=t.bean_life.vital_thresh.shelter.warning?.5+e.discrete_stamina:1+e.discrete_stamina/t.bean_life.vital_thresh.shelter.sufficient},un=function(e,t){return 3};function mn(e,t,n){var a=new Qt([]),i=new Zt({act:"work",good:_(e.job)},sn(e,t));return a.enqueue(i),i=new Zt({act:"buy",good:"food"},cn(e,n)),a.enqueue(i),i=new Zt({act:"buy",good:"shelter"},ln(e,n)),a.enqueue(i),i=new Zt({act:"buy",good:"medicine"},on(e,n)),a.enqueue(i),i=new Zt({act:"buy",good:"fun"},un(e,n)),a.enqueue(i),a}function dn(e,t,n,a){var i=function(e,t,n){var a=e.buildingKeys.filter((function(e){return t.buildings.byID[e].type===n}));if(!(a.length<1)){var i=We(a);return t.buildings.byID[i]}}(e,t,a);return void 0===i?null:hn(e,n,i)}function hn(e,t,n){var a,i,r=qe.Get("bean",t.key).current||Object(W.a)({},pe),s=function(e,t,n){var a=De,i=(n.x-t.x)/e.x,r=(n.y-t.y)/e.y,s=a.b0*i+a.b1*r,c=a.b2*i+a.b3*r;return new le(s,c)}(e.hex_size,e.petriOrigin,r.point);return(a=s,i=n.address,xe(we(a),we(i))).map((function(t){return Se(e.hex_size,e.petriOrigin,t)})).map((function(e,t,n){if(t===n.length-1){var a=Ut(We(ue));return{x:e.x+a.x,y:e.y+a.y}}return e}))}var yn,pn={common:3,uncommon:5,rare:7},fn={common:3,uncommon:5,rare:7};function bn(e){var t=F[e].rarity;return{trait:e,cost:{hedons:pn[t]+Le(0,fn[t])}}}!function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Fall=2]="Fall",e[e.Winter=3]="Winter"}(yn||(yn={}));var vn;!function(e){e[e.Midnight=0]="Midnight",e[e.Morning=2]="Morning",e[e.Noon=4]="Noon",e[e.Evening=6]="Evening"}(vn||(vn={}));function gn(e){if(e.date.hour++,e.date.hour>=8&&(e.date.hour=0,e.date.day++,function(e){e.beans.allIDs.forEach((function(t){var n=e.beans.byID[t];n.hedonHistory.length>=5&&n.hedonHistory.pop(),n.hedonHistory.unshift({})})),e.enterprises.allIDs.forEach((function(t){var n=e.enterprises.byID[t],a=e.buildings.byID[t].jobs.map((function(t){return e.beans.byID[t]}));switch(n.enterpriseType){case"company":if(a.length<1);else if(1===a.length)a[0].cash+=n.cash,n.cash>0&&(a[0].ticksSinceLastSale=0),n.cash=0;else{var i=n.cash/(a.length+.25);n.cash=0;var r=a.find((function(e){return e.key===n.ownerBeanKey}));null==r&&(r=a[0],n.ownerBeanKey=r.key),a.forEach((function(e){var t=e===r?1.25*i:i;e.cash+=t,t>0&&(e.ticksSinceLastSale=0)}))}break;case"co-op":var s=n.cash/a.length;n.cash=0,a.forEach((function(e){e.cash+=s,s>0&&(e.ticksSinceLastSale=0)}));break;case"commune":var c=n.cash/a.length;n.cash=0,a.forEach((function(e){e.cash+=c,c>0&&(e.ticksSinceLastSale=0)}))}}))}(e),e.date.day%7===0&&function(e){if(e.marketTraitsForSale=function(){for(var e=[],t=0;t<3;t++){var n=We(R);e.push(bn(n))}return e}(),En(e,{key:0,message:"New traits in the Emotion Market!",icon:"\ud83d\udecd\ufe0f",trigger:"marketrefresh"}),X(e.law,"poll_tax")){var t=0;e.cities.allIDs.forEach((function(n){oa(e,n).forEach((function(e){e.cash>=.1&&(e.cash-=.1,t+=.1)}))})),e.law.cash=e.law.cash+t}!function(e,t){var n=1*t.length;if(e.cash>n){var a=(e.cash-n)/t.length;e.cash=n,t.forEach((function(e){return e.cash+=a}))}}(e.law,Object.values(e.beans.byID))}(e)),e.date.day>30&&(e.date.day=1,function(e){e.economy.unfulfilledMonthlyDemand={food:0,shelter:0,medicine:0,fun:0},e.economy.monthlyDemand={food:0,shelter:0,medicine:0,fun:0},e.economy.monthlySupply={food:0,shelter:0,medicine:0,fun:0}}(e),e.date.season++),e.date.season>3&&(e.date.year++,function(e){!function(e){var t=e.beans.allIDs.reduce((function(t,n){return t.push(e.beans.byID[n]),t}),[]),n=t.reduce((function(e,t){return e+t.cash}),0)/100,a=Math.round(1*n);if(a>0){var i=t.reduce((function(e,t){return t.cash>e.max&&(e.winner=t,e.max=t.cash),e}),{max:0});i.winner&&(i.winner.cash+=a)}}(e)}(e),e.date.season=0),e.alien.bots.amount+=e.alien.bots.income,e.alien.energy.amount+=e.alien.energy.income,Nt(e.alien.techProgress,"fast_resources")&&(e.alien.bots.amount+=.5*e.alien.bots.income,e.alien.energy.amount+=.5*e.alien.energy.income),e.alien.currentlyResearchingTech){var t=e.alien.currentlyResearchingTech;null==e.alien.techProgress[t]&&(e.alien.techProgress[t]={researchPoints:0});var n=xt[t].techPoints,a=e.alien.techProgress[t].researchPoints;a<n&&(e.alien.techProgress[t].researchPoints+=e.alien.abductedBeanKeys.length),a>=n&&("neural_duplicator"===e.alien.currentlyResearchingTech&&e.alien.beliefInventory.forEach((function(e){return e.charges+=1})),e.alien.currentlyResearchingTech=void 0)}var i=re(e.economy);return e.beans.allIDs.forEach((function(t,n){var a=e.beans.byID[t];if("alive"==a.lifecycle){var r=function(e,t){if("alive"==e.lifecycle){var n=[],a="starving"!==e.food,i="sick"!==e.health;e.discrete_food-=t.bean_life.degrade_per_tick.food,e.discrete_food<0&&(e.discrete_health-=t.bean_life.penalty.starving_health),it(e);var r=lt(e,"starvation","starving"===e.food,.6);if(r)return r;"starving"===e.food&&a&&(n.push.apply(n,Object(h.a)(st(e,"unhappiness","Starving"))),ct(e,"Gluttony")&&(n.push.apply(n,Object(h.a)(st(e,"unhappiness","Gluttony"))),n.push.apply(n,Object(h.a)(st(e,"unhappiness","Gluttony"))))),e.discrete_stamina-=t.bean_life.degrade_per_tick.stamina,at(e);var s=lt(e,"exposure","homeless"===e.stamina,.2);if(s)return s;e.discrete_health-=t.bean_life.degrade_per_tick.health,e.discrete_health=Math.min(e.discrete_health,3),nt(e);var c=lt(e,"sickness","sick"===e.health,.4);return c||("sick"===e.health&&i&&(n.push.apply(n,Object(h.a)(st(e,"unhappiness","Sick"))),ct(e,"Germophobia")&&n.push.apply(n,Object(h.a)(st(e,"unhappiness","Germophobia")))),e.discrete_fun-=t.bean_life.degrade_per_tick.fun,e.discrete_fun=Math.max(0,e.discrete_fun),ht(e)||(e.graceTicks=oe(e.graceTicks+1,0,6)),n.length?{emotes:n}:void 0)}}(a,e.alien.difficulty);(null===r||void 0===r?void 0:r.emotes)&&r.emotes.map((function(t){return Ot(e.pickups,t)})),(null===r||void 0===r?void 0:r.death)&&Ot(e.events,r.death);var s=ot(a,i);if(s){var c=Ye(e,e.cities.byID[a.cityKey],a);a.lastPoint&&(c.lastPoint=a.lastPoint,qe.Get("bean",c.key).publish({point:{x:a.lastPoint.x,y:a.lastPoint.y},velocity:{x:0,y:0}})),e.beans.byID[c.key]=c,e.beans.allIDs.push(c.key),e.cities.byID[a.cityKey].beanKeys.push(c.key),En(e,s),zt.play("squeak")}if("jobless"===a.job)(function(e,t){for(var n=ce(e.cities.byID[t.cityKey].buildingKeys.map((function(t){return e.buildings.byID[t]})).filter((function(e){var t=["farm","house","theater","hospital"].includes(e.type),n=He(e).length>0;return t&&n}))),a=0;a<n.length;a++){var i=n[a];if(He(i).length>0)return Mt(t,i,e.enterprises.byID[i.key]),!0}return!1})(e,a)||En(e,{icon:"\ud83c\udfda\ufe0f",trigger:"nojobslots",message:"A subject cannot find a job; build or upgrade more buildings.",key:0});a.happiness=L(a.hedonHistory)}})),e.cities.allIDs.forEach((function(t){var n,a,i=e.cities.byID[t];n=i,a=e.economy,n.costOfLiving=re(a)})),e.beans.allIDs.forEach((function(t){var n,a,i=e.beans.byID[t];i&&"alive"==i.lifecycle&&(n=i,a=e.economy,e.alien.difficulty,e.law,n.hedonFiveDayRecord={min:Math.min(n.hedonFiveDayRecord.min,n.happiness.flatAverage),max:Math.max(n.hedonFiveDayRecord.max,n.happiness.flatAverage)},0===n.happiness.flatAverage?n.lastHappiness=0:n.lastHappiness=n.happiness.flatAverage>=0?n.happiness.flatAverage/Math.abs(n.hedonFiveDayRecord.max)*100:n.happiness.flatAverage/Math.abs(n.hedonFiveDayRecord.min)*100,it(n),nt(n),function(e,t){e.discrete_sanity>=8?e.sanity="sane":e.discrete_sanity>=5?e.sanity="stressed":e.discrete_sanity>=3?e.sanity="disturbed":e.sanity="psychotic",e.sanity}(n),at(n),"jobless"===n.job?n.fairGoodPrice=1:n.fairGoodPrice=ie(a,_(n.job)))})),function(e,t){for(var n=0;n<t.goals.length;n++){var a=t.goals[n];if(null==t.goalProgress[a]&&(t.goalProgress[a]={done:!1,step:0}),!t.goalProgress[a].done){var i=bt[a].check(e),r=bt[a].reward;t.goalProgress[a].done=i,i&&null!=r&&Dt(t,r)}}}(e,e.alien),function(e,t){t.workingReportCard=vt.GradeWorld(e)}(e,e.alien),e}function En(e,t){t.key=e.events.nextID++,e.events.byID[t.key]=t,e.events.allIDs.push(t.key),ft.events.publish(t)}function kn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=[];return e.energy&&a.push(t+e.energy*n+" Energy"),e.bots&&a.push(t+e.bots*n+" Bots"),e.hedons&&a.push(t+e.hedons*n+" Hedons"),e.tortrons&&a.push(t+e.tortrons*n+" Antihedons"),a.join(" ")}var wn={cost:{emptyHex:{build:{house:{energy:1,bots:3},farm:{energy:1,bots:3},theater:{energy:1,bots:4},hospital:{energy:1,bots:4},church:{energy:1,bots:4},courthouse:{energy:999,bots:999},park:{energy:1,bots:4},nature:{energy:1,bots:4}}},hex:{beam:{energy:3},upgrade:{energy:1,bots:4}},bean_brain:{brainwash_ideal:{sanity:4},brainimplant_secondary:{sanity:1},brainwash_secondary:{sanity:2}},bean:{scan:{energy:1},abduct:{bots:3},gift:{},empower:{},vaporize:{energy:2,bots:4},siphon:{}},market:{scrubHedons:{energy:5},resource:{bots:{hedons:6},energy:{hedons:5}},beliefs:{common:{},uncommon:{},rare:{}}}},bean_life:{vital_thresh:{food:{warning:.6,sufficient:1,abundant:3},shelter:{warning:.6,sufficient:1,abundant:7},medicine:{warning:.6,sufficient:1,abundant:3},fun:{warning:.1,sufficient:1,abundant:3}},degrade_per_tick:{food:1/24,health:1/40,stamina:1,fun:1/40},penalty:{homeless_health:1/56,starving_health:1/56},death_chance:{starvation:1/8,sickness:1/8,exposure:1/8,vaporization:1}},report_card_progression:[]};var xn=Object(It.b)({name:"world",initialState:function(){return{buildings:{byID:{},allIDs:[],hxPosition:{},nextID:0},enterprises:{byID:{},allIDs:[],hxPosition:{},nextID:0},cities:(e=[Object(W.a)(Object(W.a)({},Pe()),{},{key:0,name:"string",deadBeanKeys:[],beanKeys:[],ufoKeys:[],pickupKeys:[],buildingKeys:[],pickupMagnetPoint:void 0,costOfLiving:0,buildingMap:{}})],{byID:e.reduce((function(e,t){return e[t.key]=t,e}),{}),allIDs:e.map((function(e){return e.key})),hxPosition:{},nextID:e.reduce((function(e,t){return Math.max(t.key+1,e)}),0)}),beans:{byID:{},allIDs:[],hxPosition:{},nextID:0},ufos:{byID:{},allIDs:[],hxPosition:{},nextID:0},events:{byID:{},allIDs:[],hxPosition:{},nextID:0},pickups:{byID:{},allIDs:[],hxPosition:{},nextID:0},economy:{unfulfilledMonthlyDemand:{food:0,shelter:0,medicine:0,fun:0},monthlyDemand:{food:0,shelter:0,medicine:0,fun:0},monthlySupply:{food:0,shelter:0,medicine:0,fun:0},market:{listings:{food:[],fun:[],medicine:[],shelter:[]}}},law:{cash:0,lawTree:{},laws:[],ticksSinceLastSale:0},date:{year:1,season:yn.Spring,day:1,hour:1},marketTraitsForSale:[],alien:{scanned_bean:{},seenBeliefs:{},beliefInventory:[],speechcrimes:{},abductedBeanKeys:[],energy:{amount:16,income:2/30},bots:{amount:10,income:2/30},hedons:{amount:0,income:0},next_grade:{year:1,season:3,day:1,hour:0},difficulty:Object(W.a)({},wn),goals:["found_utopia","build_house_n_farm","beam_3","scan","brainwash","set_policy","c+_grade"],goalProgress:{},pastReportCards:[],workingReportCard:{Happiness:"D",Prosperity:"D",Stability:"D",Dogma:"D"},techProgress:{},currentlyResearchingTech:void 0},spotlightEvent:void 0,saveSlot:1};var e}(),reducers:{refreshMarket:function(e){},magnetChange:function(e,t){e.cities.byID[t.payload.cityKey].pickupMagnetPoint=t.payload.px},worldTick:function(e){gn(e)},newGame:function(e){var t=e.cities.byID[0];t.name=Xe(),Fe(e,t,"courthouse",{q:0,r:0},e.economy),Fe(e,t,"nature",t.hexes[Le(15,20)],e.economy),Fe(e,t,"nature",t.hexes[Le(21,25)],e.economy),Fe(e,t,"nature",t.hexes[Le(26,60)],e.economy)},loadGame:function(e,t){return t.payload.newState.beans.allIDs.map((function(e){var n,a,i=t.payload.newState.beans.byID[e];i&&qe.Get("bean",e).publish({point:{x:(null===(n=i.lastPoint)||void 0===n?void 0:n.x)||0,y:(null===(a=i.lastPoint)||void 0===a?void 0:a.y)||0},velocity:{x:0,y:0}})})),t.payload.newState},build:function(e,t){var n=e.alien.difficulty.cost.emptyHex.build[t.payload.what];jt(e.alien,n)&&Fe(e,e.cities.byID[t.payload.city],t.payload.what,t.payload.where,e.economy)},changeEnterprise:function(e,t){e.enterprises.byID[t.payload.enterpriseKey].enterpriseType=t.payload.newType},fireBean:function(e,t){var n=e.beans.byID[t.payload.beanKey];if(n.employerEnterpriseKey){var a=e.buildings.byID[n.employerEnterpriseKey],i=e.enterprises.byID[n.employerEnterpriseKey];i.ownerBeanKey==n.key&&(i.ownerBeanKey=a.jobs.find((function(e){return e!=n.key}))),Re(a,n)}},upgrade:function(e,t){var n=e.alien.difficulty.cost.hex.upgrade,a=e.buildings.byID[t.payload.buildingKey];jt(e.alien,n)&&(a.upgraded=!0)},beam:function(e,t){var n=e.alien.difficulty.cost.hex.beam;if(St(e.alien,n)){Kt(e.alien,n);var a={key:e.ufos.nextID++,action:"beam-in",duration:0,point:Object(W.a)({},t.payload.where),cityKey:t.payload.cityKey};e.ufos.allIDs.push(a.key),e.ufos.byID[a.key]=a,e.cities.byID[t.payload.cityKey].ufoKeys.push(a.key)}},remove_ufo:function(e,t){var n=e.ufos.byID[t.payload.ufoKey],a=Ye(e,e.cities.byID[0],void 0,n.point);delete e.ufos.byID[t.payload.ufoKey],e.ufos.allIDs=e.ufos.allIDs.filter((function(e){return e!=t.payload.ufoKey})),e.cities.byID[n.cityKey].ufoKeys=e.cities.byID[n.cityKey].ufoKeys.filter((function(e){return e!=t.payload.ufoKey})),e.beans.byID[a.key]=a,e.beans.allIDs.push(a.key),e.cities.byID[n.cityKey].beanKeys.push(a.key),qe.Get("bean",a.key).current={point:Se(e.cities.byID[n.cityKey].hex_size,e.cities.byID[n.cityKey].petriOrigin,n.point),velocity:{x:0,y:0}}},abduct:function(e,t){if(jt(e.alien,e.alien.difficulty.cost.bean.abduct)){var n=e.beans.byID[t.payload.beanKey];if(n.lifecycle="abducted",n.employerEnterpriseKey)Re(e.buildings.byID[n.employerEnterpriseKey],n);e.cities.byID[n.cityKey].beanKeys=e.cities.byID[n.cityKey].beanKeys.filter((function(e){return e!=n.key})),e.alien.abductedBeanKeys.push(n.key)}},cheatAdd:function(e){e.alien.energy.amount+=10,e.alien.bots.amount+=10,e.alien.hedons.amount+=10},release:function(e){if(e.alien.abductedBeanKeys.length>0){var t=e.alien.abductedBeanKeys.shift();if(null!=t){var n=e.beans.byID[t];n.lifecycle="alive",e.cities.byID[n.cityKey].beanKeys.push(t)}}},washCommunity:function(e,t){},washMotive:function(){},washNarrative:function(e,t){var n=e.beans.byID[t.payload.beanKey];if(yt(n,e.alien.difficulty.cost.bean_brain.brainwash_ideal,0)){mt(n,e.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0);for(var a=n.faith;n.faith===a;)n.faith=We(["rocket","dragon","music","noFaith"])}},washBelief:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=Nt(e.alien.techProgress,"sanity_bonus")?-1:0;if(yt(n,e.alien.difficulty.cost.bean_brain.brainwash_secondary,a)){mt(n,e.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0),n.beliefs.splice(n.beliefs.indexOf(t.payload.trait),1);var i=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.trait})),r=Nt(e.alien.techProgress,"neural_duplicator")?1:0;i?i.charges+=2+r:e.alien.beliefInventory.push({trait:t.payload.trait,charges:2+r}),zt.play("wash_out")}},setResearch:function(e,t){e.alien.currentlyResearchingTech=t.payload.t},implant:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=Nt(e.alien.techProgress,"sanity_bonus")?-1:0;yt(n,e.alien.difficulty.cost.bean_brain.brainimplant_secondary,a)&&e.alien.beliefInventory.filter((function(e){return e.trait==t.payload.trait&&e.charges>0}))&&(n.beliefs.push(t.payload.trait),function(e,t){var n=e.beliefInventory,a=n.find((function(e){return e.trait===t}));a&&(a.charges-=1,e.beliefInventory=Object(h.a)(n.filter((function(e){return e.charges>0}))))}(e.alien,t.payload.trait),zt.play("wash_in"),mt(n,e.alien.difficulty.cost.bean_brain.brainimplant_secondary.sanity||0))},scan:function(e,t){var n=e.beans.byID[t.payload.beanKey];jt(e.alien,e.alien.difficulty.cost.bean.scan)&&(e.alien.scanned_bean[n.key]=!0,n.beliefs.forEach((function(t){e.alien.seenBeliefs[t]||(e.alien.seenBeliefs[t]=!0,ft.newTraitSeen.publish({k:F[t].noun,v:!0}))})),zt.play("scan"))},vaporize:function(e,t){if(jt(e.alien,e.alien.difficulty.cost.bean.vaporize)){var n=ut(e.beans.byID[t.payload.beanKey],"vaporization");Ot(e.events,n.death),n.emotes.map((function(t){return Ot(e.pickups,t)}))}},pickUpPickup:function(e,t){var n=e.pickups.byID[t.payload.pickupKey],a=A[n.type];e.alien.hedons.amount+=a,e.cities.byID[t.payload.cityKey].pickupKeys=e.cities.byID[t.payload.cityKey].pickupKeys.filter((function(e){return e!=t.payload.pickupKey})),e.pickups.allIDs=e.pickups.allIDs.filter((function(e){return e!=t.payload.pickupKey})),delete e.pickups.byID[t.payload.pickupKey],ft.alienHedons.publish({change:a}),zt.play(n.type)},changeState:function(e,t){var n,a=e.beans.byID[t.payload.beanKey].action,i=e.beans.byID[t.payload.beanKey],r=_t.Get("bean",i.key);"chat"===a&&(i.lastChatMS=Date.now()),i.activity_duration[a]+=r.elapsed,i.action=t.payload.newState.act,i.actionData=t.payload.newState;var s=null===(n=qe.Get("bean",i.key).current)||void 0===n?void 0:n.point;s&&(i.lastPoint=Object(W.a)({},s)),r.elapsed=0},beanHitDestination:function(e,t){var n=e.beans.byID[t.payload.beanKey];null!=n.actionData.destinationIndex&&n.actionData.destinationIndex++},beanBePersuaded:function(e,t){var n=e.beans.byID[t.payload.beanKey];n.beliefs.push(t.payload.belief),En(e,{key:0,icon:"\ud83d\udde3\ufe0f",trigger:"persuasion",message:"".concat(n.name," now believes in ").concat(F[t.payload.belief].icon," ").concat(F[t.payload.belief].noun,"!"),beanKey:n.key,cityKey:n.cityKey,point:n.lastPoint}),zt.play("mhmm")},beanGiveCharity:function(e,t){var n=e.beans.byID[t.payload.senderBeanKey];n.cash-=.5,Nn(n,e,{emote:"happiness",source:"Charity"});var a=e.beans.byID[t.payload.needyBeanKey];a.cash+=.5,Nn(a,e,{emote:"happiness",source:"Charity"})},beanWork:function(e,t){var n,a=e.beans.byID[t.payload.beanKey];if("jobless"===a.job);else{switch(a.job){case"farmer":a.discrete_food=Math.min(a.discrete_food+1,2*I.sufficient),Dn(e,a,"Parochialism","happiness",.25);break;case"doc":a.discrete_health=Math.min(a.discrete_health+1,2*C.sufficient),Dn(e,a,"Germophobia","unhappiness",.25);break;case"builder":a.stamina="awake",a.discrete_stamina=7;break;case"entertainer":Dn(e,a,"Cosmopolitanism","happiness",.25)}if(Dn(e,a,"Diligence","happiness",.25),Dn(e,a,"Hedonism","unhappiness",.15),a.ticksSinceLastSale++,a.ticksSinceLastSale>8&&null!=a.employerEnterpriseKey)if(e.enterprises.byID[a.employerEnterpriseKey].ownerBeanKey!=a.key&&Math.random()>.5){var i=(n=e.economy,Q.reduce((function(e,t){return n.unfulfilledMonthlyDemand[t]>e.max&&(e.max=n.unfulfilledMonthlyDemand[t],e.job=M(t)),e}),{max:0,job:null}).job);i&&(Re(e.buildings.byID[a.employerEnterpriseKey],a),function(e,t,n){if("jobless"===n)return!1;for(var a=e.cities.byID[t.cityKey].buildingKeys.map((function(t){return e.buildings.byID[t]})).filter((function(e){return e.type===Be[n]})),i=0;i<a.length;i++){var r=a[i];if(He(r).length>0)return Mt(t,r,e.enterprises.byID[r.key]),!0}}(e,a,i))}var r=!1;if(a.employerEnterpriseKey){var s=e.enterprises.byID[a.employerEnterpriseKey];if(s)switch(function(e,t,n,a,i){e.monthlySupply[n]+=a;var r=e.market.listings[n].find((function(e){return e.sellerEnterpriseKey==t.key}));r?(r.quantity+=a,r.price=i,r.quantity=Math.min(r.quantity,20)):e.market.listings[n].push({sellerEnterpriseKey:t.key,price:i,quantity:a}),e.market.listings[n].sort((function(e,t){return e.price-t.price}))}(e.economy,s,_(a.job),4,a.fairGoodPrice),r=!0,s.enterpriseType){case"company":Dn(e,a,"Communism","unhappiness",.1),s.ownerBeanKey===a.key&&Dn(e,a,"Capitalism","happiness",.1);break;case"co-op":Dn(e,a,"Capitalism","unhappiness",.1),Dn(e,a,"Socialism","happiness",.1);break;case"commune":Dn(e,a,"Capitalism","unhappiness",.1)}}r||function(e,t,n,a,i){e.monthlySupply[n]+=a;var r=e.market.listings[n].find((function(e){return e.sellerBeanKey==t.key}));r?(r.quantity+=a,r.price=i,r.quantity=Math.min(r.quantity,20)):e.market.listings[n].push({sellerBeanKey:t.key,sellerCityKey:t.cityKey,price:i,quantity:a}),e.market.listings[n].sort((function(e,t){return e.price-t.price}))}(e.economy,a,_(a.job),4,a.fairGoodPrice)}},beanEmote:function(e,t){var n=e.beans.byID[t.payload.beanKey];Nn(n,e,t.payload),ct(n,"Hedonism")&&("happiness"===t.payload.emote||"love"===t.payload.emote)&&Math.random()<.1&&Nn(n,e,{emote:"happiness",source:"Hedonism"})},beanCrime:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=We(e.economy.market.listings[t.payload.good]);if(null==a);else{var i=Math.min(a.quantity,3);if(ne(e.economy.market,a,t.payload.good,i),null!=i)switch(t.payload.good){case"food":n.discrete_food+=i;break;case"medicine":n.discrete_health+=i}}},beanRelax:function(e,t){var n=e.beans.byID[t.payload.beanKey];n.discrete_fun+=1,Nn(n,e,{emote:"happiness",source:"Relaxation"}),ct(n,"Naturalism")&&Nn(n,e,{emote:"happiness",source:"Naturalism"})},enactLaw:function(e,t){var n=$[t.payload.lawKey];e.law.lawTree[n.axis]=n},repealLaw:function(e,t){var n=$[t.payload.lawKey];delete e.law.lawTree[n.axis]},buyBots:function(e,t){var n=e.alien.difficulty.cost.market.resource.bots;jt(e.alien,n,t.payload.amount)&&(e.alien.bots.amount+=t.payload.amount)},buyEnergy:function(e,t){var n=e.alien.difficulty.cost.market.resource.bots;jt(e.alien,n,t.payload.amount)&&(e.alien.energy.amount+=t.payload.amount)},scrubHedons:function(e){var t=e.alien.difficulty.cost.market.scrubHedons;if(jt(e.alien,t)){e.alien.hedons.amount;e.alien.hedons.amount=0}},buyTrait:function(e,t){if(jt(e.alien,t.payload.l.cost)){var n=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.l.trait}));n?n.charges+=3:e.alien.beliefInventory.push({trait:t.payload.l.trait,charges:3})}},beanBuy:function(e,t){var n,a,i,r,s,c=e.beans.byID[t.payload.beanKey],o=function(t){return null!=t.sellerEnterpriseKey?e.enterprises.byID[t.sellerEnterpriseKey]:t.sellerBeanKey?e.beans.byID[t.sellerBeanKey]:e.law};switch(t.payload.good){case"food":(null===(n=s=ae(e.economy,e.law,c,"food",o,.5,3))||void 0===n?void 0:n.bought)&&(c.discrete_food+=s.bought,"stuffed"===c.food&&(Nn(c,e,{emote:"happiness",source:"Stuffed"}),Dn(e,c,"Gluttony","happiness",1)));break;case"shelter":(null===(a=s=ae(e.economy,e.law,c,"shelter",o))||void 0===a?void 0:a.bought)?(c.discrete_stamina=10,c.stamina="awake"):c.discrete_stamina<=0&&(c.stamina="homeless");break;case"medicine":(null===(i=s=ae(e.economy,e.law,c,"medicine",o,.5,3))||void 0===i?void 0:i.bought)&&(c.discrete_health+=s.bought,"fresh"===c.health&&Nn(c,e,{emote:"happiness",source:"Robust"}));break;case"fun":(null===(r=s=ae(e.economy,e.law,c,"fun",o))||void 0===r?void 0:r.bought)&&(c.discrete_fun=1,Nn(c,e,{emote:"happiness",source:"Entertainment"}),Nn(c,e,{emote:"happiness",source:"Entertainment"}))}c.actionData.buyAttempts=(c.actionData.buyAttempts||0)+1,s&&(s.tax&&(Dn(e,c,"Libertarianism","unhappiness",Qe),Dn(e,c,"Progressivism","happiness",et)),c.actionData.buyReceipt=s)}}});function Dn(e,t,n,a,i){ct(t,n)&&Math.random()<i&&Nn(t,e,{emote:a,source:n})}function Nn(e,t,n){e.discrete_sanity=oe(e.discrete_sanity+P[n.emote],0,10),e.hedonHistory[0][n.source]=(e.hedonHistory[0][n.source]||0)+A[n.emote];var a=qe.Get("bean",e.key).current||pe,i={key:t.pickups.nextID++,point:{x:a.point.x,y:a.point.y},type:n.emote,velocity:{x:0,y:0}};t.cities.byID[e.cityKey].pickupKeys.push(i.key),t.pickups.byID[i.key]=i,t.pickups.allIDs.push(i.key),qe.Get("pickup",i.key).publish({point:{x:a.point.x,y:a.point.y},velocity:{x:0,y:0}})}var Sn=xn.actions,jn=(Sn.refreshMarket,Sn.magnetChange),Kn=Sn.worldTick,In=Sn.remove_ufo,Cn=Sn.newGame,_n=Sn.loadGame,Mn=Sn.build,On=Sn.changeEnterprise,Bn=Sn.fireBean,An=Sn.upgrade,Pn=Sn.beam,Tn=Sn.abduct,Hn=Sn.release,Gn=Sn.scan,Fn=Sn.vaporize,qn=Sn.pickUpPickup,Rn=Sn.implant,Ln=Sn.washBelief,zn=Sn.washNarrative,Wn=(Sn.washCommunity,Sn.washMotive,Sn.changeState),Un=Sn.beanEmote,Jn=(Sn.beanGiveCharity,Sn.beanHitDestination),Vn=Sn.beanWork,$n=Sn.beanRelax,Xn=Sn.beanBuy,Yn=Sn.beanCrime,Zn=Sn.beanBePersuaded,Qn=Sn.cheatAdd,ea=Sn.enactLaw,ta=Sn.repealLaw,na=Sn.setResearch,aa=Sn.buyBots,ia=Sn.buyEnergy,ra=Sn.buyTrait,sa=Sn.scrubHedons,ca=function(e,t){return e.cities.byID[t].beanKeys},oa=Object(Ct.a)(ca,(function(e){return e.beans.byID}),(function(e,t){return e.reduce((function(e,n){return e.push(t[n]),e}),[])})),la=(Object(Ct.a)(oa,(function(e){var t=e.reduce((function(e,t){switch(t.ethnicity){case"circle":e.circle++;break;case"square":e.square++;break;case"triangle":e.triangle++}return e}),{circle:0,square:0,triangle:0});return t.circle>t.square&&t.circle>t.triangle?"circle":t.square>t.circle&&t.square>t.triangle?"square":"triangle"})),xn.reducer,function(){return Object(m.b)()}),ua=m.c,ma=Object(It.b)({name:"selected",initialState:{selectedHexKey:void 0,selectedCityKey:void 0,selectedBeanKey:void 0},reducers:{doSelectCity:function(e,t){return{selectedHexKey:void 0,selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0}},doSelectHex:function(e,t){return{selectedHexKey:"".concat(t.payload.hex.q,",").concat(t.payload.hex.r),selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0}},doSelectBuilding:function(e,t){return{selectedHexKey:"".concat(t.payload.hex.q,",").concat(t.payload.hex.r),selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:t.payload.buildingKey}},doSelectBean:function(e,t){return{selectedHexKey:void 0,selectedCityKey:t.payload.cityKey,selectedBeanKey:t.payload.beanKey,selectedBuildingKey:void 0}},doSelectNone:function(e){return{selectedBeanKey:void 0,selectedCityKey:void 0,selectedHexKey:void 0,selectedBuildingKey:void 0}}}}),da=ma.actions,ha=da.doSelectHex,ya=da.doSelectNone,pa=da.doSelectBean,fa=da.doSelectCity,ba=da.doSelectBuilding,va=Object(It.a)({reducer:{world:xn.reducer,selected:ma.reducer},middleware:Object(It.c)().concat([function(e){return function(e){return function(t){switch(t.type){case"world/magnetChange":break;default:t.type.startsWith("selected")||b.Dirty.publish(!0)}return e(t)}}}])}),ga=function(e){return null!=e.selected.selectedCityKey?e.world.cities.byID[e.selected.selectedCityKey]:void 0},Ea=function(e){return null!=e.selected.selectedBeanKey?e.world.beans.byID[e.selected.selectedBeanKey]:void 0},ka=function(e){var t=null!=e.selected.selectedCityKey&&e.world.cities.byID[e.selected.selectedCityKey];if(t&&null!=e.selected.selectedHexKey){var n=t.buildingMap[e.selected.selectedHexKey];return e.world.buildings.byID[n]}},wa=function(e){return e.world.events.allIDs.map((function(t){return e.world.events.byID[t]}))},xa=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={confirming:!1},a}return Object(o.a)(n,[{key:"click",value:function(){this.state.confirming?(this.props.onConfirm(),this.setState({confirming:!1})):this.setState({confirming:!0})}},{key:"render",value:function(){var e=this;return i.a.createElement("button",{className:this.props.className,onClick:function(){return e.click()},disabled:this.props.disabled},this.state.confirming?this.props.confirmText:this.props.children)}}]),n}(i.a.Component),Da=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChange=function(e){a.props.onChange(e.target.value),a.setState({key:e.target.value})},a.state={key:e.value||null},a}return Object(o.a)(n,[{key:"hint",value:function(){if(this.props.hint)return i.a.createElement("option",{value:"",disabled:!0,selected:!0,hidden:!0},this.props.hint)}},{key:"getTextForOption",value:function(e){return this.props.titleCase&&(e=e[0].toUpperCase()+e.slice(1)),e}},{key:"options",value:function(){var e=this;return this.props.options.map((function(t){return i.a.createElement("option",{value:t,key:t,title:e.getTitleForOption(t)},e.getTextForOption(t))}))}},{key:"render",value:function(){return i.a.createElement("select",{onChange:this.onChange,value:this.state.key,required:null!=this.props.hint},this.hint(),this.options())}},{key:"getTitleForOption",value:function(e){}}]),n}(i.a.Component),Na=(n(32),function(e){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},e.data.icon),e.leftButton),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},e.titleView,e.cost?i.a.createElement("span",{className:"pull-r"},e.cost,"\ud83e\udde0"):null),e.data.description?e.data.description.split(";").map((function(e,t){return i.a.createElement("small",{className:"marg-b-6",key:t}," ",e)})):null,i.a.createElement("div",{className:"grow-1 text-center"},e.bottomView))))}),Sa=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},this.props.data.icon),this.props.frozen?null:i.a.createElement(xa,{className:"callout pad-4 marg-0",confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",disabled:this.props.available<this.props.cost,onConfirm:this.props.wash},"\ud83d\udebf ",i.a.createElement("small",null,"Wash"))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",{title:this.props.data.description,className:this.props.divergent?"divergent marg-r-6":"marg-r-6"},this.props.data.noun),i.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),i.a.createElement("small",{className:"marg-b-6"},this.props.data.description),i.a.createElement("div",{className:"grow-1 text-center"}))))}}]),n}(i.a.Component),ja=q.slice().sort((function(e,t){return e.localeCompare(t)})),Ka=(i.a.Component,n(33),function(e){var t=ua((function(e){return e.world.alien.beliefInventory})),n=la();return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement(Na,{key:t.trait,data:F[t.trait],titleView:i.a.createElement("strong",null,F[t.trait].noun),leftButton:i.a.createElement(xa,{onConfirm:function(){return n(Rn({beanKey:e.beanKey,trait:t.trait}))},className:"callout marg-0",confirmText:"-1 \ud83e\udde0?",disabled:t.charges<1||e.dogmatic},"Implant"),bottomView:i.a.createElement("span",null,t.charges," \ud83e\udde0")})})))}),Ia=function(){var e=ua(Ea),t=ua((function(t){return null!=(null===e||void 0===e?void 0:e.key)&&t.world.alien.scanned_bean[e.key]})),n=ua((function(e){return e.world.alien.difficulty})),a=ua((function(e){return e.world.alien.techProgress})),r=la(),s=Nt(a,"sanity_bonus")?-1:0;if(null==e)return i.a.createElement("div",null);var c=ct(e,"Dogmatism");return i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal fancy-header"},i.a.createElement("div",null,"BRAIN"),i.a.createElement("div",{className:"emoji-3"},"\ud83e\udde0\ud83d\udebf"),i.a.createElement("div",null,"WASH")),i.a.createElement("div",null,i.a.createElement("p",{className:"pad-4p"},i.a.createElement("strong",null,e.name)," has ",e.discrete_sanity.toFixed(0)," sanity \ud83e\udde0.","stressed"===e.sanity||"disturbed"===e.sanity?i.a.createElement("small",{className:"pull-r"},"(Low sanity \ud83e\udde0 causes ",B.unhappiness,"; Negative sanity \ud83e\udde0 causes extremely negative traits)"):null),c?i.a.createElement("div",{className:"text-center"},"\ud83d\udc36 Dogmatic subjects cannot change their minds"):null,t?i.a.createElement("div",{className:"horizontal scroll"},i.a.createElement(Sa,{available:e.discrete_sanity,frozen:c,wash:function(){return r(zn({beanKey:e.key,faith:e.faith}))},cost:n.cost.bean_brain.brainwash_ideal.sanity||0,data:G[e.faith]}),e.beliefs.map((function(t){return i.a.createElement(Sa,{key:t,available:e.discrete_sanity,frozen:c&&"Dogmatism"!=t,divergent:!1,wash:function(){return r(Ln({beanKey:e.key,trait:t}))},cost:(n.cost.bean_brain.brainwash_secondary.sanity||0)+s,data:F[t]})}))):i.a.createElement("div",{className:"text-center"},"\ud83d\udef0\ufe0f Scan this subject to reveal its Traits! "),i.a.createElement("h3",{className:"pad-4p"},"\ud83e\udde0 Trait Inventory"),i.a.createElement("div",{className:"horizontal scroll"},i.a.createElement(Ka,{beanKey:e.key,dogmatic:c}))))},Ca=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("div",{className:"subheader"},i.a.createElement("h3",null,"Propaganda"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83c\udf99\ufe0f Buy Propaganda")),i.a.createElement("span",null,"Propaganda changes beans' feelings on a wide variety of topics."),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udcfa Broadcast Campaign"),i.a.createElement("small",null,"Approval+ Cash-"),i.a.createElement("span",{className:"p"},"Small chance to increase Approval among all beans")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udc4b Canvassing"),i.a.createElement("small",null,"Approval+ Labor-"),i.a.createElement("span",{className:"p"},"Chance to increase Approval on a few random beans")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\uddde\ufe0f Print Campaign"),i.a.createElement("small",null,"Approval+ Cash-"),i.a.createElement("span",{className:"p"},"Chance to increase Approval on wealthy beans"))),i.a.createElement("div",{className:"subheader"},i.a.createElement("h3",null,"Appearances"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83d\udcac Schedule Appearance")),i.a.createElement("span",null,"Appearances have limited reach, but have powerful effects."),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83e\udd14 Debating"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Chance to gain or lose Influence")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udcf8 Photo Op"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Increases Approval within one Social Group")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83c\udfa4 Speechmaking"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Increases chance of Donations in a single City")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\ude4b Town Hall"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Suppresses negative Approval in a single city"))))}}]),n}(i.a.Component),_a={state:"Collectivist",ego:"Independent",trad:"Elitist",prog:"Progressive",circle:"Brunette",square:"Blonde",triangle:"Redhead",rocket:"Futuristic",dragon:"Mythical",music:"Dramatic",noFaith:"Nihilistic",starving:"Starving",hungry:"Hungry",sated:"Sated",stuffed:"Stuffed",homeless:"Homeless",sleepy:"Sleepy",awake:"Awake",rested:"Rested",sick:"Sick",sickly:"Sickly",bruised:"Bruised",fresh:"Robust",sane:"Sane",stressed:"Confused",disturbed:"Disturbed",psychotic:"Psychotic",house:"House",hospital:"Hospital",farm:"Farm",theater:"Theater",church:"Church",courthouse:"Courthouse",park:"Park",nature:"Elysian Scenery"},Ma=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a}return Object(o.a)(n,[{key:"header",value:function(){return this.props.children?i.a.createElement("b",null,this.props.children):null}},{key:"render",value:function(){var e=this,t=this.props.beans.filter((function(t){return e.props.need(t)==e.props.dire})).length,n={width:Math.floor(t/this.props.beans.length*100)+"%"},a=this.props.beans.filter((function(t){return e.props.need(t)==e.props.abundant})).length,r={width:Math.floor(a/this.props.beans.length*100)+"%"};return i.a.createElement("div",{className:this.props.className},this.header(),i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"bar-inner dire",style:n},t>0?"".concat(t," ").concat(_a[this.props.dire]):""),i.a.createElement("div",{className:"bar-inner abundant",style:r},a>0?a:"")))}}]),n}(i.a.Component);function Oa(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}var Ba=function(){var e=ua((function(e){return oa(e.world,0)})),t=ua((function(e){return e.world.economy})),n=Oa(e.map((function(e){return e.discrete_food}))),a=Oa(e.map((function(e){return e.discrete_health}))).toFixed(1),r=Oa(e.map((function(e){return e.discrete_stamina}))).toFixed(1),s=e.reduce((function(e,t){return e+t.cash}),0),c=s/(e.length||1),o=Oa(e.map((function(e){return e.cash}))),l=e.filter((function(e){return e.cash<1})).length,u=Math.max(c,o),m=e.filter((function(e){return e.cash>u})),d=m.length/(e.length||1)*100,h=m.reduce((function(e,t){return e+t.cash}),0)/s*100,y=e.reduce((function(e,t){return e[t.job]=(e[t.job]||0)+1,e}),{}),p=((y.jobless||0)/e.length*100).toFixed(1);function f(e,t){return e.supply+=t.quantity,e.price+=t.price,e.count++,e.avg=e.price/e.count,e}var b=t.market.listings.food.reduce(f,{supply:0,price:0,avg:0,count:0}),v=t.market.listings.medicine.reduce(f,{supply:0,price:0,avg:0,count:0}),g=t.market.listings.shelter.reduce(f,{supply:0,price:0,avg:0,count:0});return i.a.createElement("div",null,i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"State of the Utopia")),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udf5e Food Security"),i.a.createElement(Ma,{beans:e,need:function(e){return e.food},dire:"hungry",abundant:"stuffed",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",n.toFixed(1)," \ud83c\udf5e"),i.a.createElement("td",{className:"text-center"},"Supply: ",b.supply," \ud83c\udf5e @ $",b.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.food," \ud83c\udf5e"))))),i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83e\ude7a Healthcare"),i.a.createElement(Ma,{beans:e,need:function(e){return e.health},dire:"sick",abundant:"fresh",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",a," \ud83e\ude7a"),i.a.createElement("td",{className:"text-center"},"Supply: ",v.supply," \ud83e\ude7a @ $",v.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.medicine," \ud83e\ude7a")))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udfe1 Housing")," ",i.a.createElement("br",null),i.a.createElement(Ma,{beans:e,need:function(e){return e.stamina},dire:"homeless",abundant:"rested",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",r," \ud83c\udfe1"),i.a.createElement("td",{className:"text-center"},"Supply: ",g.supply," \ud83c\udfe1 @ $",g.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.shelter," \ud83c\udfe1")))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83d\udcb0 Wealth")," ",i.a.createElement("br",null),l," penniless citizens \xa0 \xa0 Cost of Living: $",re(t).toFixed(2)," ",i.a.createElement("br",null),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Total $",s.toFixed(2)),i.a.createElement("td",{className:"text-center"},"Median: $",o.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Avg: $",c.toFixed(2))))),"Top ",d.toFixed(1),"% of subjects own ",h.toFixed(1),"% of the wealth"),i.a.createElement("span",null,i.a.createElement("strong",null,"Unemployment")," ",p,"% (",y.jobless,")",i.a.createElement("br",null),i.a.createElement("ul",{className:"boxes"},i.a.createElement("li",null,y.farmer||0," farmers"),i.a.createElement("li",null,y.builder||0," builders"),i.a.createElement("li",null,y.doc||0," doctors"),i.a.createElement("li",null,y.entertainer||0," entertainers")))))},Aa=function(e){return i.a.createElement("div",null)},Pa=function(e){var t=ua((function(e){return e.world.law.cash}));return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83d\udcb0 Treasury: ",t.toFixed(2))))},Ta=function(e){var t=Object(a.useState)("Welfare"),n=Object(z.a)(t,2),r=n[0],s=n[1];return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("h2",{className:"marg-b-0"},"Utopia Government"),i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"},i.a.createElement("button",{type:"button",onClick:function(){return s("Welfare")},className:"Welfare"===r?"active":""},"\ud83e\udd32 Welfare"),i.a.createElement("button",{type:"button",onClick:function(){return s("Crime")},className:"Crime"===r?"active":""},"\ud83d\udea8 Crime"),i.a.createElement("button",{type:"button",onClick:function(){return s("Taxation")},className:"Taxation"===r?"active":""},"\ud83d\udcb0 Taxes"),i.a.createElement("button",{type:"button",onClick:function(){return s("funds")},className:"funds"===r?"active":""},"\ud83d\udcb8 Funds")))),"funds"===r?i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement(Pa,null)),i.a.createElement("div",null)):i.a.createElement(Ha,{group:r}))},Ha=function(e){var t=Object.values($).filter((function(t){return t.group===e.group})),n=ua((function(e){return e.world.alien.seenBeliefs})),a=ua((function(e){return e.world.alien.beliefInventory})),r=ua((function(e){return e.world.law})),s=la();return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("strong",null,e.group," Laws"),i.a.createElement("div",{className:"horizontal scroll"},t.map((function(e){return i.a.createElement(Ga,{seenBeliefs:n,id:e.key,beliefs:a,key:e.key,enacted:X(r,e.key),enactLaw:function(e){return s(ea({lawKey:e}))},revokeLaw:function(e){return s(ta({lawKey:e}))}})}))))},Ga=function(e){var t,n,a=$[e.id],r=(t=a.prereqs,n=e.seenBeliefs,0===t.length||t.some((function(e){return U(e,n)}))),s=function(e,t){return 0===e.length||e.every((function(e){return U(e,t)}))}(a.prereqs,e.seenBeliefs);return i.a.createElement("div",{className:"vertical law-formula"},i.a.createElement("div",{className:"horizontal"},i.a.createElement("div",{className:"circular"},r?a.icon:"\u2754"),i.a.createElement("div",null,i.a.createElement("strong",null,r?a.name:"Unknown"),i.a.createElement("div",null,r?i.a.createElement("small",null," ",a.description," "):null))),i.a.createElement("div",{className:"vertical"},a.prereqs.map((function(t){var n,a=U(t,e.seenBeliefs),r=(n=t,Array.isArray(n)?n.join("/"):n);return a?i.a.createElement("span",{className:"law-formula-ingredient",key:r},function(e){return Array.isArray(e)?e.map((function(e){return V(e)})).join(" / "):V(e)}(t)):i.a.createElement("span",{className:"law-formula-ingredient unknown",key:r},"\u2754 Unknown")}))),e.enacted?i.a.createElement("button",{className:"callout",onClick:function(){return e.revokeLaw(e.id)}},"\ud83d\uddd1\ufe0f\xa0Revoke Active Law"):i.a.createElement("button",{className:"callout",disabled:!s,onClick:function(){return e.enactLaw(e.id)}},s?"\u2712\ufe0f":i.a.createElement("span",{className:"grey"},"\ud83d\udd12"),"\xa0Enact"),e.children)},Fa=function(e){return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h3",null,"Welcome to the"),i.a.createElement("h2",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Laboratory"),i.a.createElement("div",null,"Thank you for joining the ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," Cultivation Division of the ",i.a.createElement("strong",null,"\ud83c\udf0c Galactic Xenosensation Federation!")," Your interdimensional petri dish is ready for farming."),i.a.createElement("p",null,"As a ",i.a.createElement("select",null,i.a.createElement("option",null,"Human Emotion Farmer")),", you are required to execute the following duties:"),i.a.createElement("ul",null,i.a.createElement("li",null,"Construct ",i.a.createElement("strong",null,"\ud83c\udfe0 Buildings")," for your ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef8 Beam In")," ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects for cultivation."),i.a.createElement("li",null,"Harvest your subject's positive ",i.a.createElement("strong",null,B.happiness," Hedons"),"."),i.a.createElement("li",null,"Sell the Hedons on the ",i.a.createElement("br",null),i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market"),".")),i.a.createElement("div",null)),i.a.createElement("div",null,i.a.createElement("p",null,"The GXF's records indicate ",i.a.createElement("select",null,i.a.createElement("option",null,"Humans"))," are a",i.a.createElement("br",null),i.a.createElement("u",null,"mentally malleable")," and ",i.a.createElement("u",null,"physically fragile")," species. Try the following cultivation methods:"),i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef0\ufe0f Scan")," your subject's primitive minds for information on what pleases them."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udebf Brainwash")," subjects to change their ",i.a.createElement("strong",null,"\ud83e\udde0\xa0Traits"),". Try to add Traits that emit more ",i.a.createElement("strong",null,B.happiness,"\xa0Hedons"),"."),i.a.createElement("li",null,"Avoid letting your subjects die or endure pain; this makes ",i.a.createElement("strong",null,B.unhappiness,"\xa0Antihedons")," which are less profitable."),i.a.createElement("li",null,"Use your knowledge of Traits to modify the farm's ",i.a.createElement("strong",null,"\ud83d\uddf3\ufe0f\xa0Government")," to maximize Hedon generation."),i.a.createElement("li",null,"Use the GXF's ",i.a.createElement("strong",null,"\ud83e\uddea Research Lab")," to upgrade your farm, when stocked with ",i.a.createElement("strong",null,"\ud83d\udc7e Abducted")," subjects.")),i.a.createElement("h3",null,"\ud83c\udf0c Galactic Xenosensation Federation ",i.a.createElement("br",null),i.a.createElement("div",{className:"text-right"},i.a.createElement("small",null,i.a.createElement("i",null,"1 trillion sensations. 100% organic. 100% gourmet.")))))))},qa=function(e){return i.a.createElement("div",null)},Ra=function(e){var t=Object(a.useState)("main"),n=Object(z.a)(t,2),r=n[0],s=n[1],c=b.HasContinueGame(),o=b.GetGameSlots();return i.a.createElement("div",null,i.a.createElement("h1",{className:"text-center"},"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),"main"===r?i.a.createElement("div",null,null!=c?i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.loadGame(c)}},"\ud83e\uddeb Continue Game")):null,i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.startGame()}},"\ud83d\udef8 Start New Game")),i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return s("showslots")},disabled:o.every((function(e){return null==e.brief}))},"\ud83d\uddc2\ufe0f Load Game"))):i.a.createElement("div",{className:"card-parent vertical load-menu pad-4p"},o.map((function(t){return i.a.createElement("div",{key:t.id,className:"card marg-b-20"},i.a.createElement("button",{disabled:null==t.brief,className:"",onClick:function(){t.brief&&e.loadGame(t.id)}},t.brief?i.a.createElement("span",{className:"f-size-125em"},i.a.createElement("strong",null,t.brief.Name),"\xa0",i.a.createElement("span",null,"Year ",t.brief.Age.year),"\xa0",i.a.createElement("span",null,t.brief.Population," \ud83d\ude10")):i.a.createElement("span",{className:"f-size-125em"},"Slot ",t.id)))}))))},La=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("svg",{width:"100",height:"300",xmlns:"http://www.w3.org/2000/svg",style:{},className:this.props.classN+" robot-arm"},i.a.createElement("g",null,i.a.createElement("title",null,"robotarm"),i.a.createElement("rect",{fill:"transparent",id:"canvas_background",height:"302",width:"102",y:"-1",x:"-1"}),i.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},i.a.createElement("rect",{fill:"url(#gridpattern)",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),i.a.createElement("g",null,i.a.createElement("title",null,"Layer 1"),i.a.createElement("rect",{id:"svg_2",height:"200",width:"48",y:"91.63545",x:"25",strokeWidth:"1.5",stroke:"#000",fill:"#BBBBBB"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_1",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_3",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_4",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_5",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"},this.props.tool)),i.a.createElement("text",{y:"250",x:"-20",fontSize:"4em"},this.props.tool))}}]),n}(i.a.Component);n(34);var za=["\ud83d\udce1","\ud83d\udddc\ufe0f","\ud83d\udd2c","\ud83d\udc89","\ud83d\udd0e","\ud83e\uddfc","\ud83e\uddf2","\ud83c\udfa5","\ud83d\udd27"];function Wa(e){var t=e+1;return t===za.length&&(t=0),t}var Ua=function(){var e=ua((function(e){return e.world.alien.abductedBeanKeys})),t=ua((function(e){return e.world.alien.techProgress})),n=ua((function(e){return e.world.alien.currentlyResearchingTech})),r=la(),s=Object(a.useState)(0),c=Object(z.a)(s,2),o=c[0],l=c[1],u=Object(a.useState)(3),m=Object(z.a)(u,2),d=m[0],h=m[1],y=Object(a.useState)(2),p=Object(z.a)(y,2),f=p[0],b=p[1],v=Object(a.useState)(1),g=Object(z.a)(v,2),E=g[0],k=g[1];Object(a.useEffect)((function(){var e=window.setInterval((function(){Math.random()<.51&&l(Wa(o)),Math.random()<.51&&h(Wa(d)),Math.random()<.51&&b(Wa(f)),Math.random()<.51&&k(Wa(E))}),1e3);return function(){window.clearInterval(e)}}));var w=Object.values(xt);return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h2",null,"Research \ud83e\uddea Lab"),i.a.createElement("div",{className:"vertical"},w.map((function(e){return function(e,t,n,a){var r=null==t[e.tech]?0:t[e.tech].researchPoints,s=e.techPoints,c={width:Math.min(r/s*100,100)+"%"},o=r>=s,l=n===e.tech,u=o?"\u2705":l?"\ud83d\udd2c":"\u2b55\ufe0f",m=l?"active":"inactive";return i.a.createElement("div",{className:"card-parent "+m,key:e.tech},i.a.createElement("button",{className:"card button",onClick:function(){return a(e.tech)}},i.a.createElement("strong",null,e.name),i.a.createElement("strong",{className:"pull-r f-size-125em"},u),i.a.createElement("div",null,e.description),i.a.createElement("div",{className:"bar f-size-12 h-12"},i.a.createElement("div",{className:"bar-inner text-center",style:c}),r,"/",s," tech")))}(e,t,n,(function(e){return r(na({t:e}))}))})))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",null,i.a.createElement("div",{className:"robot"},"\ud83e\udd16",i.a.createElement(La,{classN:"far-left",tool:za[o]}),i.a.createElement(La,{classN:"left",tool:za[d]}),i.a.createElement(La,{classN:"near-right",tool:za[f]}),i.a.createElement(La,{classN:"far-right",tool:za[E]}))),i.a.createElement("div",{className:"h-42em"},e.map((function(e){return i.a.createElement("span",{key:e,className:"victim bean triangle shake"},"\ud83d\ude28")}))),i.a.createElement("div",{className:"text-center"},"Currently probing ",e.length," beings for ",e.length," tech a day",i.a.createElement("p",null,i.a.createElement("small",null,"1 tech per research subject per day"))),e.length>0?i.a.createElement("div",{className:"text-right"},i.a.createElement(xa,{className:"callout",onConfirm:function(){r(Hn())},confirmText:"-1 Research Subject?"},"\ud83c\udf88 Release Research Subject")):null)),i.a.createElement("div",null))},Ja=function(){var e=ua((function(e){return e.world.alien.beliefInventory})),t=ua((function(e){return e.world.alien.seenBeliefs})),n=Object(a.useState)(),r=Object(z.a)(n,2),s=(r[0],r[1],[]);return Object.keys(t).forEach((function(e){null!=F[e]&&s.push(F[e])})),s.sort((function(e,t){return e.noun.localeCompare(t.noun)})),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"Subject \ud83e\udde0 Traits")),i.a.createElement("div",{className:"col-2-30-60"},i.a.createElement("div",null,i.a.createElement("div",{className:"scroll"},i.a.createElement("div",{className:"scoll-sticky-h"},i.a.createElement("strong",null,"Trait Inventory")),e.length<1?i.a.createElement("div",null,"No Traits! ",i.a.createElement("br",null),"\ud83d\ude35 Brainwash your subjects  ",i.a.createElement("br",null),"or buy from the \ud83d\udecd\ufe0f Market"):e.map((function(e){return i.a.createElement("div",{key:e.trait},i.a.createElement("div",null,i.a.createElement("strong",null,F[e.trait].icon," ",F[e.trait].noun)),i.a.createElement("div",null,"This can be implanted ",e.charges," more times"))})))),i.a.createElement("div",null,i.a.createElement("div",{className:"modal-scroll-v"},i.a.createElement("div",{className:"sticky-t-0"},i.a.createElement("strong",null,"Discovered ",s.length," of ",q.length," Traits")),s.length<1?i.a.createElement("div",null,"No Traits! ",i.a.createElement("br",null),"\ud83d\udef0\ufe0f Scan some of your subjects."):s.map((function(e){return i.a.createElement(Na,{key:e.noun,data:e,cost:0,titleView:i.a.createElement("strong",null,e.noun),bottomView:i.a.createElement("span",null)})}))))))};function Va(e){return"buy"==e.actionData.act&&"shelter"!=e.actionData.good}var $a=function(e){var t=ua((function(t){return function(e,t){var n=e.world.beans.byID[t],a="work"===n.actionData.act;return{speech:dt(n),face:pt(n),good:Va(n)?O[n.actionData.good||"food"]:void 0,classes:[n.job,n.ethnicity,"travel"!=n.actionData.act||"dead"===n.lifecycle?"paused":""].join(" "),animationClasses:["bean-walker",a?"spin":""].join(" ")}}(t,e.beanKey)})),n=ua((function(t){return t.selected.selectedBeanKey===e.beanKey})),a=["bean interactable",t.classes,e.sitStill?"":t.animationClasses,n?"selected":""].join(" "),r=la();return i.a.createElement("span",{className:a,onClick:function(t){t.stopPropagation(),r(pa({cityKey:e.cityKey,beanKey:e.beanKey}))}},t.face," ",t.good?i.a.createElement("span",{className:"purchase"},i.a.createElement("span",{className:"money"},"\ud83d\udcb8"),i.a.createElement("span",{className:"purchase-good"},t.good)):null," ",t.speech?i.a.createElement("span",{className:"speech"},i.a.createElement("span",{className:""},t.speech)):null)},Xa=function(e){var t=Object(a.useState)(!1),n=Object(z.a)(t,2),r=n[0],s=n[1],c=ua((function(t){return t.world.pickups.byID[e.pickupKey]})),o=i.a.useContext(zi);return Object(a.useEffect)((function(){!r&&o&&(o.play("drop"),s(!0))})),i.a.createElement("span",{className:"pickup bob"},B[c.type])},Ya=function(e){var t=i.a.useContext(Wi),n=Object(a.useRef)(null),r=function(e){n.current&&e&&(n.current.style.transform="translate(".concat(e.point.x,"px, ").concat(e.point.y,"px)"))};return Object(a.useEffect)((function(){var n=t.Get(e.moverType,e.moverKey);return n.subscribe(r),n.current&&r(n.current),function(){return t.Get(e.moverType,e.moverKey).unsubscribe(r)}}),[]),i.a.createElement("div",{ref:n},e.children)},Za=function(e){var t=ua((function(t){return ca(t.world,e.cityKey)}));return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement(Ya,{moverKey:t,key:t,moverType:"bean"},i.a.createElement($a,{cityKey:e.cityKey,beanKey:t}))})))},Qa=function(e){var t=ua((function(t){return t.world.cities.byID[e.cityKey].pickupKeys}));return i.a.createElement(i.a.Fragment,null,t.map((function(e){return i.a.createElement(Ya,{moverKey:e,key:e,moverType:"pickup"},i.a.createElement(Xa,{pickupKey:e}))})))},ei=function(e){var t=ua((function(t){return function(e,t,n){var a=e.cities.byID[t].buildingMap[n];return null!=a?function(e,t){return e.buildings.byID[t]}(e,a):void 0}(t.world,e.cityKey,"".concat(e.hex.q,",").concat(e.hex.r))})),n=ua((function(t){return function(e,t){return e.cities.byID[t]}(t.world,e.cityKey)}));return t?i.a.createElement($t,{city:n,building:t}):null},ti=function(e){var t=la(),n=ua((function(t){return t.selected.selectedHexKey===e.hexString}))?"hex-selected":"";return i.a.createElement("div",{className:"hex "+n,key:e.i,style:Object(W.a)(Object(W.a)({},si),Ke(e.xy)),onMouseEnter:function(n){t(jn({cityKey:e.cityKey,px:e.xy}))},onClick:function(n){return null!=e.buildingKey?t(ba({cityKey:e.cityKey,buildingKey:e.buildingKey,hex:e.hex})):t(ha({cityKey:e.cityKey,hex:e.hex})),n.stopPropagation(),!1}},e.children)},ni=function(e){var t=ua((function(t){return t.world.cities.byID[e.cityKey]})),n=ua((function(t){var n;return null===(n=t.world.cities.byID[e.cityKey])||void 0===n?void 0:n.hexes}));return i.a.createElement(i.a.Fragment,null,n.map((function(n,a){var r=Se(t.hex_size,t.petriOrigin,n),s=n.q+","+n.r,c=t.buildingMap[s];return i.a.createElement(ti,{i:a,hex:n,xy:r,hexString:s,cityKey:e.cityKey,buildingKey:c},i.a.createElement(ei,{cityKey:e.cityKey,hex:n}))})))},ai=function(e){var t=ua((function(t){return function(e,t){return function(e,t){return e.cities.byID[t].buildingKeys}(e,t).reduce((function(t,n){return t.push(e.buildings.byID[n]),t}),[])}(t.world,e.city.key)}));return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement("div",{key:t.key,className:"building-node",onClick:function(){return e.onClickBuilding(t)}},i.a.createElement(Xt,{cityName:e.city.name,building:t,style:{},getStyle:function(){return{}}}))})))},ii=function(e){Object(a.useRef)(null);var t=ua((function(t){return t.world.cities.byID[e.cityKey].pickupMagnetPoint}));return t?i.a.createElement("div",{className:"magnet",style:{transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}},"\ud83e\uddf2"):null},ri=function(e){var t=Object(a.useState)(!1),n=Object(z.a)(t,2),r=n[0],s=n[1],c=ua((function(t){return t.world.cities.byID[e.cityKey]})),o=ua((function(t){return t.world.ufos.byID[e.ufoKey]}));setTimeout((function(){s(!0),setTimeout((function(){s(!1)}),1800)}),1800);var l=Object(W.a)({},Ke(Se(c.hex_size,c.petriOrigin,o.point)));return i.a.createElement("span",{style:l,className:"ufo"},"\ud83d\udef8",r?i.a.createElement("span",{className:"beam"}):null)},si={width:"120px",height:"120px",top:"-60px",left:"-60px"},ci=function(e){for(var t=ua((function(t){return t.world.cities.byID[e.cityKey]})),n=ua((function(t){return t.world.cities.byID[e.cityKey].ufoKeys})),a=(ua((function(e){return e.world.spotlightEvent})),ua((function(e){if(e.world.spotlightEvent&&e.world.spotlightEvent.beanKey)return e.world.beans.byID[e.world.spotlightEvent.beanKey]})),la()),r=[],s=t.petriRadius-20,c=0;c<72;c++){var o=je({r:s,az:5*c*Math.PI/180});o.x+=t.petriRadius,o.y+=t.petriRadius,r.push(Ke(o))}t.deadBeanKeys.map((function(e,t){return i.a.createElement("span",{key:t,className:"dead",style:{left:10*t+"px"}},"\u26b0\ufe0f")}));var l={height:2*t.petriRadius+"px",width:2*t.petriRadius+"px"};return i.a.createElement("div",{className:"tile",onClick:function(){return e.onClick()},onMouseLeave:function(){a(jn({cityKey:t.key}))},style:l},i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-base"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 1)"})),i.a.createElement(ni,{cityKey:t.key}),r.map((function(e,t){return i.a.createElement("span",{key:t,style:e,className:"mtn"},"\u26f0\ufe0f")})),i.a.createElement(Qa,{cityKey:e.cityKey}),i.a.createElement(Za,{cityKey:e.cityKey}),n.map((function(e,n){return i.a.createElement(ri,{ufoKey:e,key:e,cityKey:t.key})})),i.a.createElement(ii,{cityKey:e.cityKey}),i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-lid"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 0.2)"})))},oi=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t="card button";return this.props.thin&&(t+=" thin"),this.props.singleLine&&(t+=" single"),i.a.createElement("button",{className:t,title:this.props.title,onClick:function(){e.props.onClick&&e.props.onClick()},type:"button",disabled:this.props.disabled},this.props.icon," ",this.props.name,null!=this.props.subtext?i.a.createElement("small",null,this.props.subtext):null)}}]),n}(i.a.Component);function li(e,t,n){switch(t){case"trad":case"prog":case"ego":case"state":return i.a.createElement(oi,{icon:j[t],title:H[t].description,name:"",subtext:_a[t],thin:!0,singleLine:!0,onClick:n});case"fresh":case"sick":case"hungry":case"starving":case"stuffed":case"homeless":case"rested":case"circle":case"square":case"triangle":case"sane":case"disturbed":case"stressed":return i.a.createElement(oi,{icon:j[t],title:_a[t],name:"",subtext:_a[t],thin:!0,singleLine:!0,onClick:n});case"noFaith":case"rocket":case"dragon":case"music":return i.a.createElement(oi,{icon:j[t],title:G[t].description,name:"",subtext:_a[t],thin:!0,singleLine:!0,onClick:n});default:return null}}var ui=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("small",null,kn(this.props.cost,"-",this.props.qty)," ",this.props.rider)}}]),n}(i.a.Component);n(35);function mi(e,t,n,a,r){if(!e)return i.a.createElement("div",{className:"width-100p text-center"},i.a.createElement("small",null,"Subject needs a Scan to reveal their thoughts"));switch(t){case"beliefs":return e?n.beliefs.map((function(e,t){var n,a="belief-name shadow text-left "+F[e].rarity;return i.a.createElement("table",{className:"width-100p",key:e+t},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",{className:a},F[e].icon," ",F[e].adj),i.a.createElement("td",{className:"text-right"},(F[e].idealPro||[]).map((function(e){return i.a.createElement("span",{key:e},"+",j[e])})),(F[e].idealCon||[]).map((function(e){return i.a.createElement("span",{key:e},"-",j[e])})))),i.a.createElement("tr",null,i.a.createElement("td",{className:"small text-center",colSpan:2},F[e].description?null===(n=F[e].description)||void 0===n?void 0:n.split(";").map((function(e,t){return i.a.createElement("div",{key:t},e)})):null))))})):null;case"feelings":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,e?function(e){return Object.keys(e.happiness.all).map((function(t,n){return i.a.createElement("tr",{key:n},i.a.createElement("td",{className:"small text-right"},e.happiness.all[t]," ",e.happiness.all[t]>=0?B.happiness:B.unhappiness," from "),i.a.createElement("td",{className:"small"},t))}))}(n):null));default:case"priorities":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Currently ",function(e){var t;switch(e.act){case"chat":return"chatting";case"crime":return"commiting crime";case"sleep":return"sleeping \ud83d\ude34";case"relax":return"relaxing";case"travel":return"travelling to "+(null===(t=e.intent)||void 0===t?void 0:t.act)||!1;case"work":return e.good?"working to make "+O[e.good]:"working";case"buy":return e.good?"buying "+O[e.good]:"buying"}return""}(n.actionData))),mn(n,a,r.difficulty).values.map((function(e){return i.a.createElement("tr",{key:"p-".concat(e.value.act,"-").concat(e.value.good)},i.a.createElement("td",null,e.priority.toFixed(1)," ",function(e){switch(e.act){case"sleep":return"\ud83d\ude34";case"work":return e.good?"\ud83d\udcaa "+O[e.good]:"\ud83d\udcaa";case"buy":return e.good?"\ud83d\udcb8 "+O[e.good]:"\ud83d\udcb8"}return""}(e.value)))})),function(e){var t=Object.keys(e.activity_duration).map((function(e){return e}));return t.sort((function(t,n){return e.activity_duration[n]-e.activity_duration[t]})),t}(n).filter((function(e){return n.activity_duration[e]>0})).map((function(e){var t=e;return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e),i.a.createElement("td",null,(n.activity_duration[t]/1e3).toFixed(1),"s"))}))))}}var di=function(e){var t=la(),n=Object(a.useState)(void 0),r=Object(z.a)(n,2),s=r[0],c=r[1],o=Object(a.useState)("beliefs"),l=Object(z.a)(o,2),u=l[0],m=l[1],d=ua((function(e){return e.world.alien})),h=ua(Ea),y=ua(ga);function p(){setTimeout((function(){c(void 0)}),5e3)}if(!h||!y)return null;var f=h.job+" "+h.ethnicity;return i.a.createElement("div",{className:"vertical bean-panel"},i.a.createElement("div",{className:"bean-panel-header"},i.a.createElement("div",null,i.a.createElement("b",null,h.name,"\xa0",y?i.a.createElement("small",null," of ",y.name," "):null),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){t(ya())}},"\u274c")),i.a.createElement("div",{className:"bean-view"},i.a.createElement("span",{className:f+" bean"},void 0===s?pt(h):s)),i.a.createElement("div",{className:"horizontal"},i.a.createElement("span",{className:"text-center"},"\ud83d\udcb0 $",h.cash.toFixed(2)),i.a.createElement("span",{className:"text-center"},"\ud83d\ude42 ",Math.round(h.lastHappiness),"%"),i.a.createElement("span",{className:"text-center"},Math.round(h.happiness.flatAverage)," ",B.happiness," /day")),function(e,t,n,a,r){return e?i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},li(0,t.ethnicity,void 0),li(0,t.faith,a)),i.a.createElement("div",{className:"card-parent"},t.beliefs.map((function(e){return i.a.createElement(oi,{key:e,icon:F[e].icon,title:F[e].adj,name:"",thin:!0,singleLine:!0,onClick:function(){}})}))),i.a.createElement("div",{className:"card-parent"},li(0,t.food,void 0),li(0,t.stamina,void 0),li(0,t.health,void 0))):i.a.createElement("div",{className:"card-parent"},i.a.createElement(oi,{icon:"\ud83d\udef0\ufe0f",name:"Scan",subtext:"-Energy +Info",onClick:r,disabled:!St(n,n.difficulty.cost.bean.scan)}))}(d.scanned_bean[h.key],h,d,(function(){t(function(){throw new Error("Function not implemented.")}())}),(function(){t(Gn({beanKey:h.key})),c("\ud83d\ude28"),p()}))),i.a.createElement("div",{className:"grow-1 pad-4 bean-panel-content"},i.a.createElement("div",{className:"cylinder blue-orange horizontal"},i.a.createElement("button",{type:"button",className:"beliefs"==u?"active":"",onClick:function(){return m("beliefs")}},"\ud83d\ude07 Traits"),i.a.createElement("button",{type:"button",className:"feelings"==u?"active":"",onClick:function(){return m("feelings")}},"\ud83d\ude10 Feelings"),i.a.createElement("button",{type:"button",className:"priorities"==u?"active":"",onClick:function(){return m("priorities")}},"\ud83d\udcaa Priorities")),mi(d.scanned_bean[h.key],u,h,y,d)),i.a.createElement("div",{className:"bean-action-card-parent"},i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){e.brainwash()},title:"Rewrite one of this being's traits"},"\ud83d\ude35 Brainwash",i.a.createElement("small",null,"-Sanity +-Trait"))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){t(Fn({beanKey:h.key})),c("\ud83d\ude28"),p()},disabled:!St(d,d.difficulty.cost.bean.vaporize),title:"Delete this being from the experiment"},"\u2620\ufe0f Vaporize",i.a.createElement(ui,{cost:d.difficulty.cost.bean.vaporize}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",disabled:!St(d,d.difficulty.cost.bean.abduct),onClick:function(){return t(Tn({beanKey:h.key}))},title:"Remove this being for study"},"\ud83d\udc7e Abduct for Research",i.a.createElement(ui,{cost:d.difficulty.cost.bean.abduct,rider:"+Tech"})))))};var hi=function(e){return i.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"+(e.additionalClasses||"")},e.options.map((function(t){return i.a.createElement("button",{type:"button",key:t.value,onClick:function(){return t.onClick()},className:e.active===t.value?"active":""},t.icon," ",t.text)})))},yi=["company","co-op","commune"],pi={company:"\ud83c\udfa9","co-op":"\ud83e\udd1d",commune:"\u2692\ufe0f"},fi=function(e){var t=la();return i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return t(Pn({cityKey:e.city,where:xi(e.hex)}))}},"\ud83d\udef8 Beam In New Subject",i.a.createElement(ui,{cost:e.difficulty.cost.hex.beam,rider:"+Subject"})))},bi=function(e){var t=Object(m.c)((function(e){return e.selected.selectedHexKey})),n=Object(m.c)(ka),a=Object(m.c)(ga),r=la();if(a&&n)return i.a.createElement(vi,{building:n,city:a,difficulty:e.difficulty});if(a&&t){var s=e.difficulty.cost.emptyHex;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,"Empty Lot")," in ",i.a.createElement("strong",null,a.name),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return r(fa({cityKey:a.key}))}},"\u274c")),i.a.createElement("h3",null,"Build:"),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(Mn({city:a.key,where:xi(t),what:"house"}))}},Ie.house," House",i.a.createElement(ui,{cost:s.build.house}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(Mn({city:a.key,where:xi(t),what:"farm"}))}},Ie.farm," Farm",i.a.createElement(ui,{cost:s.build.farm})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(Mn({city:a.key,where:xi(t),what:"hospital"}))}},Ie.hospital," Hospital",i.a.createElement(ui,{cost:s.build.hospital}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(Mn({city:a.key,where:xi(t),what:"theater"}))}},Ie.theater," Theater",i.a.createElement(ui,{cost:s.build.theater})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(Mn({city:a.key,where:xi(t),what:"park"}))}},Ie.park," Park",i.a.createElement(ui,{cost:s.build.park}))),i.a.createElement("h3",null,"Beings:"),i.a.createElement(fi,{difficulty:e.difficulty,hex:t,city:a.key}))}return i.a.createElement("div",null)},vi=function(e){var t,n=e.building,a=ua((function(e){return null!=n.enterpriseKey?e.world.enterprises.byID[n.enterpriseKey]:void 0})),r=la(),s=He(n),c="park"!=n.type&&"nature"!=n.type,o="".concat(n.address.q,",").concat(n.address.r);return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,n.upgraded&&c?"Dense ":"Small ",_a[n.type]),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return r(ya())}},"\u274c")),i.a.createElement("div",{className:"text-right"},i.a.createElement("small",null,"in\xa0",i.a.createElement("strong",null,e.city.name))),null!=a?i.a.createElement("div",null,i.a.createElement("small",null,"$",null===(t=a.cash)||void 0===t?void 0:t.toFixed(2)," from sales today"),i.a.createElement(wi,{enterpriseKey:a.key,good:Me[n.type]})):null,n.upgraded&&c?i.a.createElement("div",null,gi(n.type)):null,null!=a?i.a.createElement(ki,{enter:a,changeEnterprise:function(e){return r(On({enterpriseKey:n.key,newType:e}))}}):null,i.a.createElement(Ei,{cityKey:e.city.key,building:n}),c?i.a.createElement("div",null,"This ",_a[n.type]," can support ",s.length," more jobs.",n.upgraded?null:i.a.createElement("span",null,i.a.createElement("br",null),"Upgrade it to add 3 more job slots.")):null,n.upgraded||!c?null:i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return r(An({buildingKey:n.key}))}},"\ud83d\udee0\ufe0f Upgrade",i.a.createElement(ui,{cost:e.difficulty.cost.hex.upgrade}))),gi(n.type)),i.a.createElement(fi,{city:e.city.key,difficulty:e.difficulty,hex:o}))},gi=function(e){return"house"===e?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83d\udc2e Parochial subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in dense buildings")),i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83c\udf78 Cosmopolitan subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in small buildings"))):i.a.createElement("div",null)},Ei=function(e){var t=la(),n=ua((function(t){return e.building.jobs.map((function(e){return t.world.beans.byID[e]}))})),a=ua((function(t){return t.world.enterprises.byID[e.building.key]}));return n.length<0?i.a.createElement("div",null,"No Workers"):i.a.createElement("div",null,i.a.createElement("strong",null,"Workers:"),n.map((function(n){return i.a.createElement("div",{key:n.key},_e[e.building.type]," ",n.name," ",a&&"company"===a.enterpriseType&&n.key===a.ownerBeanKey?"\ud83c\udfa9":"",i.a.createElement("button",{title:"Fire",className:"callout marg-0",onClick:function(){return n?t(Bn({cityKey:e.cityKey,beanKey:n.key})):null}},"\ud83d\udd25"))})))},ki=function(e){var t=yi.map((function(t){return{icon:pi[t],text:t[0].toUpperCase()+t.substring(1),value:t,onClick:function(){e.changeEnterprise(t)}}}));return i.a.createElement(hi,{active:e.enter.enterpriseType,options:t})},wi=function(e){var t=ua((function(t){return t.world.economy.market.listings[e.good]}));return i.a.createElement("div",null,t.filter((function(t){return t.sellerEnterpriseKey===e.enterpriseKey})).map((function(t,n){return i.a.createElement("div",{key:n},t.quantity," ",O[e.good]," @ $",t.price.toFixed(2))})))};function xi(e){var t=e.split(",");return{q:+t[0],r:+t[1]}}var Di=function(e){var t=ua((function(t){return oa(t.world,e.city.key)})),n=i.a.createElement("div",null,"Human Emotion Farm",i.a.createElement("div",null,i.a.createElement("small",null,"Part of the \ud83c\udf0c Galactic Xenosensation Federation")));e.city&&(n=i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("b",null,e.city.name),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.clearCity()}},"\u274c"))));var a=t.reduce((function(e,t){return e+t.lastHappiness}),0)/(t.length||1),r=t.reduce((function(e,t){return e+t.cash}),0)/(t.length||1);return i.a.createElement("div",null,n,i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"\ud83d\udc65 Subjects")),i.a.createElement("div",null,i.a.createElement("b",null,"Population"),"\xa0",i.a.createElement("span",null,t.length)),i.a.createElement(Ma,{beans:t,need:function(e){return e.food},dire:"starving",abundant:"stuffed"},"Food Security"),i.a.createElement(Ma,{beans:t,need:function(e){return e.stamina},dire:"homeless",abundant:"rested"},"Housing"),i.a.createElement(Ma,{beans:t,need:function(e){return e.health},dire:"sick",abundant:"fresh"},"Healthcare"),i.a.createElement("b",null,"Avg. Money")," $",r.toFixed(2)," \xa0",i.a.createElement("b",null,"Avg. Happiness")," ",Math.round(a),"%",t&&t.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"\ud83e\udde0 Traits")),i.a.createElement("div",{className:"max-w-300"},function(e,t){return Array.from(t.reduce((function(t,n){return e[n.key]?n.beliefs.forEach((function(e){var n=t.get(e)||0;t.set(e,n+1)})):t.set("Unknown",(t.get("Unknown")||0)+1),t}),new Map).entries()).sort((function(e,t){var n=Object(z.a)(e,2),a=(n[0],n[1]),i=Object(z.a)(t,2);i[0];return i[1]-a})).map((function(e){var t=Object(z.a)(e,2),n=t[0],a=t[1];return"Unknown"===n?{icon:"\u2754",noun:"Unknown",count:a}:{icon:F[n].icon,noun:F[n].noun,count:a}}))}(e.alien.scanned_bean,t).map((function(e){return i.a.createElement("span",{key:e.noun,className:"overview-belief"},e.icon,"\xa0",e.noun,"\xa0x",e.count)})))):null,t.length?i.a.createElement("div",{className:"card-parent"},i.a.createElement(oi,{icon:"\ud83d\udef0\ufe0f",name:"Scan All",disabled:!0,subtext:"-Energy +Info",onClick:function(){}})):null)},Ni=(i.a.Component,function(e){var t=ua(ga),n=ua((function(e){return e.selected.selectedHexKey})),a=ua(Ea),r=ua((function(e){return e.world.alien})),s=la();return a&&t?i.a.createElement(di,{bean:a,city:t,alien:r,brainwash:function(){return e.openBrainwash()}}):n?i.a.createElement(bi,{difficulty:r.difficulty}):t?i.a.createElement(Di,{city:t,clearCity:function(){return s(ya())},alien:r}):i.a.createElement("div",null)});var Si=function(e){var t=ua(wa),n=la(),a=t.map((function(e,t){var a="\ud83d\udea8"===e.icon,r="nojobslots"===e.trigger||"persuasion"===e.trigger;return i.a.createElement("div",{key:t,className:a||r?"tall":""},i.a.createElement("span",{className:a?"police-siren":""},e.icon),"\xa0",function(e){return null!=e.beanKey&&("speechcrime"===e.trigger||"birth"===e.trigger)}(e)?i.a.createElement("a",{onClick:function(){e.beanKey&&e.cityKey&&n(pa({beanKey:e.beanKey,cityKey:e.cityKey}))},href:"javascript:void(0)"},e.message):i.a.createElement("span",null,e.message))}));return 0===t.length&&(a=[i.a.createElement("div",{key:0},i.a.createElement("small",null,"No events yet"))]),i.a.createElement("div",{className:"events-panel"},i.a.createElement("div",null,i.a.createElement("b",null,"Events")),a)};function ji(e,t){return i.a.createElement("li",null,(null===e||void 0===e?void 0:e.done)?"\u2611\ufe0f":"\u2b55\ufe0f",t.text,null!=t.tooltip?i.a.createElement("small",{title:t.tooltip},"\u2754"):null,(null===e||void 0===e?void 0:e.done)||null==t.reward?null:function(e){return i.a.createElement("div",null,i.a.createElement("small",null,"\ud83c\udf81 ",kn(e.reward||{},"+")))}(t))}var Ki=function(){var e,t=ua((function(e){return e.world.alien.goalProgress})),n=ua((function(e){return e.world.alien.goals})),a=ua((function(e){return e.world.alien.workingReportCard}));return i.a.createElement("div",{className:"goals"},i.a.createElement("div",null,i.a.createElement("b",null,"Goals")),i.a.createElement("ul",null,n.map((function(e){return ji(t[e],bt[e])}))),i.a.createElement("div",null,i.a.createElement("b",null,"Report Card")),i.a.createElement("p",{className:"horizontal"},i.a.createElement("span",null,"Last Grade: ",i.a.createElement("b",null,"D")),i.a.createElement("span",null,"Next Grade in: ",i.a.createElement("b",null,"2 mo."))),i.a.createElement("p",null),i.a.createElement("table",{style:{margin:"auto"}},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Happiness"),i.a.createElement("td",null,a.Happiness),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects happy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,vt.RubricDescription.Happiness))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Prosperity"),i.a.createElement("td",null,a.Prosperity),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects fed and healthy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,vt.RubricDescription.Prosperity))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Stability"),i.a.createElement("td",null,a.Stability),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects sane and civil?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,vt.RubricDescription.Stability))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Dogma"),i.a.createElement("td",null,a.Dogma),i.a.createElement("td",null,i.a.createElement("small",{title:"Do your society's rules match your utopian ideals?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,vt.RubricDescription.Dogma))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:3},i.a.createElement("hr",null))),i.a.createElement("tr",null,i.a.createElement("th",null,"Avg. Grade"),i.a.createElement("td",null,kt((wt[(e=a).Happiness]+wt[e.Prosperity]+wt[e.Stability]+wt[e.Dogma])/20)),i.a.createElement("td",null)))))},Ii=function(){var e=ua((function(e){return e.world.alien})),t=la();return i.a.createElement("div",null,i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market")),i.a.createElement("p",null,i.a.createElement("small",null,"The premier exchange for \u26a1\ufe0f, \ud83e\udd16,  and ",B.happiness,"!")),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(ia({amount:1}))},disabled:!St(e,e.difficulty.cost.market.resource.energy)},"+1 \u26a1\ufe0f Energy",i.a.createElement(ui,{cost:e.difficulty.cost.market.resource.energy,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return t(ia({amount:5}))},disabled:!St(e,e.difficulty.cost.market.resource.energy,5)},"+5 \u26a1\ufe0f Energy",i.a.createElement(ui,{cost:e.difficulty.cost.market.resource.energy,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(aa({amount:1}))},disabled:!St(e,e.difficulty.cost.market.resource.bots)},"+1 \ud83e\udd16 Bot",i.a.createElement(ui,{cost:e.difficulty.cost.market.resource.bots,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return t(aa({amount:5}))},disabled:!St(e,e.difficulty.cost.market.resource.bots,5)},"+5 \ud83e\udd16 Bots",i.a.createElement(ui,{cost:e.difficulty.cost.market.resource.bots,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(sa())},disabled:e.hedons.amount>=0||!St(e,e.difficulty.cost.market.scrubHedons)},"Remove \ud83d\udca2 Negative Hedons",i.a.createElement(ui,{cost:e.difficulty.cost.market.scrubHedons,qty:1}))),i.a.createElement("div",null,i.a.createElement("small",null,i.a.createElement("i",null,"Current \ud83e\udde0 Traits for sale:"))),i.a.createElement("div",{className:"short-scroll"},i.a.createElement(Ci,{hedons:e.hedons.amount})))},Ci=function(e){var t=ua((function(e){return e.world.marketTraitsForSale})),n=la();return i.a.createElement(i.a.Fragment,null,t.map((function(t,a){var r=F[t.trait],s="belief-name "+r.rarity;return i.a.createElement("div",{className:"card-parent",key:a},i.a.createElement("button",{className:"card button",onClick:function(){return n(ra({l:t}))},disabled:e.hedons<(t.cost.hedons||0)},i.a.createElement("span",{className:s},r.icon," ",r.noun),i.a.createElement(ui,{cost:t.cost})))})))},_i=function(e){var t=Object(a.useState)(!1),n=Object(z.a)(t,2),r=n[0],s=n[1],c=Object(a.useState)(!1),o=Object(z.a)(c,2),l=o[0],u=o[1],m=function(e){s(e)},d=function(){u(!0),setTimeout((function(){return u(!1)}),500)};Object(a.useEffect)((function(){return b.Dirty.subscribe(m),function(){return b.Dirty.unsubscribe(m)}})),Object(a.useEffect)((function(){return b.Saving.subscribe(d),function(){return b.Saving.unsubscribe(d)}}));return i.a.createElement("button",{disabled:!r||l},l?"\ud83d\udcbf":r?"\ud83d\udcbe":"\u2714\ufe0f")};var Mi=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).bubbleSeed=0,a.onChange=function(e){var t=++a.bubbleSeed,n=e.change>0;a.setState({bubbles:a.state.bubbles.concat([{string:(n?"+":"")+e.change,id:t,className:n?"pos":"neg"}])}),setTimeout((function(){a.setState({bubbles:a.state.bubbles.filter((function(e){return e.id!=t}))})}),1500)},a.state={bubbles:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.changeEvent&&this.props.changeEvent.subscribe(this.onChange)}},{key:"componentWillUnmount",value:function(){this.props.changeEvent&&this.props.changeEvent.unsubscribe(this.onChange)}},{key:"render",value:function(){var e=this,t=this.state.bubbles.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.props.bubbleClass,"bubbler"].join(" ")},e.props.icon," ",t.string)}));return i.a.createElement("span",{className:"bubble-parent"},this.props.children,t)}}]),n}(i.a.Component),Oi=function(e){var t=function(e,t){var n=Object(a.useState)([]),i=Object(z.a)(n,2),r=i[0],s=i[1],c=0,o=function(e){var n=++c;s(r.concat([Object(W.a)({id:n},t(e))])),setTimeout((function(){s(r.filter((function(e){return e.id!=n})))}),1500)};return Object(a.useEffect)((function(){return e.subscribe(o),function(){return e.unsubscribe(o)}})),r}(e.changeEvent,(function(e){return{string:"Discovered ".concat(e.k,"!"),className:"seen-belief"}}));return i.a.createElement("span",{className:"bubble-parent"},e.children,t.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.bubbleClass,"bubbler"].join(" ")},e.icon," ",t.string)})))},Bi=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a}return Object(o.a)(n,[{key:"render",value:function(){var e="capsule-label "+this.props.label||!1;return i.a.createElement("span",{className:e},i.a.createElement("span",{className:"capsule-icon"},this.props.icon),i.a.createElement("span",{className:"capsule-text"},this.props.label,":"),i.a.createElement("span",{className:"capsule-value"},this.props.children))}}]),n}(i.a.Component),Ai=function(){var e=ua((function(e){return e.world.alien.energy.amount}));return i.a.createElement("span",null,e.toFixed(1))},Pi=function(){var e=ua((function(e){return e.world.alien.bots.amount}));return i.a.createElement("span",null,e.toFixed(1))},Ti=function(){var e=ua((function(e){return e.world.alien.hedons.amount}));return i.a.createElement("span",null,e.toFixed(0))},Hi=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={show:!1},a}return Object(o.a)(n,[{key:"getButton",value:function(){var e=this;return this.props.onClick?i.a.createElement("button",{type:"button",className:"done",onClick:function(){return e.props.onClick&&e.props.onClick()}},this.props.closeButtonText||"Done"):null}},{key:"render",value:function(){return this.props.show?i.a.createElement("div",{className:"modal"},this.props.children,this.getButton()):null}}]),n}(i.a.Component);var Gi=function(){var e,t=ua((function(e){return e.world.date}));return i.a.createElement("span",null,"\xa0Year ",t.year,",\xa0",yn[t.season]," ",t.day," ",(e=t.hour)<vn.Morning?"\ud83c\udf19":e<vn.Noon?"\ud83c\udf04":e<vn.Evening?"\u2600\ufe0f":"\ud83c\udf07")},Fi=(n(36),function(e){var t=ua((function(t){return ca(t.world,e.city.key)})),n=ua((function(e){return e.world.alien.scanned_bean})),a=la();return i.a.createElement("div",{className:"social-graph"},i.a.createElement("div",{className:"social-graph-row"},t.map((function(t){return i.a.createElement("div",{key:t,className:"bean-node",onClick:function(){return a(pa({cityKey:e.city.key,beanKey:t}))}},i.a.createElement($a,{beanKey:t,static:!0,sitStill:!0,cityKey:e.city.key}),n[t]?null:i.a.createElement("span",{className:"social-graph-unscanned prohibited-emoji"},"\ud83d\udef0\ufe0f"))}))),i.a.createElement("div",{className:"social-graph-row"},i.a.createElement(ai,{city:e.city,onClickBuilding:e.onClickBuilding})))}),qi=(n(37),function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\u231b\ufe0f",i.a.createElement("button",{type:"button",className:0==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(0)}},"\u23f9"),i.a.createElement("button",{type:"button",className:1==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(1)}},"\u25b6\ufe0f"),i.a.createElement("button",{type:"button",className:2==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(2)}},"\u23e9"))}}]),n}(i.a.Component)),Ri=function(e){return i.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\ud83d\udc41\ufe0f",i.a.createElement("button",{type:"button",className:"geo"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("geo")}},"\ud83c\udf0e"),i.a.createElement("button",{type:"button",className:"network"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("network")}},"\ud83c\udf10"))},Li=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onEvent=function(e){a.setState({eventCount:a.state.eventCount+1}),window.setTimeout((function(){a.setState({eventCount:a.state.eventCount-1})}),3e3)},a.props.event.subscribe(a.onEvent),a.state={eventCount:0},a}return Object(o.a)(n,[{key:"render",value:function(){return i.a.createElement("span",null,this.state.eventCount<1?this.props.children:i.a.createElement("span",{className:this.props.eventClass},this.props.eventIcon))}}]),n}(i.a.Component),zi=i.a.createContext(void 0),Wi=i.a.createContext(qe),Ui=va,Ji=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).previousTimeMS=0,a.logicTickAccumulatorMS=0,a.millisecondsSinceLastSave=0,a.saveAccumulatorMS=0,a.tick=function(e){var t=e-a.previousTimeMS;if(a.previousTimeMS=e,t>0){var n=t*a.state.timeScale;(function(e,t){var n=[];return e.ufos.allIDs.forEach((function(a){e.ufos.byID[a];_t.Get("ufo",a).elapsed+=t,_t.Get("ufo",a).elapsed>4e3&&n.push(In({ufoKey:a}))})),n})(Ui.getState().world,t).map((function(e){return Ui.dispatch(e)})),n>0&&(a.logicTickAccumulatorMS+=t,function(e,t){for(var n=e.pickups.allIDs,a=e.cities.byID[0],i=[],r=n.length-1;r>=0;r--){var s=n[r],c=a.pickupMagnetPoint,o=Object(W.a)({},qe.Get("pickup",s).current||pe);if(c)fe(o,c,E*t/1e3,k,w,g)&&i.push(qn({cityKey:a.key,pickupKey:s}));else be(o,g);qe.Get("pickup",s).publish(o)}return i}(Ui.getState().world,t).map((function(e){return Ui.dispatch(e)})),function(e,t){var n=[];return e.beans.allIDs.forEach((function(a){var i=e.beans.byID[a];if("alive"==i.lifecycle){var r=_t.Get("bean",i.key);r.elapsed+=t;var s=en[i.action].act(i,e,r.elapsed,t);if(Array.isArray(s.action)?n.push.apply(n,Object(h.a)(s.action)):s.action&&n.push(s.action),s.newActivity){var c=en[i.action].exit(i);c&&n.push(c),n.push(Wn({beanKey:a,newState:s.newActivity}));var o=en[s.newActivity.act].enter(i);o&&n.push(o)}}})),n}(Ui.getState().world,t).map((function(e){return Ui.dispatch(e)})),a.logicTickAccumulatorMS>2e3&&(Ui.dispatch(Kn()),a.logicTickAccumulatorMS=0)),a.millisecondsSinceLastSave+=t,b.Dirty.current&&a.millisecondsSinceLastSave>15e3&&(b.SaveGame(Ui.getState().world),a.millisecondsSinceLastSave=0)}window.requestAnimationFrame(a.tick)},a.cheatMode=!1,a.keyupHandler=function(e){" "===e.key?a.state.timeScale>0?a.setState({timeScale:0}):a.setState({timeScale:1}):"Escape"===e.key?("greeting"===a.state.activeModal&&Ui.dispatch(Cn()),a.setState({activeModal:null})):a.cheatMode&&"A"===e.key?Ui.dispatch(Qn()):a.cheatMode&&"Q"===e.key||a.cheatMode&&e.key,a.cheatMode=e.shiftKey&&"C"===e.key},a.onDeath=function(e){zt.play("death"),a.startSpotlight(e)},a.timescaleBeforeSpotlight=1,a.state={activeMain:"geo",activeModal:"mainmenu",activeRightPanel:"overview",timeScale:0,spotlightEvent:void 0},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this.keyupHandler,!1),window.requestAnimationFrame((function(t){e.previousTimeMS=t,window.requestAnimationFrame(e.tick)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyupHandler)}},{key:"startSpotlight",value:function(e){var t=this;this.timescaleBeforeSpotlight=this.state.timeScale,this.setState({spotlightEvent:e,timeScale:0},(function(){setTimeout((function(){return t.endSpotlight()}),5e3)}))}},{key:"endSpotlight",value:function(){this.setState({timeScale:this.timescaleBeforeSpotlight,spotlightEvent:void 0})}},{key:"getPanel",value:function(){var e=this;switch(this.state.activeRightPanel){case"overview":return i.a.createElement(Ni,{openBrainwash:function(){return e.setState({activeModal:"brainwash"})}});case"goals":return i.a.createElement(Ki,null);case"events":return i.a.createElement(Si,null);case"market":return i.a.createElement(Ii,null)}}},{key:"render",value:function(){var e=this;return i.a.createElement(m.a,{store:Ui},i.a.createElement(zi.Provider,{value:zt},i.a.createElement(Wi.Provider,{value:qe},i.a.createElement("div",{className:"canvas"},"network"===this.state.activeMain?i.a.createElement("div",{className:"canvas"},i.a.createElement(Fi,{city:Ui.getState().world.cities.byID[0],onClickBuilding:function(e){return Ui.dispatch(ba({cityKey:Ui.getState().world.cities.allIDs[0],buildingKey:e.key,hex:e.address}))},onClick:function(e){return Ui.dispatch(pa({cityKey:e.cityKey,beanKey:e.key}))}})):i.a.createElement(d.b,{defaultScale:1,wheel:{step:48}},i.a.createElement(d.a,null,i.a.createElement("div",{className:"world"},Ui.getState().world.cities.allIDs.map((function(e){return i.a.createElement(ci,{cityKey:e,key:e,onClick:function(){}})}))))),i.a.createElement("div",{className:"overlay"},i.a.createElement(Hi,{show:"mainmenu"==this.state.activeModal},i.a.createElement(Ra,{startGame:function(){return e.setState({activeModal:"greeting"})},loadGame:function(t){var n=b.GetGame(t);null!=n.game&&(Ui.dispatch(_n({newState:n.game})),e.setState({activeModal:null}))}})),i.a.createElement(Hi,{show:"loadgame"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Ui.dispatch(Cn())}},i.a.createElement(qa,null)),i.a.createElement(Hi,{show:"escapemenu"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Ui.dispatch(Cn())}},i.a.createElement(Aa,null)),i.a.createElement(Hi,{show:"greeting"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Ui.dispatch(Cn())}},i.a.createElement(Fa,null)),i.a.createElement(Hi,{show:"gov"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ta,null)),i.a.createElement(Hi,{show:"polisci"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ua,null)),i.a.createElement(Hi,{show:"campaign"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ca,null)),i.a.createElement(Hi,{show:"economy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"economy"==this.state.activeModal?i.a.createElement(Ba,null):""),i.a.createElement(Hi,{show:"traits"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ja,null)),i.a.createElement(Hi,{show:"brainwash"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ia,null)),i.a.createElement("div",{className:"left"},i.a.createElement("div",{className:"top"},i.a.createElement("span",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),i.a.createElement(Gi,null),i.a.createElement(qi,{timeScale:this.state.timeScale,setTimeScale:function(t){e.setState({timeScale:t})}}),i.a.createElement(Ri,{setActiveMain:function(t){return e.setState({activeMain:t})},activeMain:this.state.activeMain}),i.a.createElement(_i,null)),i.a.createElement("div",{className:"bottom"},i.a.createElement(Mi,{changeEvent:ft.alienEnergy,icon:"\u26a1\ufe0f"},i.a.createElement(Bi,{icon:"\u26a1\ufe0f",label:"Energy"},i.a.createElement(Ai,null))),i.a.createElement(Mi,{changeEvent:ft.alienBots,icon:"\ud83e\udd16"},i.a.createElement(Bi,{icon:"\ud83e\udd16",label:"Bots"},i.a.createElement(Pi,null))),i.a.createElement(Mi,{changeEvent:ft.alienHedons,icon:"\ud83d\udc4d"},i.a.createElement(Bi,{icon:"\ud83d\udc4d",label:"Hedons"},i.a.createElement(Ti,null))),i.a.createElement("span",null,i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"economy"})}},"\ud83d\udcca State of the Utopia"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"gov"})}},"\ud83d\uddf3\ufe0f Gov"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"polisci"})}},"\ud83e\uddea Research"),i.a.createElement(Oi,{changeEvent:ft.newTraitSeen,icon:"\ud83e\udde0"},i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"traits"})}},"\ud83e\udde0 Traits"))))),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"full-width-tabs"},i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"overview"})}},"\ud83d\udcc8 Info"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"market"})}},"\ud83d\udecd\ufe0f Market"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"events"})}},i.a.createElement(Li,{event:ft.events,eventIcon:"\ud83d\udea8",eventClass:"police-siren"},"\ud83d\udce3")," Events"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"goals"})}},"\ud83c\udfc6 Goals")),i.a.createElement("div",{className:"right-panel"},this.getPanel())))))))}}]),n}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(Ji,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.7d18b2e6.chunk.js.map