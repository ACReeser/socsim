(this.webpackJsonpsocsim=this.webpackJsonpsocsim||[]).push([[0],{19:function(e,t,n){e.exports=n(38)},24:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),l=n.n(i),c=(n(24),n(1)),o=n(2),s=n(5),u=n(4),d=n(8),m=n(16),y=(n(29),n(30),function(){function e(t){Object(c.a)(this,e),this.onPublish=t,this.callbacks=[],this.current=void 0}return Object(o.a)(e,[{key:"publish",value:function(e){this.onPublish&&this.onPublish(e),this.current=e,this.callbacks.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e){this.callbacks.push(e)}},{key:"unsubscribe",value:function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)}}]),e}()),p=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return n}(y);var f,h=new(function(){function e(){Object(c.a)(this,e),this.Dirty=new y,this.Saving=new y}return Object(o.a)(e,[{key:"HasContinueGame",value:function(){var e=localStorage.getItem("last-game-id");if(null!=e){var t=parseInt(e);if(!isNaN(t))return null!=localStorage.getItem("".concat("game-").concat(t))?t:void 0}}},{key:"GetGameSlots",value:function(){for(var e=[],t=0;t<3;t++){var n=localStorage.getItem("".concat("game-brief-").concat(t+1));e.push({id:t+1,brief:n?JSON.parse(n):void 0})}return e}},{key:"GetGame",value:function(e){var t=localStorage.getItem("".concat("game-").concat(e));if(!t)return{errors:["Cannot find game"]};try{return{game:JSON.parse(t)}}catch(n){return{errors:[n]}}}},{key:"SaveGame",value:function(e){var t=JSON.stringify(e),n={Name:e.cities.byID[0].name,Population:e.beans.allIDs.map((function(t){return e.beans.byID[t]})).filter((function(e){return"dead"!=e.lifecycle})).length,Age:{day:e.date.day,hour:e.date.hour,season:e.date.season,year:e.date.year}};localStorage.setItem("".concat("game-").concat(e.saveSlot),t),localStorage.setItem("".concat("game-brief-").concat(e.saveSlot),JSON.stringify(n)),localStorage.setItem("last-game-id",e.saveSlot.toString()),this.Dirty.publish(!1),this.Saving.publish()}}]),e}()),b=n(7),v=new(function(){function e(){Object(c.a)(this,e),this.cache={ufo:{},bean:{},pickup:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]=new y),this.cache[e][t]}}]),e}()),g={x:.94,y:.94},E=60,k=9,w=10,x={x:.94,y:.94},D=10,K=4,N=10,S={state:"\ud83d\udd4a\ufe0f",ego:"\ud83e\udd85",prog:"\u2696\ufe0f",trad:"\ud83d\udc51",circle:"\ud83e\udd0e",square:"\ud83d\udc9b",triangle:"\ud83e\udde1",rocket:"\ud83d\ude80",music:"\ud83c\udfb5",dragon:"\ud83d\udc32",noFaith:"\u26ab\ufe0f",starving:"\ud83c\udf74",hungry:"\ud83c\udf7d\ufe0f",sated:"\ud83e\udd5c",stuffed:"\ud83e\udd69",homeless:"\ud83c\udf28\ufe0f",sleepy:"\ud83c\udf19",awake:"\u2600\ufe0f",rested:"\ud83c\udf1e",sick:"\ud83e\udd22",sickly:"\ud83d\ude37",bruised:"\ud83e\ude79",fresh:"\ud83d\udcaa",psychotic:"\ud83e\udd2a",disturbed:"\ud83e\udd24",stressed:"",sane:"\ud83e\udde0"};!function(e){e[e.Deficient=-.25]="Deficient",e[e.Sufficient=0]="Sufficient",e[e.Abundant=.15]="Abundant"}(f||(f={}));f.Deficient,f.Sufficient,f.Sufficient,f.Abundant,f.Deficient,f.Sufficient,f.Sufficient,f.Abundant,f.Deficient,f.Sufficient,f.Sufficient,f.Abundant;var j={warning:.5,sufficient:1,abundant:3},C={warning:.5,sufficient:1,abundant:3};function I(e){switch(e){case"builder":return"shelter";case"doc":return"medicine";case"entertainer":return"fun";default:case"farmer":return"food"}}var _={food:"\ud83e\udd6a",shelter:"\ud83c\udfe0",medicine:"\ud83d\udc8a",fun:"\ud83d\udc4f"},M={love:"\ud83d\udc9b",happiness:"\ud83d\udc4d",unhappiness:"\ud83d\udca2",hate:"\ud83d\udc94"},O={love:5,happiness:1,unhappiness:-1,hate:-5},T={love:1,happiness:.2,unhappiness:0,hate:-1};var B=n(3),P={common:3,uncommon:2,rare:1},A={prog:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"Strives to help others",rarity:"common"},trad:{noun:"Elitism",adj:"Elitist",icon:"\ud83d\udc51",description:"Strives for individual power",rarity:"common"},state:{noun:"Collectivism",adj:"Collectivist",icon:"\ud83d\udd4a\ufe0f",description:"Trusts in the social group",rarity:"common"},ego:{noun:"Independence",adj:"Independent",icon:"\ud83e\udd85",description:"Trusts only in oneself",rarity:"common"}},G={rocket:{noun:"Futurism",adj:"Futuristic",icon:"\ud83d\ude80",description:"Loves stories of the far future",rarity:"common"},dragon:{noun:"Mythology",adj:"Mythical",icon:"\ud83d\udc32",description:"Loves stories of the legendary past",rarity:"common"},music:{noun:"Drama",adj:"Dramatic",icon:"\ud83c\udfb5",description:"Loves stories of emotional bonding",rarity:"common"},noFaith:{noun:"Nihilism",adj:"Nihilist",icon:"\u26ab\ufe0f",description:"Hates fairy tales",rarity:"common"}},L={Diligence:{noun:"Diligence",adj:"Diligence",icon:"\ud83d\udcaa",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udc4d while working"},Natalism:{noun:"Natalism",adj:"Natalist",icon:"\ud83d\udc76",rarity:"common",description:"Extra \ud83c\udfb2 for \ud83d\udc76;Extra \ud83d\udc4d after birth"},Antinatalism:{noun:"Antinatalism",adj:"Antinatalist",icon:"\ud83d\udeb7",rarity:"uncommon",description:"Less \ud83c\udfb2 for \ud83d\udc76;\ud83d\udca2 after birth"},Charity:{noun:"Charity",adj:"Charitable",icon:"\ud83d\ude07",rarity:"uncommon",description:"\ud83c\udfb2 to gift \ud83d\udcb0 to the penniless; and spread \ud83d\udc4d"},Progressivism:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when paying taxes"},Libertarianism:{noun:"Libertarianism",adj:"Libertarian",icon:"\ud83d\udd2b",rarity:"rare",description:"\ud83c\udfb2 to \ud83d\udca2 when paying taxes"},Wanderlust:{noun:"Wanderlust",adj:"Wanderer",icon:"\ud83d\udd2d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when travelling"},Germophobia:{noun:"Germophobia",adj:"Germophobic",icon:"\ud83e\udd27",rarity:"rare",description:"\ud83d\udca2 when sick or working in hospital"},Parochialism:{noun:"Parochialism",adj:"Parochial",icon:"\ud83d\udc2e",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udf3e; \ud83d\udca2 from dense houses"},Cosmopolitanism:{noun:"Cosmopolitanism",adj:"Cosmopolitan",icon:"\ud83c\udf78",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udfbb; \ud83d\udca2 from rural houses"},Capitalism:{noun:"Capitalism",adj:"Capitalist",icon:"\ud83c\udfa9",rarity:"common",description:"\ud83d\udca2 working in co-ops and communes; Extra \ud83d\udc4d when owner"},Socialism:{noun:"Socialism",adj:"Socialist",icon:"\ud83e\udd1d",rarity:"common",description:"Extra \ud83d\udc4d working in co-ops"},Communism:{noun:"Communism",adj:"Communist",icon:"\u2692\ufe0f",rarity:"common",description:"\ud83d\udca2 working in companies"},Fraud:{noun:"Fraud",adj:"Fraudulent",icon:"\ud83e\udd25",rarity:"uncommon",description:"\ud83c\udfb2 to avoid taxes; Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime"},Naturalism:{noun:"Naturalism",adj:"Naturalist",icon:"\ud83d\udef6",rarity:"uncommon",description:"Extra \ud83d\udc4d from \ud83d\ude0e; \ud83d\ude0e 3x longer"},Hedonism:{noun:"Hedonism",adj:"Hedonistic",icon:"\ud83d\udc8b",rarity:"uncommon",description:"\ud83c\udfb2 to emote extra \ud83d\udc4d;\ud83c\udfb2 to \ud83d\udca2 when working;"},Gluttony:{noun:"Gluttony",adj:"Glutton",icon:"\ud83c\udf83",rarity:"common",description:"Extra \ud83d\udc4d when stuffed; Extra \ud83d\udca2 when hungry;"},Paranoia:{noun:"Paranoia",adj:"Paranoid",icon:"\ud83d\udc7d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udca2 at any time"},Depression:{noun:"Depression",adj:"Depressive",icon:"\ud83d\ude13",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udca2 when unhappy"},Optimism:{noun:"Optimism",adj:"Optimistic",icon:"\ud83d\ude3a",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when happy"},Authority:{noun:"Authority",adj:"Authoritarian",icon:"\ud83d\udc62",rarity:"common",description:"Less \ud83c\udfb2 for all \ud83d\ude08 Crime"},Anarchism:{noun:"Anarchism",adj:"Anarchist",icon:"\ud83d\udd95",rarity:"uncommon",description:"Extra \ud83c\udfb2 for all \ud83d\ude08 Crime"},Greed:{noun:"Greed",adj:"Greedy",icon:"\ud83e\udd11",rarity:"common",description:"Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime; Extra \ud83d\udc4d when rich"},Bloodthirst:{noun:"Bloodthirst",adj:"Bloodthirsty",icon:"\ud83e\ude78",rarity:"rare",description:"High \ud83c\udfb2 to \u2620\ufe0f Kill during \ud83d\ude08 Crime"},Extroversion:{noun:"Extroversion",adj:"Extroverted",icon:"\ud83e\udd29",rarity:"common",description:"Extra \ud83c\udfb2 to start a \ud83d\udde3\ufe0f"},Introversion:{noun:"Introversion",adj:"Introverted",icon:"\ud83e\udd13",rarity:"uncommon",description:"Less \ud83c\udfb2 to be in a \ud83d\udde3\ufe0f"},Charisma:{noun:"Charisma",adj:"Charismatic",icon:"\ud83d\ude0f",rarity:"uncommon",description:"More \ud83c\udfb2 to persuade in a \ud83d\udde3\ufe0f"},Gossip:{noun:"Gossip",adj:"Gossipy",icon:"\ud83d\udcde",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f; \ud83c\udfb2 to \ud83d\udc4d after \ud83d\udde3\ufe0f"},Antagonism:{noun:"Antagonism",adj:"Antagonistic",icon:"\ud83e\udd2c",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f"},Enthusiasm:{noun:"Enthusiasm",adj:"Enthusiastic",icon:"\ud83e\udd73",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udc4d in a \ud83d\udde3\ufe0f"},Sadism:{noun:"Sadism",adj:"Sadistic",icon:"\ud83d\ude08",rarity:"rare",description:"\ud83c\udfb2 to \u2620\ufe0f Kill in a \ud83d\udde3\ufe0f;\ud83d\udc4d from \u2620\ufe0f Kill"},Vandalism:{noun:"Vandalism",adj:"Vandal",icon:"\ud83d\udca9",rarity:"rare",description:"\ud83c\udfb2 to destroy goods;\ud83d\udc4d from \ud83d\ude08 Theft Crime"},Neuroticism:{noun:"Neuroticism",adj:"Neurotic",icon:"\ud83d\ude31",rarity:"rare",description:"+100% \ud83e\udde0 damage"},Dogmatism:{noun:"Dogmatism",adj:"Dogmatic",icon:"\ud83d\udc36",rarity:"uncommon",description:"Cannot change beliefs"}};var q=Object.keys(L).map((function(e){return e})),H=Object.keys(L).reduce((function(e,t){for(var n=t,a=P[L[n].rarity],r=0;r<a;r++)e.push(n);return e}),[]);function F(e,t,n){return Math.max(Math.min(e,n),t)}function R(e){var t,n,a,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.125;do{t=(n=2*De(e)-1)*n+(a=2*De(e)-1)*a}while(t>=1||0===t);return r+i*n*Math.sqrt(-2*Math.log(t)/t)}var z=function e(t,n){Object(c.a)(this,e),this.q=t,this.r=n},W=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}];function U(e){return W[e]}function J(e,t){var n=U(t);return{q:e.q+n.q,r:e.r+n.r}}function Z(e,t){for(var n,a,r=[],i=function(e,t){return{q:e.q+t.q,r:e.r+t.r}}(e,(n=U(4),a=t,{q:n.q*a,r:n.r*a})),l=0;l<6;l++)for(var c=0;c<t;c++)r.push(i),i=J(i,l);return r}function V(e,t){for(var n=[e],a=0;a<t;a++)n=n.concat(Z(e,a));return n}var $={point:{x:0,y:0},velocity:{x:0,y:0}};function X(e,t,n,a,r,i){var l={x:t.x-e.point.x,y:t.y-e.point.y},c=Math.sqrt(l.x*l.x+l.y*l.y);return c<=r||(l.x/=c,l.y/=c,e.velocity.x+=l.x*n,e.velocity.y+=l.y*n,e.velocity.x=F(e.velocity.x,-a,a),e.velocity.y=F(e.velocity.y,-a,a),Y(e,i),!1)}function Y(e,t){e.velocity.x*=t.x,e.velocity.y*=t.y,e.point.x+=e.velocity.x,e.point.y+=e.velocity.y}function Q(e,t,n){return e+(t-e)*n}function ee(e,t,n){return{x:Q(e.x,t.x,n),y:Q(e.y,t.y,n),z:Q(e.z,t.z,n)}}function te(e){var t=Math.round(e.x),n=Math.round(e.y),a=Math.round(e.z),r=Math.abs(t-e.x),i=Math.abs(n-e.y),l=Math.abs(a-e.z);return r>i&&r>l?t=-n-a:i>l?n=-t-a:a=-t-n,{x:t,y:n,z:a}}function ne(e){var t=e.x,n=e.z;return new z(t,n)}function ae(e){return{x:e.q,z:e.r,y:-e.q-e.r}}function re(e,t){for(var n=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z))/2}(e,t),a=[],r=0;r<=n;r++)a.push(ne(te(ee(e,t,1/n*r))));return a}var ie=function e(t,n,a,r,i,l,o,s,u){Object(c.a)(this,e),this.f0=t,this.f1=n,this.f2=a,this.f3=r,this.b0=i,this.b1=l,this.b2=o,this.b3=s,this.start_angle=u},le=(new ie(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0),new ie(Math.sqrt(3),Math.sqrt(3)/2,0,1.5,Math.sqrt(3)/3,-1/3,0,2/3,.5));function ce(e,t,n){var a=le,r=(a.f0*n.q+a.f1*n.r)*e.x,i=(a.f2*n.q+a.f3*n.r)*e.y;return{x:r+t.x,y:i+t.y}}function oe(e){return{x:e.r*Math.cos(e.az),y:e.r*Math.sin(e.az)}}function se(e){return{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}}var ue={farm:"\ud83d\udc04",house:"\ud83c\udfe1",hospital:"\ud83c\udfe5",church:"\u26ea",theater:"\ud83c\udfaa",courthouse:"\ud83c\udfeb",park:"\u26f2\ufe0f",nature:"\ud83c\udfde\ufe0f"},de={farm:"\ud83d\ude9c",house:"\ud83c\udfd8\ufe0f",hospital:"\ud83c\udfd9\ufe0f",church:"\u26ea",theater:"\ud83c\udfdf\ufe0f",courthouse:"\ud83c\udfeb",park:"\ud83c\udfa1",nature:"\ud83c\udfde\ufe0f"},me={farm:"\ud83c\udf3e",house:"\ud83d\udcea",hospital:"\ud83d\udecf\ufe0f",church:"\u26ea",theater:"\ud83e\ude91",courthouse:"\ud83c\udfeb",park:"\ud83d\udc90",nature:"\u2668\ufe0f"},ye={farm:"food",house:"shelter",hospital:"medicine",church:"fun",theater:"fun",courthouse:"fun",park:"fun",nature:"fun"},pe={food:"farm",shelter:"house",medicine:"hospital",fun:"theater"},fe={farmer:"farm",builder:"house",doc:"hospital",entertainer:"theater",cleric:"church",jobless:"house",polit:"house"},he={farm:"farmer",house:"builder",hospital:"doc",theater:"entertainer",church:"cleric",park:"entertainer",nature:"entertainer",courthouse:"polit"},be={x:150,y:150};var ve=n(17);function ge(e){return{byID:e.reduce((function(e,t){return e[t.key]=t,e}),{}),allIDs:e.map((function(e){return e.key})),nextID:e.reduce((function(e,t){return Math.max(t.key+1,e)}),0)}}function Ee(e,t){var n=e.nextID++;t.key=n,e.allIDs.push(n),e.byID[n]=t}var ke={};function we(e){return null==ke[e]&&(ke[e]=new ve.b(e,ve.a.sfc32)),ke[e]}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=we(e).next();return t=Math.ceil(t),n=Math.floor(n),Math.floor(a*(n-t+1))+t}function De(e){return we(e).next()}function Ke(e,t){return 1==t.length?t[0]:t[function(e,t){return xe(e,0,t-1)}(e,t.length)]}function Ne(e){return Ke(e,["prog","trad"])}function Se(e){return Ke(e,["state","ego"])}function je(e){return Ke(e,["rocket","music","dragon","noFaith"])}Math.PI;var Ce=["New ","Old ","Fort ","St. ","Mount ","Grand ","","","","","","","","","",""],Ie=["Spring","Timber","Over","West","East","North","South","Rock","Sand","Clay","Iron","Ore","Coal","Liver","Hawk","Red","Yellow","Gold","Blue","Black","White","Sunny","Reed","Ox","Mill","Fern","Down","Bel","Bald","Ash"],_e=["water "," Springs","ville","dale","lane","peak","coast","beach","port","market","ton","brook"," Creek","land","burgh","bridge","ford","bury","chester","son","vale"," Valley","hill","more","wood"," Oaks"," Cove","mouth","way","crest"];function Me(){return Object(B.a)(Object(B.a)({},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=260*(e-.5);return{numberOfRings:e,hexes:V({q:0,r:0},e),hex_size:Object(B.a)({},be),petriRadius:t,petriOrigin:{x:t,y:t}}}()),{},{key:0,name:"string",deadBeanKeys:[],beanKeys:[],ufoKeys:[],pickupKeys:[],buildingKeys:[],pickupMagnetPoint:void 0,costOfLiving:0,buildingMap:{},districtKeys:[]})}function Oe(e){var t=ge([]);return{ds:ge(e.hexes.map((function(n,a){var r=0===n.q&&0===n.r,i=function(e,t,n){return{kind:e,key:0,q:n.q,r:n.r,hexString:n.q+","+n.r,point:ce(t.hex_size,t.petriOrigin,n),lots:[]}}(r?"urban":"fallow",e,n);return i.key=a+1,e.districtKeys.push(i.key),r&&Pe(i,t,"urban"),i}))),lots:t}}var Te=[{q:1,r:-1},{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],Be=[{q:1,r:-1},{q:0,r:1},{q:-1,r:0}];function Pe(e,t,n){("rural"===n?Be:Te).forEach((function(a,r){if(null==e.lots[r]){var i={key:0,kind:n,districtKey:e.key,point:ce({x:50,y:50},e.point,a)};Ee(t,i),e.lots.push(i.key)}}))}function Ae(e,t,n,a,r){var i,l={key:e.beans.nextID++,cityKey:t.key,name:"",ethnicity:(i=e.seed,Ke(i,["circle","square","triangle"])),community:Se(e.seed),ideals:Ne(e.seed),faith:je(e.seed),stamina:"awake",health:"fresh",food:"sated",discrete_food:3,discrete_health:2,discrete_sanity:10,discrete_stamina:7,discrete_fun:0,graceTicks:0,dob:{year:e.date.year,season:e.date.season,day:e.date.day,hour:e.date.hour},sanity:"sane",beliefs:[],lifecycle:"alive",hedonHistory:[{},{},{},{},{}],priorities:[],job:"jobless",happiness:{flatAverage:0,all:{},maxSource:"",minSource:"",weightedAverage:0},lastHappiness:0,hedonFiveDayRecord:{max:0,min:0},fairGoodPrice:0,bornInPetri:null!=n,cash:3,ticksSinceLastSale:0,ticksSinceLastRelax:0,lastChatMS:0,action:"idle",actionData:{act:"idle"},activity_duration:{buy:0,chat:0,craze:0,crime:0,idle:0,relax:0,sleep:0,soapbox:0,travel:0,work:0}};l.name=Ke(e.seed,["Joe","Frank","Jill","Jose","Johnny","Isabelle","Carmen","Ace","Carl","Zander","Jean","Anne","Leslie","Ben","Ron","Ellen","Dallas","Kane","Ash","Jim","James","Leonard","Nyota","Christine","Scotty","Tasha","Geordi","Beverly","Deanna","Wesley","Majel","Malcolm","River","Luke","Han","Owen","Rey","Mace","Cody","Dana","Walter","Rick","Holden","Roy","Pris","Eldon","Rachael","Rose","Donna","Jack","Amy","Rory","Martha","Clara","Arnold","Dave","Holly","Kara","Gaius","William","Lee","Laura","Saul","Max","Edison","Theora","Bryce","Murray","Ned","Daniel","Samantha","Logan","Francis","Jessica","Thomas","Benny","James","John Henry","Sarah","Piper","Nick","Shaun","Preston"])+" ",l.name+=Ke(e.seed,["Ripley","Bishop","Hicks","Vasquez","Hudson","Rico","Flores","Ibanez","Levy","Jenkins","Barlow","Zim","Rasczak","Kirk","McCoy","Sulu","Uhura","Chekov","Chapel","Rand","Riker","Crusher","Barret","O'Brien","Reynolds","Tam","Scully","Mulder","Skinner","Connor","Rex","Thrace","Baltar","Smith","Adama","Roslin","Tigh","Song","Oswald","Deckard","Bryant","Tyrell","Sebastian","Voight","Kampff","Tyler","Harkness","Jones","Noble","Pond","Williams","Rimmer","Lister","Head","Carter","Lynch","McKenzie","Grossberg","O'Neil","Jackson","Carter","Whitmore","House","Mitchell","Eden","Lyons","Valentine","Garvey"]);for(var c=Math.ceil(3*Math.random());l.beliefs.length<c;){var o=Ke(e.seed,H);l.beliefs.includes(o)||l.beliefs.push(o)}return n&&(l.ethnicity=n.ethnicity,l.name=l.name.split(" ")[0]+" "+n.name.split(" ")[1],l.cash=n.cash/2,n.cash/=2),l}function Ge(e,t){return Array.isArray(e)?e.some((function(e){return Le(e,t)})):Le(e,t)}function Le(e,t){return t[e]}function qe(e){return L[e].icon+" "+L[e].noun}var He={food_aid:{key:"food_aid",group:"Welfare",name:"Food Aid",axis:"wel_food",icon:"\ud83d\udc68\u200d\ud83c\udf3e",description:"The government buys Hungry Subjects food.",prereqs:[["Gluttony","Parochialism"],["Charity","Socialism"]]},medical_aid:{key:"medical_aid",group:"Welfare",name:"Med Aid",axis:"wel_health",icon:"\ud83d\udc69\u200d\u2695\ufe0f",description:"The government buys Sick Subjects medicine.",prereqs:["Charity","Cosmopolitanism"]},poll_tax:{key:"poll_tax",group:"Taxation",name:"Head Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udc51",description:"Subjects must pay a flat tax."},sales_tax:{key:"sales_tax",group:"Taxation",name:"Sales Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udcb8",description:"Subjects must pay a percentage tax for every transaction."},death_tax:{key:"death_tax",group:"Taxation",name:"Death Tax",axis:"tax_second",prereqs:[],icon:"\u2620\ufe0f",description:"Dead subjects pay a portion of their cash to the government."}};function Fe(e,t){var n;return(null===(n=e.lawTree[He[t].axis])||void 0===n?void 0:n.key)===t}function Re(e,t,n){if(void 0!=(a=t).food&&void 0!=a.sick)switch(n){case"food":return("starving"===t.food||"hungry"===t.food)&&Fe(e,"food_aid");case"medicine":return("sick"===t.health||"sickly"===t.health)&&Fe(e,"medical_aid")}var a;return!1}function ze(e,t){return e.cash>=t}var We=["food","shelter","medicine","fun"];function Ue(e,t,n,a,r,i,l){Ze(e,t,n,a);var c=t.price*a,o=c*l,s=c+o;return r.cash-=s,i.cash+=c,i.ticksSinceLastSale=0,{bought:a,price:c,tax:o}}function Je(e,t,n,a,r,i){Ze(e,n,a,r);var l=n.price*r,c=l;return t.cash-=c,i.cash+=l,i.ticksSinceLastSale=0,{bought:r,price:l,tax:0}}function Ze(e,t,n,a){t.quantity-=a,t.quantity<=0&&e.listings[n].splice(0,1)}function Ve(e,t,n,a,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;e.monthlyDemand[a]+=l;var c=Ye(e.market,a,i);if(null!=c){var o=Math.min(c.quantity,l),s=Fe(t,"sales_tax")?.05:0;if(c.price*(1+s)<=n.cash*o){var u=Ue(e.market,c,a,o,n,r(c),s);return u.tax&&(t.cash+=u.tax),u}if(Re(t,n,a)&&ze(t,c.price))return Je(e.market,t,c,a,o,r(c));e.unfulfilledMonthlyDemand[a]+=o}else e.unfulfilledMonthlyDemand[a]+=l}function $e(e,t){var n=e.monthlySupply[t]||1,a=e.monthlyDemand[t];return.25+.75*Math.min(a/n,1)}function Xe(e){return $e(e,"food")+$e(e,"shelter")+$e(e,"medicine")}function Ye(e,t,n){var a=e.listings[t].filter((function(e){return e.quantity>=n}));if(a.length>0){for(var r=1,i=a[0].price,l=1;l<a.length;l++){if(a[l].price>i)break;r++}var c=Math.floor(Math.random()*r);if(c>=a.length)throw"invalid index";return a[c]}return null}function Qe(e,t){return{key:0,point:Object(B.a)({},(v.Get("bean",e.key).current||$).point),type:t,velocity:{x:0,y:0}}}function et(e,t){return e.discrete_health>=C.abundant?e.health="fresh":e.discrete_health>=C.sufficient?e.health="bruised":e.discrete_health>=C.warning?e.health="sickly":e.health="sick",e.health}function tt(e,t){return e.discrete_stamina<0?e.stamina="homeless":e.stamina="rested",e.stamina}function nt(e,t){return e.discrete_food>=j.abundant?e.food="stuffed":e.discrete_food>=j.sufficient?e.food="sated":e.discrete_food>=j.warning?e.food="hungry":e.food="starving",e.food}function at(e){if(e.lastChatMS+4e3>Date.now())return!1;if("chat"===e.action)return!1;var t=Math.random(),n="state"===e.community?.2:.1;return it(e,"Extroversion")&&(n+=.25),it(e,"Introversion")&&(n+=-.15),t<n}function rt(e,t,n){e.discrete_sanity=F(e.discrete_sanity+T[t],0,10),e.hedonHistory[0][n]=(e.hedonHistory[0][n]||0)+O[t];var a=[Qe(e,t)];return it(e,"Hedonism")&&("happiness"===t||"love"===t)&&Math.random()<.1&&a.push.apply(a,Object(b.a)(rt(e,"happiness","Hedonism"))),a}function it(e,t){return-1!==e.beliefs.indexOf(t)}function lt(e,t,n){return function(e,t){return"alive"===e.lifecycle&&e.cash>3*t&&!dt(e)}(e,n)&&function(e,t){return De(e)<=t}(t,function(e){var t=.008;it(e,"Natalism")&&(t+=.04);it(e,"Antinatalism")&&(t+=-.002);return t}(e))?(it(e,"Natalism")?rt(e,"love","Natalist Parent"):it(e,"Antinatalism")?rt(e,"hate","Antinatalism"):rt(e,"happiness","Proud Parent"),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(e.name," has a baby!"),key:0}):void 0}function ct(e,t,n,a,r){if(a&&Math.random()<=r){if(e.graceTicks<=0)return ot(e,t,n);e.graceTicks--}}function ot(e,t,n){e.lifecycle="dead";var a=xe(t,2,3),r=new Array(a).map((function(t){return Qe(e,"hate")}));return{death:{icon:"\u2620\ufe0f",trigger:"death",message:"".concat(e.name," died of ").concat(n,"!"),beanKey:e.key,cityKey:e.cityKey,point:(v.Get("bean",e.key).current||$).point,key:0},emotes:r}}function st(e,t){var n=it(e,"Neuroticism")?2:1;e.discrete_sanity-=n*t}function ut(e){var t;if("chat"===e.action&&("speaker"===(null===(t=e.actionData.chat)||void 0===t?void 0:t.participation)&&e.actionData.chat.preachBelief))return"\ud83d\udcac"+L[e.actionData.chat.preachBelief].icon}function dt(e){return"starving"===e.food||"homeless"===e.stamina||"sick"===e.health}function mt(e,t,n){return void 0===t.sanity||e.discrete_sanity>=t.sanity+n}function yt(e){var t,n;if("dead"===e.lifecycle)return"\ud83d\udc80";if("sleep"===e.actionData.act)return"\ud83d\ude34";if("crime"===e.actionData.act)return"\ud83d\ude08";if("relax"===e.actionData.act)return"\ud83d\ude0e";if("chat"===e.actionData.act){var a;if("speaker"===(null===(a=e.actionData.chat)||void 0===a?void 0:a.participation))switch(null===(t=e.actionData)||void 0===t||null===(n=t.chat)||void 0===n?void 0:n.type){default:return"\ud83d\ude03";case"gift":return"\ud83d\ude07";case"praise":return"\ud83e\udd73";case"bully":return"\ud83d\ude08"}return"\ud83e\udd28"}return"starving"===e.food?"\ud83d\ude2b":"sick"===e.health?"\ud83e\udd22":"homeless"===e.stamina?"\ud83e\udd76":"jobless"===e.job?"\ud83d\ude27":e.lastHappiness<0?"\u2639\ufe0f":e.lastHappiness>=50?"\ud83d\ude42":"\ud83d\ude10"}var pt=new function e(){Object(c.a)(this,e),this.alienEnergy=new p,this.alienBots=new p,this.alienHedons=new p,this.newTraitSeen=new y,this.events=new y,this.autosave=new y},ft={found_utopia:{key:"found_utopia",text:"Found your Utopia",check:function(e){return e.buildings.allIDs.length>0}},build_house_n_farm:{key:"build_house_n_farm",text:"Build a house and farm",check:function(e){return null!=e.buildings.allIDs.find((function(t){return"farm"==e.buildings.byID[t].type}))&&null!=e.buildings.allIDs.find((function(t){return"house"==e.buildings.byID[t].type}))},reward:{energy:3,bots:3}},beam_3:{key:"beam_3",text:"Beam in 3 new beings",check:function(e){return e.beans.allIDs.filter((function(t){return!e.beans.byID[t].bornInPetri})).length>=3}},scan:{key:"scan",text:"Scan a Subject",check:function(e){return Object.keys(e.alien.scanned_bean).length>0}},set_policy:{key:"set_policy",text:"Set a Gov Policy",check:function(e){return!1}},brainwash:{key:"brainwash",text:"Brainwash a Subject",check:function(e){return!1}},"c+_grade":{key:"c+_grade",text:"Receive a C+ Grade",check:function(e){return!1}}},ht={GradeWorld:function(e){return{Happiness:vt(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return e.lastHappiness>-.2})),Prosperity:vt(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"hungry"!==e.food})),Stability:vt(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"sane"===e.sanity})),Dogma:bt(e.alien.speechcrimes[e.date.year]||0,10,10)}},RubricDescription:{Happiness:"Subjects are at least 20% happy",Prosperity:"Subjects are not hungry",Stability:"Subjects are all sane",Dogma:"Up to 10 Speechcrimes"}};function bt(e,t,n){return gt(1-Math.min(1,Math.max(0,e-t)/n))}function vt(e,t){return e.length<1?"F":gt(e.filter(t).length/e.length)}function gt(e){return e<.58?"F":e<.68?"D":e<.78?"C":e<.88?"B":"A"}var Et={A:5,B:4,C:3,D:2,F:1};var kt={sanity_bonus:{tech:"sanity_bonus",name:"Surgical Psychops",techPoints:30,description:"Brainwashing causes -1 \ud83e\udde0 Sanity damage"},fast_resources:{tech:"fast_resources",name:"0 Dimensional Supersiphons",techPoints:30,description:"Faster \u26a1\ufe0f and \ud83e\udd16 accumulation"},trauma_nanobots:{tech:"trauma_nanobots",name:"Trauma Nanobots",techPoints:30,description:"Spend \ud83e\udd16 to stop Subject from dying"},neural_duplicator:{tech:"neural_duplicator",name:"Level 2 Neural Duplication",techPoints:30,description:"Copy \ud83e\udde0 Traits 1 additional time"}};function wt(e,t){t.bots&&(e.bots.amount+=t.bots,pt.alienBots.publish({change:t.bots})),t.energy&&(e.energy.amount+=t.energy,pt.alienEnergy.publish({change:t.energy})),t.hedons&&(e.hedons.amount+=t.hedons,pt.alienHedons.publish({change:t.hedons}))}function xt(e,t){return null!=e[t]&&e[t].researchPoints>=kt[t].techPoints}function Dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(void 0===t.bots||e.bots.amount>=t.bots*n)&&(void 0===t.energy||e.energy.amount>=t.energy*n)&&(void 0===t.hedons||e.hedons.amount>=t.hedons*n)}function Kt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!!Dt(e,t,n)&&(Nt(e,t,n),!0)}function Nt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.bots&&(e.bots.amount-=t.bots*n,pt.alienBots.publish({change:-t.bots*n})),t.energy&&(e.energy.amount-=t.energy*n,pt.alienEnergy.publish({change:-t.energy*n})),t.hedons&&(e.hedons.amount-=t.hedons*n,pt.alienHedons.publish({change:-t.hedons*n}))}var St=n(9),jt=n(12),Ct=n(6),It=["farm","hospital","house","theater"];function _t(e){return[0,1,2,3,4,5].filter((function(t,n){return null==e.jobs[+t]&&(n<3||e.upgraded)})).map((function(e){return+e}))}function Mt(e,t){if(null!=e.employerEnterpriseKey){var n=t.buildings.byID[e.employerEnterpriseKey],a=t.enterprises.byID[e.employerEnterpriseKey];a.ownerBeanKey==e.key&&(a.ownerBeanKey=n.jobs.find((function(t){return t!=e.key}))),Ot(n,e)}}function Ot(e,t){"jobless"!==t.job&&function(e,t){var n=e.jobs.length;return e.jobs=e.jobs.filter((function(e){return e!=t})),n===e.jobs.length+1}(e,t.key)&&(t.employerEnterpriseKey=void 0,t.job="jobless")}var Tt={travel:{enter:function(e){},act:function(e,t,n,a){var r=t.cities.byID[e.cityKey],i=e.actionData.destinationIndex||0;if(null==e.actionData.destinations||0===e.actionData.destinations.length||i>=e.actionData.destinations.length)return e.actionData.intent?{newActivity:e.actionData.intent}:{newActivity:{act:"idle"}};var l=e.actionData.destinations[i];if(isNaN(l.x)||isNaN(l.y))return console.warn("NaN destination, resetting to idle"),{newActivity:{act:"idle"}};var c=Object(B.a)({},v.Get("bean",e.key).current||$),o=X(c,l,D*a/1e3,K,N,x);if(v.Get("bean",e.key).publish(c),o)return{action:Zn({beanKey:e.key})};if(r){var s=function(e,t){var n=v.Get("bean",t.key).current;return n?e.beanKeys.filter((function(e){if(e==t.key)return!1;var a=v.Get("bean",e).current;if(!a)return!1;var r=Math.pow(a.point.x-n.point.x,2)+Math.pow(a.point.y-n.point.y,2);return r<1600&&r>600})):[]}(r,e);if(s.length&&at(e)){var u=s.filter((function(e){return at(t.beans.byID[e])}));if(u.length<1)return{};var d=function(e,t,n){if(e.beliefs.length){if(it(e,"Charity")&&e.cash>=2){var a=n();if(a)return{participation:"speaker",type:"gift",targetBeanKey:a.key}}else{if(it(e,"Enthusiasm")&&Math.random()<.45)return{participation:"speaker",type:"praise",preachBelief:"Enthusiasm"};if(it(e,"Antagonism")&&Math.random()<.45)return{participation:"speaker",type:"bully",preachBelief:"Antagonism"};if(it(e,"Gossip")&&Math.random()<.35)return{participation:"speaker",type:"bully",preachBelief:"Gossip"}}return{participation:"speaker",type:"preach",preachBelief:Ke(t,e.beliefs),persuasionStrength:1+(it(e,"Charisma")?2:0)}}return{participation:"speaker",type:"praise"}}(e,t.seed,(function(){return u.map((function(e){return t.beans.byID[e]})).filter((function(t){return t.cash<=e.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),void 0)}));return{newActivity:{act:"chat",chat:d,intent:e.actionData},action:u.map((function(e){return Un({beanKey:e,newState:{act:"chat",chat:Object(B.a)(Object(B.a)({},d),{},{participation:"listener"}),intent:t.beans.byID[e].actionData}})}))}}if(it(e,"Wanderlust")&&Math.random()<Gt)return{action:Jn({beanKey:e.key,emote:"happiness",source:"Wanderlust"})}}return{}},exit:function(e){}},work:{enter:function(e){},act:function(e,t,n){return n>3e3&&e.actionData.good?{action:Vn({beanKey:e.key}),newActivity:{act:"idle"}}:{}},exit:function(e){}},sleep:{enter:function(e){},act:function(e,t,n){return n>3e3?{newActivity:{act:"idle"}}:{}},exit:function(e){}},chat:{enter:function(e){},act:function(e,t,n){return n>1e3&&e.actionData.intent?{newActivity:{act:"travel",intent:e.actionData.intent}}:{}},exit:function(e,t){if(e.actionData.chat&&"listener"===e.actionData.chat.participation)switch(e.actionData.chat.type){case"bully":return Jn({beanKey:e.key,emote:"unhappiness",source:"Antagonism"});case"praise":return Jn({beanKey:e.key,emote:"happiness",source:"Enthusiasm"});case"preach":if(e.actionData.chat.preachBelief&&e.actionData.chat.persuasionStrength&&function(e,t,n,a){if(it(e,"Dogmatism"))return!1;if(!e.beliefs.includes(n)){var r=10+xe(t,1,6);return r+=e.beliefs.length-2,xe(t,1,20)+a>r}return!1}(e,t,e.actionData.chat.preachBelief,e.actionData.chat.persuasionStrength))return Qn({beanKey:e.key,belief:e.actionData.chat.preachBelief})}}},soapbox:{enter:function(e){},act:function(e){return{}},exit:function(e){}},craze:{enter:function(e){},act:function(e){return{}},exit:function(e){}},idle:{enter:function(e){},act:function(e,t,n){if(n<200)return{};for(var a=e.priorities.slice(0),r=a[0],i=void 0,l=void 0;r&&null==i;){var c=Bt(e,t,r);if(null===c||void 0===c?void 0:c.intent){if(null!=(i=At(e,t.cities.byID[e.cityKey],c.intent,t)))return{newActivity:i,action:l}}else(null===c||void 0===c?void 0:c.sideEffect)&&(l=c.sideEffect);r=a.shift()}return{action:l}},exit:function(e){if(function(e){if(it(e,"Paranoia")&&Math.random()<.05)return!0}(e))return Jn({beanKey:e.key,emote:"unhappiness",source:"Paranoia"})}},buy:{enter:function(e){},act:function(e,t,n){if(e.actionData.buyReceipt){if(n>750)return{newActivity:{act:"shelter"===e.actionData.good?"sleep":"idle"}}}else{if(n>1100)return{newActivity:{act:"idle"}};if((e.actionData.buyAttempts||0)>=3)return{newActivity:{act:"idle"}};if(n>100&&e.actionData.good)return{action:Xn({beanKey:e.key,good:e.actionData.good})}}return{}},exit:function(e){}},crime:{enter:function(e){},act:function(e,t,n){return n>1500?{newActivity:{act:"idle"},action:Yn({beanKey:e.key,good:e.actionData.crimeGood||"food"})}:{}},exit:function(e){}},relax:{enter:function(e){},act:function(e,t,n){var a=3e3;return it(e,"Naturalism")&&(a*=3),n>a?{newActivity:{act:"idle"}}:{}},exit:function(e){return $n({beanKey:e.key})}}};function Bt(e,t,n){if("buy"===n.act&&null!=n.good){var a=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=Ye(e.market,a,r);if(null==l)return"nosupply";var c=Math.min(l.quantity,i);return l.price<=n.cash*c||Re(t,n,a)&&ze(t,l.price)?"yes":"pricedout"}(t.economy,t.law,e,n.good);return"yes"!=a&&"fun"===n.good?{intent:{act:"relax"}}:"pricedout"===a?"food"!=n.good&&"medicine"!=n.good||!function(e,t){if("shelter"===t)return!1;if("fun"===t)return!1;var n=Math.random(),a=.05;return"ego"===e.community&&(a+=.1),dt(e)&&(a+=.1),it(e,"Greed")&&(a+=.25),it(e,"Anarchism")&&(a+=.33),it(e,"Authority")&&(a+=-.25),("food"===t&&"starving"===e.food||"medicine"===t&&"sick"===e.health)&&(a+=.25),a<=n}(e,n.good)?"food"===n.good||"medicine"===n.good||"shelter"===n.good?{sideEffect:Jn({beanKey:e.key,emote:"unhappiness",source:_[n.good]+" Poverty"})}:void 0:{intent:{act:"crime",crimeGood:n.good}}:"nosupply"===a?n.good&&function(e,t){var n=!1;return("food"!==t||"starving"!==e.food&&"hungry"!==e.food)&&("shelter"!==t||"homeless"!==e.stamina&&"sleepy"!==e.stamina)&&("medicine"!==t||"sick"!==e.health&&"sickly"!==e.health)||(n=!0),n}(e,n.good)?{sideEffect:Jn({beanKey:e.key,emote:"unhappiness",source:"Scarcity"})}:void 0:{intent:Object(B.a)(Object(B.a)({},n),{},{buyAttempts:0})}}return{intent:n}}function Pt(e,t,n,a){switch(n.act){case"buy":if(n.good)return Wt(t,a,e,pe[n.good]);case"work":return Wt(t,a,e,fe[e.job]);case"relax":var r=function(e,t){var n=e.buildingKeys.filter((function(e){return"nature"===t.buildings.byID[e].type||"park"===t.buildings.byID[e].type||"theater"===t.buildings.byID[e].type}));if(!(n.length<1)){var a=Ke(t.seed,n);return t.buildings.byID[a]}}(t,a);if(r)return Ut(a.seed,t,e,r);var i=a.districts.allIDs.map((function(e){return a.districts.byID[e]})).find((function(e){return"nature"===e.kind}));if(i)return Jt(a.seed,t,e,{q:i.q,r:i.r},{x:i.point.x+150*Math.random()-75,y:i.point.y+150*Math.random()-75})}return[]}function At(e,t,n,a){var r=Pt(e,t,n,a);return r?{act:"travel",destinations:r,destinationIndex:0,intent:n}:void 0}var Gt=.002,Lt=function(e,t,n){return"jobless"==e.job?0:0===e.cash?R(t,.75):n?R(t,.5+.125*Math.min(1,n.costOfLiving/e.cash)):R(t)},qt=function(e,t,n){return R(t,.5+.75*Math.min(1,n.bean_life.vital_thresh.food.warning/e.discrete_food))},Ht=function(e,t,n){return R(t,.5+.5*Math.min(1,n.bean_life.vital_thresh.shelter.warning/e.discrete_stamina))},Ft=function(e,t,n){return R(t,.5+.25*Math.min(1,n.bean_life.vital_thresh.medicine.warning/e.discrete_health))},Rt=function(e,t,n){return R(t,.5+.125*Math.min(1,-e.lastHappiness/100))};function zt(e,t,n,a){var r=[{act:"work",good:I(e.job),priority:Lt(e,t,n)},{act:"buy",good:"shelter",priority:Ht(e,t,a)},{act:"buy",good:"food",priority:qt(e,t,a)},{act:"buy",good:"medicine",priority:Ft(e,t,a)},{act:"buy",good:"fun",priority:Rt(e,t,a)}];return r.sort((function(e,t){return t.priority-e.priority})),r}function Wt(e,t,n,a){var r=function(e,t,n){var a=e.buildingKeys.filter((function(e){return t.buildings.byID[e].type===n}));if(!(a.length<1)){var r=Ke(t.seed,a);return t.buildings.byID[r]}}(e,t,a);return void 0===r?null:Ut(t.seed,e,n,r)}function Ut(e,t,n,a){return Jt(e,t,n,a.hex,a.point)}function Jt(e,t,n,a,r){var i,l,c=v.Get("bean",n.key).current||Object(B.a)({},$),o=function(e,t,n){var a=le,r=(n.x-t.x)/e.x,i=(n.y-t.y)/e.y,l=a.b0*r+a.b1*i,c=a.b2*r+a.b3*i;return new z(l,c)}(t.hex_size,t.petriOrigin,c.point);return(i=o,l=a,re(ae(i),ae(l))).map((function(e){return ce(t.hex_size,t.petriOrigin,e)})).map((function(t,n,a){return n===a.length-1?{x:r.x+xe(e,-20,20),y:r.y+xe(e,-20,20)}:t}))}var Zt=new(function(){function e(){Object(c.a)(this,e),this.cache={bean:{},ufo:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]={elapsed:0,duration:0}),this.cache[e][t]}}]),e}());function Vt(e,t){for(var n=function(e){for(var t=e.length;t>0;){var n=Math.floor(Math.random()*t),a=e[--t];e[t]=e[n],e[n]=a}return e}(e.cities.byID[t.cityKey].buildingKeys.map((function(t){return e.buildings.byID[t]})).filter((function(e){var t=["farm","house","theater","hospital"].includes(e.type),n=_t(e).length>0;return t&&n}))),a=0;a<n.length;a++){var r=n[a];if(_t(r).length>0)return $t(t,r,e.enterprises.byID[r.key]),!0}return!1}function $t(e,t,n){t.jobs.push(e.key),e.employerEnterpriseKey=t.key,n&&null==n.ownerBeanKey&&(n.ownerBeanKey=e.key),e.job=he[t.type]}var Xt,Yt="drop.mp3",Qt="ding_soft.mp3",en="ding_bad.wav",tn="death_bell.wav",nn="digital_beeping.mp3",an="squish_pop.mp3",rn="squish_suck.mp3",ln="baby_squeak.wav",cn="mhmm.mp3",on="pill-shake.wav",sn="cow-moo.wav",un="door-open.wav",dn="teleport.wav",mn="cash_ding.mp3",yn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.file=t,this.volume=n,this.buffer=[]}return Object(o.a)(e,[{key:"play",value:function(){if(this.buffer.length>0&&this.buffer[0].ended){var e=this.buffer.shift();null===e||void 0===e||e.play(),e&&this.buffer.push(e)}else{var t=new Audio("/socsim/"+this.file);t.volume=this.volume,t.play(),this.buffer.push(t)}}}]),e}(),pn=new(function(){function e(){Object(c.a)(this,e),this.lib={drop:new yn(Yt,.2),love:new yn(Qt),happiness:new yn(Qt),unhappiness:new yn(en),hate:new yn(en),death:new yn(tn),scan:new yn(nn,.3),wash_in:new yn(an),wash_out:new yn(rn),squeak:new yn(ln,.3),mhmm:new yn(cn,.5),moo:new yn(sn,1),pills:new yn(on,1),door:new yn(un,1),teleport:new yn(dn,.6),cash:new yn(mn,.23)}}return Object(o.a)(e,[{key:"play",value:function(e){this.lib[e].play()}}]),e}()),fn={common:3,uncommon:5,rare:7},hn={common:3,uncommon:5,rare:7};function bn(e,t){var n=L[t].rarity;return{trait:t,cost:{hedons:fn[n]+xe(e,0,hn[n])}}}!function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Fall=2]="Fall",e[e.Winter=3]="Winter"}(Xt||(Xt={}));var vn;!function(e){e[e.Midnight=0]="Midnight",e[e.Morning=2]="Morning",e[e.Noon=4]="Noon",e[e.Evening=6]="Evening"}(vn||(vn={}));function gn(e){if(e.date.hour++,e.date.hour%2===0&&function(e){e.enterprises.allIDs.forEach((function(t){var n=e.enterprises.byID[t],a=e.buildings.byID[t].jobs.map((function(t){return e.beans.byID[t]}));switch(n.enterpriseType){case"company":if(a.length<1);else if(1===a.length)a[0].cash+=n.cash,n.cash>0&&(a[0].ticksSinceLastSale=0),n.cash=0;else{var r=n.cash/(a.length+.15);n.cash=0;var i=a.find((function(e){return e.key===n.ownerBeanKey}));null==i&&(i=a[0],n.ownerBeanKey=i.key),a.forEach((function(e){var t=e===i?1.15*r:r;e.cash+=t,t>0&&(e.ticksSinceLastSale=0)}))}break;case"co-op":var l=n.cash/a.length;n.cash=0,a.forEach((function(e){e.cash+=l,l>0&&(e.ticksSinceLastSale=0)}));break;case"commune":var c=n.cash/a.length;n.cash=0,a.forEach((function(e){e.cash+=c,c>0&&(e.ticksSinceLastSale=0)}))}}))}(e),e.date.hour>=8&&(e.date.hour=0,e.date.day++,function(e){e.beans.allIDs.forEach((function(t){var n=e.beans.byID[t];n.hedonHistory.length>=5&&n.hedonHistory.pop(),n.hedonHistory.unshift({})}))}(e),e.date.day%7===0&&function(e){if(e.marketTraitsForSale=function(e){for(var t=[],n=0;n<3;n++){var a=Ke(e,H);t.push(bn(e,a))}return t}(e.seed),En(e,{key:0,message:"New traits in the Emotion Market!",icon:"\ud83d\udecd\ufe0f",trigger:"marketrefresh"}),Fe(e.law,"poll_tax")){var t=0;e.cities.allIDs.forEach((function(n){ya(e,n).forEach((function(e){e.cash>=.1&&(e.cash-=.1,t+=.1)}))})),e.law.cash=e.law.cash+t}!function(e,t){var n=1*t.length;if(e.cash>n){var a=(e.cash-n)/t.length;e.cash=n,t.forEach((function(e){return e.cash+=a}))}}(e.law,Object.values(e.beans.byID))}(e)),e.date.day>30&&(e.date.day=1,function(e){e.economy.unfulfilledMonthlyDemand={food:0,shelter:0,medicine:0,fun:0},e.economy.monthlyDemand={food:0,shelter:0,medicine:0,fun:0},e.economy.monthlySupply={food:0,shelter:0,medicine:0,fun:0}}(e),e.date.season++),e.date.season>3&&(e.date.year++,function(e){!function(e){var t=e.beans.allIDs.reduce((function(t,n){return t.push(e.beans.byID[n]),t}),[]),n=t.reduce((function(e,t){return e+t.cash}),0)/100,a=Math.round(1*n);if(a>0){var r=t.reduce((function(e,t){return t.cash>e.max&&(e.winner=t,e.max=t.cash),e}),{max:0});r.winner&&(r.winner.cash+=a)}}(e)}(e),e.date.season=0),e.alien.bots.amount+=e.alien.bots.income,e.alien.energy.amount+=e.alien.energy.income,xt(e.alien.techProgress,"fast_resources")&&(e.alien.bots.amount+=.5*e.alien.bots.income,e.alien.energy.amount+=.5*e.alien.energy.income),e.alien.currentlyResearchingTech){var t=e.alien.currentlyResearchingTech;null==e.alien.techProgress[t]&&(e.alien.techProgress[t]={researchPoints:0});var n=kt[t].techPoints,a=e.alien.techProgress[t].researchPoints;a<n&&(e.alien.techProgress[t].researchPoints+=e.alien.abductedBeanKeys.length),a>=n&&("neural_duplicator"===e.alien.currentlyResearchingTech&&e.alien.beliefInventory.forEach((function(e){return e.charges+=1})),e.alien.currentlyResearchingTech=void 0)}var r=Xe(e.economy);return e.beans.allIDs.forEach((function(t,n){var a=e.beans.byID[t];if("alive"==a.lifecycle){var i=function(e,t,n){if("alive"==e.lifecycle){var a=[],r="starving"!==e.food,i="sick"!==e.health;e.discrete_food-=n.bean_life.degrade_per_tick.food,e.discrete_food<0&&(e.discrete_health-=n.bean_life.penalty.starving_health),nt(e);var l=ct(e,t,"starvation","starving"===e.food,.6);if(l)return l;"starving"===e.food&&r&&(a.push.apply(a,Object(b.a)(rt(e,"unhappiness","Starving"))),it(e,"Gluttony")&&(a.push.apply(a,Object(b.a)(rt(e,"unhappiness","Gluttony"))),a.push.apply(a,Object(b.a)(rt(e,"unhappiness","Gluttony"))))),e.discrete_stamina-=n.bean_life.degrade_per_tick.stamina,tt(e);var c=ct(e,t,"exposure","homeless"===e.stamina,.2);if(c)return c;e.discrete_health-=n.bean_life.degrade_per_tick.health,e.discrete_health=Math.min(e.discrete_health,3),et(e);var o=ct(e,t,"sickness","sick"===e.health,.4);return o||("sick"===e.health&&i&&(a.push.apply(a,Object(b.a)(rt(e,"unhappiness","Sick"))),it(e,"Germophobia")&&a.push.apply(a,Object(b.a)(rt(e,"unhappiness","Germophobia")))),e.discrete_fun-=n.bean_life.degrade_per_tick.fun,e.discrete_fun=Math.max(0,e.discrete_fun),dt(e)||(e.graceTicks=F(e.graceTicks+1,0,6)),a.length?{emotes:a}:void 0)}}(a,e.seed,e.alien.difficulty);(null===i||void 0===i?void 0:i.emotes)&&i.emotes.map((function(t){return Ee(e.pickups,t)})),(null===i||void 0===i?void 0:i.death)&&(Ee(e.events,i.death),Mt(a,e),pn.play("death"));var l=lt(a,e.seed,r);if(l){var c=Ae(e,e.cities.byID[a.cityKey],a);a.lastPoint&&(c.lastPoint=a.lastPoint,v.Get("bean",c.key).publish({point:{x:a.lastPoint.x,y:a.lastPoint.y},velocity:{x:0,y:0}})),e.beans.byID[c.key]=c,e.beans.allIDs.push(c.key),e.cities.byID[a.cityKey].beanKeys.push(c.key),En(e,l),pn.play("squeak")}if("jobless"===a.job)Vt(e,a)||En(e,{icon:"\ud83c\udfda\ufe0f",trigger:"nojobslots",message:"A subject cannot find a job; build or upgrade more buildings.",key:0});a.happiness=function(e){if(0===e.length)return{all:{},flatAverage:0,weightedAverage:0,maxSource:"",minSource:""};for(var t={},n=0,a=0,r=0;r<e.length;r++){for(var i=e[r],l=0,c=Object.keys(i),o=0;o<c.length;o++){var s=c[o];l+=i[s],t[s]||(t[s]=0),t[s]+=i[s]}n+=l/(r+1),a+=l}var u=Object.keys(t);return{flatAverage:a/e.length,weightedAverage:n,maxSource:u.reduce((function(e,n){return t[n]>e.val?{source:n,val:t[n]}:e}),{source:"",val:0}).source,minSource:u.reduce((function(e,n){return t[n]<e.val?{source:n,val:t[n]}:e}),{source:"",val:0}).source,all:t}}(a.hedonHistory)}})),e.cities.allIDs.forEach((function(t){var n,a,r=e.cities.byID[t];n=r,a=e.economy,n.costOfLiving=Xe(a)})),e.beans.allIDs.forEach((function(t){var n,a,r=e.beans.byID[t];r&&"alive"==r.lifecycle&&(n=r,a=e.economy,e.alien.difficulty,e.law,n.hedonFiveDayRecord={min:Math.min(n.hedonFiveDayRecord.min,n.happiness.flatAverage),max:Math.max(n.hedonFiveDayRecord.max,n.happiness.flatAverage)},0===n.happiness.flatAverage?n.lastHappiness=0:n.lastHappiness=n.happiness.flatAverage>=0?n.happiness.flatAverage/Math.abs(n.hedonFiveDayRecord.max)*100:n.happiness.flatAverage/Math.abs(n.hedonFiveDayRecord.min)*100,nt(n),et(n),function(e,t){e.discrete_sanity>=8?e.sanity="sane":e.discrete_sanity>=5?e.sanity="stressed":e.discrete_sanity>=3?e.sanity="disturbed":e.sanity="psychotic",e.sanity}(n),tt(n),"jobless"===n.job?n.fairGoodPrice=1:n.fairGoodPrice=$e(a,I(n.job)))})),function(e,t){for(var n=0;n<t.goals.length;n++){var a=t.goals[n];if(null==t.goalProgress[a]&&(t.goalProgress[a]={done:!1,step:0}),!t.goalProgress[a].done){var r=ft[a].check(e),i=ft[a].reward;t.goalProgress[a].done=r,r&&null!=i&&wt(t,i)}}}(e,e.alien),function(e,t){t.workingReportCard=ht.GradeWorld(e)}(e,e.alien),e}function En(e,t){for(t.key=e.events.nextID++,e.events.byID[t.key]=t,e.events.allIDs.push(t.key),pt.events.publish(t);e.events.allIDs.length>25;){var n=e.events.allIDs[0];null!=n&&(e.events.allIDs=e.events.allIDs.slice(1),e.events.byID=Object(B.a)({removedID:n},e.events.byID))}}function kn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=[];return e.energy&&a.push(t+e.energy*n+" Energy"),e.bots&&a.push(t+e.bots*n+" Bots"),e.hedons&&a.push(t+e.hedons*n+" Hedons"),e.tortrons&&a.push(t+e.tortrons*n+" Antihedons"),a.join(" ")}var wn={cost:{emptyHex:{build:{house:{energy:1,bots:3},farm:{energy:1,bots:3},theater:{energy:1,bots:4},hospital:{energy:1,bots:4},church:{energy:1,bots:4},courthouse:{energy:999,bots:999},park:{energy:1,bots:4},nature:{energy:1,bots:4}}},hex:{beam:{energy:3},upgrade:{energy:1,bots:4},fallow_2_rural:{bots:1},rural_2_urban:{bots:2}},bean_brain:{brainwash_ideal:{sanity:4},brainimplant_secondary:{sanity:1},brainwash_secondary:{sanity:2}},bean:{scan:{energy:1},abduct:{bots:3},gift:{},empower:{},vaporize:{energy:2,bots:4},siphon:{}},market:{scrubHedons:{energy:5},resource:{bots:{hedons:6},energy:{hedons:5}},beliefs:{common:{},uncommon:{},rare:{}}}},bean_life:{vital_thresh:{food:{warning:.6,sufficient:1,abundant:3},shelter:{warning:2,sufficient:3,abundant:7},medicine:{warning:.6,sufficient:1,abundant:3},fun:{warning:.1,sufficient:1,abundant:3}},degrade_per_tick:{food:1/24,health:1/40,stamina:1/8,fun:1/40},penalty:{homeless_health:1/56,starving_health:1/56},death_chance:{starvation:1/8,sickness:1/8,exposure:1/8,vaporization:1}},report_card_progression:[]};var xn=Object(St.b)({name:"world",initialState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"abcdef";return{buildings:{byID:{},allIDs:[],nextID:0},enterprises:{byID:{},allIDs:[],nextID:0},cities:ge([Me()]),beans:{byID:{},allIDs:[],nextID:0},ufos:{byID:{},allIDs:[],nextID:0},events:{byID:{},allIDs:[],nextID:0},pickups:{byID:{},allIDs:[],nextID:0},lots:{byID:{},allIDs:[],nextID:0},districts:{byID:{},allIDs:[],nextID:0},titles:{byID:{},allIDs:[],nextID:0},economy:{unfulfilledMonthlyDemand:{food:0,shelter:0,medicine:0,fun:0},monthlyDemand:{food:0,shelter:0,medicine:0,fun:0},monthlySupply:{food:0,shelter:0,medicine:0,fun:0},market:{listings:{food:[],fun:[],medicine:[],shelter:[]}}},law:{cash:0,lawTree:{},laws:[],ticksSinceLastSale:0},date:{year:1,season:Xt.Spring,day:1,hour:1},marketTraitsForSale:[],alien:{scanned_bean:{},seenBeliefs:{},beliefInventory:[],speechcrimes:{},abductedBeanKeys:[],energy:{amount:16,income:2/30},bots:{amount:10,income:2/30},hedons:{amount:0,income:0},next_grade:{year:1,season:3,day:1,hour:0},difficulty:Object(B.a)({},wn),goals:["found_utopia","build_house_n_farm","beam_3","scan","brainwash","set_policy","c+_grade"],goalProgress:{},pastReportCards:[],workingReportCard:{Happiness:"D",Prosperity:"D",Stability:"D",Dogma:"D"},techProgress:{},currentlyResearchingTech:void 0},spotlightEvent:void 0,saveSlot:1,seed:e}}(),reducers:{refreshMarket:function(e){},magnetChange:function(e,t){e.cities.byID[t.payload.cityKey].pickupMagnetPoint=t.payload.px},worldTick:function(e){gn(e)},newGame:function(e,t){var n,a=e.cities.byID[0];e.seed=t.payload.seed,a.name=(n=e.seed,"".concat(Ke(n,Ce)).concat(Ke(n,Ie)).concat(Ke(n,_e)));var r=Oe(a);e.districts=r.ds,e.lots=r.lots;var i=Ke(e.seed,e.districts.allIDs.slice(1));e.districts.byID[i].kind="nature"},loadGame:function(e,t){return t.payload.newState.beans.allIDs.map((function(e){var n,a,r=t.payload.newState.beans.byID[e];r&&v.Get("bean",e).publish({point:{x:(null===(n=r.lastPoint)||void 0===n?void 0:n.x)||0,y:(null===(a=r.lastPoint)||void 0===a?void 0:a.y)||0},velocity:{x:0,y:0}})})),t.payload.newState},build:function(e,t){var n=e.alien.difficulty.cost.emptyHex.build[t.payload.what];if(Kt(e.alien,n)){var a=e.lots.byID[t.payload.lot],r=e.districts.byID[a.districtKey];switch(function(e,t,n,a,r,i,l){var c={type:n,key:e.buildings.nextID++,hex:a,point:Object(B.a)({},r),lotKey:i,jobs:[],upgraded:!1};e.buildings.allIDs.push(c.key),e.buildings.byID[c.key]=c,t.buildingKeys.push(c.key),e.lots.byID[i].buildingKey=c.key,It.some((function(e){return n}))&&(c.enterpriseKey=c.key,e.enterprises.allIDs.push(c.key),e.enterprises.byID[c.key]={cash:0,cityKey:t.key,enterpriseType:"company",key:c.key,ticksSinceLastSale:0});var o=ye[n];"fun"!=o&&e.economy.market.listings[o].push({price:1,quantity:3,sellerCityKey:t.key,sellerEnterpriseKey:c.key})}(e,e.cities.byID[t.payload.city],t.payload.what,r,a.point,a.key,e.economy),t.payload.what){case"farm":pn.play("moo");break;case"hospital":pn.play("pills");break;case"house":pn.play("door")}}},upgradeDistrict:function(e,t){var n=e.districts.byID[t.payload.district];if(n)if("rural"===("rural"===n.kind?"urban":"rural")){var a=e.alien.difficulty.cost.hex.fallow_2_rural;Kt(e.alien,a)&&(Pe(n,e.lots,"rural"),n.kind="rural")}else{var r=e.alien.difficulty.cost.hex.rural_2_urban;Kt(e.alien,r)&&(Pe(n,e.lots,"urban"),n.kind="urban")}},changeEnterprise:function(e,t){e.enterprises.byID[t.payload.enterpriseKey].enterpriseType=t.payload.newType},fireBean:function(e,t){Mt(e.beans.byID[t.payload.beanKey],e)},upgrade:function(e,t){var n=e.alien.difficulty.cost.hex.upgrade,a=e.buildings.byID[t.payload.buildingKey];Kt(e.alien,n)&&(a.upgraded=!0)},beam:function(e,t){var n=e.alien.difficulty.cost.hex.beam;if(Dt(e.alien,n)){Nt(e.alien,n);var a={key:e.ufos.nextID++,action:"beam-in",duration:0,point:Object(B.a)({},t.payload.where),cityKey:t.payload.cityKey};e.ufos.allIDs.push(a.key),e.ufos.byID[a.key]=a,e.cities.byID[t.payload.cityKey].ufoKeys.push(a.key)}},remove_ufo:function(e,t){var n=e.ufos.byID[t.payload.ufoKey],a=Ae(e,e.cities.byID[0],void 0,n.point);a.priorities=zt(a,e.seed,e.cities.byID[a.cityKey],e.alien.difficulty),delete e.ufos.byID[t.payload.ufoKey],e.ufos.allIDs=e.ufos.allIDs.filter((function(e){return e!=t.payload.ufoKey})),e.cities.byID[n.cityKey].ufoKeys=e.cities.byID[n.cityKey].ufoKeys.filter((function(e){return e!=t.payload.ufoKey})),e.beans.byID[a.key]=a,e.beans.allIDs.push(a.key),e.cities.byID[n.cityKey].beanKeys.push(a.key),v.Get("bean",a.key).current={point:ce(e.cities.byID[n.cityKey].hex_size,e.cities.byID[n.cityKey].petriOrigin,n.point),velocity:{x:0,y:0}}},abduct:function(e,t){if(Kt(e.alien,e.alien.difficulty.cost.bean.abduct)){var n=e.beans.byID[t.payload.beanKey];if("alive"===n.lifecycle){if(n.lifecycle="abducted",n.employerEnterpriseKey)Ot(e.buildings.byID[n.employerEnterpriseKey],n);e.cities.byID[n.cityKey].beanKeys=e.cities.byID[n.cityKey].beanKeys.filter((function(e){return e!=n.key})),e.alien.abductedBeanKeys.push(n.key)}}},cheatAdd:function(e){e.alien.energy.amount+=10,e.alien.bots.amount+=10,e.alien.hedons.amount+=10},release:function(e){if(e.alien.abductedBeanKeys.length>0){var t=e.alien.abductedBeanKeys.shift();if(null!=t){var n=e.beans.byID[t];n.lifecycle="alive",e.cities.byID[n.cityKey].beanKeys.push(t)}}},washCommunity:function(e,t){},washMotive:function(){},washNarrative:function(e,t){var n=e.beans.byID[t.payload.beanKey];if(mt(n,e.alien.difficulty.cost.bean_brain.brainwash_ideal,0)){st(n,e.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0);for(var a=n.faith;n.faith===a;)n.faith=Ke(e.seed,["rocket","dragon","music","noFaith"])}},washBelief:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=xt(e.alien.techProgress,"sanity_bonus")?-1:0;if(mt(n,e.alien.difficulty.cost.bean_brain.brainwash_secondary,a)){st(n,e.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0),n.beliefs.splice(n.beliefs.indexOf(t.payload.trait),1);var r=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.trait})),i=xt(e.alien.techProgress,"neural_duplicator")?1:0;r?r.charges+=2+i:e.alien.beliefInventory.push({trait:t.payload.trait,charges:2+i}),pn.play("wash_out")}},setResearch:function(e,t){e.alien.currentlyResearchingTech=t.payload.t},implant:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=xt(e.alien.techProgress,"sanity_bonus")?-1:0;mt(n,e.alien.difficulty.cost.bean_brain.brainimplant_secondary,a)&&e.alien.beliefInventory.filter((function(e){return e.trait==t.payload.trait&&e.charges>0}))&&(n.beliefs.push(t.payload.trait),function(e,t){var n=e.beliefInventory,a=n.find((function(e){return e.trait===t}));a&&(a.charges-=1,e.beliefInventory=Object(b.a)(n.filter((function(e){return e.charges>0}))))}(e.alien,t.payload.trait),pn.play("wash_in"),st(n,e.alien.difficulty.cost.bean_brain.brainimplant_secondary.sanity||0))},scan:function(e,t){var n=e.beans.byID[t.payload.beanKey];Kt(e.alien,e.alien.difficulty.cost.bean.scan)&&(e.alien.scanned_bean[n.key]=!0,n.beliefs.forEach((function(t){e.alien.seenBeliefs[t]||(e.alien.seenBeliefs[t]=!0,pt.newTraitSeen.publish({k:L[t].noun,v:!0}))})),pn.play("scan"))},vaporize:function(e,t){if(Kt(e.alien,e.alien.difficulty.cost.bean.vaporize)){var n=ot(e.beans.byID[t.payload.beanKey],e.seed,"vaporization");Ee(e.events,n.death),n.emotes.map((function(t){return Ee(e.pickups,t)}))}},pickUpPickup:function(e,t){var n=e.pickups.byID[t.payload.pickupKey],a=O[n.type];e.alien.hedons.amount+=a,e.cities.byID[t.payload.cityKey].pickupKeys=e.cities.byID[t.payload.cityKey].pickupKeys.filter((function(e){return e!=t.payload.pickupKey})),e.pickups.allIDs=e.pickups.allIDs.filter((function(e){return e!=t.payload.pickupKey})),delete e.pickups.byID[t.payload.pickupKey],pt.alienHedons.publish({change:a}),pn.play(n.type)},changeState:function(e,t){var n,a=e.beans.byID[t.payload.beanKey].action,r=e.beans.byID[t.payload.beanKey],i=Zt.Get("bean",r.key);"chat"===a&&(r.lastChatMS=Date.now()),"idle"===t.payload.newState.act&&(r.priorities=zt(r,e.seed,e.cities.byID[r.cityKey],e.alien.difficulty)),r.activity_duration[a]+=i.elapsed,r.action=t.payload.newState.act,r.actionData=t.payload.newState;var l=null===(n=v.Get("bean",r.key).current)||void 0===n?void 0:n.point;l&&(r.lastPoint=Object(B.a)({},l)),i.elapsed=0},beanHitDestination:function(e,t){var n=e.beans.byID[t.payload.beanKey];null!=n.actionData.destinationIndex&&n.actionData.destinationIndex++},beanBePersuaded:function(e,t){var n=e.beans.byID[t.payload.beanKey];n.beliefs.push(t.payload.belief),En(e,{key:0,icon:"\ud83d\udde3\ufe0f",trigger:"persuasion",message:"".concat(n.name," now believes in ").concat(L[t.payload.belief].icon," ").concat(L[t.payload.belief].noun,"!"),beanKey:n.key,cityKey:n.cityKey,point:n.lastPoint}),pn.play("mhmm")},beanGiveCharity:function(e,t){var n=e.beans.byID[t.payload.senderBeanKey];n.cash-=.5,Kn(n,e,{emote:"happiness",source:"Charity"});var a=e.beans.byID[t.payload.needyBeanKey];a.cash+=.5,Kn(a,e,{emote:"happiness",source:"Charity"})},beanWork:function(e,t){var n,a=e.beans.byID[t.payload.beanKey];if("jobless"===a.job);else{switch(a.job){case"farmer":a.discrete_food=Math.min(a.discrete_food+1,2*j.sufficient),Dn(e,a,"Parochialism","happiness",.25);break;case"doc":a.discrete_health=Math.min(a.discrete_health+1,2*C.sufficient),Dn(e,a,"Germophobia","unhappiness",.25);break;case"builder":a.stamina="awake",a.discrete_stamina=7;break;case"entertainer":Dn(e,a,"Cosmopolitanism","happiness",.25)}if(Dn(e,a,"Diligence","happiness",.25),Dn(e,a,"Hedonism","unhappiness",.15),a.ticksSinceLastSale++,a.ticksSinceLastSale>8&&null!=a.employerEnterpriseKey)if(e.enterprises.byID[a.employerEnterpriseKey].ownerBeanKey!=a.key&&Math.random()>.5){var r=(n=e.economy,We.reduce((function(e,t){return n.unfulfilledMonthlyDemand[t]>e.max&&(e.max=n.unfulfilledMonthlyDemand[t],e.job=function(e){switch(e){case"shelter":return"builder";case"medicine":return"doc";case"fun":return"entertainer";default:case"food":return"farmer"}}(t)),e}),{max:0,job:null}).job);r&&(Ot(e.buildings.byID[a.employerEnterpriseKey],a),function(e,t,n){if("jobless"===n)return!1;for(var a=e.cities.byID[t.cityKey].buildingKeys.map((function(t){return e.buildings.byID[t]})).filter((function(e){return e.type===fe[n]})),r=0;r<a.length;r++){var i=a[r];if(_t(i).length>0)return $t(t,i,e.enterprises.byID[i.key]),!0}}(e,a,r))}var i=!1;if(a.employerEnterpriseKey){var l=e.enterprises.byID[a.employerEnterpriseKey];if(l)switch(function(e,t,n,a,r){e.monthlySupply[n]+=a;var i=e.market.listings[n].find((function(e){return e.sellerEnterpriseKey==t.key}));i?(i.quantity+=a,i.price=r,i.quantity=Math.min(i.quantity,20)):e.market.listings[n].push({sellerEnterpriseKey:t.key,price:r,quantity:a}),e.market.listings[n].sort((function(e,t){return e.price-t.price}))}(e.economy,l,I(a.job),4,a.fairGoodPrice),i=!0,l.enterpriseType){case"company":Dn(e,a,"Communism","unhappiness",.1),l.ownerBeanKey===a.key&&Dn(e,a,"Capitalism","happiness",.1);break;case"co-op":Dn(e,a,"Capitalism","unhappiness",.1),Dn(e,a,"Socialism","happiness",.1);break;case"commune":Dn(e,a,"Capitalism","unhappiness",.1)}}i||function(e,t,n,a,r){e.monthlySupply[n]+=a;var i=e.market.listings[n].find((function(e){return e.sellerBeanKey==t.key}));i?(i.quantity+=a,i.price=r,i.quantity=Math.min(i.quantity,20)):e.market.listings[n].push({sellerBeanKey:t.key,sellerCityKey:t.cityKey,price:r,quantity:a}),e.market.listings[n].sort((function(e,t){return e.price-t.price}))}(e.economy,a,I(a.job),4,a.fairGoodPrice)}},beanEmote:function(e,t){var n=e.beans.byID[t.payload.beanKey];Kn(n,e,t.payload),it(n,"Hedonism")&&("happiness"===t.payload.emote||"love"===t.payload.emote)&&Math.random()<.1&&Kn(n,e,{emote:"happiness",source:"Hedonism"})},beanCrime:function(e,t){var n=e.beans.byID[t.payload.beanKey],a=Ke(e.seed,e.economy.market.listings[t.payload.good]);if(null==a);else{var r=Math.min(a.quantity,3);if(Ze(e.economy.market,a,t.payload.good,r),null!=r)switch(t.payload.good){case"food":n.discrete_food+=r;break;case"medicine":n.discrete_health+=r}}},beanRelax:function(e,t){var n=e.beans.byID[t.payload.beanKey];n.discrete_fun+=1,Kn(n,e,{emote:"happiness",source:"Relaxation"}),it(n,"Naturalism")&&Kn(n,e,{emote:"happiness",source:"Naturalism"})},enactLaw:function(e,t){var n=He[t.payload.lawKey];e.law.lawTree[n.axis]=n},repealLaw:function(e,t){var n=He[t.payload.lawKey];delete e.law.lawTree[n.axis]},buyBots:function(e,t){var n=e.alien.difficulty.cost.market.resource.bots;Kt(e.alien,n,t.payload.amount)&&(e.alien.bots.amount+=t.payload.amount)},buyEnergy:function(e,t){var n=e.alien.difficulty.cost.market.resource.bots;Kt(e.alien,n,t.payload.amount)&&(e.alien.energy.amount+=t.payload.amount)},scrubHedons:function(e){var t=e.alien.difficulty.cost.market.scrubHedons;if(Kt(e.alien,t)){e.alien.hedons.amount;e.alien.hedons.amount=0}},buyTrait:function(e,t){if(Kt(e.alien,t.payload.l.cost)){var n=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.l.trait}));n?n.charges+=3:e.alien.beliefInventory.push({trait:t.payload.l.trait,charges:3})}},beanBuy:function(e,t){var n,a,r,i,l,c=e.beans.byID[t.payload.beanKey],o=function(t){return null!=t.sellerEnterpriseKey?e.enterprises.byID[t.sellerEnterpriseKey]:t.sellerBeanKey?e.beans.byID[t.sellerBeanKey]:e.law};switch(t.payload.good){case"food":(null===(n=l=Ve(e.economy,e.law,c,"food",o,.5,3))||void 0===n?void 0:n.bought)&&(c.discrete_food+=l.bought,"stuffed"===c.food&&(Kn(c,e,{emote:"happiness",source:"Stuffed"}),Dn(e,c,"Gluttony","happiness",1)));break;case"shelter":(null===(a=l=Ve(e.economy,e.law,c,"shelter",o))||void 0===a?void 0:a.bought)?(c.discrete_stamina=10,c.stamina="awake"):c.discrete_stamina<=0&&(c.stamina="homeless");break;case"medicine":(null===(r=l=Ve(e.economy,e.law,c,"medicine",o,.5,3))||void 0===r?void 0:r.bought)&&(c.discrete_health+=l.bought,"fresh"===c.health&&Kn(c,e,{emote:"happiness",source:"Robust"}));break;case"fun":(null===(i=l=Ve(e.economy,e.law,c,"fun",o))||void 0===i?void 0:i.bought)&&(c.discrete_fun=1,Kn(c,e,{emote:"happiness",source:"Entertainment"}),Kn(c,e,{emote:"happiness",source:"Entertainment"}))}c.actionData.buyAttempts=(c.actionData.buyAttempts||0)+1,l&&(pn.play("cash"),l.tax&&(Dn(e,c,"Libertarianism","unhappiness",.1),Dn(e,c,"Progressivism","happiness",.1)),c.actionData.buyReceipt=l)},addTitle:function(e,t){Ee(e.titles,{key:0,name:"Title",privileges:[]})},editTitle:function(e,t){var n=e.titles.byID[t.payload.newT.key];e.titles.byID[t.payload.newT.key]=t.payload.newT,n&&n.badge!=t.payload.newT.badge&&e.beans.allIDs.forEach((function(a){e.beans.byID[a].titleKey===n.key&&(e.beans.byID[a].badge=t.payload.newT.badge)})),n&&n.headwear!=t.payload.newT.headwear&&e.beans.allIDs.forEach((function(a){e.beans.byID[a].titleKey===n.key&&(e.beans.byID[a].hat=t.payload.newT.headwear)}))},manualSave:function(e){h.SaveGame(e)},beanSetTitle:function(e,t){var n=e.beans.byID[t.payload.beanKey];n.titleKey=t.payload.titleKey;var a=e.titles.byID[t.payload.titleKey];n.badge=a.badge,n.hat=a.headwear}}});function Dn(e,t,n,a,r){it(t,n)&&Math.random()<r&&Kn(t,e,{emote:a,source:n})}function Kn(e,t,n){e.discrete_sanity=F(e.discrete_sanity+T[n.emote],0,10),e.hedonHistory[0][n.source]=(e.hedonHistory[0][n.source]||0)+O[n.emote];var a=v.Get("bean",e.key).current||$,r={key:t.pickups.nextID++,point:{x:a.point.x,y:a.point.y},type:n.emote,velocity:{x:0,y:0}};t.cities.byID[e.cityKey].pickupKeys.push(r.key),t.pickups.byID[r.key]=r,t.pickups.allIDs.push(r.key),v.Get("pickup",r.key).publish({point:{x:a.point.x,y:a.point.y},velocity:{x:0,y:0}})}var Nn=xn.actions,Sn=(Nn.refreshMarket,Nn.magnetChange),jn=Nn.worldTick,Cn=Nn.remove_ufo,In=Nn.upgradeDistrict,_n=Nn.newGame,Mn=Nn.loadGame,On=Nn.build,Tn=Nn.changeEnterprise,Bn=Nn.fireBean,Pn=Nn.upgrade,An=Nn.beam,Gn=Nn.abduct,Ln=Nn.release,qn=Nn.scan,Hn=Nn.vaporize,Fn=Nn.pickUpPickup,Rn=Nn.implant,zn=Nn.washBelief,Wn=Nn.washNarrative,Un=(Nn.washCommunity,Nn.washMotive,Nn.changeState),Jn=Nn.beanEmote,Zn=(Nn.beanGiveCharity,Nn.beanHitDestination),Vn=Nn.beanWork,$n=Nn.beanRelax,Xn=Nn.beanBuy,Yn=Nn.beanCrime,Qn=Nn.beanBePersuaded,ea=Nn.cheatAdd,ta=Nn.manualSave,na=Nn.addTitle,aa=Nn.editTitle,ra=Nn.beanSetTitle,ia=Nn.enactLaw,la=Nn.repealLaw,ca=Nn.setResearch,oa=Nn.buyBots,sa=Nn.buyEnergy,ua=Nn.buyTrait,da=Nn.scrubHedons,ma=function(e,t){return e.cities.byID[t].beanKeys},ya=Object(jt.a)(ma,(function(e){return e.beans.byID}),(function(e,t){return e.reduce((function(e,n){return e.push(t[n]),e}),[])})),pa=(Object(jt.a)(ya,(function(e){var t=e.reduce((function(e,t){switch(t.ethnicity){case"circle":e.circle++;break;case"square":e.square++;break;case"triangle":e.triangle++}return e}),{circle:0,square:0,triangle:0});return t.circle>t.square&&t.circle>t.triangle?"circle":t.square>t.circle&&t.square>t.triangle?"square":"triangle"})),xn.reducer,function(){return Object(d.b)()}),fa=d.c,ha=Object(St.b)({name:"selected",initialState:{selectedCityKey:void 0,selectedBeanKey:void 0},reducers:{doSelectCity:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}},doSelectDistrict:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:t.payload.district,selectedLotKey:void 0}},doSelectLot:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:t.payload.district,selectedLotKey:t.payload.lot}},doSelectBuilding:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:t.payload.buildingKey,selectedLotKey:void 0,selectedDistrictKey:void 0}},doSelectBean:function(e,t){return{selectedHexKey:void 0,selectedCityKey:t.payload.cityKey,selectedBeanKey:t.payload.beanKey,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}},doSelectNone:function(e){return{selectedBeanKey:void 0,selectedCityKey:void 0,selectedHexKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}}}}),ba=ha.actions,va=ba.doSelectDistrict,ga=ba.doSelectNone,Ea=ba.doSelectBean,ka=ba.doSelectCity,wa=ba.doSelectBuilding,xa=ba.doSelectLot,Da=Object(St.a)({reducer:{world:xn.reducer,selected:ha.reducer},middleware:Object(St.c)().concat([function(e){return function(e){return function(t){switch(t.type){case"world/magnetChange":break;default:t.type.startsWith("selected")||h.Dirty.publish(!0)}return e(t)}}}])}),Ka=function(e){return null!=e.selected.selectedCityKey?e.world.cities.byID[e.selected.selectedCityKey]:void 0},Na=function(e){return null!=e.selected.selectedBeanKey?e.world.beans.byID[e.selected.selectedBeanKey]:void 0},Sa=function(e){if(null!=e.selected.selectedCityKey&&e.world.cities.byID[e.selected.selectedCityKey]&&null!=e.selected.selectedLotKey){var t=e.world.lots.byID[e.selected.selectedLotKey].buildingKey;if(null!=t)return e.world.buildings.byID[t]}},ja=function(e){return e.world.events.allIDs},Ca=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={confirming:!1},a}return Object(o.a)(n,[{key:"click",value:function(){this.state.confirming?(this.props.onConfirm(),this.setState({confirming:!1})):this.setState({confirming:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("button",{className:this.props.className,onClick:function(){return e.click()},disabled:this.props.disabled},this.state.confirming?this.props.confirmText:this.props.children)}}]),n}(r.a.Component),Ia=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChange=function(e){a.props.onChange(e.target.value),a.setState({key:e.target.value})},a.state={key:e.value||null},a}return Object(o.a)(n,[{key:"hint",value:function(){if(this.props.hint)return r.a.createElement("option",{value:"",disabled:!0,selected:!0,hidden:!0},this.props.hint)}},{key:"getTextForOption",value:function(e){return this.props.titleCase&&(e=e[0].toUpperCase()+e.slice(1)),e}},{key:"options",value:function(){var e=this;return this.props.options.map((function(t){return r.a.createElement("option",{value:t,key:t,title:e.getTitleForOption(t)},e.getTextForOption(t))}))}},{key:"render",value:function(){return r.a.createElement("select",{onChange:this.onChange,value:this.state.key,required:null!=this.props.hint},this.hint(),this.options())}},{key:"getTitleForOption",value:function(e){}}]),n}(r.a.Component),_a=(n(31),function(e){return r.a.createElement("div",{className:"belief"},r.a.createElement("div",{className:"horizontal badger"},r.a.createElement("div",{className:"vertical"},r.a.createElement("div",{className:"circular"},e.data.icon),e.leftButton),r.a.createElement("div",{className:"vertical"},r.a.createElement("div",{className:"text-center"},e.titleView,e.cost?r.a.createElement("span",{className:"pull-r"},e.cost,"\ud83e\udde0"):null),e.data.description?e.data.description.split(";").map((function(e,t){return r.a.createElement("small",{className:"marg-b-6",key:t}," ",e)})):null,r.a.createElement("div",{className:"grow-1 text-center"},e.bottomView))))}),Ma=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"belief"},r.a.createElement("div",{className:"horizontal badger"},r.a.createElement("div",{className:"vertical"},r.a.createElement("div",{className:"circular"},this.props.data.icon),this.props.frozen?null:r.a.createElement(Ca,{className:"callout pad-4 marg-0",confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",disabled:this.props.available<this.props.cost,onConfirm:this.props.wash},"\ud83d\udebf ",r.a.createElement("small",null,"Wash"))),r.a.createElement("div",{className:"vertical"},r.a.createElement("div",{className:"text-center"},r.a.createElement("strong",{title:this.props.data.description,className:this.props.divergent?"divergent marg-r-6":"marg-r-6"},this.props.data.noun),r.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),r.a.createElement("small",{className:"marg-b-6"},this.props.data.description),r.a.createElement("div",{className:"grow-1 text-center"}))))}}]),n}(r.a.Component),Oa=q.slice().sort((function(e,t){return e.localeCompare(t)})),Ta=(r.a.Component,n(32),function(e){var t=fa((function(e){return e.world.alien.beliefInventory})),n=pa();return r.a.createElement(r.a.Fragment,null,t.map((function(t){return r.a.createElement(_a,{key:t.trait,data:L[t.trait],titleView:r.a.createElement("strong",null,L[t.trait].noun),leftButton:r.a.createElement(Ca,{onConfirm:function(){return n(Rn({beanKey:e.beanKey,trait:t.trait}))},className:"callout marg-0",confirmText:"-1 \ud83e\udde0?",disabled:t.charges<1||e.dogmatic},"Implant"),bottomView:r.a.createElement("span",null,t.charges," \ud83e\udde0")})})))}),Ba=function(){var e=fa(Na),t=fa((function(t){return null!=(null===e||void 0===e?void 0:e.key)&&t.world.alien.scanned_bean[e.key]})),n=fa((function(e){return e.world.alien.difficulty})),a=fa((function(e){return e.world.alien.techProgress})),i=pa(),l=xt(a,"sanity_bonus")?-1:0;if(null==e)return r.a.createElement("div",null);var c=it(e,"Dogmatism");return r.a.createElement("div",null,r.a.createElement("div",{className:"horizontal fancy-header"},r.a.createElement("div",null,"BRAIN"),r.a.createElement("div",{className:"emoji-3"},"\ud83e\udde0\ud83d\udebf"),r.a.createElement("div",null,"WASH")),r.a.createElement("div",null,r.a.createElement("p",{className:"pad-4p"},r.a.createElement("strong",null,e.name)," has ",e.discrete_sanity.toFixed(0)," sanity \ud83e\udde0.","stressed"===e.sanity||"disturbed"===e.sanity?r.a.createElement("small",{className:"pull-r"},"(Low sanity \ud83e\udde0 causes ",M.unhappiness,"; Negative sanity \ud83e\udde0 causes extremely negative traits)"):null),c?r.a.createElement("div",{className:"text-center"},"\ud83d\udc36 Dogmatic subjects cannot change their minds"):null,t?r.a.createElement("div",{className:"horizontal scroll"},r.a.createElement(Ma,{available:e.discrete_sanity,frozen:c,wash:function(){return i(Wn({beanKey:e.key,faith:e.faith}))},cost:n.cost.bean_brain.brainwash_ideal.sanity||0,data:G[e.faith]}),e.beliefs.map((function(t){return r.a.createElement(Ma,{key:t,available:e.discrete_sanity,frozen:c&&"Dogmatism"!=t,divergent:!1,wash:function(){return i(zn({beanKey:e.key,trait:t}))},cost:(n.cost.bean_brain.brainwash_secondary.sanity||0)+l,data:L[t]})}))):r.a.createElement("div",{className:"text-center"},"\ud83d\udef0\ufe0f Scan this subject to reveal its Traits! "),r.a.createElement("h3",{className:"pad-4p"},"\ud83e\udde0 Trait Inventory"),r.a.createElement("div",{className:"horizontal scroll"},r.a.createElement(Ta,{beanKey:e.key,dogmatic:c}))))},Pa=function(e){return r.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"+(e.additionalClasses||"")},e.options.map((function(t){return r.a.createElement("button",{type:"button",key:t.value,onClick:function(){return t.onClick()},className:e.active===t.value?"active":""},t.icon," ",t.text)})))},Aa=function(e){var t=fa((function(e){return e.world.titles.allIDs.reduce((function(t,n){return t.push(e.world.titles.byID[n]),t}),[])})),n=pa();return r.a.createElement("div",{className:"pad-4p"},r.a.createElement(Pa,{active:"titles",options:[{icon:"\ud83d\udc51",text:"Titles",value:"titles",onClick:function(){}},{icon:"\ud83d\udd16",text:"Names",value:"names",onClick:function(){}}]}),r.a.createElement("div",{className:"subheader"},r.a.createElement("h2",null,"Titles",r.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){n(na({}))}},"\u2795 Title"))),r.a.createElement("div",null,t.map((function(e){return r.a.createElement(Ga,{key:e.key,title:e,onEdit:function(e){n(aa({newT:e}))}})}))))},Ga=function(e){return r.a.createElement("div",{style:{border:"1px solid black",borderRadius:"10px",padding:"2px",display:"flex",width:"300px",flexDirection:"column"}},r.a.createElement("div",null,r.a.createElement("label",null,"Title:\xa0",r.a.createElement("input",{type:"text",value:e.title.name,onChange:function(t){return e.onEdit(Object(B.a)(Object(B.a)({},e.title),{},{name:t.target.value}))}}))),r.a.createElement("div",null,r.a.createElement("label",null,"Headwear:\xa0",r.a.createElement("select",{value:e.title.headwear,onChange:function(t){return e.onEdit(Object(B.a)(Object(B.a)({},e.title),{},{headwear:t.target.value}))}},r.a.createElement("option",{value:void 0},"None"),r.a.createElement("option",{value:"\ud83d\udc51"},"\ud83d\udc51"),r.a.createElement("option",{value:"\ud83d\udc52"},"\ud83d\udc52"),r.a.createElement("option",{value:"\ud83c\udfa9"},"\ud83c\udfa9"),r.a.createElement("option",{value:"\ud83c\udf93"},"\ud83c\udf93"),r.a.createElement("option",{value:"\ud83e\udde2"},"\ud83e\udde2"))),r.a.createElement("label",null,"\xa0Badge:\xa0",r.a.createElement("select",{value:e.title.badge,onChange:function(t){return e.onEdit(Object(B.a)(Object(B.a)({},e.title),{},{badge:t.target.value}))}},r.a.createElement("option",{value:void 0},"None"),r.a.createElement("option",{value:"\u2b50"},"\u2b50"),r.a.createElement("option",{value:"\ud83d\udee1\ufe0f"},"\ud83d\udee1\ufe0f"),r.a.createElement("option",{value:"\u2696\ufe0f"},"\u2696\ufe0f"),r.a.createElement("option",{value:"\ud83d\udccb"},"\ud83d\udccb"),r.a.createElement("option",{value:"\ud83c\udfc5"},"\ud83c\udfc5"),r.a.createElement("option",{value:"\ud83c\udf80"},"\ud83c\udf80"),r.a.createElement("option",{value:"\ud83c\udf38"},"\ud83c\udf38")))),r.a.createElement("h3",null,"Privileges",r.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){var t=e.title.privileges.slice();t.push(void 0),e.onEdit(Object(B.a)(Object(B.a)({},e.title),{},{privileges:t}))}},"\u2795 Privilege")),e.title.privileges.map((function(e,t){return r.a.createElement("div",null,r.a.createElement("select",{key:t,value:e,onChange:function(e){}},r.a.createElement("option",{value:void 0},"None"),r.a.createElement("option",{value:"tax_exemption"},"Social Deference"),r.a.createElement("option",{value:"tax_exemption"},"Criminal Immunity"),r.a.createElement("option",{value:"tax_exemption"},"Tax Exemption")))})))},La={state:"Collectivist",ego:"Independent",trad:"Elitist",prog:"Progressive",circle:"Brunette",square:"Blonde",triangle:"Redhead",rocket:"Futuristic",dragon:"Mythical",music:"Dramatic",noFaith:"Nihilistic",starving:"Starving",hungry:"Hungry",sated:"Sated",stuffed:"Stuffed",homeless:"Homeless",sleepy:"Sleepy",awake:"Awake",rested:"Rested",sick:"Sick",sickly:"Sickly",bruised:"Bruised",fresh:"Robust",sane:"Sane",stressed:"Confused",disturbed:"Disturbed",psychotic:"Psychotic",house:"House",hospital:"Hospital",farm:"Farm",theater:"Theater",church:"Church",courthouse:"Courthouse",park:"Park",nature:"Elysian Scenery"},qa=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a}return Object(o.a)(n,[{key:"header",value:function(){return this.props.children?r.a.createElement("b",null,this.props.children):null}},{key:"render",value:function(){var e=this,t=this.props.beans.filter((function(t){return e.props.need(t)==e.props.dire})).length,n={width:Math.floor(t/this.props.beans.length*100)+"%"},a=this.props.beans.filter((function(t){return e.props.need(t)==e.props.abundant})).length,i={width:Math.floor(a/this.props.beans.length*100)+"%"};return r.a.createElement("div",{className:this.props.className},this.header(),r.a.createElement("div",{className:"bar"},r.a.createElement("div",{className:"bar-inner dire",style:n},t>0?"".concat(t," ").concat(La[this.props.dire]):""),r.a.createElement("div",{className:"bar-inner abundant",style:i},a>0?a:"")))}}]),n}(r.a.Component);function Ha(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}var Fa=function(){var e=fa((function(e){return ya(e.world,0)})),t=fa((function(e){return e.world.economy})),n=Ha(e.map((function(e){return e.discrete_food}))),a=Ha(e.map((function(e){return e.discrete_health}))).toFixed(1),i=Ha(e.map((function(e){return e.discrete_stamina}))).toFixed(1),l=e.reduce((function(e,t){return e+t.cash}),0),c=l/(e.length||1),o=Ha(e.map((function(e){return e.cash}))),s=e.filter((function(e){return e.cash<1})).length,u=Math.max(c,o),d=e.filter((function(e){return e.cash>u})),m=d.length/(e.length||1)*100,y=d.reduce((function(e,t){return e+t.cash}),0)/l*100,p=e.reduce((function(e,t){return e[t.job]=(e[t.job]||0)+1,e}),{}),f=((p.jobless||0)/e.length*100).toFixed(1);function h(e,t){return e.supply+=t.quantity,e.price+=t.price,e.count++,e.avg=e.price/e.count,e}var b=t.market.listings.food.reduce(h,{supply:0,price:0,avg:0,count:0}),v=t.market.listings.medicine.reduce(h,{supply:0,price:0,avg:0,count:0}),g=t.market.listings.shelter.reduce(h,{supply:0,price:0,avg:0,count:0});return r.a.createElement("div",null,r.a.createElement("div",{className:"pad-4p"},r.a.createElement("h2",null,"State of the Utopia")),r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement("strong",null,"\ud83c\udf5e Food Security"),r.a.createElement(qa,{beans:e,need:function(e){return e.food},dire:"hungry",abundant:"stuffed",className:"big"}),r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Median ",n.toFixed(1)," \ud83c\udf5e"),r.a.createElement("td",{className:"text-center"},"Supply: ",b.supply," \ud83c\udf5e @ $",b.avg.toFixed(2)),r.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.food," \ud83c\udf5e"))))),r.a.createElement("div",null,r.a.createElement("strong",null,"\ud83e\ude7a Healthcare"),r.a.createElement(qa,{beans:e,need:function(e){return e.health},dire:"sick",abundant:"fresh",className:"big"}),r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Median ",a," \ud83e\ude7a"),r.a.createElement("td",{className:"text-center"},"Supply: ",v.supply," \ud83e\ude7a @ $",v.avg.toFixed(2)),r.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.medicine," \ud83e\ude7a")))))),r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement("strong",null,"\ud83c\udfe1 Housing")," ",r.a.createElement("br",null),r.a.createElement(qa,{beans:e,need:function(e){return e.stamina},dire:"homeless",abundant:"rested",className:"big"}),r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Median ",i," \ud83c\udfe1"),r.a.createElement("td",{className:"text-center"},"Supply: ",g.supply," \ud83c\udfe1 @ $",g.avg.toFixed(2)),r.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.shelter," \ud83c\udfe1")))))),r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement("strong",null,"\ud83d\udcb0 Wealth")," ",r.a.createElement("br",null),s," penniless citizens \xa0 \xa0 Cost of Living: $",Xe(t).toFixed(2)," ",r.a.createElement("br",null),r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Total $",l.toFixed(2)),r.a.createElement("td",{className:"text-center"},"Median: $",o.toFixed(2)),r.a.createElement("td",{className:"text-right"},"Avg: $",c.toFixed(2))))),"Top ",m.toFixed(1),"% of subjects own ",y.toFixed(1),"% of the wealth"),r.a.createElement("span",null,r.a.createElement("strong",null,"Unemployment")," ",f,"% (",p.jobless,")",r.a.createElement("br",null),r.a.createElement("ul",{className:"boxes"},r.a.createElement("li",null,p.farmer||0," farmers"),r.a.createElement("li",null,p.builder||0," builders"),r.a.createElement("li",null,p.doc||0," doctors"),r.a.createElement("li",null,p.entertainer||0," entertainers")))))},Ra=function(e){return r.a.createElement("div",null)},za=function(e){var t=fa((function(e){return e.world.law.cash}));return r.a.createElement("div",{className:"pad-4p"},r.a.createElement("div",null,r.a.createElement("strong",null,"\ud83d\udcb0 Treasury: ",t.toFixed(2))))},Wa=function(e){var t=Object(a.useState)("Welfare"),n=Object(Ct.a)(t,2),i=n[0],l=n[1];return r.a.createElement("div",null,r.a.createElement("div",{className:"col-2"},r.a.createElement("h2",{className:"marg-b-0"},"Utopia Government"),r.a.createElement("div",null,r.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"},r.a.createElement("button",{type:"button",onClick:function(){return l("Welfare")},className:"Welfare"===i?"active":""},"\ud83e\udd32 Welfare"),r.a.createElement("button",{type:"button",onClick:function(){return l("Crime")},className:"Crime"===i?"active":""},"\ud83d\udea8 Crime"),r.a.createElement("button",{type:"button",onClick:function(){return l("Taxation")},className:"Taxation"===i?"active":""},"\ud83d\udcb0 Taxes"),r.a.createElement("button",{type:"button",onClick:function(){return l("funds")},className:"funds"===i?"active":""},"\ud83d\udcb8 Funds")))),"funds"===i?r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement(za,null)),r.a.createElement("div",null)):r.a.createElement(Ua,{group:i}))},Ua=function(e){var t=Object.values(He).filter((function(t){return t.group===e.group})),n=fa((function(e){return e.world.alien.seenBeliefs})),a=fa((function(e){return e.world.alien.beliefInventory})),i=fa((function(e){return e.world.law})),l=pa();return r.a.createElement("div",{className:"pad-4p"},r.a.createElement("strong",null,e.group," Laws"),r.a.createElement("div",{className:"horizontal scroll"},t.map((function(e){return r.a.createElement(Ja,{seenBeliefs:n,id:e.key,beliefs:a,key:e.key,enacted:Fe(i,e.key),enactLaw:function(e){return l(ia({lawKey:e}))},revokeLaw:function(e){return l(la({lawKey:e}))}})}))))},Ja=function(e){var t,n,a=He[e.id],i=(t=a.prereqs,n=e.seenBeliefs,0===t.length||t.some((function(e){return Ge(e,n)}))),l=function(e,t){return 0===e.length||e.every((function(e){return Ge(e,t)}))}(a.prereqs,e.seenBeliefs);return r.a.createElement("div",{className:"vertical law-formula"},r.a.createElement("div",{className:"horizontal"},r.a.createElement("div",{className:"circular"},i?a.icon:"\u2754"),r.a.createElement("div",null,r.a.createElement("strong",null,i?a.name:"Unknown"),r.a.createElement("div",null,i?r.a.createElement("small",null," ",a.description," "):null))),r.a.createElement("div",{className:"vertical"},a.prereqs.map((function(t){var n,a=Ge(t,e.seenBeliefs),i=(n=t,Array.isArray(n)?n.join("/"):n);return a?r.a.createElement("span",{className:"law-formula-ingredient",key:i},function(e){return Array.isArray(e)?e.map((function(e){return qe(e)})).join(" / "):qe(e)}(t)):r.a.createElement("span",{className:"law-formula-ingredient unknown",key:i},"\u2754 Unknown")}))),e.enacted?r.a.createElement("button",{className:"callout",onClick:function(){return e.revokeLaw(e.id)}},"\ud83d\uddd1\ufe0f\xa0Revoke Active Law"):r.a.createElement("button",{className:"callout",disabled:!l,onClick:function(){return e.enactLaw(e.id)}},l?"\u2712\ufe0f":r.a.createElement("span",{className:"grey"},"\ud83d\udd12"),"\xa0Enact"),e.children)},Za=function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement("h3",null,"Welcome to the"),r.a.createElement("h2",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Laboratory"),r.a.createElement("div",null,"Thank you for joining the ",r.a.createElement("select",null,r.a.createElement("option",null,"Human"))," Cultivation Division of the ",r.a.createElement("strong",null,"\ud83c\udf0c\xa0Galactic Xenosensation Federation!")," Interdimensional petri dish ",r.a.createElement("span",{style:{whiteSpace:"nowrap"}},"#",r.a.createElement("input",{type:"text",value:e.seed,onChange:function(t){return e.changeSeed(t.currentTarget.value)},maxLength:19,style:{width:"115px",fontFamily:"monospace",fontSize:"11px"}}))," is ready for farming."),r.a.createElement("p",null,"As a ",r.a.createElement("select",null,r.a.createElement("option",null,"Human Emotion Farmer")),", you are required to execute the following duties:"),r.a.createElement("ul",null,r.a.createElement("li",null,"Construct ",r.a.createElement("strong",null,"\ud83c\udfe0 Buildings")," for your ",r.a.createElement("select",null,r.a.createElement("option",null,"Human"))," subjects."),r.a.createElement("li",null,r.a.createElement("strong",null,"\ud83d\udef8 Beam In")," ",r.a.createElement("select",null,r.a.createElement("option",null,"Human"))," subjects for cultivation."),r.a.createElement("li",null,"Harvest your subject's positive ",r.a.createElement("strong",null,M.happiness," Hedons"),"."),r.a.createElement("li",null,"Sell the Hedons on the ",r.a.createElement("br",null),r.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market"),".")),r.a.createElement("div",null)),r.a.createElement("div",null,r.a.createElement("p",null,"The GXF's records indicate ",r.a.createElement("select",null,r.a.createElement("option",null,"Humans"))," are a",r.a.createElement("br",null),r.a.createElement("u",null,"mentally malleable")," and ",r.a.createElement("u",null,"physically fragile")," species. Try the following cultivation methods:"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("strong",null,"\ud83d\udef0\ufe0f Scan")," your subject's primitive minds for information on what pleases them."),r.a.createElement("li",null,r.a.createElement("strong",null,"\ud83d\udebf Brainwash")," subjects to change their ",r.a.createElement("strong",null,"\ud83e\udde0\xa0Traits"),". Try to add Traits that emit more ",r.a.createElement("strong",null,M.happiness,"\xa0Hedons"),"."),r.a.createElement("li",null,"Avoid letting your subjects die or endure pain; this makes ",r.a.createElement("strong",null,M.unhappiness,"\xa0Antihedons")," which are less profitable."),r.a.createElement("li",null,"Use your knowledge of Traits to modify the farm's ",r.a.createElement("strong",null,"\ud83d\uddf3\ufe0f\xa0Government")," to maximize Hedon generation."),r.a.createElement("li",null,"Use the GXF's ",r.a.createElement("strong",null,"\ud83e\uddea Research Lab")," to upgrade your farm, when stocked with ",r.a.createElement("strong",null,"\ud83d\udc7e Abducted")," subjects.")),r.a.createElement("h3",null,"\ud83c\udf0c Galactic Xenosensation Federation ",r.a.createElement("br",null),r.a.createElement("div",{className:"text-right"},r.a.createElement("small",null,r.a.createElement("i",null,"1 trillion sensations. 100% organic. 100% gourmet.")))))))},Va=function(e){return r.a.createElement("div",null)},$a=function(e){var t=Object(a.useState)("main"),n=Object(Ct.a)(t,2),i=n[0],l=n[1],c=h.HasContinueGame(),o=h.GetGameSlots();return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center"},"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),"main"===i?r.a.createElement("div",null,null!=c?r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.loadGame(c)}},"\ud83e\uddeb Continue Game")):null,r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.startGame()}},"\ud83d\udef8 Start New Game")),r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return l("showslots")},disabled:o.every((function(e){return null==e.brief}))},"\ud83d\uddc2\ufe0f Load Game"))):r.a.createElement("div",{className:"card-parent vertical load-menu pad-4p"},o.map((function(t){return r.a.createElement("div",{key:t.id,className:"card marg-b-20"},r.a.createElement("button",{disabled:null==t.brief,className:"",onClick:function(){t.brief&&e.loadGame(t.id)}},t.brief?r.a.createElement("span",{className:"f-size-125em"},r.a.createElement("strong",null,t.brief.Name),"\xa0",r.a.createElement("span",null,"Year ",t.brief.Age.year),"\xa0",r.a.createElement("span",null,t.brief.Population," \ud83d\ude10")):r.a.createElement("span",{className:"f-size-125em"},"Slot ",t.id)))}))))},Xa=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("svg",{width:"100",height:"300",xmlns:"http://www.w3.org/2000/svg",style:{},className:this.props.classN+" robot-arm"},r.a.createElement("g",null,r.a.createElement("title",null,"robotarm"),r.a.createElement("rect",{fill:"transparent",id:"canvas_background",height:"302",width:"102",y:"-1",x:"-1"}),r.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},r.a.createElement("rect",{fill:"url(#gridpattern)",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),r.a.createElement("g",null,r.a.createElement("title",null,"Layer 1"),r.a.createElement("rect",{id:"svg_2",height:"200",width:"48",y:"91.63545",x:"25",strokeWidth:"1.5",stroke:"#000",fill:"#BBBBBB"}),r.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_1",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),r.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_3",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"}),r.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_4",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),r.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_5",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"},this.props.tool)),r.a.createElement("text",{y:"250",x:"-20",fontSize:"4em"},this.props.tool))}}]),n}(r.a.Component);n(33);var Ya=["\ud83d\udce1","\ud83d\udddc\ufe0f","\ud83d\udd2c","\ud83d\udc89","\ud83d\udd0e","\ud83e\uddfc","\ud83e\uddf2","\ud83c\udfa5","\ud83d\udd27"];function Qa(e){var t=e+1;return t===Ya.length&&(t=0),t}var er=function(){var e=fa((function(e){return e.world.alien.abductedBeanKeys})),t=fa((function(e){return e.world.alien.techProgress})),n=fa((function(e){return e.world.alien.currentlyResearchingTech})),i=pa(),l=Object(a.useState)(0),c=Object(Ct.a)(l,2),o=c[0],s=c[1],u=Object(a.useState)(3),d=Object(Ct.a)(u,2),m=d[0],y=d[1],p=Object(a.useState)(2),f=Object(Ct.a)(p,2),h=f[0],b=f[1],v=Object(a.useState)(1),g=Object(Ct.a)(v,2),E=g[0],k=g[1];Object(a.useEffect)((function(){var e=window.setInterval((function(){Math.random()<.51&&s(Qa(o)),Math.random()<.51&&y(Qa(m)),Math.random()<.51&&b(Qa(h)),Math.random()<.51&&k(Qa(E))}),1e3);return function(){window.clearInterval(e)}}));var w=Object.values(kt);return r.a.createElement("div",null,r.a.createElement("div",{className:"col-2"},r.a.createElement("div",null,r.a.createElement("h2",null,"Research \ud83e\uddea Lab"),r.a.createElement("div",{className:"vertical"},w.map((function(e){return function(e,t,n,a){var i=null==t[e.tech]?0:t[e.tech].researchPoints,l=e.techPoints,c={width:Math.min(i/l*100,100)+"%"},o=i>=l,s=n===e.tech,u=o?"\u2705":s?"\ud83d\udd2c":"\u2b55\ufe0f",d=s?"active":"inactive";return r.a.createElement("div",{className:"card-parent "+d,key:e.tech},r.a.createElement("button",{className:"card button",onClick:function(){return a(e.tech)}},r.a.createElement("strong",null,e.name),r.a.createElement("strong",{className:"pull-r f-size-125em"},u),r.a.createElement("div",null,e.description),r.a.createElement("div",{className:"bar f-size-12 h-12"},r.a.createElement("div",{className:"bar-inner text-center",style:c}),i,"/",l," tech")))}(e,t,n,(function(e){return i(ca({t:e}))}))})))),r.a.createElement("div",{className:"vertical"},r.a.createElement("div",null,r.a.createElement("div",{className:"robot"},"\ud83e\udd16",r.a.createElement(Xa,{classN:"far-left",tool:Ya[o]}),r.a.createElement(Xa,{classN:"left",tool:Ya[m]}),r.a.createElement(Xa,{classN:"near-right",tool:Ya[h]}),r.a.createElement(Xa,{classN:"far-right",tool:Ya[E]}))),r.a.createElement("div",{className:"h-42em"},e.map((function(e){return r.a.createElement("span",{key:e,className:"victim bean triangle shake"},"\ud83d\ude28")}))),r.a.createElement("div",{className:"text-center"},"Currently probing ",e.length," beings for ",e.length," tech a day",r.a.createElement("p",null,r.a.createElement("small",null,"1 tech per research subject per day"))),e.length>0?r.a.createElement("div",{className:"text-right"},r.a.createElement(Ca,{className:"callout",onConfirm:function(){i(Ln())},confirmText:"-1 Research Subject?"},"\ud83c\udf88 Release Research Subject")):null)),r.a.createElement("div",null))},tr=function(){var e=fa((function(e){return e.world.alien.beliefInventory})),t=fa((function(e){return e.world.alien.seenBeliefs})),n=Object(a.useState)(),i=Object(Ct.a)(n,2),l=(i[0],i[1],[]);return Object.keys(t).forEach((function(e){null!=L[e]&&l.push(L[e])})),l.sort((function(e,t){return e.noun.localeCompare(t.noun)})),r.a.createElement("div",{className:"vertical"},r.a.createElement("div",{className:"pad-4p"},r.a.createElement("h2",null,"Subject \ud83e\udde0 Traits")),r.a.createElement("div",{className:"col-2-30-60"},r.a.createElement("div",null,r.a.createElement("div",{className:"scroll"},r.a.createElement("div",{className:"scoll-sticky-h"},r.a.createElement("strong",null,"Trait Inventory")),e.length<1?r.a.createElement("div",null,"No Traits! ",r.a.createElement("br",null),"\ud83d\ude35 Brainwash your subjects  ",r.a.createElement("br",null),"or buy from the \ud83d\udecd\ufe0f Market"):e.map((function(e){return r.a.createElement("div",{key:e.trait},r.a.createElement("div",null,r.a.createElement("strong",null,L[e.trait].icon," ",L[e.trait].noun)),r.a.createElement("div",null,"This can be implanted ",e.charges," more times"))})))),r.a.createElement("div",null,r.a.createElement("div",{className:"modal-scroll-v"},r.a.createElement("div",{className:"sticky-t-0"},r.a.createElement("strong",null,"Discovered ",l.length," of ",q.length," Traits")),l.length<1?r.a.createElement("div",null,"No Traits! ",r.a.createElement("br",null),"\ud83d\udef0\ufe0f Scan some of your subjects."):l.map((function(e){return r.a.createElement(_a,{key:e.noun,data:e,cost:0,titleView:r.a.createElement("strong",null,e.noun),bottomView:r.a.createElement("span",null)})}))))))},nr=function(e){var t=Object(a.useState)(!1),n=Object(Ct.a)(t,2),i=n[0],l=n[1],c=fa((function(t){return t.world.cities.byID[e.cityKey]})),o=fa((function(t){return t.world.ufos.byID[e.ufoKey]}));Object(a.useEffect)((function(){setTimeout((function(){l(!0),pn.play("teleport"),setTimeout((function(){l(!1)}),1800)}),1800)}),[]);var s=Object(B.a)({},se(ce(c.hex_size,c.petriOrigin,o.point)));return r.a.createElement("span",{style:s,className:"ufo"},"\ud83d\udef8",i?r.a.createElement("span",{className:"beam"}):null)},ar=["company","co-op","commune"],rr={company:"\ud83c\udfa9","co-op":"\ud83e\udd1d",commune:"\u2692\ufe0f"},ir=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("small",null,kn(this.props.cost,"-",this.props.qty)," ",this.props.rider)}}]),n}(r.a.Component),lr=function(e){var t=pa();return r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return t(An({cityKey:e.city,where:e.hex}))}},"\ud83d\udef8 Beam In New Subject",r.a.createElement(ir,{cost:e.difficulty.cost.hex.beam,rider:"+Subject"})))},cr=function(e){var t,n,a=fa((function(t){return e.district.lots.map((function(e){return t.world.lots.byID[e]}))})),i=null!==(t=e.selectedLotKey)&&void 0!==t?t:null===(n=a.find((function(e){return null==e.buildingKey})))||void 0===n?void 0:n.key,l=pa(),c=e.difficulty.cost.emptyHex;return null!=i?r.a.createElement("div",null,r.a.createElement("h3",null,"Build:"),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(On({city:e.cityKey,lot:i,what:"house"}))}},ue.house," House",r.a.createElement(ir,{cost:c.build.house}))),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(On({city:e.cityKey,lot:i,what:"farm"}))}},ue.farm," Farm",r.a.createElement(ir,{cost:c.build.farm})),r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(On({city:e.cityKey,lot:i,what:"hospital"}))}},ue.hospital," Hospital",r.a.createElement(ir,{cost:c.build.hospital}))),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(On({city:e.cityKey,lot:i,what:"theater"}))}},ue.theater," Theater",r.a.createElement(ir,{cost:c.build.theater})),r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(On({city:e.cityKey,lot:i,what:"park"}))}},ue.park," Park",r.a.createElement(ir,{cost:c.build.park})))):r.a.createElement("div",null)},or={urban:"\u26f2",rural:"\ud83d\udcea",fallow:"\ud83c\udf33",nature:"\ud83c\udfd4\ufe0f"},sr={urban:"Urban",rural:"Rural",fallow:"Empty",nature:"Nature"},ur=function(e){var t=Object(d.c)((function(e){return e.selected.selectedDistrictKey})),n=fa((function(e){return null!=t?e.world.districts.byID[t]:void 0})),a=fa((function(e){return e.selected.selectedLotKey})),i=Object(d.c)(Sa),l=Object(d.c)(Ka),c=pa();return l&&null==n?r.a.createElement("div",null):l&&i&&n?r.a.createElement(dr,{building:i,city:l,hex:n,difficulty:e.difficulty}):l&&n?r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("strong",null,or[n.kind]," ",sr[n.kind]," District")," in ",r.a.createElement("strong",null,l.name),r.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return c(ka({cityKey:l.key}))}},"\u274c")),null!=a?r.a.createElement("span",null,"Lot #",a+1):r.a.createElement("br",null),"fallow"===n.kind?r.a.createElement("div",null,r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return c(In({city:l.key,district:n.key}))}},"\ud83d\udea7 Develop",r.a.createElement(ir,{cost:e.difficulty.cost.hex.fallow_2_rural})))):"rural"===n.kind?r.a.createElement("div",null,r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return c(In({city:l.key,district:n.key}))}},"\ud83c\udfd7\ufe0f Urbanize",r.a.createElement(ir,{cost:e.difficulty.cost.hex.rural_2_urban})))):null,r.a.createElement(cr,{cityKey:l.key,district:n,selectedLotKey:a,difficulty:e.difficulty}),r.a.createElement("h3",null,"Beings:"),r.a.createElement(lr,{difficulty:e.difficulty,hex:n,city:l.key})):r.a.createElement("div",null)},dr=function(e){var t,n=e.building,a=fa((function(e){return null!=n.enterpriseKey?e.world.enterprises.byID[n.enterpriseKey]:void 0})),i=pa(),l=_t(n),c="park"!=n.type&&"nature"!=n.type;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("strong",null,n.upgraded&&c?"Dense ":"Small ",La[n.type]),r.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return i(ga())}},"\u274c")),r.a.createElement("div",{className:"text-right"},r.a.createElement("small",null,"in\xa0",r.a.createElement("strong",null,e.city.name))),null!=a?r.a.createElement("div",null,r.a.createElement("small",null,"$",null===(t=a.cash)||void 0===t?void 0:t.toFixed(2)," from sales today"),r.a.createElement(fr,{enterpriseKey:a.key,good:ye[n.type]})):null,n.upgraded&&c?r.a.createElement("div",null,mr(n.type)):null,null!=a?r.a.createElement(pr,{enter:a,changeEnterprise:function(e){return i(Tn({enterpriseKey:n.key,newType:e}))}}):null,r.a.createElement(yr,{cityKey:e.city.key,building:n}),c?r.a.createElement("div",null,"This ",La[n.type]," can support ",l.length," more jobs.",n.upgraded?null:r.a.createElement("span",null,r.a.createElement("br",null),"Upgrade it to add 3 more job slots.")):null,n.upgraded||!c?null:r.a.createElement("div",null,r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",type:"button",onClick:function(){return i(Pn({buildingKey:n.key}))}},"\ud83d\udee0\ufe0f Upgrade",r.a.createElement(ir,{cost:e.difficulty.cost.hex.upgrade}))),mr(n.type)),r.a.createElement(lr,{city:e.city.key,difficulty:e.difficulty,hex:e.hex}))},mr=function(e){return"house"===e?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"text-center"},r.a.createElement("small",null,"\ud83d\udc2e Parochial subjects may emit \ud83d\udc4e",r.a.createElement("br",null),"when living in dense buildings")),r.a.createElement("div",{className:"text-center"},r.a.createElement("small",null,"\ud83c\udf78 Cosmopolitan subjects may emit \ud83d\udc4e",r.a.createElement("br",null),"when living in small buildings"))):r.a.createElement("div",null)},yr=function(e){var t=pa(),n=fa((function(t){return e.building.jobs.map((function(e){return t.world.beans.byID[e]}))})),a=fa((function(t){return t.world.enterprises.byID[e.building.key]}));return n.length<0?r.a.createElement("div",null,"No Workers"):r.a.createElement("div",null,r.a.createElement("strong",null,"Workers:"),n.map((function(n){return r.a.createElement("div",{key:n.key},me[e.building.type]," ",n.name," ",a&&"company"===a.enterpriseType&&n.key===a.ownerBeanKey?"\ud83c\udfa9":"",r.a.createElement("button",{title:"Fire",className:"callout marg-0",onClick:function(){return n?t(Bn({cityKey:e.cityKey,beanKey:n.key})):null}},"\ud83d\udd25"))})))},pr=function(e){var t=ar.map((function(t){return{icon:rr[t],text:t[0].toUpperCase()+t.substring(1),value:t,onClick:function(){e.changeEnterprise(t)}}}));return r.a.createElement(Pa,{active:e.enter.enterpriseType,options:t})},fr=function(e){var t=fa((function(t){return t.world.economy.market.listings[e.good]}));return r.a.createElement("div",null,t.filter((function(t){return t.sellerEnterpriseKey===e.enterpriseKey})).map((function(t,n){return r.a.createElement("div",{key:n},t.quantity," ",_[e.good]," @ $",t.price.toFixed(2))})))};n(34);var hr={2:0,0:1,4:2,1:3,5:4,3:5},br={farm:"\ud83e\ude95",house:"\ud83e\uddf9",hospital:"\ud83e\ude7a",church:"",theater:"\ud83d\udc58",courthouse:"\ud83d\udcbc",park:"\ud83c\udf92",nature:"\ud83c\udf92"},vr=function(e){var t=fa((function(t){return t.world.economy.market.listings[e.goodType].filter((function(t){return t.sellerEnterpriseKey===e.enterpriseKey})).reduce((function(e,t){return e+t.quantity}),0)}));if(t<1)return null;for(var n=[],a=0;a<t;a++)n.push({row:Math.floor(a/2),col:a%2});return r.a.createElement(r.a.Fragment,null,n.map((function(t,n){return r.a.createElement("text",{x:270+-12*t.col+"px",y:85+-12*t.row+"px",style:{fontSize:"11px"},key:n},_[e.goodType])})))},gr=function(e){var t=fa((function(t){return t.world.lots.byID[e.lotKey]})),n=fa((function(e){return null!=t.buildingKey?e.world.buildings.byID[t.buildingKey]:void 0}));return n?r.a.createElement(r.a.Fragment,null,r.a.createElement("text",{x:"280px",y:"77.859px",style:{fontSize:"36px"}},n.upgraded?de[n.type]:ue[n.type]),n.jobs.filter((function(e){return null!=e})).map((function(e,t){return r.a.createElement("text",{x:"325px",y:85+-14*t+"px",style:{fontSize:"11px"},key:e},br[n.type])})),null!=n.enterpriseKey?r.a.createElement(vr,{enterpriseKey:n.enterpriseKey,goodType:ye[n.type]}):null):r.a.createElement("text",{x:"280.931px",y:"77.859px",style:{fontSize:"36px"}},"rural"===t.kind?"\ud83c\udf3c":"\ud83d\ude8f")},Er=function(e){return r.a.createElement("div",{key:e.building.type+e.building.key,style:e.style,className:"building "+e.building.type},e.building.upgraded?de[e.building.type]:ue[e.building.type],r.a.createElement(kr,{building:e.building,getStyle:e.getStyle}),e.children)},kr=function(e){return r.a.createElement(r.a.Fragment,null,W.map((function(t,n){var a=hr[n],i=null!=e.building.jobs[a];return r.a.createElement("span",{key:n,className:"slot",style:e.getStyle(t)},i?me[e.building.type]:null)})))},wr=function(e){var t=pa(),n=fa((function(t){return t.selected.selectedLotKey===e.lotKey}));return r.a.createElement("g",{className:"lot "+e.className+(n?" selected":""),transform:"matrix(1.21104,0,0,0.901051,-221.832,-145.114)",onClick:function(n){return t(xa({cityKey:e.cityKey,district:e.districtKey,lot:e.lotKey})),n.preventDefault(),!1}},r.a.createElement("path",{d:e.lotDrawn}))},xr=function(e){var t=pa(),n=fa((function(t){return t.world.districts.byID[e.districtKey]})),a=fa((function(t){return t.selected.selectedDistrictKey===e.districtKey}))?"hex-selected":"";return r.a.createElement("div",{className:"hex "+a,key:e.districtKey,style:Object(B.a)(Object(B.a)({},Or),se(n.point)),onMouseEnter:function(a){t(Sn({cityKey:e.cityKey,px:n.point}))},onClick:function(n){if(!n.isDefaultPrevented())return t(va({cityKey:e.cityKey,district:e.districtKey})),n.stopPropagation(),!1}},r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 104 120",version:"1.1",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",left:"0%",top:"0%",opacity:.5},className:"svg-hex"},r.a.createElement("g",{transform:"matrix(1,0,0,1,-233.288,0)"},"fallow"===n.kind?r.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},r.a.createElement("g",{id:"circle",transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},r.a.createElement("circle",{className:"district-circle",cx:"285.248",cy:"60.588",r:"17.271"})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},"\ud83c\udf33"))):"rural"===n.kind?r.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},r.a.createElement("g",{transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},r.a.createElement("path",{className:"district-circle",d:"M285.25,0L285.251,43.341M300.181,69.173L337.211,89.968L300.181,69.173ZM270.408,69.173L233.288,90.21M285.248,43.317C294.78,43.317 302.519,51.056 302.519,60.588C302.519,70.12 294.78,77.859 285.248,77.859C275.716,77.859 267.977,70.12 267.977,60.588C267.977,51.056 275.716,43.317 285.248,43.317Z"})),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_3",lotKey:n.lots[2],lotDrawn:"M43.3,112.51L43.301,142.954L43.3,142.954C35.334,142.954 28.868,149.421 28.868,157.387C28.868,160.061 29.596,162.566 30.866,164.714L6.474,178.584C2.37,171.965 0,164.162 0,155.81C0,131.912 19.402,112.51 43.3,112.51L43.3,112.51Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_2",lotKey:n.lots[1],lotDrawn:"M55.735,164.713L80.126,178.583C72.489,190.9 58.846,199.11 43.3,199.11C27.754,199.11 14.111,190.9 6.474,178.584L30.866,164.714C33.378,168.965 38.009,171.819 43.3,171.819C48.592,171.819 53.223,168.964 55.735,164.713ZM0,155.81C0,155.81 0,155.81 0,155.81Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_1",lotKey:n.lots[0],lotDrawn:"M43.3,112.51C67.198,112.51 86.6,131.912 86.6,155.81C86.6,164.162 84.23,171.965 80.126,178.583L55.735,164.713C57.004,162.564 57.732,160.06 57.732,157.387C57.732,149.421 51.266,142.954 43.301,142.954L43.3,112.51Z"}),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,-46.211)"},r.a.createElement(gr,{lotKey:n.lots[0]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,1.20645)"},r.a.createElement(gr,{lotKey:n.lots[1]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-323.46,-21.9919)"},r.a.createElement(gr,{lotKey:n.lots[2]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"36.631px"}},"\ud83d\udcea"))):"urban"===n.kind?r.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,-46.211)"},r.a.createElement(gr,{lotKey:n.lots[0]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-253.016,-21.9919)"},r.a.createElement(gr,{lotKey:n.lots[1]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,1.20645)"},r.a.createElement(gr,{lotKey:n.lots[2]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-306.821,1.20645)"},r.a.createElement(gr,{lotKey:n.lots[3]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-323.46,-21.9919)"},r.a.createElement(gr,{lotKey:n.lots[4]})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-306.821,-46.211)"},r.a.createElement(gr,{lotKey:n.lots[5]})),r.a.createElement("g",{transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},r.a.createElement("path",{className:"district-circle",d:"M285.25,0L285.251,43.341M300.181,69.173L337.211,89.968L300.181,69.173ZM270.408,69.173L233.288,90.21M285.248,43.317C294.78,43.317 302.519,51.056 302.519,60.588C302.519,70.12 294.78,77.859 285.248,77.859C275.716,77.859 267.977,70.12 267.977,60.588C267.977,51.056 275.716,43.317 285.248,43.317Z"})),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_9",lotKey:n.lots[5],lotDrawn:"M5.135,135.352C12.441,121.76 26.798,112.51 43.3,112.51L43.3,112.51L43.301,142.954L43.3,142.954C37.962,142.954 33.298,145.858 30.801,150.17L5.135,135.352Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_8",lotKey:n.lots[4],lotDrawn:"M5.158,135.317L30.861,150.068C29.594,152.215 28.868,154.717 28.868,157.387C28.868,160.061 29.596,162.566 30.866,164.714L6.474,178.584C2.37,171.965 0,164.162 0,155.81C0,148.284 1.774,141.487 5.158,135.317Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_7",lotKey:n.lots[3],lotDrawn:"M43.3,171.819L43.3,199.11C27.754,199.11 14.111,190.9 6.474,178.584L30.866,164.714C33.378,168.965 38.009,171.819 43.3,171.819ZM0,155.81C0,155.81 0,155.81 0,155.81Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_6",lotKey:n.lots[2],lotDrawn:"M43.3,171.819C48.592,171.819 53.223,168.964 55.735,164.713L80.126,178.583C72.489,190.9 58.846,199.11 43.3,199.11L43.3,171.819Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_5",lotKey:n.lots[1],lotDrawn:"M81.453,135.317C84.837,141.487 86.6,148.284 86.6,155.81C86.6,164.162 84.23,171.965 80.126,178.583L55.735,164.713C57.004,162.564 57.732,160.06 57.732,157.387C57.732,154.717 57.006,152.215 55.739,150.068L81.453,135.317Z"}),r.a.createElement(wr,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_4",lotKey:n.lots[0],lotDrawn:"M55.725,150.044C53.211,145.801 48.585,142.954 43.301,142.954L43.3,112.51C59.792,112.51 74.143,121.75 81.453,135.331L55.725,150.044Z"}),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},0===n.q&&0===n.r?"\ud83c\udfeb":"\u26f2"))):r.a.createElement("g",{transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},r.a.createElement("g",{id:"circle",transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},r.a.createElement("circle",{className:"district-circle",cx:"285.248",cy:"60.588",r:"17.271"})),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},or.nature)),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"270px",y:"-20px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f")),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"180.931px",y:"147.859px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f")),r.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},r.a.createElement("text",{x:"365.931px",y:"147.859px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f"))))),e.children)},Dr=function(e){fa((function(t){return t.world.cities.byID[e.cityKey]}));var t=fa((function(t){var n;return null===(n=t.world.cities.byID[e.cityKey])||void 0===n?void 0:n.districtKeys}));return r.a.createElement(r.a.Fragment,null,t.map((function(t,n){return r.a.createElement(xr,{cityKey:e.cityKey,key:t,districtKey:t})})))},Kr=function(e){var t=fa((function(t){return function(e,t){return function(e,t){return e.cities.byID[t].buildingKeys}(e,t).reduce((function(t,n){return t.push(e.buildings.byID[n]),t}),[])}(t.world,e.city.key)}));return r.a.createElement(r.a.Fragment,null,t.map((function(t){return r.a.createElement("div",{key:t.key,className:"building-node",onClick:function(){return e.onClickBuilding(t)}},r.a.createElement(Er,{building:t,style:{},getStyle:function(){return{}}}))})))},Nr=function(e){Object(a.useRef)(null);var t=fa((function(t){return t.world.cities.byID[e.cityKey].pickupMagnetPoint}));return t?r.a.createElement("div",{className:"magnet",style:{transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}},"\ud83e\uddf2"):null};function Sr(e){return"buy"==e.actionData.act}var jr=function(e){var t=fa((function(t){return function(e,t){var n=e.world.beans.byID[t],a="work"===n.actionData.act;return{speech:ut(n),face:yt(n),good:Sr(n)?_[n.actionData.good||"food"]:void 0,classes:[n.job,n.ethnicity,"travel"!=n.actionData.act||"dead"===n.lifecycle?"paused":""].join(" "),animationClasses:["bean-walker",a?"spin":""].join(" "),badge:n.badge,hat:n.hat}}(t,e.beanKey)})),n=fa((function(t){return t.selected.selectedBeanKey===e.beanKey})),a=["bean interactable",t.classes,e.sitStill?"":t.animationClasses,n?"selected":""].join(" "),i=pa();return r.a.createElement("span",{className:a,onClick:function(t){t.stopPropagation(),i(Ea({cityKey:e.cityKey,beanKey:e.beanKey}))}},t.badge?r.a.createElement("span",{className:"badge "+t.badge},t.badge):null,t.face," ",t.good?r.a.createElement("span",{className:"purchase"},r.a.createElement("span",{className:"money"},"\ud83d\udcb8"),r.a.createElement("span",{className:"purchase-good"},t.good)):null," ",t.speech?r.a.createElement("span",{className:"speech"},r.a.createElement("span",{className:""},t.speech)):null,t.hat?r.a.createElement("span",{className:"hat "+t.hat},t.hat):null)},Cr=function(e){var t=Object(a.useState)(!1),n=Object(Ct.a)(t,2),i=n[0],l=n[1],c=fa((function(t){return t.world.pickups.byID[e.pickupKey]})),o=r.a.useContext(si);return Object(a.useEffect)((function(){!i&&o&&(o.play("drop"),l(!0))})),r.a.createElement("span",{className:"pickup bob"},M[c.type])},Ir=function(e){var t=r.a.useContext(ui),n=Object(a.useRef)(null),i=function(e){n.current&&e&&(n.current.style.transform="translate(".concat(e.point.x,"px, ").concat(e.point.y,"px)"))};return Object(a.useEffect)((function(){var n=t.Get(e.moverType,e.moverKey);return n.subscribe(i),n.current&&i(n.current),function(){return t.Get(e.moverType,e.moverKey).unsubscribe(i)}}),[]),r.a.createElement("div",{ref:n},e.children)},_r=function(e){var t=fa((function(t){return ma(t.world,e.cityKey)}));return r.a.createElement(r.a.Fragment,null,t.map((function(t){return r.a.createElement(Ir,{moverKey:t,key:t,moverType:"bean"},r.a.createElement(jr,{cityKey:e.cityKey,beanKey:t}))})))},Mr=function(e){var t=fa((function(t){return t.world.cities.byID[e.cityKey].pickupKeys}));return r.a.createElement(r.a.Fragment,null,t.map((function(e){return r.a.createElement(Ir,{moverKey:e,key:e,moverType:"pickup"},r.a.createElement(Cr,{pickupKey:e}))})))},Or={width:"260px",height:"260px",top:"-130px",left:"-130px"},Tr=function(e){for(var t=fa((function(t){return t.world.cities.byID[e.cityKey]})),n=fa((function(t){return t.world.cities.byID[e.cityKey].ufoKeys})),a=(fa((function(e){return e.world.spotlightEvent})),fa((function(e){if(e.world.spotlightEvent&&e.world.spotlightEvent.beanKey)return e.world.beans.byID[e.world.spotlightEvent.beanKey]})),pa()),i=[],l=t.petriRadius-20,c=0;c<72;c++){var o=oe({r:l,az:5*c*Math.PI/180});o.x+=t.petriRadius,o.y+=t.petriRadius,i.push(se(o))}t.deadBeanKeys.map((function(e,t){return r.a.createElement("span",{key:t,className:"dead",style:{left:10*t+"px"}},"\u26b0\ufe0f")}));var s={height:2*t.petriRadius+"px",width:2*t.petriRadius+"px"};return r.a.createElement("div",{className:"tile",onClick:function(){return e.onClick()},onMouseLeave:function(){a(Sn({cityKey:t.key}))},style:s},r.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-base"},r.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 1)"})),r.a.createElement(Dr,{cityKey:t.key}),i.map((function(e,t){return r.a.createElement("span",{key:t,style:e,className:"mtn"},"\u26f0\ufe0f")})),r.a.createElement(Mr,{cityKey:e.cityKey}),r.a.createElement(_r,{cityKey:e.cityKey}),n.map((function(e,n){return r.a.createElement(nr,{ufoKey:e,key:e,cityKey:t.key})})),r.a.createElement(Nr,{cityKey:e.cityKey}),r.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-lid"},r.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 0.2)"})))},Br=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t="card button";return this.props.thin&&(t+=" thin"),this.props.singleLine&&(t+=" single"),r.a.createElement("button",{className:t,title:this.props.title,onClick:function(){e.props.onClick&&e.props.onClick()},type:"button",disabled:this.props.disabled},this.props.icon," ",this.props.name,null!=this.props.subtext?r.a.createElement("small",null,this.props.subtext):null)}}]),n}(r.a.Component);function Pr(e,t,n){switch(t){case"trad":case"prog":case"ego":case"state":return r.a.createElement(Br,{icon:S[t],title:A[t].description,name:"",subtext:La[t],thin:!0,singleLine:!0,onClick:n});case"fresh":case"sick":case"hungry":case"starving":case"stuffed":case"homeless":case"rested":case"circle":case"square":case"triangle":case"sane":case"disturbed":case"stressed":return r.a.createElement(Br,{icon:S[t],title:La[t],name:"",subtext:La[t],thin:!0,singleLine:!0,onClick:n});case"noFaith":case"rocket":case"dragon":case"music":return r.a.createElement(Br,{icon:S[t],title:G[t].description,name:"",subtext:La[t],thin:!0,singleLine:!0,onClick:n});default:return null}}n(35);function Ar(e,t,n,a,i){if(!e)return r.a.createElement("div",{className:"width-100p text-center"},r.a.createElement("small",null,"Subject needs a Scan to reveal their thoughts"));switch(t){case"beliefs":return e?n.beliefs.map((function(e,t){var n,a="belief-name shadow text-left "+L[e].rarity;return r.a.createElement("table",{className:"width-100p",key:e+t},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",{className:a},L[e].icon," ",L[e].adj),r.a.createElement("td",{className:"text-right"},(L[e].idealPro||[]).map((function(e){return r.a.createElement("span",{key:e},"+",S[e])})),(L[e].idealCon||[]).map((function(e){return r.a.createElement("span",{key:e},"-",S[e])})))),r.a.createElement("tr",null,r.a.createElement("td",{className:"small text-center",colSpan:2},L[e].description?null===(n=L[e].description)||void 0===n?void 0:n.split(";").map((function(e,t){return r.a.createElement("div",{key:t},e)})):null))))})):null;case"feelings":return r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,e?function(e){return Object.keys(e.happiness.all).map((function(t,n){return r.a.createElement("tr",{key:n},r.a.createElement("td",{className:"small text-right"},e.happiness.all[t]," ",e.happiness.all[t]>=0?M.happiness:M.unhappiness," from "),r.a.createElement("td",{className:"small"},t))}))}(n):null));default:case"priorities":return r.a.createElement("table",{className:"width-100p"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Currently ",function(e){var t;switch(e.act){case"chat":return"chatting";case"crime":return"stealing ".concat(null===e||void 0===e?void 0:e.crimeGood);case"sleep":return"sleeping \ud83d\ude34";case"relax":return"relaxing";case"travel":return"travelling to "+(null===(t=e.intent)||void 0===t?void 0:t.act)||!1;case"work":return e.good?"working to make "+_[e.good]:"working";case"buy":return e.good?"buying "+_[e.good]:"buying"}return""}(n.actionData))),n.priorities.map((function(e){return r.a.createElement("tr",{key:"p-".concat(e.act,"-").concat(e.good)},r.a.createElement("td",null,e.priority.toFixed(2)," ",function(e){switch(e.act){case"sleep":return"\ud83d\ude34";case"work":return e.good?"\ud83d\udcaa "+_[e.good]:"\ud83d\udcaa";case"buy":return e.good?"\ud83d\udcb8 "+_[e.good]:"\ud83d\udcb8"}return""}(e)))})),function(e){var t=Object.keys(e.activity_duration).map((function(e){return e}));return t.sort((function(t,n){return e.activity_duration[n]-e.activity_duration[t]})),t}(n).filter((function(e){return n.activity_duration[e]>0})).map((function(e){var t=e;return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e),r.a.createElement("td",null,(n.activity_duration[t]/1e3).toFixed(1),"s"))}))))}}var Gr=function(e){var t=pa(),n=Object(a.useState)(void 0),i=Object(Ct.a)(n,2),l=i[0],c=i[1],o=Object(a.useState)("beliefs"),s=Object(Ct.a)(o,2),u=s[0],d=s[1],m=fa((function(e){return e.world.alien})),y=fa(Na),p=fa(Ka);function f(){setTimeout((function(){c(void 0)}),5e3)}if(!y||!p)return null;var h=y.job+" "+y.ethnicity;return r.a.createElement("div",{className:"vertical bean-panel"},r.a.createElement("div",{className:"bean-panel-header"},r.a.createElement("div",null,r.a.createElement("b",null,y.name,"\xa0",p?r.a.createElement("small",null," of ",p.name," "):null),r.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){t(ga())}},"\u274c")),r.a.createElement("div",{className:"bean-view"},r.a.createElement("span",{className:h+" bean"},void 0===l?yt(y):l)),null!=y.titleKey?r.a.createElement(qr,{titleKey:y.titleKey}):null,r.a.createElement("div",{className:"horizontal"},r.a.createElement("span",{className:"text-center"},"\ud83d\udcb0 $",y.cash.toFixed(2)),r.a.createElement("span",{className:"text-center"},"\ud83d\ude42 ",Math.round(y.lastHappiness),"%"),r.a.createElement("span",{className:"text-center"},Math.round(y.happiness.flatAverage)," ",M.happiness," /day")),function(e,t,n,a,i){return e?r.a.createElement("div",null,r.a.createElement("div",{className:"card-parent"},Pr(0,t.ethnicity,void 0),Pr(0,t.faith,a)),r.a.createElement("div",{className:"card-parent"},t.beliefs.map((function(e){return r.a.createElement(Br,{key:e,icon:L[e].icon,title:L[e].adj,name:"",thin:!0,singleLine:!0,onClick:function(){}})}))),r.a.createElement("div",{className:"card-parent"},Pr(0,t.food,void 0),Pr(0,t.stamina,void 0),Pr(0,t.health,void 0))):r.a.createElement("div",{className:"card-parent"},r.a.createElement(Br,{icon:"\ud83d\udef0\ufe0f",name:"Scan",subtext:"-Energy +Info",onClick:i,disabled:!Dt(n,n.difficulty.cost.bean.scan)}))}(m.scanned_bean[y.key],y,m,(function(){e.brainwash()}),(function(){t(qn({beanKey:y.key})),c("\ud83d\ude28"),f()}))),r.a.createElement("div",{className:"grow-1 pad-4 bean-panel-content"},r.a.createElement("div",{className:"cylinder blue-orange horizontal"},r.a.createElement("button",{type:"button",className:"beliefs"==u?"active":"",onClick:function(){return d("beliefs")}},"\ud83d\ude07 Traits"),r.a.createElement("button",{type:"button",className:"feelings"==u?"active":"",onClick:function(){return d("feelings")}},"\ud83d\ude10 Feelings"),r.a.createElement("button",{type:"button",className:"priorities"==u?"active":"",onClick:function(){return d("priorities")}},"\ud83d\udcaa Priorities")),Ar(m.scanned_bean[y.key],u,y)),r.a.createElement("div",{className:"bean-action-card-parent"},r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{type:"button",className:"button card",onClick:function(){e.brainwash()},title:"Rewrite one of this being's traits"},"\ud83d\ude35 Brainwash",r.a.createElement("small",null,"-Sanity +-Trait"))),r.a.createElement(Lr,{beanKey:y.key}),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{type:"button",className:"button card",onClick:function(){t(Hn({beanKey:y.key})),c("\ud83d\ude28"),f()},disabled:!Dt(m,m.difficulty.cost.bean.vaporize),title:"Delete this being from the experiment"},"\u2620\ufe0f Vaporize",r.a.createElement(ir,{cost:m.difficulty.cost.bean.vaporize}))),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{type:"button",className:"button card",disabled:"alive"!=y.lifecycle||!Dt(m,m.difficulty.cost.bean.abduct),onClick:function(){return t(Gn({beanKey:y.key}))},title:"Remove this being for study"},"\ud83d\udc7e Abduct for Research",r.a.createElement(ir,{cost:m.difficulty.cost.bean.abduct,rider:"+Tech"})))))},Lr=function(e){var t=fa((function(e){return e.world.titles.allIDs})),n=pa();return t.length>0?r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{type:"button",className:"button card",onClick:function(){return n(ra({beanKey:e.beanKey,titleKey:0}))},title:"Give this bean a title"},"\ud83d\udc51 Give Title",r.a.createElement(ir,{cost:{},rider:"+Title"}))):null},qr=function(e){var t=fa((function(t){return t.world.titles.byID[e.titleKey]}));return r.a.createElement("div",{className:"text-center"},r.a.createElement("strong",null,t.headwear," ",t.name," ",t.badge))},Hr=function(e){var t=fa((function(t){return ya(t.world,e.city.key)})),n=r.a.createElement("div",null,"Human Emotion Farm",r.a.createElement("div",null,r.a.createElement("small",null,"Part of the \ud83c\udf0c Galactic Xenosensation Federation")));e.city&&(n=r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("b",null,e.city.name),r.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.clearCity()}},"\u274c"))));var a=t.reduce((function(e,t){return e+t.lastHappiness}),0)/(t.length||1),i=t.reduce((function(e,t){return e+t.cash}),0)/(t.length||1);return r.a.createElement("div",null,n,r.a.createElement("div",{className:"header"},r.a.createElement("b",null,"\ud83d\udc65 Subjects")),r.a.createElement("div",null,r.a.createElement("b",null,"Population"),"\xa0",r.a.createElement("span",null,t.length)),r.a.createElement(qa,{beans:t,need:function(e){return e.food},dire:"starving",abundant:"stuffed"},"Food Security"),r.a.createElement(qa,{beans:t,need:function(e){return e.stamina},dire:"homeless",abundant:"rested"},"Housing"),r.a.createElement(qa,{beans:t,need:function(e){return e.health},dire:"sick",abundant:"fresh"},"Healthcare"),r.a.createElement("b",null,"Avg. Money")," $",i.toFixed(2)," \xa0",r.a.createElement("b",null,"Avg. Happiness")," ",Math.round(a),"%",t&&t.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"header"},r.a.createElement("b",null,"\ud83e\udde0 Traits")),r.a.createElement("div",{className:"max-w-300"},function(e,t){return Array.from(t.reduce((function(t,n){return e[n.key]?n.beliefs.forEach((function(e){var n=t.get(e)||0;t.set(e,n+1)})):t.set("Unknown",(t.get("Unknown")||0)+1),t}),new Map).entries()).sort((function(e,t){var n=Object(Ct.a)(e,2),a=(n[0],n[1]),r=Object(Ct.a)(t,2);r[0];return r[1]-a})).map((function(e){var t=Object(Ct.a)(e,2),n=t[0],a=t[1];return"Unknown"===n?{icon:"\u2754",noun:"Unknown",count:a}:{icon:L[n].icon,noun:L[n].noun,count:a}}))}(e.alien.scanned_bean,t).map((function(e){return r.a.createElement("span",{key:e.noun,className:"overview-belief"},e.icon,"\xa0",e.noun,"\xa0x",e.count)})))):null,t.length?r.a.createElement("div",{className:"card-parent"},r.a.createElement(Br,{icon:"\ud83d\udef0\ufe0f",name:"Scan All",disabled:!0,subtext:"-Energy +Info",onClick:function(){}})):null)},Fr=(r.a.Component,function(e){var t=fa(Ka),n=fa((function(e){return e.selected.selectedDistrictKey})),a=fa((function(e){return null!=n?e.world.districts.byID[n]:void 0})),i=fa(Na),l=fa((function(e){return e.world.alien})),c=pa();return i&&t?r.a.createElement(Gr,{bean:i,city:t,alien:l,brainwash:function(){return e.openBrainwash()}}):a?r.a.createElement(ur,{difficulty:l.difficulty}):t?r.a.createElement(Hr,{city:t,clearCity:function(){return c(ga())},alien:l}):r.a.createElement("div",null)});var Rr=function(e){var t=fa(ja),n=fa((function(e){return t.slice().reverse().map((function(t){return e.world.events.byID[t]}))})),a=pa(),i=n.map((function(e,t){var n="\ud83d\udea8"===e.icon,i="nojobslots"===e.trigger||"persuasion"===e.trigger;return r.a.createElement("div",{key:t,className:n||i?"tall":""},r.a.createElement("span",{className:n?"police-siren":""},e.icon),"\xa0",function(e){return null!=e.beanKey&&("speechcrime"===e.trigger||"birth"===e.trigger)}(e)?r.a.createElement("a",{onClick:function(){e.beanKey&&e.cityKey&&a(Ea({beanKey:e.beanKey,cityKey:e.cityKey}))},href:"javascript:void(0)"},e.message):r.a.createElement("span",null,e.message))}));return 0===n.length&&(i=[r.a.createElement("div",{key:0},r.a.createElement("small",null,"No events yet"))]),r.a.createElement("div",{className:"events-panel"},r.a.createElement("div",null,r.a.createElement("b",null,"Events")),i)};function zr(e,t){return r.a.createElement("li",null,(null===e||void 0===e?void 0:e.done)?"\u2611\ufe0f":"\u2b55\ufe0f",t.text,null!=t.tooltip?r.a.createElement("small",{title:t.tooltip},"\u2754"):null,(null===e||void 0===e?void 0:e.done)||null==t.reward?null:function(e){return r.a.createElement("div",null,r.a.createElement("small",null,"\ud83c\udf81 ",kn(e.reward||{},"+")))}(t))}var Wr=function(){var e,t=fa((function(e){return e.world.alien.goalProgress})),n=fa((function(e){return e.world.alien.goals})),a=fa((function(e){return e.world.alien.workingReportCard}));return r.a.createElement("div",{className:"goals"},r.a.createElement("div",null,r.a.createElement("b",null,"Goals")),r.a.createElement("ul",null,n.map((function(e){return zr(t[e],ft[e])}))),r.a.createElement("div",null,r.a.createElement("b",null,"Report Card")),r.a.createElement("p",{className:"horizontal"},r.a.createElement("span",null,"Last Grade: ",r.a.createElement("b",null,"D")),r.a.createElement("span",null,"Next Grade in: ",r.a.createElement("b",null,"2 mo."))),r.a.createElement("p",null),r.a.createElement("table",{style:{margin:"auto"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\ud83c\udfaf Happiness"),r.a.createElement("td",null,a.Happiness),r.a.createElement("td",null,r.a.createElement("small",{title:"Are your subjects happy?"},"\u2754"))),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-left",colSpan:3},r.a.createElement("small",null,ht.RubricDescription.Happiness))),r.a.createElement("tr",null,r.a.createElement("th",null,"\ud83c\udfaf Prosperity"),r.a.createElement("td",null,a.Prosperity),r.a.createElement("td",null,r.a.createElement("small",{title:"Are your subjects fed and healthy?"},"\u2754"))),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-left",colSpan:3},r.a.createElement("small",null,ht.RubricDescription.Prosperity))),r.a.createElement("tr",null,r.a.createElement("th",null,"\ud83c\udfaf Stability"),r.a.createElement("td",null,a.Stability),r.a.createElement("td",null,r.a.createElement("small",{title:"Are your subjects sane and civil?"},"\u2754"))),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-left",colSpan:3},r.a.createElement("small",null,ht.RubricDescription.Stability))),r.a.createElement("tr",null,r.a.createElement("th",null,"\ud83c\udfaf Dogma"),r.a.createElement("td",null,a.Dogma),r.a.createElement("td",null,r.a.createElement("small",{title:"Do your society's rules match your utopian ideals?"},"\u2754"))),r.a.createElement("tr",null,r.a.createElement("td",{className:"text-left",colSpan:3},r.a.createElement("small",null,ht.RubricDescription.Dogma))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:3},r.a.createElement("hr",null))),r.a.createElement("tr",null,r.a.createElement("th",null,"Avg. Grade"),r.a.createElement("td",null,gt((Et[(e=a).Happiness]+Et[e.Prosperity]+Et[e.Stability]+Et[e.Dogma])/20)),r.a.createElement("td",null)))))},Ur=function(){var e=fa((function(e){return e.world.alien})),t=pa();return r.a.createElement("div",null,r.a.createElement("div",{className:"text-center"},r.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market")),r.a.createElement("p",null,r.a.createElement("small",null,"The premier exchange for \u26a1\ufe0f, \ud83e\udd16,  and ",M.happiness,"!")),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",onClick:function(){return t(sa({amount:1}))},disabled:!Dt(e,e.difficulty.cost.market.resource.energy)},"+1 \u26a1\ufe0f Energy",r.a.createElement(ir,{cost:e.difficulty.cost.market.resource.energy,qty:1})),r.a.createElement("button",{className:"card button",onClick:function(){return t(sa({amount:5}))},disabled:!Dt(e,e.difficulty.cost.market.resource.energy,5)},"+5 \u26a1\ufe0f Energy",r.a.createElement(ir,{cost:e.difficulty.cost.market.resource.energy,qty:5}))),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",onClick:function(){return t(oa({amount:1}))},disabled:!Dt(e,e.difficulty.cost.market.resource.bots)},"+1 \ud83e\udd16 Bot",r.a.createElement(ir,{cost:e.difficulty.cost.market.resource.bots,qty:1})),r.a.createElement("button",{className:"card button",onClick:function(){return t(oa({amount:5}))},disabled:!Dt(e,e.difficulty.cost.market.resource.bots,5)},"+5 \ud83e\udd16 Bots",r.a.createElement(ir,{cost:e.difficulty.cost.market.resource.bots,qty:5}))),r.a.createElement("div",{className:"card-parent"},r.a.createElement("button",{className:"card button",onClick:function(){return t(da())},disabled:e.hedons.amount>=0||!Dt(e,e.difficulty.cost.market.scrubHedons)},"Remove \ud83d\udca2 Negative Hedons",r.a.createElement(ir,{cost:e.difficulty.cost.market.scrubHedons,qty:1}))),r.a.createElement("div",null,r.a.createElement("small",null,r.a.createElement("i",null,"Current \ud83e\udde0 Traits for sale:"))),r.a.createElement("div",{className:"short-scroll"},r.a.createElement(Jr,{hedons:e.hedons.amount})))},Jr=function(e){var t=fa((function(e){return e.world.marketTraitsForSale})),n=pa();return r.a.createElement(r.a.Fragment,null,t.map((function(t,a){var i=L[t.trait],l="belief-name "+i.rarity;return r.a.createElement("div",{className:"card-parent",key:a},r.a.createElement("button",{className:"card button",onClick:function(){return n(ua({l:t}))},disabled:e.hedons<(t.cost.hedons||0)},r.a.createElement("span",{className:l},i.icon," ",i.noun),r.a.createElement(ir,{cost:t.cost})))})))},Zr=["able","acid","aged","also","area","army","away","baby","back","ball","band","bank","base","bath","bear","beat","been","beer","bell","belt","best","bill","bird","blow","blue","boat","body","bomb","bond","bone","book","boom","born","boss","both","bowl","bulk","burn","bush","busy","call","calm","came","camp","card","care","case","cash","cast","cell","chat","chip","city","club","coal","coat","code","cold","come","cook","cool","cope","copy","CORE","cost","crew","crop","dark","data","date","dawn","days","dead","deal","dean","dear","debt","deep","deny","desk","dial","dick","diet","disc","disk","does","done","door","dose","down","draw","drew","drop","drug","dual","duke","dust","duty","each","earn","ease","east","easy","edge","else","even","ever","evil","exit","face","fact","fail","fair","fall","farm","fast","fate","fear","feed","feel","feet","fell","felt","file","fill","film","find","fine","fire","firm","fish","five","flat","flow","food","foot","ford","form","fort","four","free","from","fuel","full","fund","gain","game","gate","gave","gear","gene","gift","girl","give","glad","goal","goes","gold","Golf","gone","good","gray","grew","grey","grow","gulf","hair","half","hall","hand","hang","hard","harm","hate","have","head","hear","heat","held","hell","help","here","hero","high","hill","hire","hold","hole","holy","home","hope","host","hour","huge","hung","hunt","hurt","idea","inch","into","iron","item","jack","jane","jean","john","join","jump","jury","just","keen","keep","kent","kept","kick","kill","kind","king","knee","knew","know","lack","lady","laid","lake","land","lane","last","late","lead","left","less","life","lift","like","line","link","list","live","load","loan","lock","logo","long","look","lord","lose","loss","lost","love","luck","made","mail","main","make","male","many","Mark","mass","matt","meal","mean","meat","meet","menu","mere","mike","mile","milk","mill","mind","mine","miss","mode","mood","moon","more","most","move","much","must","name","navy","near","neck","need","news","next","nice","nick","nine","none","nose","note","okay","once","only","onto","open","oral","over","pace","pack","page","paid","pain","pair","palm","park","part","pass","past","path","peak","pick","pink","pipe","plan","play","plot","plug","plus","poll","pool","poor","port","post","pull","pure","push","race","rail","rain","rank","rare","rate","read","real","rear","rely","rent","rest","rice","rich","ride","ring","rise","risk","road","rock","role","roll","roof","room","root","rose","rule","rush","ruth","safe","said","sake","sale","salt","same","sand","save","seat","seed","seek","seem","seen","self","sell","send","sent","sept","ship","shop","shot","show","shut","sick","side","sign","site","size","skin","slip","slow","snow","soft","soil","sold","sole","some","song","soon","sort","soul","spot","star","stay","step","stop","such","suit","sure","take","tale","talk","tall","tank","tape","task","team","tech","tell","tend","term","test","text","than","that","them","then","they","thin","this","thus","till","time","tiny","told","toll","tone","tony","took","tool","tour","town","tree","trip","true","tune","turn","twin","type","unit","upon","used","user","vary","vast","very","vice","view","vote","wage","wait","wake","walk","wall","want","ward","warm","wash","wave","ways","weak","wear","week","well","went","were","west","what","when","whom","wide","wife","wild","will","wind","wine","wing","wire","wise","wish","with","wood","word","wore","work","yard","yeah","year","your","zero","zone"];function Vr(){for(var e="",t=0;t<4;t++){t>0&&(e+="-");var n=Math.random();e+=Zr[Math.floor(n*Zr.length)]}return e}var $r=function(e){var t=Object(a.useState)(!1),n=Object(Ct.a)(t,2),i=n[0],l=n[1],c=Object(a.useState)(!1),o=Object(Ct.a)(c,2),s=o[0],u=o[1],d=pa(),m=function(e){l(e)},y=function(){u(!0),setTimeout((function(){return u(!1)}),500)};Object(a.useEffect)((function(){return h.Dirty.subscribe(m),function(){return h.Dirty.unsubscribe(m)}})),Object(a.useEffect)((function(){return h.Saving.subscribe(y),function(){return h.Saving.unsubscribe(y)}}));return r.a.createElement("button",{disabled:!i||s,onClick:function(){d(ta())}},s?"\ud83d\udcbf":i?"\ud83d\udcbe":"\u2714\ufe0f")};var Xr=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).bubbleSeed=0,a.onChange=function(e){var t=++a.bubbleSeed,n=e.change>0;a.setState({bubbles:a.state.bubbles.concat([{string:(n?"+":"")+e.change,id:t,className:n?"pos":"neg"}])}),setTimeout((function(){a.setState({bubbles:a.state.bubbles.filter((function(e){return e.id!=t}))})}),1500)},a.state={bubbles:[]},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.props.changeEvent&&this.props.changeEvent.subscribe(this.onChange)}},{key:"componentWillUnmount",value:function(){this.props.changeEvent&&this.props.changeEvent.unsubscribe(this.onChange)}},{key:"render",value:function(){var e=this,t=this.state.bubbles.map((function(t){return r.a.createElement("span",{key:t.id,className:[t.className,e.props.bubbleClass,"bubbler"].join(" ")},e.props.icon," ",t.string)}));return r.a.createElement("span",{className:"bubble-parent"},this.props.children,t)}}]),n}(r.a.Component),Yr=function(e){var t=function(e,t){var n=Object(a.useState)([]),r=Object(Ct.a)(n,2),i=r[0],l=r[1],c=0,o=function(e){var n=++c;l(i.concat([Object(B.a)({id:n},t(e))])),setTimeout((function(){l(i.filter((function(e){return e.id!=n})))}),1500)};return Object(a.useEffect)((function(){return e.subscribe(o),function(){return e.unsubscribe(o)}})),i}(e.changeEvent,(function(e){return{string:"Discovered ".concat(e.k,"!"),className:"seen-belief"}}));return r.a.createElement("span",{className:"bubble-parent"},e.children,t.map((function(t){return r.a.createElement("span",{key:t.id,className:[t.className,e.bubbleClass,"bubbler"].join(" ")},e.icon," ",t.string)})))},Qr=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={},a}return Object(o.a)(n,[{key:"render",value:function(){var e="capsule-label "+this.props.label||!1;return r.a.createElement("span",{className:e},r.a.createElement("span",{className:"capsule-icon"},this.props.icon),r.a.createElement("span",{className:"capsule-text"},this.props.label,":"),r.a.createElement("span",{className:"capsule-value"},this.props.children))}}]),n}(r.a.Component),ei=function(){var e=fa((function(e){return e.world.alien.energy.amount}));return r.a.createElement("span",null,e.toFixed(1))},ti=function(){var e=fa((function(e){return e.world.alien.bots.amount}));return r.a.createElement("span",null,e.toFixed(1))},ni=function(){var e=fa((function(e){return e.world.alien.hedons.amount}));return r.a.createElement("span",null,e.toFixed(0))},ai=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).state={show:!1},a}return Object(o.a)(n,[{key:"getButton",value:function(){var e=this;return this.props.onClick?r.a.createElement("button",{type:"button",className:"done",onClick:function(){return e.props.onClick&&e.props.onClick()}},this.props.closeButtonText||"Done"):null}},{key:"render",value:function(){return this.props.show?r.a.createElement("div",{className:"modal"},this.props.children,this.getButton()):null}}]),n}(r.a.Component);var ri=function(){var e,t=fa((function(e){return e.world.date}));return r.a.createElement("span",null,"\xa0Year ",t.year,",\xa0",Xt[t.season]," ",t.day," ",(e=t.hour)<vn.Morning?"\ud83c\udf19":e<vn.Noon?"\ud83c\udf04":e<vn.Evening?"\u2600\ufe0f":"\ud83c\udf07")},ii=(n(36),function(e){var t=fa((function(t){return ma(t.world,e.city.key)})),n=fa((function(e){return e.world.alien.scanned_bean})),a=pa();return r.a.createElement("div",{className:"social-graph"},r.a.createElement("div",{className:"social-graph-row"},t.map((function(t){return r.a.createElement("div",{key:t,className:"bean-node",onClick:function(){return a(Ea({cityKey:e.city.key,beanKey:t}))}},r.a.createElement(jr,{beanKey:t,static:!0,sitStill:!0,cityKey:e.city.key}),n[t]?null:r.a.createElement("span",{className:"social-graph-unscanned prohibited-emoji"},"\ud83d\udef0\ufe0f"))}))),r.a.createElement("div",{className:"social-graph-row"},r.a.createElement(Kr,{city:e.city,onClickBuilding:e.onClickBuilding})))}),li=(n(37),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\u231b\ufe0f",r.a.createElement("button",{type:"button",className:0==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(0)}},"\u23f9"),r.a.createElement("button",{type:"button",className:1==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(1)}},"\u25b6\ufe0f"),r.a.createElement("button",{type:"button",className:2==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(2)}},"\u23e9"))}}]),n}(r.a.Component)),ci=function(e){return r.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\ud83d\udc41\ufe0f",r.a.createElement("button",{type:"button",className:"geo"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("geo")}},"\ud83c\udf0e"),r.a.createElement("button",{type:"button",className:"network"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("network")}},"\ud83c\udf10"))},oi=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onEvent=function(e){a.setState({eventCount:a.state.eventCount+1}),window.setTimeout((function(){a.setState({eventCount:a.state.eventCount-1})}),3e3)},a.props.event.subscribe(a.onEvent),a.state={eventCount:0},a}return Object(o.a)(n,[{key:"render",value:function(){return r.a.createElement("span",null,this.state.eventCount<1?this.props.children:r.a.createElement("span",{className:this.props.eventClass},this.props.eventIcon))}}]),n}(r.a.Component),si=r.a.createContext(void 0),ui=r.a.createContext(v),di=Da,mi=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).previousTimeMS=0,a.logicTickAccumulatorMS=0,a.millisecondsSinceLastSave=0,a.saveAccumulatorMS=0,a.tick=function(e){var t=e-a.previousTimeMS;if(a.previousTimeMS=e,t>0){var n=t*a.state.timeScale;(function(e,t){var n=[];return e.ufos.allIDs.forEach((function(a){e.ufos.byID[a];Zt.Get("ufo",a).elapsed+=t,Zt.Get("ufo",a).elapsed>4e3&&n.push(Cn({ufoKey:a}))})),n})(di.getState().world,t).map((function(e){return di.dispatch(e)})),n>0&&(a.logicTickAccumulatorMS+=t,function(e,t){for(var n=e.pickups.allIDs,a=e.cities.byID[0],r=[],i=n.length-1;i>=0;i--){var l=n[i],c=a.pickupMagnetPoint,o=Object(B.a)({},v.Get("pickup",l).current||$);if(c)X(o,c,E*t/1e3,k,w,g)&&r.push(Fn({cityKey:a.key,pickupKey:l}));else Y(o,g);v.Get("pickup",l).publish(o)}return r}(di.getState().world,t).map((function(e){return di.dispatch(e)})),function(e,t){var n=[];return e.beans.allIDs.forEach((function(a){var r=e.beans.byID[a];if("alive"==r.lifecycle){var i=Zt.Get("bean",r.key);i.elapsed+=t;var l=Tt[r.action].act(r,e,i.elapsed,t);if(Array.isArray(l.action)?n.push.apply(n,Object(b.a)(l.action)):l.action&&n.push(l.action),l.newActivity){var c=Tt[r.action].exit(r,e.seed);c&&n.push(c),n.push(Un({beanKey:a,newState:l.newActivity}));var o=Tt[l.newActivity.act].enter(r);o&&n.push(o)}}})),n}(di.getState().world,t).map((function(e){return di.dispatch(e)})),a.logicTickAccumulatorMS>2e3&&(di.dispatch(jn()),a.logicTickAccumulatorMS=0)),a.millisecondsSinceLastSave+=t,h.Dirty.current&&a.millisecondsSinceLastSave>15e3&&(h.SaveGame(di.getState().world),a.millisecondsSinceLastSave=0)}window.requestAnimationFrame(a.tick)},a.cheatMode=!1,a.keyupHandler=function(e){" "===e.key?a.state.timeScale>0?a.setState({timeScale:0}):a.setState({timeScale:1}):"Escape"===e.key?("greeting"===a.state.activeModal&&di.dispatch(_n({seed:a.state.newGameSeed})),a.setState({activeModal:null})):a.cheatMode&&"A"===e.key?di.dispatch(ea()):a.cheatMode&&"Q"===e.key||a.cheatMode&&e.key,a.cheatMode=e.shiftKey&&"C"===e.key},a.onDeath=function(e){pn.play("death"),a.startSpotlight(e)},a.timescaleBeforeSpotlight=1,a.state={activeMain:"geo",activeModal:"mainmenu",activeRightPanel:"overview",timeScale:0,spotlightEvent:void 0,newGameSeed:Vr()},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this.keyupHandler,!1),window.requestAnimationFrame((function(t){e.previousTimeMS=t,window.requestAnimationFrame(e.tick)})),di.subscribe((function(){var t=di.getState();null==t.selected.selectedBeanKey&&null==t.selected.selectedBuildingKey&&null==t.selected.selectedDistrictKey||"overview"==e.state.activeRightPanel||e.setState({activeRightPanel:"overview"})}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyupHandler)}},{key:"startSpotlight",value:function(e){var t=this;this.timescaleBeforeSpotlight=this.state.timeScale,this.setState({spotlightEvent:e,timeScale:0},(function(){setTimeout((function(){return t.endSpotlight()}),5e3)}))}},{key:"endSpotlight",value:function(){this.setState({timeScale:this.timescaleBeforeSpotlight,spotlightEvent:void 0})}},{key:"getPanel",value:function(){var e=this;switch(this.state.activeRightPanel){case"overview":return r.a.createElement(Fr,{openBrainwash:function(){return e.setState({activeModal:"brainwash"})}});case"goals":return r.a.createElement(Wr,null);case"events":return r.a.createElement(Rr,null);case"market":return r.a.createElement(Ur,null)}}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,{store:di},r.a.createElement(si.Provider,{value:pn},r.a.createElement(ui.Provider,{value:v},r.a.createElement("div",{className:"canvas"},"network"===this.state.activeMain?r.a.createElement("div",{className:"canvas"},r.a.createElement(ii,{city:di.getState().world.cities.byID[0],onClickBuilding:function(e){return di.dispatch(wa({cityKey:di.getState().world.cities.allIDs[0],buildingKey:e.key}))},onClick:function(e){di.dispatch(Ea({cityKey:e.cityKey,beanKey:e.key}))}})):r.a.createElement(m.b,{minScale:.65,centerZoomedOut:!0,centerOnInit:!0,initialPositionX:5e3,limitToBounds:!1,alignmentAnimation:{disabled:!0},wheel:{step:.05}},r.a.createElement(m.a,null,r.a.createElement("div",{className:"world"},di.getState().world.cities.allIDs.map((function(e){return r.a.createElement(Tr,{cityKey:e,key:e,onClick:function(){}})}))))),r.a.createElement("div",{className:"overlay"},r.a.createElement(ai,{show:"mainmenu"==this.state.activeModal},r.a.createElement($a,{startGame:function(){return e.setState({activeModal:"greeting"})},loadGame:function(t){var n=h.GetGame(t);null!=n.game&&(di.dispatch(Mn({newState:n.game})),e.setState({activeModal:null}))}})),r.a.createElement(ai,{show:"loadgame"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),di.dispatch(_n({seed:e.state.newGameSeed}))}},r.a.createElement(Va,null)),r.a.createElement(ai,{show:"escapemenu"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),di.dispatch(_n({seed:e.state.newGameSeed}))}},r.a.createElement(Ra,null)),r.a.createElement(ai,{show:"greeting"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),di.dispatch(_n({seed:e.state.newGameSeed}))}},r.a.createElement(Za,{seed:this.state.newGameSeed,changeSeed:function(t){return e.setState({newGameSeed:t})}})),r.a.createElement(ai,{show:"gov"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},r.a.createElement(Wa,null)),r.a.createElement(ai,{show:"polisci"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},r.a.createElement(er,null)),r.a.createElement(ai,{show:"society"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},r.a.createElement(Aa,null)),r.a.createElement(ai,{show:"economy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"economy"==this.state.activeModal?r.a.createElement(Fa,null):""),r.a.createElement(ai,{show:"traits"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},r.a.createElement(tr,null)),r.a.createElement(ai,{show:"brainwash"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},r.a.createElement(Ba,null)),r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"top"},r.a.createElement("span",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),r.a.createElement(ri,null),r.a.createElement(li,{timeScale:this.state.timeScale,setTimeScale:function(t){e.setState({timeScale:t})}}),r.a.createElement(ci,{setActiveMain:function(t){return e.setState({activeMain:t})},activeMain:this.state.activeMain}),r.a.createElement($r,null)),r.a.createElement("div",{className:"bottom"},r.a.createElement(Xr,{changeEvent:pt.alienEnergy,icon:"\u26a1\ufe0f"},r.a.createElement(Qr,{icon:"\u26a1\ufe0f",label:"Energy"},r.a.createElement(ei,null))),r.a.createElement(Xr,{changeEvent:pt.alienBots,icon:"\ud83e\udd16"},r.a.createElement(Qr,{icon:"\ud83e\udd16",label:"Bots"},r.a.createElement(ti,null))),r.a.createElement(Xr,{changeEvent:pt.alienHedons,icon:"\ud83d\udc4d"},r.a.createElement(Qr,{icon:"\ud83d\udc4d",label:"Hedons"},r.a.createElement(ni,null))),r.a.createElement("span",null,r.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"economy"})}},"\ud83d\udcca State of the Utopia"),r.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"gov"})}},"\ud83d\uddf3\ufe0f Gov"),r.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"polisci"})}},"\ud83e\uddea Research"),r.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"society"})}},"\ud83d\udc51 Society"),r.a.createElement(Yr,{changeEvent:pt.newTraitSeen,icon:"\ud83e\udde0"},r.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"traits"})}},"\ud83e\udde0 Traits"))))),r.a.createElement("div",{className:"right"},r.a.createElement("div",{className:"full-width-tabs"},r.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"overview"})}},"\ud83d\udcc8 Info"),r.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"market"}),di.dispatch(ga())}},"\ud83d\udecd\ufe0f Market"),r.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"events"}),di.dispatch(ga())}},r.a.createElement(oi,{event:pt.events,eventIcon:"\ud83d\udea8",eventClass:"police-siren"},"\ud83d\udce3")," Events"),r.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"goals"}),di.dispatch(ga())}},"\ud83c\udfc6 Goals")),r.a.createElement("div",{className:"right-panel"},this.getPanel())))))))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(mi,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.d12c32f7.chunk.js.map