(this.webpackJsonpsocsim=this.webpackJsonpsocsim||[]).push([[0],{19:function(e,t,a){e.exports=a(38)},24:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(11),l=a.n(r),c=(a(24),a(2)),o=a(3),s=a(5),u=a(4),d=a(8),m=a(16),y=(a(29),a(30),function(){function e(t){Object(c.a)(this,e),this.onPublish=t,this.callbacks=[],this.current=void 0}return Object(o.a)(e,[{key:"publish",value:function(e){this.onPublish&&this.onPublish(e),this.current=e,this.callbacks.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e){this.callbacks.push(e)}},{key:"unsubscribe",value:function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)}}]),e}()),p=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(y);var f=new(function(){function e(){Object(c.a)(this,e),this.Dirty=new y,this.Saving=new y}return Object(o.a)(e,[{key:"HasContinueGame",value:function(){var e=localStorage.getItem("last-game-id");if(null!=e){var t=parseInt(e);if(!isNaN(t))return null!=localStorage.getItem("".concat("game-").concat(t))?t:void 0}}},{key:"GetGameSlots",value:function(){for(var e=[],t=0;t<3;t++){var a=localStorage.getItem("".concat("game-brief-").concat(t+1));e.push({id:t+1,brief:a?JSON.parse(a):void 0})}return e}},{key:"GetGame",value:function(e){var t=localStorage.getItem("".concat("game-").concat(e));if(!t)return{errors:["Cannot find game"]};try{return{game:JSON.parse(t)}}catch(a){return{errors:[a]}}}},{key:"SaveGame",value:function(e){var t=JSON.stringify(e),a={Name:e.cities.byID[0].name,Population:e.beans.allIDs.map((function(t){return e.beans.byID[t]})).filter((function(e){return"dead"!=e.lifecycle})).length,Age:{day:e.date.day,hour:e.date.hour,season:e.date.season,year:e.date.year}};localStorage.setItem("".concat("game-").concat(e.saveSlot),t),localStorage.setItem("".concat("game-brief-").concat(e.saveSlot),JSON.stringify(a)),localStorage.setItem("last-game-id",e.saveSlot.toString()),this.Dirty.publish(!1),this.Saving.publish()}}]),e}()),h=a(7),b=a(1),v={common:3,uncommon:2,rare:1,unique:0},g={prog:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"Strives to help others",rarity:"common"},trad:{noun:"Elitism",adj:"Elitist",icon:"\ud83d\udc51",description:"Strives for individual power",rarity:"common"},state:{noun:"Collectivism",adj:"Collectivist",icon:"\ud83d\udd4a\ufe0f",description:"Trusts in the social group",rarity:"common"},ego:{noun:"Independence",adj:"Independent",icon:"\ud83e\udd85",description:"Trusts only in oneself",rarity:"common"}},E={rocket:{noun:"Futurism",adj:"Futuristic",icon:"\ud83d\ude80",description:"Loves stories of the far future",rarity:"common"},dragon:{noun:"Mythology",adj:"Mythical",icon:"\ud83d\udc32",description:"Loves stories of the legendary past",rarity:"common"},music:{noun:"Drama",adj:"Dramatic",icon:"\ud83c\udfb5",description:"Loves stories of emotional bonding",rarity:"common"},noFaith:{noun:"Nihilism",adj:"Nihilist",icon:"\u26ab\ufe0f",description:"Hates fairy tales",rarity:"common"}},k={Diligence:{noun:"Diligence",adj:"Diligence",icon:"\ud83d\udcaa",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udc4d while working"},Natalism:{noun:"Natalism",adj:"Natalist",icon:"\ud83d\udc76",rarity:"common",description:"Extra \ud83c\udfb2 for \ud83d\udc76;Extra \ud83d\udc4d after birth"},Antinatalism:{noun:"Antinatalism",adj:"Antinatalist",icon:"\ud83d\udeb7",rarity:"uncommon",description:"Less \ud83c\udfb2 for \ud83d\udc76;\ud83d\udca2 after birth"},Charity:{noun:"Charity",adj:"Charitable",icon:"\ud83d\ude07",rarity:"uncommon",description:"\ud83c\udfb2 to gift \ud83d\udcb0 to the penniless; and spread \ud83d\udc4d"},Progressivism:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when paying taxes"},Libertarianism:{noun:"Libertarianism",adj:"Libertarian",icon:"\ud83d\udd2b",rarity:"rare",description:"\ud83c\udfb2 to \ud83d\udca2 when paying taxes"},Wanderlust:{noun:"Wanderlust",adj:"Wanderer",icon:"\ud83d\udd2d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when travelling"},Germophobia:{noun:"Germophobia",adj:"Germophobic",icon:"\ud83e\udd27",rarity:"rare",description:"\ud83d\udca2 when sick or working in hospital"},Parochialism:{noun:"Parochialism",adj:"Parochial",icon:"\ud83d\udc2e",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udf3e; \ud83d\udca2 from dense houses"},Cosmopolitanism:{noun:"Cosmopolitanism",adj:"Cosmopolitan",icon:"\ud83c\udf78",rarity:"common",description:"Extra \ud83d\udc4d working \ud83c\udfbb; \ud83d\udca2 from rural houses"},Capitalism:{noun:"Capitalism",adj:"Capitalist",icon:"\ud83c\udfa9",rarity:"common",description:"\ud83d\udca2 working in co-ops and communes; Extra \ud83d\udc4d when owner"},Socialism:{noun:"Socialism",adj:"Socialist",icon:"\ud83e\udd1d",rarity:"common",description:"Extra \ud83d\udc4d working in co-ops"},Communism:{noun:"Communism",adj:"Communist",icon:"\u2692\ufe0f",rarity:"common",description:"\ud83d\udca2 working in companies"},Fraud:{noun:"Fraud",adj:"Fraudulent",icon:"\ud83e\udd25",rarity:"uncommon",description:"\ud83c\udfb2 to avoid taxes; Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime"},Naturalism:{noun:"Naturalism",adj:"Naturalist",icon:"\ud83d\udef6",rarity:"uncommon",description:"Extra \ud83d\udc4d from \ud83d\ude0e; \ud83d\ude0e 3x longer"},Hedonism:{noun:"Hedonism",adj:"Hedonistic",icon:"\ud83d\udc8b",rarity:"uncommon",description:"\ud83c\udfb2 to emote extra \ud83d\udc4d;\ud83c\udfb2 to \ud83d\udca2 when working;"},Gluttony:{noun:"Gluttony",adj:"Glutton",icon:"\ud83c\udf83",rarity:"common",description:"Extra \ud83d\udc4d when stuffed; Extra \ud83d\udca2 when hungry;"},Paranoia:{noun:"Paranoia",adj:"Paranoid",icon:"\ud83d\udc7d",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udca2 at any time"},Depression:{noun:"Depression",adj:"Depressive",icon:"\ud83d\ude13",rarity:"common",description:"\ud83c\udfb2 to \ud83d\udca2 when unhappy"},Optimism:{noun:"Optimism",adj:"Optimistic",icon:"\ud83d\ude3a",rarity:"uncommon",description:"\ud83c\udfb2 to \ud83d\udc4d when happy"},Authority:{noun:"Authority",adj:"Authoritarian",icon:"\ud83d\udc62",rarity:"common",description:"Less \ud83c\udfb2 for all \ud83d\ude08 Crime; Extra \ud83c\udfb2 to report Crime"},Anarchism:{noun:"Anarchism",adj:"Anarchist",icon:"\ud83d\udd95",rarity:"uncommon",description:"Extra \ud83c\udfb2 for all \ud83d\ude08 Crime; Less \ud83c\udfb2 to report Crime"},Greed:{noun:"Greed",adj:"Greedy",icon:"\ud83e\udd11",rarity:"common",description:"Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime; Extra \ud83d\udc4d when rich"},Bloodthirst:{noun:"Bloodthirst",adj:"Bloodthirsty",icon:"\ud83e\ude78",rarity:"rare",description:"High \ud83c\udfb2 to \u2620\ufe0f Kill during \ud83d\ude08 Crime"},Extroversion:{noun:"Extroversion",adj:"Extroverted",icon:"\ud83e\udd29",rarity:"common",description:"Extra \ud83c\udfb2 to start a \ud83d\udde3\ufe0f"},Introversion:{noun:"Introversion",adj:"Introverted",icon:"\ud83e\udd13",rarity:"uncommon",description:"Less \ud83c\udfb2 to be in a \ud83d\udde3\ufe0f"},Charisma:{noun:"Charisma",adj:"Charismatic",icon:"\ud83d\ude0f",rarity:"uncommon",description:"More \ud83c\udfb2 to persuade in a \ud83d\udde3\ufe0f"},Gossip:{noun:"Gossip",adj:"Gossipy",icon:"\ud83d\udcde",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f; \ud83c\udfb2 to \ud83d\udc4d after \ud83d\udde3\ufe0f"},Antagonism:{noun:"Antagonism",adj:"Antagonistic",icon:"\ud83e\udd2c",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udca2 in a \ud83d\udde3\ufe0f"},Enthusiasm:{noun:"Enthusiasm",adj:"Enthusiastic",icon:"\ud83e\udd73",rarity:"common",description:"\ud83c\udfb2 to spread \ud83d\udc4d in a \ud83d\udde3\ufe0f"},Sadism:{noun:"Sadism",adj:"Sadistic",icon:"\ud83d\ude08",rarity:"rare",description:"\ud83c\udfb2 to \u2620\ufe0f Kill in a \ud83d\udde3\ufe0f;\ud83d\udc4d from \u2620\ufe0f Kill"},Vandalism:{noun:"Vandalism",adj:"Vandal",icon:"\ud83d\udca9",rarity:"rare",description:"\ud83c\udfb2 to destroy goods;\ud83d\udc4d from \ud83d\ude08 Theft Crime"},Delirium:{noun:"Delirium",adj:"Delirious",icon:"\ud83d\ude2a",rarity:"unique",description:"Chooses actions at random"},DelusionalMania:{noun:"Delusional Mania",adj:"Delusional Maniac",icon:"\ud83d\ude35",rarity:"unique",description:"\ud83c\udfb2 to \u2620\ufe0f nearby subjects"},Catatonia:{noun:"Catatonia",adj:"Catatonic",icon:"\ud83d\ude36",rarity:"unique",description:"-60% walk speed. Cannot work."},Neuroticism:{noun:"Neuroticism",adj:"Neurotic",icon:"\ud83d\ude31",rarity:"rare",description:"+100% \ud83e\udde0 damage"},Dogmatism:{noun:"Dogmatism",adj:"Dogmatic",icon:"\ud83d\udc36",rarity:"uncommon",description:"Cannot change beliefs"}};var w=["Depression","Catatonia","Neuroticism","DelusionalMania","Delirium","Sadism","Antagonism"],x={Catatonia:2,Neuroticism:2,DelusionalMania:2,Delirium:2,Sadism:2,Depression:1,Antagonism:1},K={psychotic:1,disturbed:.65,stressed:.1,sane:0};var D=Object.keys(k).map((function(e){return e})),N=Object.keys(k).reduce((function(e,t){for(var a=t,n=v[k[a].rarity],i=0;i<n;i++)e.push(a);return e}),[]);var S=a(17);function j(e){return{byID:e.reduce((function(e,t){return e[t.key]=t,e}),{}),allIDs:e.map((function(e){return e.key})),nextID:e.reduce((function(e,t){return Math.max(t.key+1,e)}),0)}}function I(e,t){var a=e.nextID++;t.key=a,e.allIDs.push(a),e.byID[a]=t}var C={};function _(e){return null==C[e]&&(C[e]=new S.b(e,S.a.sfc32)),C[e]}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=_(e).next();return t=Math.ceil(t),a=Math.floor(a),Math.floor(n*(a-t+1))+t}function O(e){return _(e).next()}function B(e,t){return O(e)<=t}function T(e,t){return 1==t.length?t[0]:t[function(e,t){return M(e,0,t-1)}(e,t.length)]}function A(e){return T(e,["prog","trad"])}function P(e){return T(e,["state","ego"])}function G(e){return T(e,["rocket","music","dragon","noFaith"])}Math.PI;var L=["New ","Old ","Fort ","St. ","Mount ","Grand ","","","","","","","","","",""],q=["Spring","Timber","Over","West","East","North","South","Rock","Sand","Clay","Iron","Ore","Coal","Liver","Hawk","Red","Yellow","Gold","Blue","Black","White","Sunny","Reed","Ox","Mill","Fern","Down","Bel","Bald","Ash"],H=["water "," Springs","ville","dale","lane","peak","coast","beach","port","market","ton","brook"," Creek","land","burgh","bridge","ford","bury","chester","son","vale"," Valley","hill","more","wood"," Oaks"," Cove","mouth","way","crest"];function z(){return Object(b.a)(Object(b.a)({},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=260*(e-.5);return{numberOfRings:e,hexes:te({q:0,r:0},e),district_hex_size:Object(b.a)({},De),petriRadius:t,petriOrigin:{x:t,y:t}}}()),{},{key:0,name:"string",deadBeanKeys:[],beanKeys:[],ufoKeys:[],pickupKeys:[],buildingKeys:[],pickupMagnetPoint:void 0,costOfLiving:0,buildingMap:{},districtKeys:[]})}function F(e){var t=j([]);return{ds:j(e.hexes.map((function(a,n){var i=0===a.q&&0===a.r,r=function(e,t,a){return{kind:e,key:0,q:a.q,r:a.r,hexString:a.q+","+a.r,point:pe(t.district_hex_size,t.petriOrigin,a),lots:[]}}(i?"urban":"fallow",e,a);return r.key=n+1,e.districtKeys.push(r.key),i&&J(r,t,"urban"),r}))),lots:t}}var R=[{q:1,r:-1},{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}],W=[{q:1,r:-1},{q:0,r:1},{q:-1,r:0}];function J(e,t,a){("rural"===a?W:R).forEach((function(n,i){if(null==e.lots[i]){var r={key:0,kind:a,districtKey:e.key,point:pe({x:Se,y:Se},e.point,n)};I(t,r),e.lots.push(r.key)}}))}function U(e,t,a,n,i){var r,l={key:e.beans.nextID++,cityKey:t.key,name:"",ethnicity:(r=e.seed,T(r,["circle","square","triangle"])),community:P(e.seed),ideals:A(e.seed),faith:G(e.seed),stamina:"awake",health:"fresh",food:"sated",discrete_food:3,discrete_health:2,discrete_sanity:10,discrete_stamina:7,discrete_fun:0,housing:"homeless",graceTicks:0,dob:{year:e.date.year,season:e.date.season,day:e.date.day,hour:e.date.hour},sanity:"sane",beliefs:[],lifecycle:"alive",hedonHistory:[{},{},{},{},{}],priorities:[],job:"jobless",happiness:{flatAverage:0,all:{},maxSource:"",minSource:"",weightedAverage:0},lastHappiness:0,hedonFiveDayRecord:{max:0,min:0},fairGoodPrice:0,bornInPetri:null!=a,cash:3,ticksSinceLastSale:0,ticksSinceLastRelax:0,lastChatMS:0,action:"idle",actionData:{act:"idle"},activity_duration:{buy:0,chat:0,craze:0,crime:0,idle:0,relax:0,sleep:0,soapbox:0,travel:0,work:0,chase:0,assault:0}};l.name=T(e.seed,["Joe","Frank","Jill","Jose","Johnny","Isabelle","Carmen","Ace","Carl","Zander","Jean","Anne","Leslie","Ben","Ron","Ellen","Dallas","Kane","Ash","Jim","James","Leonard","Nyota","Christine","Scotty","Tasha","Geordi","Beverly","Deanna","Wesley","Majel","Malcolm","River","Luke","Han","Owen","Rey","Mace","Cody","Dana","Walter","Rick","Holden","Roy","Pris","Eldon","Rachael","Rose","Donna","Jack","Amy","Rory","Martha","Clara","Arnold","Dave","Holly","Kara","Gaius","William","Lee","Laura","Saul","Max","Edison","Theora","Bryce","Murray","Ned","Daniel","Samantha","Logan","Francis","Jessica","Thomas","Benny","James","John Henry","Sarah","Piper","Nick","Shaun","Preston"])+" ",l.name+=T(e.seed,["Ripley","Bishop","Hicks","Vasquez","Hudson","Rico","Flores","Ibanez","Levy","Jenkins","Barlow","Zim","Rasczak","Kirk","McCoy","Sulu","Uhura","Chekov","Chapel","Rand","Riker","Crusher","Barret","O'Brien","Reynolds","Tam","Scully","Mulder","Skinner","Connor","Rex","Thrace","Baltar","Smith","Adama","Roslin","Tigh","Song","Oswald","Deckard","Bryant","Tyrell","Sebastian","Voight","Kampff","Tyler","Harkness","Jones","Noble","Pond","Williams","Rimmer","Lister","Head","Carter","Lynch","McKenzie","Grossberg","O'Neil","Jackson","Carter","Whitmore","House","Mitchell","Eden","Lyons","Valentine","Garvey"]);for(var c=Math.ceil(3*Math.random());l.beliefs.length<c;){var o=T(e.seed,N);l.beliefs.includes(o)||l.beliefs.push(o)}return a&&(l.ethnicity=a.ethnicity,l.name=l.name.split(" ")[0]+" "+a.name.split(" ")[1],l.cash=a.cash/2,a.cash/=2),l}function Z(e,t,a){return Math.max(Math.min(e,a),t)}function V(e){var t,a,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.125;do{t=(a=2*O(e)-1)*a+(n=2*O(e)-1)*n}while(t>=1||0===t);return i+r*a*Math.sqrt(-2*Math.log(t)/t)}var $=function e(t,a){Object(c.a)(this,e),this.q=t,this.r=a},X=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}];function Y(e){return X[e]}function Q(e,t){var a=Y(t);return{q:e.q+a.q,r:e.r+a.r}}function ee(e,t){for(var a,n,i=[],r=function(e,t){return{q:e.q+t.q,r:e.r+t.r}}(e,(a=Y(4),n=t,{q:a.q*n,r:a.r*n})),l=0;l<6;l++)for(var c=0;c<t;c++)i.push(r),r=Q(r,l);return i}function te(e,t){for(var a=[e],n=0;n<t;n++)a=a.concat(ee(e,n));return a}var ae={point:{x:0,y:0},velocity:{x:0,y:0},hex:{q:0,r:0}};function ne(e){var t=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)}(e);t>0?(e.x/=t,e.y/=t):e.x=e.y=0}function ie(e,t,a,n,i,r,l,c){var o={x:a.x-e.point.x,y:a.y-e.point.y},s=Math.sqrt(o.x*o.x+o.y*o.y);if(s<=r)return!0;if(o.x/=s,o.y/=s,e.velocity.x+=o.x*n,e.velocity.y+=o.y*n,c){var u=c();e.velocity.x-=u.x,e.velocity.y-=u.y}return e.velocity.x=Z(e.velocity.x,-i,i),e.velocity.y=Z(e.velocity.y,-i,i),re(e,l),e.hex=se(oe(ue(fe(t.district_hex_size,t.petriOrigin,e.point)))),!1}function re(e,t){e.velocity.x*=t.x,e.velocity.y*=t.y,e.point.x+=e.velocity.x,e.point.y+=e.velocity.y}function le(e,t,a){return e+(t-e)*a}function ce(e,t,a){return{x:le(e.x,t.x,a),y:le(e.y,t.y,a),z:le(e.z,t.z,a)}}function oe(e){var t=Math.round(e.x),a=Math.round(e.y),n=Math.round(e.z),i=Math.abs(t-e.x),r=Math.abs(a-e.y),l=Math.abs(n-e.z);return i>r&&i>l?t=-a-n:r>l?a=-t-n:n=-t-a,{x:t,y:a,z:n}}function se(e){var t=e.x,a=e.z;return new $(t,a)}function ue(e){return{x:e.q,z:e.r,y:-e.q-e.r}}function de(e,t){for(var a=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z))/2}(e,t),n=[],i=0;i<=a;i++)n.push(se(oe(ce(e,t,1/a*i))));return n}var me=function e(t,a,n,i,r,l,o,s,u){Object(c.a)(this,e),this.f0=t,this.f1=a,this.f2=n,this.f3=i,this.b0=r,this.b1=l,this.b2=o,this.b3=s,this.start_angle=u},ye=(new me(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0),new me(Math.sqrt(3),Math.sqrt(3)/2,0,1.5,Math.sqrt(3)/3,-1/3,0,2/3,.5));function pe(e,t,a){var n=ye,i=(n.f0*a.q+n.f1*a.r)*e.x,r=(n.f2*a.q+n.f3*a.r)*e.y;return{x:i+t.x,y:r+t.y}}function fe(e,t,a){var n=ye,i=(a.x-t.x)/e.x,r=(a.y-t.y)/e.y;return{q:n.b0*i+n.b1*r,r:n.b2*i+n.b3*r}}function he(e){return{x:e.r*Math.cos(e.az),y:e.r*Math.sin(e.az)}}function be(e){return{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}}var ve={farm:"\ud83d\udc04",house:"\ud83c\udfe1",hospital:"\ud83c\udfe5",church:"\u26ea",theater:"\ud83c\udfaa",jail:"\ud83c\udfdb\ufe0f",park:"\u26f2\ufe0f",nature:"\ud83c\udfde\ufe0f",graveyard:"\u26b1\ufe0f"},ge={farm:"\ud83d\ude9c",house:"\ud83c\udfd8\ufe0f",hospital:"\ud83c\udfd9\ufe0f",church:"\u26ea",theater:"\ud83c\udfdf\ufe0f",jail:"\ud83c\udfeb",park:"\ud83c\udfa1",nature:"\ud83c\udfde\ufe0f",graveyard:"\u26b1\ufe0f"},Ee={farm:"\ud83e\ude95",house:"\ud83d\udcea",hospital:"\ud83e\ude7a",church:"\ud83d\udcff",theater:"\ud83e\ude91",jail:"\ud83d\udea8",park:"\ud83d\udc90",nature:"\u2668\ufe0f",graveyard:"\ud83d\udcff"},ke={farm:"food",house:void 0,hospital:"medicine",church:"fun",theater:"fun",jail:void 0,graveyard:void 0,park:"fun",nature:"fun"},we={food:"farm",medicine:"hospital",fun:"theater"},xe={farmer:"farm",builder:"house",doc:"hospital",entertainer:"theater",cleric:"church",jobless:"house",polit:"house",cop:"jail"},Ke={farm:"farmer",house:"builder",hospital:"doc",theater:"entertainer",church:"cleric",park:"entertainer",nature:"entertainer",jail:"cop",graveyard:"cleric"},De={x:150,y:150};var Ne,Se=50,je=new(function(){function e(){Object(c.a)(this,e),this.cache={ufo:{},bean:{},pickup:{}},this.bins={ufo:{},bean:{},pickup:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]=new y),this.cache[e][t]}},{key:"UpdatePosition",value:function(e,t,a,n){if(this.Get(e,t).publish(a),n.q!=a.hex.q||n.r!=a.hex.r){var i=this.bins[e][n.q+","+n.r];if(i){var r=i.indexOf(t);r>-1&&i.splice(r,1)}var l=a.hex.q+","+a.hex.r;null==this.bins[e][l]&&(this.bins[e][l]=[]),this.bins[e][l].push(t)}}},{key:"GetOtherKeysInHexBin",value:function(e,t,a){var n=this.bins[e][a.q+","+a.r];return Array.isArray(n)?n.filter((function(e){return e!=t})):[]}},{key:"GetOthersInHexBin",value:function(e,t,a){var n=this;return this.GetOtherKeysInHexBin(e,t,a).map((function(t){var a;return(null===(a=n.cache[e][t])||void 0===a?void 0:a.current)||ae}))}}]),e}()),Ie={x:.94,y:.94},Ce=60,_e=9,Me=10,Oe={x:.94,y:.94},Be=10,Te=4,Ae=10,Pe={state:"\ud83d\udd4a\ufe0f",ego:"\ud83e\udd85",prog:"\u2696\ufe0f",trad:"\ud83d\udc51",circle:"\ud83e\udd0e",square:"\ud83d\udc9b",triangle:"\ud83e\udde1",rocket:"\ud83d\ude80",music:"\ud83c\udfb5",dragon:"\ud83d\udc32",noFaith:"\u26ab\ufe0f",starving:"\ud83c\udf74",hungry:"\ud83c\udf7d\ufe0f",sated:"\ud83e\udd5c",stuffed:"\ud83e\udd69",homeless:"\ud83c\udf28\ufe0f",housed:"\ud83d\udeaa",sleepy:"\ud83c\udf19",awake:"\u2600\ufe0f",rested:"\ud83c\udf1e",sick:"\ud83e\udd22",sickly:"\ud83d\ude37",bruised:"\ud83e\ude79",fresh:"\ud83d\udcaa",psychotic:"\ud83e\udd2a",disturbed:"\ud83e\udd24",stressed:"",sane:"\ud83e\udde0"};!function(e){e[e.Deficient=-.25]="Deficient",e[e.Sufficient=0]="Sufficient",e[e.Abundant=.15]="Abundant"}(Ne||(Ne={}));var Ge={warning:.5,sufficient:1,abundant:3},Le={warning:.5,sufficient:1,abundant:3};function qe(e){switch(e){case"doc":return"medicine";case"entertainer":return"fun";default:case"farmer":return"food"}}var He={food:"\ud83e\udd6a",medicine:"\ud83d\udc8a",fun:"\ud83d\udc4f"},ze={love:"\ud83d\udc9b",happiness:"\ud83d\udc4d",unhappiness:"\ud83d\udca2",hate:"\ud83d\udc94"},Fe={love:5,happiness:1,unhappiness:-1,hate:-5},Re={love:1,happiness:.2,unhappiness:0,hate:-1};function We(e,t){return Array.isArray(e)?e.some((function(e){return Je(e,t)})):Je(e,t)}function Je(e,t){return t[e]}function Ue(e){return k[e].icon+" "+k[e].noun}var Ze={food_aid:{key:"food_aid",group:"Welfare",name:"Food Aid",axis:"wel_food",icon:"\ud83d\udc68\u200d\ud83c\udf3e",description:"The government buys Hungry Subjects food.",prereqs:[["Gluttony","Parochialism"],["Charity","Socialism"]]},medical_aid:{key:"medical_aid",group:"Welfare",name:"Med Aid",axis:"wel_health",icon:"\ud83d\udc69\u200d\u2695\ufe0f",description:"The government buys Sick Subjects medicine.",prereqs:["Charity","Cosmopolitanism"]},poll_tax:{key:"poll_tax",group:"Taxation",name:"Head Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udc51",description:"Subjects must pay a flat tax."},sales_tax:{key:"sales_tax",group:"Taxation",name:"Sales Tax",axis:"tax_basic",prereqs:[],icon:"\ud83d\udcb8",description:"Subjects must pay a percentage tax for every transaction."},death_tax:{key:"death_tax",group:"Taxation",name:"Death Tax",axis:"tax_second",prereqs:[],icon:"\u2620\ufe0f",description:"Dead subjects pay a portion of their cash to the government."}},Ve={murder:{key:"murder",name:"Murder",prereqs:[],icon:"\ud83d\udc7f",description:"Ceasing brain function."},hurt:{key:"hurt",name:"Assault",prereqs:[],icon:"\ud83d\ude08",description:"Damaging biological matter."},rob:{key:"rob",name:"Robbery",prereqs:[],icon:"\ud83d\udd2b",description:"Taking of scarcity tokens."},steal:{key:"steal",name:"Theft",prereqs:[],icon:"\ud83d\uded2",description:"Taking of inanimate objects."},profanity:{key:"profanity",name:"Profanity",prereqs:[],icon:"\ud83e\udd2c",description:"Uttering abnormal syllables."},destroy:{key:"destroy",name:"Vandalism",prereqs:[],icon:"\ud83d\udd28",description:"Damaging inanimate objects."}};function $e(e,t){var a;return(null===(a=e.lawTree[Ze[t].axis])||void 0===a?void 0:a.key)===t}function Xe(e,t,a){if(void 0!=(n=t).food&&void 0!=n.sick)switch(a){case"food":return("starving"===t.food||"hungry"===t.food)&&$e(e,"food_aid");case"medicine":return("sick"===t.health||"sickly"===t.health)&&$e(e,"medical_aid")}var n;return!1}function Ye(e,t){return e.cash>=t}function Qe(e,t){return"rural"===t?ft(e,"Parochialism")?1:ft(e,"Cosmopolitanism")?-1:0:"urban"===t?ft(e,"Parochialism")?-1:ft(e,"Cosmopolitanism")?1:0:0}var et=["food","medicine","fun"];function tt(e,t,a,n,i,r,l){nt(e,t,a,n);var c=t.price*n,o=c*l,s=c+o;return i.cash-=s,r.cash+=c,r.ticksSinceLastSale=0,{bought:n,price:c,tax:o}}function at(e,t,a,n,i,r){nt(e,a,n,i);var l=a.price*i,c=l;return t.cash-=c,r.cash+=l,r.ticksSinceLastSale=0,{bought:i,price:l,tax:0}}function nt(e,t,a,n){t.quantity-=n,t.quantity<=0&&e.listings[a].splice(0,1)}function it(e,t,a,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;e.monthlyDemand[n]+=l;var c=ct(e.market,n,r);if(null!=c){var o=Math.min(c.quantity,l),s=$e(t,"sales_tax")?.05:0;if(c.price*(1+s)<=a.cash*o){var u=tt(e.market,c,n,o,a,i(c),s);return u.tax&&(t.cash+=u.tax),u}if(Xe(t,a,n)&&Ye(t,c.price))return at(e.market,t,c,n,o,i(c));e.unfulfilledMonthlyDemand[n]+=o}else e.unfulfilledMonthlyDemand[n]+=l}function rt(e,t){var a=e.monthlySupply[t]||1,n=e.monthlyDemand[t];return.25+.75*Math.min(n/a,1)}function lt(e){return rt(e,"food")+rt(e,"medicine")}function ct(e,t,a){var n=e.listings[t].filter((function(e){return e.quantity>=a}));if(n.length>0){for(var i=1,r=n[0].price,l=1;l<n.length;l++){if(n[l].price>r)break;i++}var c=Math.floor(Math.random()*i);if(c>=n.length)throw"invalid index";return n[c]}return null}function ot(e,t){return{key:0,point:Object(b.a)({},(je.Get("bean",e.key).current||ae).point),type:t,velocity:{x:0,y:0}}}function st(e,t){return e.discrete_health>=Le.abundant?e.health="fresh":e.discrete_health>=Le.sufficient?e.health="bruised":e.discrete_health>=Le.warning?e.health="sickly":e.health="sick",e.health}function ut(e,t){return e.discrete_stamina<0?e.stamina="sleepy":e.discrete_stamina<=4?e.stamina="awake":e.stamina="rested",e.stamina}function dt(e,t){return e.discrete_sanity>=8?e.sanity="sane":e.discrete_sanity>=5?e.sanity="stressed":e.discrete_sanity>=3?e.sanity="disturbed":e.sanity="psychotic",e.sanity}function mt(e,t){return e.discrete_food>=Ge.abundant?e.food="stuffed":e.discrete_food>=Ge.sufficient?e.food="sated":e.discrete_food>=Ge.warning?e.food="hungry":e.food="starving",e.food}function yt(e){if(e.lastChatMS+4e3>Date.now())return!1;if("chat"===e.action)return!1;var t=Math.random(),a="state"===e.community?.2:.1;return ft(e,"Extroversion")&&(a+=.25),ft(e,"Introversion")&&(a+=-.15),t<a}function pt(e,t,a){e.discrete_sanity=Z(e.discrete_sanity+Re[t],0,10),e.hedonHistory[0][a]=(e.hedonHistory[0][a]||0)+Fe[t];var n=[ot(e,t)];return ft(e,"Hedonism")&&("happiness"===t||"love"===t)&&Math.random()<.1&&n.push.apply(n,Object(h.a)(pt(e,"happiness","Hedonism"))),n}function ft(e,t){return-1!==e.beliefs.indexOf(t)}function ht(e,t,a){return function(e,t){return"alive"===e.lifecycle&&e.cash>3*t&&!kt(e)}(e,a)&&B(t,function(e){var t=.008;ft(e,"Natalism")&&(t+=.04);ft(e,"Antinatalism")&&(t+=-.002);return t}(e))?(ft(e,"Natalism")?pt(e,"love","Natalist Parent"):ft(e,"Antinatalism")?pt(e,"hate","Antinatalism"):pt(e,"happiness","Proud Parent"),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(e.name," has a baby!"),key:0}):void 0}function bt(e,t,a,n,i){if(n&&Math.random()<=i){if(e.graceTicks<=0)return vt(e,t,a);e.graceTicks--}}function vt(e,t,a){e.lifecycle="dead";var n=M(t,2,3),i=new Array(n).map((function(t){return ot(e,"hate")}));return{death:{icon:"\u2620\ufe0f",trigger:"death",message:"".concat(e.name," died of ").concat(a,"!"),beanKey:e.key,cityKey:e.cityKey,point:(je.Get("bean",e.key).current||ae).point,key:0},emotes:i}}function gt(e,t){var a=ft(e,"Neuroticism")?2:1;e.discrete_sanity-=a*t}function Et(e){var t;if("chat"===e.action&&("speaker"===(null===(t=e.actionData.chat)||void 0===t?void 0:t.participation)&&e.actionData.chat.preachBelief))return"\ud83d\udcac"+k[e.actionData.chat.preachBelief].icon}function kt(e){return"starving"===e.food||"sick"===e.health}function wt(e,t,a){return void 0===t.sanity||e.discrete_sanity>=t.sanity+a}function xt(e){var t,a,n,i,r;switch(e.lifecycle){case"dead":return"\ud83d\udc80";case"incarcerated":return"\ud83e\udd10"}if("sleep"===e.actionData.act)return"housed"===e.housing?"\ud83d\ude34":"\ud83e\udd76";if(e.faceOverride)return e.faceOverride;if("crime"===e.actionData.act)return"\ud83d\ude08";if("chase"===e.actionData.act||"assault"===e.actionData.act){var l,c;if(e.key===(null===(l=e.actionData)||void 0===l||null===(c=l.assault)||void 0===c?void 0:c.victimBeanKey))return"\ud83d\ude30";switch(null!==(t=null===(a=e.actionData.assault)||void 0===a?void 0:a.assaultType)&&void 0!==t?t:null===(n=e.actionData.chase)||void 0===n?void 0:n.type){case"arrest":return"\ud83e\udd20";case"assault":return"\ud83d\ude21";case"murder":return"\ud83d\udc7f";case"rob":return"\ud83d\ude08"}}if("relax"===e.actionData.act)return"\ud83d\ude0e";if("chat"===e.actionData.act){var o;if("speaker"===(null===(o=e.actionData.chat)||void 0===o?void 0:o.participation))switch(null===(i=e.actionData)||void 0===i||null===(r=i.chat)||void 0===r?void 0:r.type){default:return"\ud83d\ude03";case"gift":return"\ud83d\ude07";case"praise":return"\ud83e\udd73";case"bully":return"\ud83d\ude08"}return"\ud83e\udd28"}return"starving"===e.food?"\ud83d\ude2b":"sick"===e.health?"\ud83e\udd22":"jobless"===e.job?"\ud83d\ude27":e.lastHappiness<0?"\u2639\ufe0f":e.lastHappiness>=50?"\ud83d\ude42":"\ud83d\ude10"}function Kt(e,t){var a=function(e,t,a){if(B(e,K[t])){for(var n=[],i=function(e){var i=w[e];if(a.find((function(e){return e===i})))return"continue";var r=x[i];"psychotic"===t&&(r*=2);for(var l=0;l<r;l++)n.push(i)},r=0;r<w.length;r++)i(r);return T(e,n)}}(e,t.sanity,t.beliefs);if(a)return{beanKey:t.key,newInsanity:a}}var Dt=new function e(){Object(c.a)(this,e),this.alienEnergy=new p,this.alienBots=new p,this.alienHedons=new p,this.newTraitSeen=new y,this.events=new y,this.autosave=new y},Nt={found_utopia:{key:"found_utopia",text:"Found your Utopia",check:function(e){return e.buildings.allIDs.length>0}},build_house_n_farm:{key:"build_house_n_farm",text:"Build a house and farm",check:function(e){return null!=e.buildings.allIDs.find((function(t){return"farm"==e.buildings.byID[t].type}))&&null!=e.buildings.allIDs.find((function(t){return"house"==e.buildings.byID[t].type}))},reward:{energy:3,bots:3}},beam_3:{key:"beam_3",text:"Beam in 3 new beings",check:function(e){return e.beans.allIDs.filter((function(t){return!e.beans.byID[t].bornInPetri})).length>=3}},scan:{key:"scan",text:"Scan a Subject",check:function(e){return Object.keys(e.alien.scanned_bean).length>0}},set_policy:{key:"set_policy",text:"Set a Gov Policy",check:function(e){return!1}},brainwash:{key:"brainwash",text:"Brainwash a Subject",check:function(e){return!1}},"c+_grade":{key:"c+_grade",text:"Receive a C+ Grade",check:function(e){return!1}}},St={GradeWorld:function(e){return{Happiness:It(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return e.lastHappiness>-.2})),Prosperity:It(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"hungry"!==e.food})),Stability:It(e.beans.allIDs.map((function(t){return e.beans.byID[t]})),(function(e){return"sane"===e.sanity})),Dogma:jt(e.alien.speechcrimes[e.date.year]||0,10,10)}},RubricDescription:{Happiness:"Subjects are at least 20% happy",Prosperity:"Subjects are not hungry",Stability:"Subjects are all sane",Dogma:"Up to 10 Speechcrimes"}};function jt(e,t,a){return Ct(1-Math.min(1,Math.max(0,e-t)/a))}function It(e,t){return e.length<1?"F":Ct(e.filter(t).length/e.length)}function Ct(e){return e<.58?"F":e<.68?"D":e<.78?"C":e<.88?"B":"A"}var _t={A:5,B:4,C:3,D:2,F:1};var Mt={sanity_bonus:{tech:"sanity_bonus",name:"Surgical Psychops",techPoints:30,description:"Brainwashing causes -1 \ud83e\udde0 Sanity damage"},fast_resources:{tech:"fast_resources",name:"0 Dimensional Supersiphons",techPoints:30,description:"Faster \u26a1\ufe0f and \ud83e\udd16 accumulation"},trauma_nanobots:{tech:"trauma_nanobots",name:"Trauma Nanobots",techPoints:30,description:"Spend \ud83e\udd16 to stop Subject from dying"},neural_duplicator:{tech:"neural_duplicator",name:"Level 2 Neural Duplication",techPoints:30,description:"Copy \ud83e\udde0 Traits 1 additional time"}};function Ot(e,t){t.bots&&(e.bots.amount+=t.bots,Dt.alienBots.publish({change:t.bots})),t.energy&&(e.energy.amount+=t.energy,Dt.alienEnergy.publish({change:t.energy})),t.hedons&&(e.hedons.amount+=t.hedons,Dt.alienHedons.publish({change:t.hedons}))}function Bt(e,t){return null!=e[t]&&e[t].researchPoints>=Mt[t].techPoints}function Tt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(void 0===t.bots||e.bots.amount>=t.bots*a)&&(void 0===t.energy||e.energy.amount>=t.energy*a)&&(void 0===t.hedons||e.hedons.amount>=t.hedons*a)}function At(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return!!Tt(e,t,a)&&(Pt(e,t,a),!0)}function Pt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.bots&&(e.bots.amount-=t.bots*a,Dt.alienBots.publish({change:-t.bots*a})),t.energy&&(e.energy.amount-=t.energy*a,Dt.alienEnergy.publish({change:-t.energy*a})),t.hedons&&(e.hedons.amount-=t.hedons*a,Dt.alienHedons.publish({change:-t.hedons*a}))}var Gt=a(9),Lt=a(12),qt=a(6),Ht={apartment:"\ud83d\udeaa",house:"\ud83c\udfe1",townhouse:"\ud83c\udfd8\ufe0f",loft:"\ud83d\udeaa"},zt=["farm","hospital","theater"];function Ft(e){return function(e){var t=e.upgradedJobs?2:1;return Rt[e.type]*t}(e)-e.employeeBeanKeys.length}var Rt={church:0,jail:3,graveyard:0,park:0,house:0,farm:3,hospital:3,theater:3,nature:0};function Wt(e,t){if(null!=e.employerEnterpriseKey){var a=t.buildings.byID[e.employerEnterpriseKey],n=t.enterprises.byID[e.employerEnterpriseKey];n.ownerBeanKey==e.key&&(n.ownerBeanKey=a.employeeBeanKeys.find((function(t){return t!=e.key}))),Jt(a,e)}}function Jt(e,t){"jobless"!==t.job&&function(e,t){var a=e.employeeBeanKeys.length;return e.employeeBeanKeys=e.employeeBeanKeys.filter((function(e){return e!=t})),a===e.employeeBeanKeys.length+1}(e,t.key)&&(t.employerEnterpriseKey=void 0,t.job="jobless")}var Ut={travel:{enter:function(e){},act:function(e,t,a,n){var i=t.cities.byID[e.cityKey],r=e.actionData.destinationIndex||0;if(null==e.actionData.destinations||0===e.actionData.destinations.length||r>=e.actionData.destinations.length)return e.actionData.intent?{newActivity:e.actionData.intent}:{newActivity:{act:"idle"}};var l=e.actionData.destinations[r];if(isNaN(l.x)||isNaN(l.y))return console.warn("NaN destination, resetting to idle"),{newActivity:{act:"idle"}};var c=je.Get("bean",e.key).current||ae,o=Object(b.a)({},c),s=ie(o,i,l,Be*(ft(e,"Catatonia")?.4:1)*n/1e3,Te,Ae,Oe,(function(){return je.GetOthersInHexBin("bean",e.key,c.hex).reduce((function(e,t){var a={x:t.point.x-c.point.x,y:t.point.y-c.point.y};return ne(a),e.x=Z(.78*a.x+e.x,-.07,.07),e.y=Z(.78*a.y+e.y,-.07,.07),e}),{x:0,y:0})}));if(je.UpdatePosition("bean",e.key,o,c.hex),s)return{action:vn({beanKey:e.key})};if(i){var u=function(e,t){var a=je.Get("bean",t.key).current;return a?e.beanKeys.filter((function(e){if(e==t.key)return!1;var n=je.Get("bean",e).current;if(!n)return!1;var i=Math.pow(n.point.x-a.point.x,2)+Math.pow(n.point.y-a.point.y,2);return i<1600&&i>600})):[]}(i,e);if(u.length&&yt(e)){var d=u.filter((function(e){return yt(t.beans.byID[e])}));if(d.length<1)return{};var m=function(e,t,a){if(e.beliefs.length){if(ft(e,"Charity")&&e.cash>=2){var n=a();if(n)return{participation:"speaker",type:"gift",targetBeanKey:n.key}}else{if(ft(e,"Enthusiasm")&&Math.random()<.45)return{participation:"speaker",type:"praise",preachBelief:"Enthusiasm"};if(ft(e,"Antagonism")&&Math.random()<.45)return{participation:"speaker",type:"bully",preachBelief:"Antagonism"};if(ft(e,"Gossip")&&Math.random()<.35)return{participation:"speaker",type:"bully",preachBelief:"Gossip"}}return{participation:"speaker",type:"preach",preachBelief:T(t,e.beliefs),persuasionStrength:1+(ft(e,"Charisma")?2:0)}}return{participation:"speaker",type:"praise"}}(e,t.seed,(function(){return d.map((function(e){return t.beans.byID[e]})).filter((function(t){return t.cash<=e.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),void 0)}));return{newActivity:{act:"chat",chat:m,intent:e.actionData},action:d.map((function(e){return hn({beanKey:e,newState:{act:"chat",chat:Object(b.a)(Object(b.a)({},m),{},{participation:"listener"}),intent:t.beans.byID[e].actionData}})}))}}if(ft(e,"Wanderlust")&&Math.random()<Xt)return{action:bn({beanKey:e.key,emote:"happiness",source:"Wanderlust"})}}return{}},exit:function(e){}},work:{enter:function(e){},act:function(e,t,a){return a>3e3&&e.actionData.good?{action:gn({beanKey:e.key}),newActivity:{act:"idle"}}:{}},exit:function(e){}},sleep:{enter:function(e){if("homeless"===e.housing)return bn({beanKey:e.key,emote:"unhappiness",source:"Homelessness"})},act:function(e,t,a){return a>3e3?{newActivity:{act:"idle"}}:{}},exit:function(e){}},chat:{enter:function(e){},act:function(e,t,a){return a>1e3&&e.actionData.intent?{newActivity:{act:"travel",intent:e.actionData.intent}}:{}},exit:function(e,t){if(e.actionData.chat&&"listener"===e.actionData.chat.participation)switch(e.actionData.chat.type){case"bully":return bn({beanKey:e.key,emote:"unhappiness",source:"Antagonism"});case"praise":return bn({beanKey:e.key,emote:"happiness",source:"Enthusiasm"});case"preach":if(e.actionData.chat.preachBelief&&e.actionData.chat.persuasionStrength&&function(e,t,a,n){if(ft(e,"Dogmatism"))return!1;if(!e.beliefs.includes(a)){var i=10+M(t,1,6);return i+=e.beliefs.length-2,M(t,1,20)+n>i}return!1}(e,t,e.actionData.chat.preachBelief,e.actionData.chat.persuasionStrength))return Kn({beanKey:e.key,belief:e.actionData.chat.preachBelief})}}},soapbox:{enter:function(e){},act:function(e){return{}},exit:function(e){}},craze:{enter:function(e){},act:function(e){return{}},exit:function(e){}},idle:{enter:function(e){},act:function(e,t,a){if("incarcerated"===e.lifecycle)return{};if(a<200)return{};for(var n=e.priorities.slice(0),i=n[0],r=void 0,l=void 0;i&&null==r;){var c=Zt(e,t,i);if(null===c||void 0===c?void 0:c.intent){if(null!=(r=$t(e,t.cities.byID[e.cityKey],c.intent,t)))return{newActivity:r,action:l}}else(null===c||void 0===c?void 0:c.sideEffect)&&(l=c.sideEffect);i=n.shift()}return{action:l}},exit:function(e){if(function(e){if(ft(e,"Paranoia")&&Math.random()<.05)return!0}(e))return bn({beanKey:e.key,emote:"unhappiness",source:"Paranoia"})}},chase:{enter:function(e){},act:function(e,t,a,n){var i,r;if(null!=(null===(i=e.actionData.chase)||void 0===i?void 0:i.targetBeanKey)&&a<15e3){var l,c=(null===(l=je.Get("bean",e.actionData.chase.targetBeanKey).current)||void 0===l?void 0:l.point)||t.beans.byID[e.actionData.chase.targetBeanKey].lastPoint;if(null==c||isNaN(c.x)||isNaN(c.y))return console.warn("NaN destination, resetting to idle"),{newActivity:{act:"idle"}};var o=je.Get("bean",e.key).current||ae,s=Object(b.a)({},o),u=ie(s,t.cities.byID[e.cityKey],c,Be*(ft(e,"Catatonia")?.4:1)*n/1e3,Te,Ae,Oe);if(je.UpdatePosition("bean",e.key,s,o.hex),u){var d=xn({criminalBeanKey:e.actionData.chase.targetBeanKey,crime:e.actionData.chase.crime});return e.actionData.intent?{newActivity:Object(b.a)({},e.actionData.intent),action:d}:{newActivity:{act:"idle"},action:d}}return{}}return(null===(r=e.actionData.intent)||void 0===r?void 0:r.intent)?{newActivity:Object(b.a)({},e.actionData.intent.intent)}:{newActivity:{act:"idle"}}},exit:function(e){}},assault:{enter:function(e){},act:function(e,t,a){return a>2e3?e.actionData.intent?{newActivity:Object(b.a)({},e.actionData.intent)}:{newActivity:{act:"idle"}}:{}},exit:function(e){}},buy:{enter:function(e){},act:function(e,t,a){if(e.actionData.buyReceipt){if(a>750)return{newActivity:{act:"idle"}}}else{if(a>1100)return{newActivity:{act:"idle"}};if((e.actionData.buyAttempts||0)>=3)return{newActivity:{act:"idle"}};if(a>100&&e.actionData.good)return{action:kn({beanKey:e.key,good:e.actionData.good})}}return{}},exit:function(e){}},crime:{enter:function(e){},act:function(e,t,a){return a>1500?{newActivity:{act:"idle"},action:wn({beanKey:e.key,good:e.actionData.crimeGood||"food"})}:{}},exit:function(e){}},relax:{enter:function(e){},act:function(e,t,a){var n=3e3;return ft(e,"Naturalism")&&(n*=3),a>n?{newActivity:{act:"idle"}}:{}},exit:function(e){return En({beanKey:e.key})}}};function Zt(e,t,a){if("buy"===a.act&&null!=a.good){var n=function(e,t,a,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=ct(e.market,n,i);if(null==l)return"nosupply";var c=Math.min(l.quantity,r);return l.price<=a.cash*c||Xe(t,a,n)&&Ye(t,l.price)?"yes":"pricedout"}(t.economy,t.law,e,a.good);return"yes"!=n&&"fun"===a.good?{intent:{act:"relax"}}:"pricedout"===n?"food"!=a.good&&"medicine"!=a.good||!function(e,t,a){if("fun"===a)return!1;var n=O(t),i=.05;return"ego"===e.community&&(i+=.1),kt(e)&&(i+=.1),ft(e,"Greed")&&(i+=.25),ft(e,"Anarchism")&&(i+=.33),ft(e,"Authority")&&(i+=-.25),("food"===a&&"starving"===e.food||"medicine"===a&&"sick"===e.health)&&(i+=.25),i<=n}(e,t.seed,a.good)?"food"===a.good||"medicine"===a.good?{sideEffect:bn({beanKey:e.key,emote:"unhappiness",source:He[a.good]+" Poverty"})}:void 0:{intent:{act:"crime",crimeGood:a.good}}:"nosupply"===n?a.good&&function(e,t){var a=!1;return("food"!==t||"starving"!==e.food&&"hungry"!==e.food)&&("medicine"!==t||"sick"!==e.health&&"sickly"!==e.health)||(a=!0),a}(e,a.good)?{sideEffect:bn({beanKey:e.key,emote:"unhappiness",source:"Scarcity"})}:void 0:{intent:Object(b.a)(Object(b.a)({},a),{},{buyAttempts:0})}}return{intent:a}}function Vt(e,t,a,n){switch(a.act){case"buy":if(a.good)return ia(t,n,e,we[a.good]);case"sleep":if(void 0!==e.dwellingKey){var i=n.dwellings.byID[e.dwellingKey],r=n.buildings.byID[i.buildingKey],l=n.lots.byID[r.lotKey],c=n.districts.byID[l.districtKey];return la(n.seed,t,e,{q:c.q,r:c.r},l.point)}return function(e,t,a){var n=function(e,t){var a=e.buildingKeys.filter((function(e){return"house"!==t.buildings.byID[e].type}));if(!(a.length<1)){var n=T(t.seed,a);return t.buildings.byID[n]}}(e,t);return void 0===n?null:ra(t.seed,e,a,n)}(t,n,e);case"work":return ia(t,n,e,xe[e.job]);case"relax":var o=function(e,t){var a=e.buildingKeys.filter((function(e){return"nature"===t.buildings.byID[e].type||"park"===t.buildings.byID[e].type||"theater"===t.buildings.byID[e].type}));if(!(a.length<1)){var n=T(t.seed,a);return t.buildings.byID[n]}}(t,n);if(o)return ra(n.seed,t,e,o);var s=n.districts.allIDs.map((function(e){return n.districts.byID[e]})).find((function(e){return"nature"===e.kind}));if(s)return la(n.seed,t,e,{q:s.q,r:s.r},{x:s.point.x+150*Math.random()-75,y:s.point.y+150*Math.random()-75})}return[]}function $t(e,t,a,n){var i=Vt(e,t,a,n);return i?{act:"travel",destinations:i,destinationIndex:0,intent:a}:void 0}var Xt=.002,Yt=function(e,t,a){var n=ft(e,"Delirium")?.25:.125;return"jobless"==e.job||ft(e,"Catatonia")?0:0===e.cash?V(t,.75,n):a?V(t,.5+(Math.min(1,a.costOfLiving/e.cash),n)):V(t,.5,n)},Qt=function(e,t,a){var n=ft(e,"Delirium")?.25:.125;return V(t,.5+(Math.min(1,a.bean_life.vital_thresh.food.warning/e.discrete_food),n))},ea=function(e,t,a){var n=ft(e,"Delirium")?.25:.125;return V(t,.5+(Math.min(1,a.bean_life.vital_thresh.shelter.warning/e.discrete_stamina),n))},ta=function(e,t,a){var n=ft(e,"Delirium")?.25:.125;return V(t,.5+(Math.min(1,a.bean_life.vital_thresh.medicine.warning/e.discrete_health),n))},aa=function(e,t,a){var n=ft(e,"Delirium")?.25:.125;return V(t,.5+(Math.min(1,-e.lastHappiness/100),n))};function na(e,t,a,n){var i=[{act:"work",good:qe(e.job),priority:Yt(e,t,a)},{act:"sleep",priority:ea(e,t,n)},{act:"buy",good:"food",priority:Qt(e,t,n)},{act:"buy",good:"medicine",priority:ta(e,t,n)},{act:"buy",good:"fun",priority:aa(e,t,n)}];return i.sort((function(e,t){return t.priority-e.priority})),i}function ia(e,t,a,n){var i=function(e,t,a){var n=e.buildingKeys.filter((function(e){return t.buildings.byID[e].type===a}));if(!(n.length<1)){var i=T(t.seed,n);return t.buildings.byID[i]}}(e,t,n);return void 0===i?null:ra(t.seed,e,a,i)}function ra(e,t,a,n){return la(e,t,a,n.hex,n.point)}function la(e,t,a,n,i){var r,l,c=je.Get("bean",a.key).current||Object(b.a)({},ae),o=fe(t.district_hex_size,t.petriOrigin,c.point);return(r=o,l=n,de(ue(r),ue(l))).map((function(e){return pe(t.district_hex_size,t.petriOrigin,e)})).map((function(t,a,n){return a===n.length-1?{x:i.x+M(e,-20,20),y:i.y+M(e,-20,20)}:t}))}var ca,oa=new(function(){function e(){Object(c.a)(this,e),this.cache={bean:{},ufo:{}}}return Object(o.a)(e,[{key:"Get",value:function(e,t){return this.cache[e][t]||(this.cache[e][t]={elapsed:0,duration:0}),this.cache[e][t]}}]),e}());function sa(e,t){var a=e.cities.byID[t.cityKey],n=a.buildingKeys.filter((function(t){return Ft(e.buildings.byID[t])>0}));if(n.length<1)return!1;var i=n.map((function(t){return e.buildings.byID[t]})),r=i.map((function(a){return{ideologyBonus:Qe(t,e.districts.byID[e.lots.byID[a.lotKey].districtKey].kind),isEmpty:0===a.employeeBeanKeys.length,openJobs:Ft(a),building:a}}));if(r.sort((function(e,t){return e.isEmpty!=t.isEmpty?e.isEmpty?-1:1:e.ideologyBonus!=t.ideologyBonus?e.ideologyBonus-t.ideologyBonus:e.openJobs-t.openJobs})),r.length>0){var l=r[0].building;return null!=t.employerEnterpriseKey&&Jt(e.buildings.byID[t.employerEnterpriseKey],t),ua(t,l,e.enterprises.byID[l.key]),!0}return!1}function ua(e,t,a){t.employeeBeanKeys.push(e.key),e.employerEnterpriseKey=t.key,a&&null==a.ownerBeanKey&&(a.ownerBeanKey=e.key),e.job=Ke[t.type]}!function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Fall=2]="Fall",e[e.Winter=3]="Winter"}(ca||(ca={}));var da;!function(e){e[e.Midnight=0]="Midnight",e[e.Morning=2]="Morning",e[e.Noon=4]="Noon",e[e.Evening=6]="Evening"}(da||(da={}));var ma="drop.mp3",ya="ding_soft.mp3",pa="ding_bad.wav",fa="death_bell.wav",ha="digital_beeping.mp3",ba="squish_pop.mp3",va="squish_suck.mp3",ga="baby_squeak.wav",Ea="mhmm.mp3",ka="pill-shake.wav",wa="cow-moo.wav",xa="door-open.wav",Ka="teleport.wav",Da="cash_ding.mp3",Na="crazy_laugh.mp3",Sa="handcuffs_ratchet.wav",ja="crime_uncaught.mp3",Ia="siren_double.mp3",Ca="crow.wav",_a="wood_saw.mp3",Ma="nail_saw.mp3",Oa=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,e),this.file=t,this.volume=a,this.buffer=[]}return Object(o.a)(e,[{key:"play",value:function(){if(this.buffer.length>0&&this.buffer[0].ended){var e=this.buffer.shift();null===e||void 0===e||e.play(),e&&this.buffer.push(e)}else{var t=new Audio("/socsim/"+this.file);t.volume=this.volume,t.play(),this.buffer.push(t)}}}]),e}(),Ba=new(function(){function e(){Object(c.a)(this,e),this.lib={drop:new Oa(ma,.2),love:new Oa(ya),happiness:new Oa(ya),unhappiness:new Oa(pa),hate:new Oa(pa),death:new Oa(fa),scan:new Oa(ha,.3),wash_in:new Oa(ba),wash_out:new Oa(va),squeak:new Oa(ga,.3),mhmm:new Oa(Ea,.5),moo:new Oa(wa,1),pills:new Oa(ka,1),door:new Oa(xa,1),teleport:new Oa(Ka,.6),cash:new Oa(Da,.23),crazy_laugh:new Oa(Na,.5),handcuffs:new Oa(Sa,.85),crime:new Oa(ja,.55),siren:new Oa(Ia,.2),graveyard:new Oa(Ca,.6),urbanize:new Oa(Ma,.6),develop:new Oa(_a,.6)}}return Object(o.a)(e,[{key:"play",value:function(e){this.lib[e].play()}}]),e}()),Ta={common:3,uncommon:5,rare:7,unique:99},Aa={common:3,uncommon:5,rare:7,unique:99};function Pa(e,t){var a=k[t].rarity;return{trait:t,cost:{hedons:Ta[a]+M(e,0,Aa[a])}}}function Ga(e){if(e.date.hour++,e.date.hour%2===0&&function(e){e.enterprises.allIDs.forEach((function(t){var a=e.enterprises.byID[t],n=e.buildings.byID[t].employeeBeanKeys.map((function(t){return e.beans.byID[t]}));switch(a.enterpriseType){case"company":if(n.length<1);else if(1===n.length)n[0].cash+=a.cash,a.cash>0&&(n[0].ticksSinceLastSale=0),a.cash=0;else{var i=a.cash/(n.length+.15);a.cash=0;var r=n.find((function(e){return e.key===a.ownerBeanKey}));null==r&&(r=n[0],a.ownerBeanKey=r.key),n.forEach((function(e){var t=e===r?1.15*i:i;e.cash+=t,t>0&&(e.ticksSinceLastSale=0)}))}break;case"co-op":var l=a.cash/n.length;a.cash=0,n.forEach((function(e){e.cash+=l,l>0&&(e.ticksSinceLastSale=0)}));break;case"commune":var c=a.cash/n.length;a.cash=0,n.forEach((function(e){e.cash+=c,c>0&&(e.ticksSinceLastSale=0)}))}}))}(e),e.date.hour>=8&&(e.date.hour=0,e.date.day++,function(e){e.beans.allIDs.forEach((function(t){var a=e.beans.byID[t];a.hedonHistory.length>=5&&a.hedonHistory.pop(),a.hedonHistory.unshift({})}))}(e),e.date.day%7===0&&function(e){if(e.marketTraitsForSale=function(e){for(var t=[],a=0;a<3;a++){var n=T(e,N);t.push(Pa(e,n))}return t}(e.seed),La(e,{key:0,message:"New traits in the Emotion Market!",icon:"\ud83d\udecd\ufe0f",trigger:"marketrefresh"}),$e(e.law,"poll_tax")){var t=0;e.cities.allIDs.forEach((function(a){Hn(e,a).forEach((function(e){e.cash>=.1&&(e.cash-=.1,t+=.1)}))})),e.law.cash=e.law.cash+t}!function(e,t){var a=1*t.length;if(e.cash>a){var n=(e.cash-a)/t.length;e.cash=a,t.forEach((function(e){return e.cash+=n}))}}(e.law,Object.values(e.beans.byID))}(e)),e.date.day>30&&(e.date.day=1,function(e){e.economy.unfulfilledMonthlyDemand={food:0,medicine:0,fun:0},e.economy.monthlyDemand={food:0,medicine:0,fun:0},e.economy.monthlySupply={food:0,medicine:0,fun:0}}(e),e.date.season++),e.date.season>3&&(e.date.year++,function(e){!function(e){var t=e.beans.allIDs.reduce((function(t,a){return t.push(e.beans.byID[a]),t}),[]),a=t.reduce((function(e,t){return e+t.cash}),0)/100,n=Math.round(1*a);if(n>0){var i=t.reduce((function(e,t){return t.cash>e.max&&(e.winner=t,e.max=t.cash),e}),{max:0});i.winner&&(i.winner.cash+=n)}}(e)}(e),e.date.season=0),e.alien.bots.amount+=e.alien.bots.income,e.alien.energy.amount+=e.alien.energy.income,Bt(e.alien.techProgress,"fast_resources")&&(e.alien.bots.amount+=.5*e.alien.bots.income,e.alien.energy.amount+=.5*e.alien.energy.income),e.alien.currentlyResearchingTech){var t=e.alien.currentlyResearchingTech;null==e.alien.techProgress[t]&&(e.alien.techProgress[t]={researchPoints:0});var a=Mt[t].techPoints,n=e.alien.techProgress[t].researchPoints;n<a&&(e.alien.techProgress[t].researchPoints+=1*e.alien.abductedBeanKeys.length/8),n>=a&&("neural_duplicator"===e.alien.currentlyResearchingTech&&e.alien.beliefInventory.forEach((function(e){return e.gems+=1})),e.alien.currentlyResearchingTech=void 0)}var i=lt(e.economy);return e.beans.allIDs.forEach((function(t,a){var n=e.beans.byID[t],r=n.faceOverrideTicks;if(null!=r&&(r<=1?(n.faceOverrideTicks=void 0,n.faceOverride=void 0):n.faceOverrideTicks=r-1),null!=n.jailTicksLeft&&(n.jailTicksLeft=n.jailTicksLeft-1,n.jailTicksLeft<=0&&(n.jailTicksLeft=void 0,n.lifecycle="alive")),"alive"==n.lifecycle){var l=function(e,t,a){if("alive"==e.lifecycle){var n=[],i="starving"!==e.food,r="sick"!==e.health;e.discrete_food-=a.bean_life.degrade_per_tick.food,e.discrete_food<0&&(e.discrete_health-=a.bean_life.penalty.starving_health),mt(e);var l=bt(e,t,"starvation","starving"===e.food,.6);if(l)return l;"starving"===e.food&&i&&(n.push.apply(n,Object(h.a)(pt(e,"unhappiness","Starving"))),ft(e,"Gluttony")&&(n.push.apply(n,Object(h.a)(pt(e,"unhappiness","Gluttony"))),n.push.apply(n,Object(h.a)(pt(e,"unhappiness","Gluttony"))))),e.discrete_stamina-=a.bean_life.degrade_per_tick.stamina,ut(e),e.discrete_health-=a.bean_life.degrade_per_tick.health,e.discrete_health=Math.min(e.discrete_health,3),st(e);var c=bt(e,t,"sickness","sick"===e.health,.4);return c||("sick"===e.health&&r&&(n.push.apply(n,Object(h.a)(pt(e,"unhappiness","Sick"))),ft(e,"Germophobia")&&n.push.apply(n,Object(h.a)(pt(e,"unhappiness","Germophobia")))),e.discrete_fun-=a.bean_life.degrade_per_tick.fun,e.discrete_fun=Math.max(0,e.discrete_fun),kt(e)||(e.graceTicks=Z(e.graceTicks+1,0,6)),n.length?{emotes:n}:void 0)}}(n,e.seed,e.alien.difficulty);(null===l||void 0===l?void 0:l.emotes)&&l.emotes.map((function(t){return I(e.pickups,t)}));var c=null===l||void 0===l?void 0:l.death;c&&qa(e,n,c,[]);var o=ht(n,e.seed,i);if(o){var s=U(e,e.cities.byID[n.cityKey],n);n.lastPoint&&n.lastHex&&(s.lastPoint=n.lastPoint,je.Get("bean",s.key).publish({point:{x:n.lastPoint.x,y:n.lastPoint.y},hex:{q:n.lastHex.q,r:n.lastHex.r},velocity:{x:0,y:0}})),e.beans.byID[s.key]=s,e.beans.allIDs.push(s.key),e.cities.byID[n.cityKey].beanKeys.push(s.key),La(e,o),Ba.play("squeak")}if("jobless"===n.job)sa(e,n)||La(e,{icon:"\ud83c\udfda\ufe0f",trigger:"nojobslots",message:"A subject cannot find a job; build or upgrade more buildings.",key:0});if(void 0===n.dwellingKey){var u=e.dwellings.allIDs.find((function(t){return void 0===e.dwellings.byID[t].occupantKey}));null!=u&&(e.dwellings.byID[u].occupantKey=n.key,n.dwellingKey=u,n.housing="housed")}n.happiness=function(e){if(0===e.length)return{all:{},flatAverage:0,weightedAverage:0,maxSource:"",minSource:""};for(var t={},a=0,n=0,i=0;i<e.length;i++){for(var r=e[i],l=0,c=Object.keys(r),o=0;o<c.length;o++){var s=c[o];l+=r[s],t[s]||(t[s]=0),t[s]+=r[s]}a+=l/(i+1),n+=l}var u=Object.keys(t);return{flatAverage:n/e.length,weightedAverage:a,maxSource:u.reduce((function(e,a){return t[a]>e.val?{source:a,val:t[a]}:e}),{source:"",val:0}).source,minSource:u.reduce((function(e,a){return t[a]<e.val?{source:a,val:t[a]}:e}),{source:"",val:0}).source,all:t}}(n.hedonHistory)}})),e.cities.allIDs.forEach((function(t){var a,n,i=e.cities.byID[t];a=i,n=e.economy,a.costOfLiving=lt(n)})),e.beans.allIDs.forEach((function(t){var a,n,i=e.beans.byID[t];i&&"alive"==i.lifecycle&&(a=i,n=e.economy,e.alien.difficulty,e.law,a.hedonFiveDayRecord={min:Math.min(a.hedonFiveDayRecord.min,a.happiness.flatAverage),max:Math.max(a.hedonFiveDayRecord.max,a.happiness.flatAverage)},0===a.happiness.flatAverage?a.lastHappiness=0:a.lastHappiness=a.happiness.flatAverage>=0?a.happiness.flatAverage/Math.abs(a.hedonFiveDayRecord.max)*100:a.happiness.flatAverage/Math.abs(a.hedonFiveDayRecord.min)*100,mt(a),st(a),dt(a),ut(a),"jobless"===a.job?a.fairGoodPrice=1:a.fairGoodPrice=rt(n,qe(a.job)))})),function(e,t){for(var a=0;a<t.goals.length;a++){var n=t.goals[a];if(null==t.goalProgress[n]&&(t.goalProgress[n]={done:!1,step:0}),!t.goalProgress[n].done){var i=Nt[n].check(e),r=Nt[n].reward;t.goalProgress[n].done=i,i&&null!=r&&Ot(t,r)}}}(e,e.alien),function(e,t){t.workingReportCard=St.GradeWorld(e)}(e,e.alien),e}function La(e,t){for(t.key=e.events.nextID++,e.events.byID[t.key]=t,e.events.allIDs.push(t.key),Dt.events.publish(t);e.events.allIDs.length>25;){var a=e.events.allIDs[0];null!=a&&(e.events.allIDs=e.events.allIDs.slice(1),e.events.byID=Object(b.a)({removedID:a},e.events.byID))}}function qa(e,t,a,n){if(I(e.events,a),n.map((function(t){return I(e.pickups,t)})),Wt(t,e),null!=t.dwellingKey){var i=e.dwellings.byID[t.dwellingKey];i&&(i.occupantKey=void 0),t.dwellingKey=void 0}var r=T(e.seed,e.beans.allIDs.filter((function(e){return e!==t.key})));null!=r&&(e.beans.byID[r].cash=t.cash),Ba.play("death")}function Ha(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=[];return e.energy&&n.push(t+e.energy*a+" Energy"),e.bots&&n.push(t+e.bots*a+" Bots"),e.hedons&&n.push(t+e.hedons*a+" Hedons"),e.tortrons&&n.push(t+e.tortrons*a+" Antihedons"),n.join(" ")}var za={cost:{emptyHex:{build:{house:{energy:1,bots:3},farm:{energy:1,bots:3},theater:{energy:1,bots:4},hospital:{energy:1,bots:4},church:{energy:1,bots:4},jail:{energy:1,bots:4},graveyard:{energy:1,bots:1},park:{energy:1,bots:4},nature:{energy:1,bots:4}}},hex:{beam:{energy:3},upgrade:{energy:1,bots:4},fallow_2_rural:{bots:1},rural_2_urban:{bots:2},add_loft:{bots:1,energy:1}},bean_brain:{brainwash_ideal:{sanity:4},brainimplant_secondary:{sanity:1},brainwash_secondary:{sanity:2}},bean:{scan:{energy:1},abduct:{bots:3},gift:{},empower:{},vaporize:{energy:2,bots:4},siphon:{}},market:{scrubHedons:{energy:5},resource:{bots:{hedons:6},energy:{hedons:5}},beliefs:{common:{},uncommon:{},rare:{},unique:{}}}},bean_life:{vital_thresh:{food:{warning:.6,sufficient:1,abundant:3},shelter:{warning:2,sufficient:3,abundant:7},medicine:{warning:.6,sufficient:1,abundant:3},fun:{warning:.1,sufficient:1,abundant:3}},degrade_per_tick:{food:1/24,health:1/40,stamina:1/8,fun:1/40},penalty:{homeless_health:1/56,starving_health:1/56},death_chance:{starvation:1/8,sickness:1/8,exposure:1/8,vaporization:1}},report_card_progression:[]};var Fa=Object(Gt.b)({name:"world",initialState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"abcdef";return{buildings:{byID:{},allIDs:[],nextID:0},enterprises:{byID:{},allIDs:[],nextID:0},cities:j([z()]),beans:{byID:{},allIDs:[],nextID:0},ufos:{byID:{},allIDs:[],nextID:0},events:{byID:{},allIDs:[],nextID:0},pickups:{byID:{},allIDs:[],nextID:0},lots:{byID:{},allIDs:[],nextID:0},districts:{byID:{},allIDs:[],nextID:0},titles:{byID:{},allIDs:[],nextID:0},dwellings:{byID:{},allIDs:[],nextID:0},economy:{unfulfilledMonthlyDemand:{food:0,medicine:0,fun:0},monthlyDemand:{food:0,medicine:0,fun:0},monthlySupply:{food:0,medicine:0,fun:0},market:{listings:{food:[],fun:[],medicine:[]}}},law:{cash:0,lawTree:{},crimes:{murder:"jail",destroy:"jail",hurt:"jail",rob:"jail",steal:"jail"},laws:[],ticksSinceLastSale:0},date:{year:1,season:ca.Spring,day:1,hour:1},marketTraitsForSale:[],alien:{scanned_bean:{},seenBeliefs:{},beliefInventory:[],speechcrimes:{},abductedBeanKeys:[],energy:{amount:16,income:2/30},bots:{amount:10,income:2/30},hedons:{amount:0,income:0},next_grade:{year:1,season:3,day:1,hour:0},difficulty:Object(b.a)({},za),goals:["found_utopia","build_house_n_farm","beam_3","scan","brainwash","set_policy","c+_grade"],goalProgress:{},pastReportCards:[],workingReportCard:{Happiness:"D",Prosperity:"D",Stability:"D",Dogma:"D"},techProgress:{},currentlyResearchingTech:void 0},spotlightEvent:void 0,insanityEvent:void 0,saveSlot:1,seed:e}}(),reducers:{refreshMarket:function(e){},magnetChange:function(e,t){e.cities.byID[t.payload.cityKey].pickupMagnetPoint=t.payload.px},worldTick:function(e){Ga(e)},newGame:function(e,t){var a,n=e.cities.byID[0];e.seed=t.payload.seed,n.name=(a=e.seed,"".concat(T(a,L)).concat(T(a,q)).concat(T(a,H)));var i=F(n);e.districts=i.ds,e.lots=i.lots;var r=T(e.seed,e.districts.allIDs.slice(1));e.districts.byID[r].kind="nature"},loadGame:function(e,t){return t.payload.newState.beans.allIDs.map((function(e){var a,n,i,r,l=t.payload.newState.beans.byID[e];l&&je.UpdatePosition("bean",e,{point:{x:(null===(a=l.lastPoint)||void 0===a?void 0:a.x)||0,y:(null===(n=l.lastPoint)||void 0===n?void 0:n.y)||0},velocity:{x:0,y:0},hex:{q:(null===(i=l.lastHex)||void 0===i?void 0:i.q)||0,r:(null===(r=l.lastHex)||void 0===r?void 0:r.r)||0}},{q:0,r:0})})),t.payload.newState},build:function(e,t){var a=e.alien.difficulty.cost.emptyHex.build[t.payload.what];if(At(e.alien,a)){var n=e.lots.byID[t.payload.lot],i=e.districts.byID[n.districtKey];switch(function(e,t,a,n,i,r,l){var c={type:a,key:e.buildings.nextID++,hex:n,point:Object(b.a)({},i),lotKey:r,employeeBeanKeys:[],upgradedLoft:!1,upgradedJobs:!1,upgradedStorage:!1};e.buildings.allIDs.push(c.key),e.buildings.byID[c.key]=c,t.buildingKeys.push(c.key);var o=e.lots.byID[r];if(o.buildingKey=c.key,zt.some((function(e){return e===a}))&&(c.enterpriseKey=c.key,e.enterprises.allIDs.push(c.key),e.enterprises.byID[c.key]={cash:0,cityKey:t.key,enterpriseType:"company",buildingKey:c.key,key:c.key,ticksSinceLastSale:0}),"house"===a){for(var s="urban"===e.districts.byID[o.districtKey].kind?"townhouse":"house",u=[],d=0;d<3;d++){var m={key:0,buildingKey:c.key,kind:s};I(e.dwellings,m),u.push(m.key)}c.dwellingKeys=u}"graveyard"===a&&(c.interredBeanKeys=[]);var y=ke[a];y&&"fun"!=y&&e.economy.market.listings[y].push({price:1,quantity:3,sellerCityKey:t.key,sellerEnterpriseKey:c.key})}(e,e.cities.byID[t.payload.city],t.payload.what,i,n.point,n.key,e.economy),t.payload.what){case"farm":Ba.play("moo");break;case"hospital":Ba.play("pills");break;case"house":Ba.play("door");break;case"jail":Ba.play("siren");break;case"graveyard":Ba.play("graveyard")}}},upgradeDistrict:function(e,t){var a=e.districts.byID[t.payload.district];if(a)if("rural"===("rural"===a.kind?"urban":"rural")){var n=e.alien.difficulty.cost.hex.fallow_2_rural;At(e.alien,n)&&(J(a,e.lots,"rural"),a.kind="rural",Ba.play("develop"))}else{var i=e.alien.difficulty.cost.hex.rural_2_urban;At(e.alien,i)&&(J(a,e.lots,"urban"),a.kind="urban",Ba.play("urbanize"))}},changeEnterprise:function(e,t){e.enterprises.byID[t.payload.enterpriseKey].enterpriseType=t.payload.newType},fireBean:function(e,t){Wt(e.beans.byID[t.payload.beanKey],e)},upgrade:function(e,t){var a=e.alien.difficulty.cost.hex.upgrade,n=e.buildings.byID[t.payload.buildingKey];At(e.alien,a)&&(n.upgradedJobs=!0)},upgradeLoft:function(e,t){var a=e.alien.difficulty.cost.hex.add_loft,n=e.buildings.byID[t.payload.buildingKey];if(At(e.alien,a)){n.upgradedLoft=!0;var i={key:0,buildingKey:t.payload.buildingKey,kind:"loft"};I(e.dwellings,i),n.dwellingKeys=[i.key]}},upgradeStorage:function(e,t){var a=e.alien.difficulty.cost.hex.upgrade,n=e.buildings.byID[t.payload.buildingKey];At(e.alien,a)&&(n.upgradedStorage=!0)},beam:function(e,t){var a=e.alien.difficulty.cost.hex.beam;if(Tt(e.alien,a)){Pt(e.alien,a);var n={key:e.ufos.nextID++,action:"beam-in",duration:0,hex:Object(b.a)({},t.payload.where),cityKey:t.payload.cityKey};e.ufos.allIDs.push(n.key),e.ufos.byID[n.key]=n,e.cities.byID[t.payload.cityKey].ufoKeys.push(n.key)}},remove_ufo:function(e,t){var a=e.ufos.byID[t.payload.ufoKey],n=U(e,e.cities.byID[0],void 0,a.hex);n.priorities=na(n,e.seed,e.cities.byID[n.cityKey],e.alien.difficulty),delete e.ufos.byID[t.payload.ufoKey],e.ufos.allIDs=e.ufos.allIDs.filter((function(e){return e!=t.payload.ufoKey})),e.cities.byID[a.cityKey].ufoKeys=e.cities.byID[a.cityKey].ufoKeys.filter((function(e){return e!=t.payload.ufoKey})),e.beans.byID[n.key]=n,e.beans.allIDs.push(n.key),e.cities.byID[a.cityKey].beanKeys.push(n.key),je.Get("bean",n.key).current={point:pe(e.cities.byID[a.cityKey].district_hex_size,e.cities.byID[a.cityKey].petriOrigin,a.hex),hex:Object(b.a)({},a.hex),velocity:{x:0,y:0}}},abduct:function(e,t){if(At(e.alien,e.alien.difficulty.cost.bean.abduct)){var a=e.beans.byID[t.payload.beanKey];if("alive"===a.lifecycle){if(a.lifecycle="abducted",a.employerEnterpriseKey)Jt(e.buildings.byID[a.employerEnterpriseKey],a);e.cities.byID[a.cityKey].beanKeys=e.cities.byID[a.cityKey].beanKeys.filter((function(e){return e!=a.key})),e.alien.abductedBeanKeys.push(a.key)}}},cheatAdd:function(e){e.alien.energy.amount+=10,e.alien.bots.amount+=10,e.alien.hedons.amount+=10},release:function(e){if(e.alien.abductedBeanKeys.length>0){var t=e.alien.abductedBeanKeys.shift();if(null!=t){var a=e.beans.byID[t];a.lifecycle="alive",e.cities.byID[a.cityKey].beanKeys.push(t)}}},washCommunity:function(e,t){},washMotive:function(){},washNarrative:function(e,t){var a=e.beans.byID[t.payload.beanKey];if(wt(a,e.alien.difficulty.cost.bean_brain.brainwash_ideal,0)){gt(a,e.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0);for(var n=a.faith;a.faith===n;)a.faith=T(e.seed,["rocket","dragon","music","noFaith"])}},washBelief:function(e,t){var a=e.beans.byID[t.payload.beanKey],n=Bt(e.alien.techProgress,"sanity_bonus")?-1:0;wt(a,e.alien.difficulty.cost.bean_brain.brainwash_secondary,n)&&(gt(a,e.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0),a.sanity=dt(a,e.alien.difficulty),a.beliefs.splice(a.beliefs.indexOf(t.payload.trait),1),e.insanityEvent=Kt(e.seed,a),e.insanityEvent?(a.beliefs=[].concat(Object(h.a)(a.beliefs),[e.insanityEvent.newInsanity]),Ba.play("crazy_laugh")):Ba.play("wash_out"))},extractBelief:function(e,t){var a=e.beans.byID[t.payload.beanKey],n=Bt(e.alien.techProgress,"sanity_bonus")?-1:0;if(wt(a,e.alien.difficulty.cost.bean_brain.brainwash_secondary,n)){gt(a,e.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0),a.sanity=dt(a,e.alien.difficulty);var i=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.trait})),r=Bt(e.alien.techProgress,"neural_duplicator")?1:0;i?i.gems+=1+r:e.alien.beliefInventory.push({trait:t.payload.trait,gems:1+r}),e.insanityEvent=Kt(e.seed,a),e.insanityEvent?(a.beliefs=[].concat(Object(h.a)(a.beliefs),[e.insanityEvent.newInsanity]),Ba.play("crazy_laugh")):Ba.play("wash_out")}},acknowledgeNewInsanity:function(e){e.insanityEvent=void 0},setResearch:function(e,t){e.alien.currentlyResearchingTech=t.payload.t},implant:function(e,t){var a=e.beans.byID[t.payload.beanKey],n=Bt(e.alien.techProgress,"sanity_bonus")?-1:0;wt(a,e.alien.difficulty.cost.bean_brain.brainimplant_secondary,n)&&e.alien.beliefInventory.filter((function(e){return e.trait==t.payload.trait&&e.gems>0}))&&(a.beliefs.push(t.payload.trait),function(e,t){var a=e.beliefInventory,n=a.find((function(e){return e.trait===t}));n&&(n.gems-=1,e.beliefInventory=Object(h.a)(a.filter((function(e){return e.gems>0}))))}(e.alien,t.payload.trait),gt(a,e.alien.difficulty.cost.bean_brain.brainimplant_secondary.sanity||0),a.sanity=dt(a,e.alien.difficulty),e.insanityEvent=Kt(e.seed,a),e.insanityEvent?(a.beliefs=[].concat(Object(h.a)(a.beliefs),[e.insanityEvent.newInsanity]),Ba.play("crazy_laugh")):Ba.play("wash_in"))},scan:function(e,t){var a=e.beans.byID[t.payload.beanKey];At(e.alien,e.alien.difficulty.cost.bean.scan)&&(e.alien.scanned_bean[a.key]=!0,a.beliefs.forEach((function(t){e.alien.seenBeliefs[t]||(e.alien.seenBeliefs[t]=!0,Dt.newTraitSeen.publish({k:k[t].noun,v:!0}))})),a.faceOverrideTicks=4,a.faceOverride="\ud83d\ude28",Ba.play("scan"))},vaporize:function(e,t){if(At(e.alien,e.alien.difficulty.cost.bean.vaporize)){var a=e.beans.byID[t.payload.beanKey],n=vt(a,e.seed,"vaporization");qa(e,a,n.death,n.emotes)}},setCrimeLegality:function(e,t){"none"===t.payload.legality&&(t.payload.legality=void 0),e.law.crimes[t.payload.crime]=t.payload.legality},pickUpPickup:function(e,t){var a=e.pickups.byID[t.payload.pickupKey],n=Fe[a.type];e.alien.hedons.amount+=n,e.cities.byID[t.payload.cityKey].pickupKeys=e.cities.byID[t.payload.cityKey].pickupKeys.filter((function(e){return e!=t.payload.pickupKey})),e.pickups.allIDs=e.pickups.allIDs.filter((function(e){return e!=t.payload.pickupKey})),delete e.pickups.byID[t.payload.pickupKey],Dt.alienHedons.publish({change:n}),Ba.play(a.type)},changeState:function(e,t){Ra(e,t)},beanHitDestination:function(e,t){var a=e.beans.byID[t.payload.beanKey];null!=a.actionData.destinationIndex&&a.actionData.destinationIndex++},beanBePersuaded:function(e,t){var a=e.beans.byID[t.payload.beanKey];a.beliefs.push(t.payload.belief),La(e,{key:0,icon:"\ud83d\udde3\ufe0f",trigger:"persuasion",message:"".concat(a.name," now believes in ").concat(k[t.payload.belief].icon," ").concat(k[t.payload.belief].noun,"!"),beanKey:a.key,cityKey:a.cityKey,point:a.lastPoint}),Ba.play("mhmm")},beanGiveCharity:function(e,t){var a=e.beans.byID[t.payload.senderBeanKey];a.cash-=.5,Ja(a,e,{emote:"happiness",source:"Charity"});var n=e.beans.byID[t.payload.needyBeanKey];n.cash+=.5,Ja(n,e,{emote:"happiness",source:"Charity"})},beanWork:function(e,t){var a,n=e.beans.byID[t.payload.beanKey];if("jobless"===n.job);else{switch(n.job){case"farmer":n.discrete_food=Math.min(n.discrete_food+1,2*Ge.sufficient),Wa(e,n,"Parochialism","happiness",.25);break;case"doc":n.discrete_health=Math.min(n.discrete_health+1,2*Le.sufficient),Wa(e,n,"Germophobia","unhappiness",.25);break;case"builder":n.stamina="awake",n.discrete_stamina=7;break;case"entertainer":Wa(e,n,"Cosmopolitanism","happiness",.25)}if(Wa(e,n,"Diligence","happiness",.25),Wa(e,n,"Hedonism","unhappiness",.15),n.ticksSinceLastSale++,n.ticksSinceLastSale>8&&null!=n.employerEnterpriseKey)if(e.enterprises.byID[n.employerEnterpriseKey].ownerBeanKey!=n.key&&Math.random()>.5)(a=e.economy,et.reduce((function(e,t){return a.unfulfilledMonthlyDemand[t]>e.max&&(e.max=a.unfulfilledMonthlyDemand[t],e.job=function(e){switch(e){case"medicine":return"doc";case"fun":return"entertainer";default:case"food":return"farmer"}}(t)),e}),{max:0,job:null}).job)&&(sa(e,n,n.employerEnterpriseKey),n.ticksSinceLastSale=0);var i=!1;if(n.employerEnterpriseKey){var r=e.enterprises.byID[n.employerEnterpriseKey];if(r)switch(function(e,t,a,n,i){e.monthlySupply[a]+=n;var r=e.market.listings[a].find((function(e){return e.sellerEnterpriseKey==t.key}));r?(r.quantity+=n,r.price=i,r.quantity=Math.min(r.quantity,20)):e.market.listings[a].push({sellerEnterpriseKey:t.key,price:i,quantity:n}),e.market.listings[a].sort((function(e,t){return e.price-t.price}))}(e.economy,r,qe(n.job),4,n.fairGoodPrice),i=!0,r.enterpriseType){case"company":Wa(e,n,"Communism","unhappiness",.1),r.ownerBeanKey===n.key&&Wa(e,n,"Capitalism","happiness",.1);break;case"co-op":Wa(e,n,"Capitalism","unhappiness",.1),Wa(e,n,"Socialism","happiness",.1);break;case"commune":Wa(e,n,"Capitalism","unhappiness",.1)}}i||function(e,t,a,n,i){e.monthlySupply[a]+=n;var r=e.market.listings[a].find((function(e){return e.sellerBeanKey==t.key}));r?(r.quantity+=n,r.price=i,r.quantity=Math.min(r.quantity,20)):e.market.listings[a].push({sellerBeanKey:t.key,sellerCityKey:t.cityKey,price:i,quantity:n}),e.market.listings[a].sort((function(e,t){return e.price-t.price}))}(e.economy,n,qe(n.job),4,n.fairGoodPrice)}},beanEmote:function(e,t){var a=e.beans.byID[t.payload.beanKey];Ja(a,e,t.payload),ft(a,"Hedonism")&&("happiness"===t.payload.emote||"love"===t.payload.emote)&&Math.random()<.1&&Ja(a,e,{emote:"happiness",source:"Hedonism"})},beanCrime:function(e,t){var a,n,i=e.beans.byID[t.payload.beanKey],r=T(e.seed,e.economy.market.listings[t.payload.good]);if(null==r);else{var l=Math.min(r.quantity,3);switch(nt(e.economy.market,r,t.payload.good,l),t.payload.good){case"food":i.discrete_food+=l;break;case"medicine":i.discrete_health+=l}if(null!=r.sellerEnterpriseKey){var c=e.enterprises.byID[r.sellerEnterpriseKey],o=void 0;if("company"===c.enterpriseType){var s=c.ownerBeanKey;null!=s&&t.payload.beanKey!=s&&(o=e.beans.byID[s])}else{var u=e.beans.allIDs.filter((function(a){return a!=t.payload.beanKey&&"alive"===e.beans.byID[a].lifecycle&&e.beans.byID[a].employerEnterpriseKey===r.sellerEnterpriseKey})),d=T(e.seed,u);o=e.beans.byID[d]}o&&(o.faceOverride="\ud83e\udd7a",o.faceOverrideTicks=4,Ja(o,e,{emote:"unhappiness",source:"Theft Victim"}))}if(a=e.law,n="steal",null!=a.crimes[n]){var m=(i.lastHex?je.GetOtherKeysInHexBin("bean",t.payload.beanKey,i.lastHex):e.beans.allIDs.filter((function(e){return e!=t.payload.beanKey}))).filter((function(t){return"alive"===e.beans.byID[t].lifecycle})).reduce((function(a,n){var i=e.beans.byID[n];return function(e,t,a){if("sleep"===e.action)return!1;var n=.33;return ft(e,"Anarchism")&&(n-=.25),ft(e,"Authority")&&(n+=.25),O(t)<=n}(i,e.seed,t.payload.beanKey)&&a.push(i),a}),[]);m.length?(La(e,{icon:"\ud83e\udd20",key:0,message:"".concat(i.name," was caught stealing ").concat(t.payload.good,"!"),trigger:"crimecrime",beanKey:i.key}),Ba.play("siren")):Ba.play("crime"),m.forEach((function(a){Ra(e,{payload:{beanKey:a.key,newState:{act:"chase",chase:{targetBeanKey:t.payload.beanKey,type:"arrest",crime:"steal"},intent:{act:"assault",assault:{perpBeanKey:a.key,assaultType:"arrest",victimBeanKey:t.payload.beanKey,crime:"steal"},intent:a.actionData}}},type:""})}))}}},beanArrest:function(e,t){var a=e.beans.byID[t.payload.criminalBeanKey],n=e.law.crimes[t.payload.crime];if(n)switch(n){case"death":var i=vt(a,e.seed,"execution");qa(e,a,i.death,i.emotes);break;case"jail":Ba.play("handcuffs"),a.lifecycle="incarcerated",a.jailTicksLeft=16;var r=he({az:O(e.seed)*Math.PI*2,r:30}),l={x:e.districts.byID[1].point.x+r.x,y:e.districts.byID[1].point.y+r.y};a.lastPoint=l;var c=e.districts.byID[1].hexString.split(",").map((function(e){return parseInt(e)})),o={q:c[0],r:c[1]};je.UpdatePosition("bean",a.key,{point:Object(b.a)({},l),velocity:Object(b.a)({},ae.velocity),hex:Object(b.a)({},o)},a.lastHex||{q:0,r:0}),a.lastHex=o}e.beans.allIDs.forEach((function(t){var n=e.beans.byID[t];"chase"===n.actionData.act&&n.actionData.chase&&n.actionData.chase.targetBeanKey===a.key&&(n.actionData.chase.targetBeanKey=void 0)}))},beanRelax:function(e,t){var a=e.beans.byID[t.payload.beanKey];a.discrete_fun+=1,Ja(a,e,{emote:"happiness",source:"Relaxation"}),ft(a,"Naturalism")&&Ja(a,e,{emote:"happiness",source:"Naturalism"})},enactLaw:function(e,t){var a=Ze[t.payload.lawKey];e.law.lawTree[a.axis]=a},repealLaw:function(e,t){var a=Ze[t.payload.lawKey];delete e.law.lawTree[a.axis]},beanInter:function(e,t){var a=e.buildings.byID[t.payload.graveyard],n=e.beans.byID[t.payload.bean];if(a&&n&&a.interredBeanKeys){a.interredBeanKeys.push(n.key);var i=e.cities.byID[n.cityKey];i.beanKeys=i.beanKeys.filter((function(e){return e!=n.key}))}},buyBots:function(e,t){var a=e.alien.difficulty.cost.market.resource.bots;At(e.alien,a,t.payload.amount)&&(e.alien.bots.amount+=t.payload.amount)},buyEnergy:function(e,t){var a=e.alien.difficulty.cost.market.resource.bots;At(e.alien,a,t.payload.amount)&&(e.alien.energy.amount+=t.payload.amount)},scrubHedons:function(e){var t=e.alien.difficulty.cost.market.scrubHedons;if(At(e.alien,t)){e.alien.hedons.amount;e.alien.hedons.amount=0}},buyTrait:function(e,t){if(At(e.alien,t.payload.l.cost)){var a=e.alien.beliefInventory.find((function(e){return e.trait===t.payload.l.trait}));a?a.gems+=3:e.alien.beliefInventory.push({trait:t.payload.l.trait,gems:3})}},beanBuy:function(e,t){var a,n,i,r,l=e.beans.byID[t.payload.beanKey],c=function(t){return null!=t.sellerEnterpriseKey?e.enterprises.byID[t.sellerEnterpriseKey]:t.sellerBeanKey?e.beans.byID[t.sellerBeanKey]:e.law};switch(t.payload.good){case"food":(null===(a=r=it(e.economy,e.law,l,"food",c,.5,3))||void 0===a?void 0:a.bought)&&(l.discrete_food+=r.bought,"stuffed"===l.food&&(Ja(l,e,{emote:"happiness",source:"Stuffed"}),Wa(e,l,"Gluttony","happiness",1)));break;case"medicine":(null===(n=r=it(e.economy,e.law,l,"medicine",c,.5,3))||void 0===n?void 0:n.bought)&&(l.discrete_health+=r.bought,"fresh"===l.health&&Ja(l,e,{emote:"happiness",source:"Robust"}));break;case"fun":(null===(i=r=it(e.economy,e.law,l,"fun",c))||void 0===i?void 0:i.bought)&&(l.discrete_fun=1,Ja(l,e,{emote:"happiness",source:"Entertainment"}),Ja(l,e,{emote:"happiness",source:"Entertainment"}))}l.actionData.buyAttempts=(l.actionData.buyAttempts||0)+1,r&&(Ba.play("cash"),r.tax&&(Wa(e,l,"Libertarianism","unhappiness",.1),Wa(e,l,"Progressivism","happiness",.1)),l.actionData.buyReceipt=r)},addTitle:function(e,t){I(e.titles,{key:0,name:"Title",privileges:[]})},editTitle:function(e,t){var a=e.titles.byID[t.payload.newT.key];e.titles.byID[t.payload.newT.key]=t.payload.newT,a&&a.badge!=t.payload.newT.badge&&e.beans.allIDs.forEach((function(n){e.beans.byID[n].titleKey===a.key&&(e.beans.byID[n].badge=t.payload.newT.badge)})),a&&a.headwear!=t.payload.newT.headwear&&e.beans.allIDs.forEach((function(n){e.beans.byID[n].titleKey===a.key&&(e.beans.byID[n].hat=t.payload.newT.headwear)}))},manualSave:function(e){f.SaveGame(e)},beanSetTitle:function(e,t){var a=e.beans.byID[t.payload.beanKey];a.titleKey=t.payload.titleKey;var n=e.titles.byID[t.payload.titleKey];a.badge=n.badge,a.hat=n.headwear}}});function Ra(e,t){var a,n=e.beans.byID[t.payload.beanKey].action,i=e.beans.byID[t.payload.beanKey],r=oa.Get("bean",i.key);"chat"===n&&(i.lastChatMS=Date.now()),"sleep"===n&&(i.discrete_stamina=7,ut(i,e.alien.difficulty)),"idle"===t.payload.newState.act&&(i.priorities=na(i,e.seed,e.cities.byID[i.cityKey],e.alien.difficulty)),i.activity_duration[n]+=r.elapsed,i.action=t.payload.newState.act,i.actionData=t.payload.newState;var l=null===(a=je.Get("bean",i.key).current)||void 0===a?void 0:a.point;!l||isNaN(l.x)||isNaN(l.y)||(i.lastPoint=Object(b.a)({},l)),r.elapsed=0}function Wa(e,t,a,n,i){ft(t,a)&&Math.random()<i&&Ja(t,e,{emote:n,source:a})}function Ja(e,t,a){e.discrete_sanity=Z(e.discrete_sanity+Re[a.emote],0,10),e.hedonHistory[0][a.source]=(e.hedonHistory[0][a.source]||0)+Fe[a.emote];var n=je.Get("bean",e.key).current||ae,i={key:t.pickups.nextID++,point:{x:n.point.x,y:n.point.y},type:a.emote,velocity:{x:0,y:0}};t.cities.byID[e.cityKey].pickupKeys.push(i.key),t.pickups.byID[i.key]=i,t.pickups.allIDs.push(i.key),je.Get("pickup",i.key).publish({point:{x:n.point.x,y:n.point.y},hex:{q:n.hex.q,r:n.hex.r},velocity:{x:0,y:0}})}var Ua=Fa.actions,Za=(Ua.refreshMarket,Ua.magnetChange),Va=Ua.worldTick,$a=Ua.remove_ufo,Xa=Ua.upgradeDistrict,Ya=Ua.newGame,Qa=Ua.loadGame,en=Ua.build,tn=Ua.changeEnterprise,an=Ua.fireBean,nn=Ua.upgrade,rn=Ua.upgradeLoft,ln=(Ua.upgradeStorage,Ua.beam),cn=Ua.abduct,on=Ua.release,sn=Ua.scan,un=Ua.vaporize,dn=Ua.pickUpPickup,mn=Ua.implant,yn=Ua.washBelief,pn=Ua.washNarrative,fn=(Ua.washCommunity,Ua.washMotive,Ua.extractBelief),hn=Ua.changeState,bn=Ua.beanEmote,vn=(Ua.beanGiveCharity,Ua.beanHitDestination),gn=Ua.beanWork,En=Ua.beanRelax,kn=Ua.beanBuy,wn=Ua.beanCrime,xn=Ua.beanArrest,Kn=Ua.beanBePersuaded,Dn=Ua.cheatAdd,Nn=Ua.manualSave,Sn=Ua.setCrimeLegality,jn=Ua.beanInter,In=Ua.addTitle,Cn=Ua.editTitle,_n=Ua.beanSetTitle,Mn=Ua.acknowledgeNewInsanity,On=Ua.enactLaw,Bn=Ua.repealLaw,Tn=Ua.setResearch,An=Ua.buyBots,Pn=Ua.buyEnergy,Gn=Ua.buyTrait,Ln=Ua.scrubHedons,qn=function(e,t){return e.cities.byID[t].beanKeys},Hn=Object(Lt.a)(qn,(function(e){return e.beans.byID}),(function(e,t){return e.reduce((function(e,a){return e.push(t[a]),e}),[])})),zn=(Object(Lt.a)(Hn,(function(e){var t=e.reduce((function(e,t){switch(t.ethnicity){case"circle":e.circle++;break;case"square":e.square++;break;case"triangle":e.triangle++}return e}),{circle:0,square:0,triangle:0});return t.circle>t.square&&t.circle>t.triangle?"circle":t.square>t.circle&&t.square>t.triangle?"square":"triangle"})),Fa.reducer,function(){return Object(d.b)()}),Fn=d.c,Rn=Object(Gt.b)({name:"selected",initialState:{selectedCityKey:void 0,selectedBeanKey:void 0},reducers:{doSelectCity:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}},doSelectDistrict:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:t.payload.district,selectedLotKey:void 0}},doSelectLot:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:t.payload.district,selectedLotKey:t.payload.lot}},doSelectBuilding:function(e,t){return{selectedCityKey:t.payload.cityKey,selectedBeanKey:void 0,selectedBuildingKey:t.payload.buildingKey,selectedLotKey:void 0,selectedDistrictKey:void 0}},doSelectBean:function(e,t){return{selectedHexKey:void 0,selectedCityKey:t.payload.cityKey,selectedBeanKey:t.payload.beanKey,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}},doSelectNone:function(e){return{selectedBeanKey:void 0,selectedCityKey:void 0,selectedHexKey:void 0,selectedBuildingKey:void 0,selectedDistrictKey:void 0,selectedLotKey:void 0}}}}),Wn=Rn.actions,Jn=Wn.doSelectDistrict,Un=Wn.doSelectNone,Zn=Wn.doSelectBean,Vn=Wn.doSelectCity,$n=Wn.doSelectBuilding,Xn=Wn.doSelectLot,Yn=Object(Gt.a)({reducer:{world:Fa.reducer,selected:Rn.reducer},middleware:Object(Gt.c)().concat([function(e){return function(e){return function(t){switch(t.type){case"world/magnetChange":break;default:t.type.startsWith("selected")||f.Dirty.publish(!0)}return e(t)}}}])}),Qn=function(e){return null!=e.selected.selectedCityKey?e.world.cities.byID[e.selected.selectedCityKey]:void 0},ei=function(e){return null!=e.selected.selectedBeanKey?e.world.beans.byID[e.selected.selectedBeanKey]:void 0},ti=function(e){if(null!=e.selected.selectedCityKey&&e.world.cities.byID[e.selected.selectedCityKey]&&null!=e.selected.selectedLotKey){var t=e.world.lots.byID[e.selected.selectedLotKey].buildingKey;if(null!=t)return e.world.buildings.byID[t]}},ai=function(e){return e.world.events.allIDs},ni=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={confirming:!1},n}return Object(o.a)(a,[{key:"click",value:function(){this.state.confirming?(this.props.onConfirm(),this.setState({confirming:!1})):this.setState({confirming:!0})}},{key:"render",value:function(){var e=this;return i.a.createElement("button",{className:this.props.className,onClick:function(){return e.click()},disabled:this.props.disabled},this.state.confirming?this.props.confirmText:this.props.children)}}]),a}(i.a.Component),ii=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.props.onChange(e.target.value),n.setState({key:e.target.value})},n.state={key:e.value||null},n}return Object(o.a)(a,[{key:"hint",value:function(){if(this.props.hint)return i.a.createElement("option",{value:"",disabled:!0,selected:!0,hidden:!0},this.props.hint)}},{key:"getTextForOption",value:function(e){return this.props.titleCase&&(e=e[0].toUpperCase()+e.slice(1)),e}},{key:"options",value:function(){var e=this;return this.props.options.map((function(t){return i.a.createElement("option",{value:t,key:t,title:e.getTitleForOption(t)},e.getTextForOption(t))}))}},{key:"render",value:function(){return i.a.createElement("select",{onChange:this.onChange,value:this.state.key,required:null!=this.props.hint},this.hint(),this.options())}},{key:"getTitleForOption",value:function(e){}}]),a}(i.a.Component),ri=(a(31),function(e){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},e.data.icon),e.leftButton),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},e.titleView,e.cost?i.a.createElement("span",{className:"pull-r"},e.cost,"\ud83e\udde0"):null),e.data.description?e.data.description.split(";").map((function(e,t){return i.a.createElement("small",{className:"marg-b-6",key:t}," ",e)})):null,i.a.createElement("div",{className:"grow-1 text-center"},e.bottomView))))}),li=function(e){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal edit badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},e.data.icon)),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",{title:e.data.description,className:e.divergent?"divergent marg-r-6":"marg-r-6"},e.data.noun),i.a.createElement("span",{className:"pull-r"},e.cost,"\ud83e\udde0")),i.a.createElement("small",{className:"marg-b-6"},e.data.description),i.a.createElement("div",{className:"grow-1 text-center"}))),i.a.createElement("div",{className:"horizontal"},e.frozen?null:i.a.createElement(ni,{className:"callout pad-4 marg-0",confirmText:"-"+e.cost.toString()+"\ud83e\udde0?",disabled:e.available<e.cost,onConfirm:e.wash},"\ud83d\udebf ",i.a.createElement("small",null,"Wash Out")),i.a.createElement(ni,{className:"callout pad-4 marg-0",confirmText:"-"+e.cost.toString()+"\ud83e\udde0?",disabled:e.available<e.cost,onConfirm:e.extract},"\ud83d\udc8e ",i.a.createElement("small",null,"Copy to Gem"))))},ci=D.slice().sort((function(e,t){return e.localeCompare(t)})),oi=(i.a.Component,a(32),function(e){var t=Fn((function(e){return e.world.alien.beliefInventory})),a=zn();return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement(ri,{key:t.trait,data:k[t.trait],titleView:i.a.createElement("strong",null,k[t.trait].noun),leftButton:i.a.createElement(ni,{onConfirm:function(){return a(mn({beanKey:e.beanKey,trait:t.trait}))},className:"callout marg-0",confirmText:"-1 \ud83e\udde0?",disabled:t.gems<1||e.dogmatic},"Implant"),bottomView:i.a.createElement("span",null,i.a.createElement("span",{className:"trait-gem"}),"x",t.gems)})})))}),si=function(){var e=Fn(ei),t=Fn((function(t){return null!=(null===e||void 0===e?void 0:e.key)&&t.world.alien.scanned_bean[e.key]})),a=Fn((function(e){return e.world.alien.difficulty})),n=Fn((function(e){return e.world.alien.techProgress})),r=Fn((function(e){return e.world.insanityEvent})),l=zn(),c=Bt(n,"sanity_bonus")?-1:0;if(null==e)return i.a.createElement("div",null);for(var o=ft(e,"Dogmatism"),s=[],u=1;u<11;u++)s.push(e.discrete_sanity>=u?"\ud83e\udde0":"\ud83d\ude35");return i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal fancy-header"},i.a.createElement("div",null,"\ud83e\udde0\ud83d\udebf BRAINWASH"),i.a.createElement("div",null,i.a.createElement("strong",null,xt(e)," ",e.name)),i.a.createElement("div",null,i.a.createElement("table",{className:"trait-measure"},i.a.createElement("tbody",null,i.a.createElement("tr",null,s.map((function(e,t){return i.a.createElement("td",{key:t,className:"\ud83d\ude35"===e?"grey":""},e)}))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:2,className:"set-1"},i.a.createElement("small",null,"Psychotic")),i.a.createElement("td",{colSpan:2,className:"set-2"},i.a.createElement("small",null,"Disturbed")),i.a.createElement("td",{colSpan:3,className:"set-3"},i.a.createElement("small",null,"Stressed")),i.a.createElement("td",{colSpan:3,className:"set-4"},i.a.createElement("small",null,"Sane")),i.a.createElement("td",null)))))),i.a.createElement("p",{className:"pad-4p text-center"},"sane"!=e.sanity?i.a.createElement("small",null,"Brainwashing subjects with low sanity \ud83e\udde0 has a \ud83c\udfb2 to add extremely negative traits!"):null),r&&r.beanKey===e.key?i.a.createElement("div",{className:"pad-4p text-center red-alert"},i.a.createElement("h2",null,e.name," is inflicted with ",k[r.newInsanity].icon," ",k[r.newInsanity].noun," due to brainwashing!",i.a.createElement("button",{onClick:function(){return l(Mn())}},"\u274c"))):null,i.a.createElement("div",{style:{clear:"both"}},o?i.a.createElement("div",{className:"text-center"},"\ud83d\udc36 Dogmatic subjects cannot change their minds"):null,t?i.a.createElement("div",{className:"horizontal scroll"},i.a.createElement(li,{available:e.discrete_sanity,frozen:o,wash:function(){return l(pn({beanKey:e.key,faith:e.faith}))},extract:function(){},cost:a.cost.bean_brain.brainwash_ideal.sanity||0,data:E[e.faith]}),e.beliefs.map((function(t){return i.a.createElement(li,{key:t,available:e.discrete_sanity,frozen:o&&"Dogmatism"!=t,divergent:!1,wash:function(){return l(yn({beanKey:e.key,trait:t}))},extract:function(){return l(fn({beanKey:e.key,trait:t}))},cost:(a.cost.bean_brain.brainwash_secondary.sanity||0)+c,data:k[t]})}))):i.a.createElement("div",{className:"text-center"},"\ud83d\udef0\ufe0f Scan this subject to reveal its Traits! "),i.a.createElement("h3",{className:"pad-4p"},i.a.createElement("span",{className:"trait-gem"})," Trait Gems"),i.a.createElement("div",{className:"horizontal scroll"},i.a.createElement(oi,{beanKey:e.key,dogmatic:o}))))},ui=function(e){return i.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"+(e.additionalClasses||"")},e.options.map((function(t){return i.a.createElement("button",{type:"button",key:t.value,onClick:function(){return t.onClick()},className:e.active===t.value?"active":""},t.icon," ",t.text)})))},di={social_deference:{description:"\ud83c\udfb2 that nearby subjects emit \ud83d\udca2; \ud83c\udfb2 that this subject gains \ud83d\udc4d"},criminal_immunity:{description:"This subject will never be penalized due to crime."},tax_exemption:{description:"This subject will never pay taxes."},hereditary:{description:"Children of this subject automatically gain this title."},gentility:{description:"This subject will not work but will still be paid."}},mi=function(e){var t=Fn((function(e){return e.world.titles.allIDs.reduce((function(t,a){return t.push(e.world.titles.byID[a]),t}),[])})),a=zn();return i.a.createElement("div",{className:"pad-4p"},i.a.createElement(ui,{active:"titles",options:[{icon:"\ud83d\udc51",text:"Titles",value:"titles",onClick:function(){}},{icon:"\ud83d\udd16",text:"Names",value:"names",onClick:function(){}}]}),i.a.createElement("div",{className:"subheader"},i.a.createElement("h2",null,"\ud83d\udc51 Titles",i.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){a(In({}))}},"\u2795 Title"))),i.a.createElement("div",{className:"title-row"},t.map((function(e){return i.a.createElement(yi,{key:e.key,title:e,onEdit:function(e){a(Cn({newT:e}))}})})),0===t.length?i.a.createElement("div",null,i.a.createElement("p",null,i.a.createElement("i",null,"No Titles")),i.a.createElement("p",null,"Titles are cosmetic items and privileges that can be awarded to subjects.")):null))},yi=function(e){return i.a.createElement("div",{className:"title-box"},i.a.createElement("div",null,i.a.createElement("label",null,"Title:\xa0",i.a.createElement("input",{type:"text",value:e.title.name,onChange:function(t){return e.onEdit(Object(b.a)(Object(b.a)({},e.title),{},{name:t.target.value}))}}))),i.a.createElement("div",null,i.a.createElement("label",null,"Headwear:\xa0",i.a.createElement("select",{value:e.title.headwear,onChange:function(t){return e.onEdit(Object(b.a)(Object(b.a)({},e.title),{},{headwear:t.target.value}))}},i.a.createElement("option",{value:void 0},"None"),i.a.createElement("option",{value:"\ud83d\udc51"},"\ud83d\udc51"),i.a.createElement("option",{value:"\ud83d\udc52"},"\ud83d\udc52"),i.a.createElement("option",{value:"\ud83c\udfa9"},"\ud83c\udfa9"),i.a.createElement("option",{value:"\ud83c\udf93"},"\ud83c\udf93"),i.a.createElement("option",{value:"\ud83e\udde2"},"\ud83e\udde2"))),i.a.createElement("label",null,"\xa0Badge:\xa0",i.a.createElement("select",{value:e.title.badge,onChange:function(t){return e.onEdit(Object(b.a)(Object(b.a)({},e.title),{},{badge:t.target.value}))}},i.a.createElement("option",{value:void 0},"None"),i.a.createElement("option",{value:"\u2b50"},"\u2b50"),i.a.createElement("option",{value:"\ud83d\udee1\ufe0f"},"\ud83d\udee1\ufe0f"),i.a.createElement("option",{value:"\u2696\ufe0f"},"\u2696\ufe0f"),i.a.createElement("option",{value:"\ud83d\udccb"},"\ud83d\udccb"),i.a.createElement("option",{value:"\ud83c\udfc5"},"\ud83c\udfc5"),i.a.createElement("option",{value:"\ud83c\udf80"},"\ud83c\udf80"),i.a.createElement("option",{value:"\ud83c\udf38"},"\ud83c\udf38")))),i.a.createElement("h3",null,"Privileges",i.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){var t=e.title.privileges.slice();t.push(void 0),e.onEdit(Object(b.a)(Object(b.a)({},e.title),{},{privileges:t}))}},"\u2795 Privilege")),e.title.privileges.map((function(t,a){return i.a.createElement("div",{key:t},i.a.createElement("select",{key:a,value:t,onChange:function(t){var n=e.title.privileges.slice();"None"===t.target.value?n.splice(a,1):n.splice(a,1,t.target.value),e.onEdit(Object(b.a)(Object(b.a)({},e.title),{},{privileges:n}))}},i.a.createElement("option",{value:void 0},"None"),i.a.createElement("option",{value:"social_deference"},"Social Deference"),i.a.createElement("option",{value:"criminal_immunity"},"Criminal Immunity"),i.a.createElement("option",{value:"tax_exemption"},"Tax Exemption"),i.a.createElement("option",{value:"hereditary"},"Hereditary"),i.a.createElement("option",{value:"gentility"},"Gentility")),null!=t&&di[t]?i.a.createElement("div",null,di[t].description):null)})))},pi={state:"Collectivist",ego:"Independent",trad:"Elitist",prog:"Progressive",circle:"Brunette",square:"Blonde",triangle:"Redhead",rocket:"Futuristic",dragon:"Mythical",music:"Dramatic",noFaith:"Nihilistic",starving:"Starving",hungry:"Hungry",sated:"Sated",stuffed:"Stuffed",homeless:"Homeless",sleepy:"Sleepy",awake:"Awake",rested:"Rested",sick:"Sick",sickly:"Sickly",bruised:"Bruised",fresh:"Robust",sane:"Sane",stressed:"Confused",disturbed:"Disturbed",psychotic:"Psychotic",housed:"Housed",graveyard:"Graveyard",house:"House",hospital:"Hospital",farm:"Farm",theater:"Theater",church:"Church",jail:"Jail",park:"Park",nature:"Elysian Scenery"},fi=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"header",value:function(){return this.props.children?i.a.createElement("b",null,this.props.children):null}},{key:"render",value:function(){var e=this,t=this.props.beans.filter((function(t){return e.props.need(t)==e.props.dire})).length,a={width:Math.floor(t/this.props.beans.length*100)+"%"},n=this.props.beans.filter((function(t){return e.props.need(t)==e.props.abundant})).length,r={width:Math.floor(n/this.props.beans.length*100)+"%"};return i.a.createElement("div",{className:this.props.className},this.header(),i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"bar-inner dire",style:a},t>0?"".concat(t," ").concat(pi[this.props.dire]):""),i.a.createElement("div",{className:"bar-inner abundant",style:r},n>0?n:"")))}}]),a}(i.a.Component);function hi(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}var bi=function(){var e=Fn((function(e){return Hn(e.world,0)})),t=Fn((function(e){return e.world.economy})),a=Fn((function(e){return e.world.dwellings.allIDs.length})),n=hi(e.map((function(e){return e.discrete_food}))),r=hi(e.map((function(e){return e.discrete_health}))).toFixed(1),l=hi(e.map((function(e){return e.discrete_stamina}))).toFixed(1),c=e.reduce((function(e,t){return e+t.cash}),0),o=c/(e.length||1),s=hi(e.map((function(e){return e.cash}))),u=e.filter((function(e){return e.cash<1})).length,d=Math.max(o,s),m=e.filter((function(e){return e.cash>d})),y=m.length/(e.length||1)*100,p=m.reduce((function(e,t){return e+t.cash}),0)/c*100,f=e.reduce((function(e,t){return e[t.job]=(e[t.job]||0)+1,e}),{}),h=((f.jobless||0)/e.length*100).toFixed(1);function b(e,t){return e.supply+=t.quantity,e.price+=t.price,e.count++,e.avg=e.price/e.count,e}var v=t.market.listings.food.reduce(b,{supply:0,price:0,avg:0,count:0}),g=t.market.listings.medicine.reduce(b,{supply:0,price:0,avg:0,count:0});return i.a.createElement("div",null,i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"State of the Utopia")),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udf5e Food Security"),i.a.createElement(fi,{beans:e,need:function(e){return e.food},dire:"hungry",abundant:"stuffed",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",n.toFixed(1)," \ud83c\udf5e"),i.a.createElement("td",{className:"text-center"},"Supply: ",v.supply," \ud83c\udf5e @ $",v.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.food," \ud83c\udf5e"))))),i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83e\ude7a Healthcare"),i.a.createElement(fi,{beans:e,need:function(e){return e.health},dire:"sick",abundant:"fresh",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",r," \ud83e\ude7a"),i.a.createElement("td",{className:"text-center"},"Supply: ",g.supply," \ud83e\ude7a @ $",g.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",t.unfulfilledMonthlyDemand.medicine," \ud83e\ude7a")))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udfe1 Housing")," ",i.a.createElement("br",null),i.a.createElement(fi,{beans:e,need:function(e){return e.housing},dire:"homeless",abundant:"housed",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",l," \ud83c\udfe1"),i.a.createElement("td",{className:"text-center"},"Supply: ",a," \ud83c\udfe1"),i.a.createElement("td",{className:"text-right"})))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83d\udcb0 Wealth")," ",i.a.createElement("br",null),u," penniless citizens \xa0 \xa0 Cost of Living: $",lt(t).toFixed(2)," ",i.a.createElement("br",null),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Total $",c.toFixed(2)),i.a.createElement("td",{className:"text-center"},"Median: $",s.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Avg: $",o.toFixed(2))))),"Top ",y.toFixed(1),"% of subjects own ",p.toFixed(1),"% of the wealth"),i.a.createElement("span",null,i.a.createElement("strong",null,"Unemployment")," ",h,"% (",f.jobless,")",i.a.createElement("br",null),i.a.createElement("ul",{className:"boxes"},i.a.createElement("li",null,f.farmer||0," farmers"),i.a.createElement("li",null,f.builder||0," builders"),i.a.createElement("li",null,f.doc||0," doctors"),i.a.createElement("li",null,f.entertainer||0," entertainers")))))},vi=function(e){return i.a.createElement("div",null)},gi=function(e){var t=Fn((function(e){return e.world.law.cash}));return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83d\udcb0 Treasury: ",t.toFixed(2))))},Ei=function(e){var t=Object(n.useState)("Welfare"),a=Object(qt.a)(t,2),r=a[0],l=a[1];return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("h2",{className:"marg-b-0"},"Utopia Government"),i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"},i.a.createElement("button",{type:"button",onClick:function(){return l("Welfare")},className:"Welfare"===r?"active":""},"\ud83e\udd32 Welfare"),i.a.createElement("button",{type:"button",onClick:function(){return l("Crime")},className:"Crime"===r?"active":""},"\ud83d\udea8 Crime"),i.a.createElement("button",{type:"button",onClick:function(){return l("Taxation")},className:"Taxation"===r?"active":""},"\ud83d\udcb0 Taxes"),i.a.createElement("button",{type:"button",onClick:function(){return l("funds")},className:"funds"===r?"active":""},"\ud83d\udcb8 Funds")))),"funds"===r?i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement(gi,null)),i.a.createElement("div",null)):"Crime"===r?i.a.createElement("div",null,i.a.createElement(ki,null)):i.a.createElement(Di,{group:r}))},ki=function(e){return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("strong",null,"Criminal Laws"),i.a.createElement("div",{className:"horizontal scroll"},["steal","rob","profanity"].map((function(e){return i.a.createElement(wi,{key:e,crime:e})}))),i.a.createElement("br",null),i.a.createElement("div",{className:"horizontal scroll"},["murder","hurt","destroy"].map((function(e){return i.a.createElement(wi,{key:e,crime:e})}))))},wi=function(e){return i.a.createElement("div",{key:e.crime},i.a.createElement("div",{className:"horizontal"},i.a.createElement("div",{className:"circular"},Ve[e.crime].icon),i.a.createElement("div",null,i.a.createElement("strong",null,Ve[e.crime].name),i.a.createElement("br",null),i.a.createElement("small",null,Ve[e.crime].description))),i.a.createElement("div",null,i.a.createElement(Ki,{crime:e.crime})))},xi=[{icon:"\u2714\ufe0f",text:"Legal",value:"none",onClick:function(){}},{icon:"\ud83d\udcb8",text:"Fine",value:"fine",onClick:function(){}},{icon:"\ud83d\udea8",text:"Jail",value:"jail",onClick:function(){}},{icon:"\u2620\ufe0f",text:"Death",value:"death",onClick:function(){}}],Ki=function(e){var t=Fn((function(t){return t.world.law.crimes[e.crime]})),a=zn(),n=xi.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{onClick:function(){a(Sn({crime:e.crime,legality:t.value}))}})}));return i.a.createElement(ui,{active:t||"none",options:n})},Di=function(e){var t=Object.values(Ze).filter((function(t){return t.group===e.group})),a=Fn((function(e){return e.world.alien.seenBeliefs})),n=Fn((function(e){return e.world.alien.beliefInventory})),r=Fn((function(e){return e.world.law})),l=zn();return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("strong",null,e.group," Laws"),i.a.createElement("div",{className:"horizontal scroll"},t.map((function(e){return i.a.createElement(Ni,{seenBeliefs:a,id:e.key,beliefs:n,key:e.key,enacted:$e(r,e.key),enactLaw:function(e){return l(On({lawKey:e}))},revokeLaw:function(e){return l(Bn({lawKey:e}))}})}))))},Ni=function(e){var t,a,n=Ze[e.id],r=(t=n.prereqs,a=e.seenBeliefs,0===t.length||t.some((function(e){return We(e,a)}))),l=function(e,t){return 0===e.length||e.every((function(e){return We(e,t)}))}(n.prereqs,e.seenBeliefs);return i.a.createElement("div",{className:"vertical law-formula"},i.a.createElement("div",{className:"horizontal"},i.a.createElement("div",{className:"circular"},r?n.icon:"\u2754"),i.a.createElement("div",null,i.a.createElement("strong",null,r?n.name:"Unknown"),i.a.createElement("div",null,r?i.a.createElement("small",null," ",n.description," "):null))),i.a.createElement("div",{className:"vertical"},n.prereqs.map((function(t){var a,n=We(t,e.seenBeliefs),r=(a=t,Array.isArray(a)?a.join("/"):a);return n?i.a.createElement("span",{className:"law-formula-ingredient",key:r},function(e){return Array.isArray(e)?e.map((function(e){return Ue(e)})).join(" / "):Ue(e)}(t)):i.a.createElement("span",{className:"law-formula-ingredient unknown",key:r},"\u2754 Unknown")}))),e.enacted?i.a.createElement("button",{className:"callout",onClick:function(){return e.revokeLaw(e.id)}},"\ud83d\uddd1\ufe0f\xa0Revoke Active Law"):i.a.createElement("button",{className:"callout",disabled:!l,onClick:function(){return e.enactLaw(e.id)}},l?"\u2712\ufe0f":i.a.createElement("span",{className:"grey"},"\ud83d\udd12"),"\xa0Enact"),e.children)},Si=function(e){return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h3",null,"Welcome to the"),i.a.createElement("h2",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Laboratory"),i.a.createElement("div",null,"Thank you for joining the ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," Cultivation Division of the ",i.a.createElement("strong",null,"\ud83c\udf0c\xa0Galactic Xenosensation Federation!")," Interdimensional petri dish ",i.a.createElement("span",{style:{whiteSpace:"nowrap"}},"#",i.a.createElement("input",{type:"text",value:e.seed,onChange:function(t){return e.changeSeed(t.currentTarget.value)},maxLength:19,style:{width:"115px",fontFamily:"monospace",fontSize:"11px"}}))," is ready for farming."),i.a.createElement("p",null,"As a ",i.a.createElement("select",null,i.a.createElement("option",null,"Human Emotion Farmer")),", you are required to execute the following duties:"),i.a.createElement("ul",null,i.a.createElement("li",null,"Construct ",i.a.createElement("strong",null,"\ud83c\udfe0 Buildings")," for your ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef8 Beam In")," ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects for cultivation."),i.a.createElement("li",null,"Harvest your subject's positive ",i.a.createElement("strong",null,ze.happiness," Hedons"),"."),i.a.createElement("li",null,"Sell the Hedons on the ",i.a.createElement("br",null),i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market"),".")),i.a.createElement("div",null)),i.a.createElement("div",null,i.a.createElement("p",null,"The GXF's records indicate ",i.a.createElement("select",null,i.a.createElement("option",null,"Humans"))," are a",i.a.createElement("br",null),i.a.createElement("u",null,"mentally malleable")," and ",i.a.createElement("u",null,"physically fragile")," species. Try the following cultivation methods:"),i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef0\ufe0f Scan")," your subject's primitive minds for information on what pleases them."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udebf Brainwash")," subjects to change their ",i.a.createElement("strong",null,"\ud83e\udde0\xa0Traits"),". Try to add Traits that emit more ",i.a.createElement("strong",null,ze.happiness,"\xa0Hedons"),"."),i.a.createElement("li",null,"Avoid letting your subjects die or endure pain; this makes ",i.a.createElement("strong",null,ze.unhappiness,"\xa0Antihedons")," which are less profitable."),i.a.createElement("li",null,"Use your knowledge of Traits to modify the farm's ",i.a.createElement("strong",null,"\ud83d\uddf3\ufe0f\xa0Government")," to maximize Hedon generation."),i.a.createElement("li",null,"Use the GXF's ",i.a.createElement("strong",null,"\ud83e\uddea Research Lab")," to upgrade your farm, when stocked with ",i.a.createElement("strong",null,"\ud83d\udc7e Abducted")," subjects.")),i.a.createElement("h3",null,"\ud83c\udf0c Galactic Xenosensation Federation ",i.a.createElement("br",null),i.a.createElement("div",{className:"text-right"},i.a.createElement("small",null,i.a.createElement("i",null,"1 trillion sensations. 100% organic. 100% gourmet.")))))))},ji=function(e){return i.a.createElement("div",null)},Ii=function(e){var t=Object(n.useState)("main"),a=Object(qt.a)(t,2),r=a[0],l=a[1],c=f.HasContinueGame(),o=f.GetGameSlots();return i.a.createElement("div",null,i.a.createElement("h1",{className:"text-center"},"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),"main"===r?i.a.createElement("div",null,null!=c?i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.loadGame(c)}},"\ud83e\uddeb Continue Game")):null,i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return e.startGame()}},"\ud83d\udef8 Start New Game")),i.a.createElement("div",{className:"text-center"},i.a.createElement("button",{className:"callout button f-size-15em",onClick:function(){return l("showslots")},disabled:o.every((function(e){return null==e.brief}))},"\ud83d\uddc2\ufe0f Load Game"))):i.a.createElement("div",{className:"card-parent vertical load-menu pad-4p"},o.map((function(t){return i.a.createElement("div",{key:t.id,className:"card marg-b-20"},i.a.createElement("button",{disabled:null==t.brief,className:"",onClick:function(){t.brief&&e.loadGame(t.id)}},t.brief?i.a.createElement("span",{className:"f-size-125em"},i.a.createElement("strong",null,t.brief.Name),"\xa0",i.a.createElement("span",null,"Year ",t.brief.Age.year),"\xa0",i.a.createElement("span",null,t.brief.Population," \ud83d\ude10")):i.a.createElement("span",{className:"f-size-125em"},"Slot ",t.id)))}))))},Ci=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return i.a.createElement("svg",{width:"100",height:"300",xmlns:"http://www.w3.org/2000/svg",style:{},className:this.props.classN+" robot-arm"},i.a.createElement("g",null,i.a.createElement("title",null,"robotarm"),i.a.createElement("rect",{fill:"transparent",id:"canvas_background",height:"302",width:"102",y:"-1",x:"-1"}),i.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},i.a.createElement("rect",{fill:"url(#gridpattern)",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),i.a.createElement("g",null,i.a.createElement("title",null,"Layer 1"),i.a.createElement("rect",{id:"svg_2",height:"200",width:"48",y:"91.63545",x:"25",strokeWidth:"1.5",stroke:"#000",fill:"#BBBBBB"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_1",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_3",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_4",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_5",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"},this.props.tool)),i.a.createElement("text",{y:"250",x:"-20",fontSize:"4em"},this.props.tool))}}]),a}(i.a.Component);a(33);var _i=["\ud83d\udce1","\ud83d\udddc\ufe0f","\ud83d\udd2c","\ud83d\udc89","\ud83d\udd0e","\ud83e\uddfc","\ud83e\uddf2","\ud83c\udfa5","\ud83d\udd27"];function Mi(e){var t=e+1;return t===_i.length&&(t=0),t}var Oi=function(){var e=Fn((function(e){return e.world.alien.abductedBeanKeys})),t=Fn((function(e){return e.world.alien.techProgress})),a=Fn((function(e){return e.world.alien.currentlyResearchingTech})),r=zn(),l=Object(n.useState)(0),c=Object(qt.a)(l,2),o=c[0],s=c[1],u=Object(n.useState)(3),d=Object(qt.a)(u,2),m=d[0],y=d[1],p=Object(n.useState)(2),f=Object(qt.a)(p,2),h=f[0],b=f[1],v=Object(n.useState)(1),g=Object(qt.a)(v,2),E=g[0],k=g[1];Object(n.useEffect)((function(){var e=window.setInterval((function(){Math.random()<.51&&s(Mi(o)),Math.random()<.51&&y(Mi(m)),Math.random()<.51&&b(Mi(h)),Math.random()<.51&&k(Mi(E))}),1e3);return function(){window.clearInterval(e)}}));var w=Object.values(Mt);return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h2",null,"Research \ud83e\uddea Lab"),i.a.createElement("div",{className:"vertical"},w.map((function(e){return function(e,t,a,n){var r=null==t[e.tech]?0:t[e.tech].researchPoints,l=e.techPoints,c={width:Math.min(r/l*100,100)+"%"},o=r>=l,s=a===e.tech,u=o?"\u2705":s?"\ud83d\udd2c":"\u2b55\ufe0f",d=s?"active":"inactive";return i.a.createElement("div",{className:"card-parent "+d,key:e.tech},i.a.createElement("button",{className:"card button",onClick:function(){return n(e.tech)}},i.a.createElement("strong",null,e.name),i.a.createElement("strong",{className:"pull-r f-size-125em"},u),i.a.createElement("div",null,e.description),i.a.createElement("div",{className:"bar f-size-12 h-12"},i.a.createElement("div",{className:"bar-inner text-center",style:c}),r,"/",l," tech")))}(e,t,a,(function(e){return r(Tn({t:e}))}))})))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",null,i.a.createElement("div",{className:"robot"},"\ud83e\udd16",i.a.createElement(Ci,{classN:"far-left",tool:_i[o]}),i.a.createElement(Ci,{classN:"left",tool:_i[m]}),i.a.createElement(Ci,{classN:"near-right",tool:_i[h]}),i.a.createElement(Ci,{classN:"far-right",tool:_i[E]}))),i.a.createElement("div",{className:"h-42em"},e.map((function(e){return i.a.createElement("span",{key:e,className:"victim bean triangle shake"},"\ud83d\ude28")}))),i.a.createElement("div",{className:"text-center"},"Currently probing ",e.length," beings for ",e.length," tech a day",i.a.createElement("p",null,i.a.createElement("small",null,"1 tech per research subject per day"))),e.length>0?i.a.createElement("div",{className:"text-right"},i.a.createElement(ni,{className:"callout",onConfirm:function(){r(on())},confirmText:"-1 Research Subject?"},"\ud83c\udf88 Release Research Subject")):null)),i.a.createElement("div",null))},Bi=function(){var e=Fn((function(e){return e.world.alien.beliefInventory})),t=Fn((function(e){return e.world.alien.seenBeliefs})),a=Object(n.useState)(),r=Object(qt.a)(a,2),l=(r[0],r[1],[]);return Object.keys(t).forEach((function(e){null!=k[e]&&l.push(k[e])})),l.sort((function(e,t){return e.noun.localeCompare(t.noun)})),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"Subject \ud83e\udde0 Traits")),i.a.createElement("div",{className:"col-2-30-60"},i.a.createElement("div",null,i.a.createElement("div",{className:"scroll"},i.a.createElement("div",{className:"scoll-sticky-h"},i.a.createElement("strong",null,i.a.createElement("span",{className:"trait-gem"}),"Trait Gems")),e.length<1?i.a.createElement("div",null,"No Trait Gems! ",i.a.createElement("br",null),"\ud83d\ude35 Brainwash your subjects  ",i.a.createElement("br",null),"or buy from the \ud83d\udecd\ufe0f Market"):e.map((function(e){return i.a.createElement("div",{key:e.trait},i.a.createElement("div",null,i.a.createElement("strong",null,k[e.trait].icon," ",k[e.trait].noun)),i.a.createElement("div",null,"This can be implanted ",e.gems," more times"))})))),i.a.createElement("div",null,i.a.createElement("div",{className:"modal-scroll-v"},i.a.createElement("div",{className:"sticky-t-0"},i.a.createElement("strong",null,"Discovered ",l.length," of ",D.length," Traits")),l.length<1?i.a.createElement("div",null,"No Traits Scanned! ",i.a.createElement("br",null),"\ud83d\udef0\ufe0f Scan some of your subjects."):l.map((function(e){return i.a.createElement(ri,{key:e.noun,data:e,cost:0,titleView:i.a.createElement("strong",null,e.noun),bottomView:i.a.createElement("span",null)})}))))))},Ti=function(e){var t=Object(n.useState)(!1),a=Object(qt.a)(t,2),r=a[0],l=a[1],c=Fn((function(t){return t.world.cities.byID[e.cityKey]})),o=Fn((function(t){return t.world.ufos.byID[e.ufoKey]}));Object(n.useEffect)((function(){setTimeout((function(){l(!0),Ba.play("teleport"),setTimeout((function(){l(!1)}),1800)}),1800)}),[]);var s=Object(b.a)({},be(pe(c.district_hex_size,c.petriOrigin,o.hex)));return i.a.createElement("span",{style:s,className:"ufo"},"\ud83d\udef8",r?i.a.createElement("span",{className:"beam"}):null)},Ai=["company","co-op","commune"],Pi={company:"\ud83c\udfa9","co-op":"\ud83e\udd1d",commune:"\u2692\ufe0f"},Gi=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){return i.a.createElement("small",null,Ha(this.props.cost,"-",this.props.qty)," ",this.props.rider)}}]),a}(i.a.Component),Li=function(e){var t=Fn((function(t){return e.dwellingKeys.map((function(e){return t.world.dwellings.byID[e]}))})),a=Fn((function(e){return t.reduce((function(t,a){return null!=a.occupantKey&&(t[a.key]=e.world.beans.byID[a.occupantKey].name),t}),{})}));return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,"Housing:")),t.map((function(e,t){return i.a.createElement("div",{key:e.key},Ht[e.kind]," ",(n=e.kind)[0].toUpperCase()+n.substr(1)," #",t+1," ",a[e.key]||"");var n})))},qi=function(e){var t=zn();return i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return t(ln({cityKey:e.city,where:e.hex}))}},"\ud83d\udef8 Beam In New Subject",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.beam,rider:"+Subject"})))},Hi=function(e){var t,a,n=Fn((function(t){return e.district.lots.map((function(e){return t.world.lots.byID[e]}))})),r=null!==(t=e.selectedLotKey)&&void 0!==t?t:null===(a=n.find((function(e){return null==e.buildingKey})))||void 0===a?void 0:a.key,l=zn(),c=e.difficulty.cost.emptyHex;return null!=r?i.a.createElement("div",null,i.a.createElement("h3",null,"Build:"),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"house"}))}},ve.house," House",i.a.createElement(Gi,{cost:c.build.house}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"farm"}))}},ve.farm," Farm",i.a.createElement(Gi,{cost:c.build.farm})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"hospital"}))}},ve.hospital," Hospital",i.a.createElement(Gi,{cost:c.build.hospital}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"theater"}))}},ve.theater," Theater",i.a.createElement(Gi,{cost:c.build.theater})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"park"}))}},ve.park," Park",i.a.createElement(Gi,{cost:c.build.park}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"jail"}))}},ve.jail," Jail",i.a.createElement(Gi,{cost:c.build.jail})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(en({city:e.cityKey,lot:r,what:"graveyard"}))}},ve.graveyard," Graveyard",i.a.createElement(Gi,{cost:c.build.graveyard})))):i.a.createElement("div",null)},zi={urban:"\u26f2",rural:"\ud83d\udcea",fallow:"\ud83c\udf33",nature:"\ud83c\udfd4\ufe0f"},Fi={urban:"Urban",rural:"Rural",fallow:"Empty",nature:"Nature"},Ri=function(e){var t=Object(d.c)((function(e){return e.selected.selectedDistrictKey})),a=Fn((function(e){return null!=t?e.world.districts.byID[t]:void 0})),n=Fn((function(e){return e.selected.selectedLotKey})),r=Object(d.c)(ti),l=Object(d.c)(Qn),c=zn();return l&&null==a?i.a.createElement("div",null):l&&r&&a?i.a.createElement(Wi,{building:r,city:l,hex:a,difficulty:e.difficulty}):l&&a?i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,zi[a.kind]," ",Fi[a.kind]," District")," in ",i.a.createElement("strong",null,l.name),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return c(Vn({cityKey:l.key}))}},"\u274c")),null!=n?i.a.createElement("span",null,"Lot #",n+1):i.a.createElement("br",null),"fallow"===a.kind?i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return c(Xa({city:l.key,district:a.key}))}},"\ud83d\udea7 Develop",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.fallow_2_rural})))):"rural"===a.kind?i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return c(Xa({city:l.key,district:a.key}))}},"\ud83c\udfd7\ufe0f Urbanize",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.rural_2_urban})))):null,i.a.createElement(Hi,{cityKey:l.key,district:a,selectedLotKey:n,difficulty:e.difficulty}),i.a.createElement("h3",null,"Beings:"),i.a.createElement(qi,{difficulty:e.difficulty,hex:a,city:l.key})):i.a.createElement("div",null)},Wi=function(e){var t,a=e.building,n=Fn((function(e){return null!=a.enterpriseKey?e.world.enterprises.byID[a.enterpriseKey]:void 0})),r=ke[a.type],l=zn(),c=Rt[a.type]>0,o=e.building.upgradedJobs||e.building.upgradedStorage;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,pi[a.type]),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return l(Un())}},"\u274c")),i.a.createElement("div",{className:"text-right"},i.a.createElement("small",null,"in\xa0",i.a.createElement("strong",null,e.city.name))),null!=n&&null!=r?i.a.createElement("div",null,i.a.createElement("small",null,"$",null===(t=n.cash)||void 0===t?void 0:t.toFixed(2)," from sales today"),i.a.createElement(Vi,{enterpriseKey:n.key,good:r,buildingKey:a.key})):null,o&&c?i.a.createElement("div",null,Ji(a.type)):null,c&&null!=n?i.a.createElement(Zi,{enter:n,changeEnterprise:function(e){return l(tn({enterpriseKey:a.key,newType:e}))}}):null,c?i.a.createElement(Ui,{cityKey:e.city.key,building:a}):null,c?i.a.createElement("div",null,i.a.createElement("small",null,"This ",pi[a.type]," can support ",Ft(a)," more jobs.",o?null:i.a.createElement("span",null,i.a.createElement("br",null),"Add Worker Space to add 3 more job slots."))):null,a.upgradedJobs||a.upgradedStorage||!c?null:i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(nn({buildingKey:a.key}))}},"\ud83d\udee0\ufe0f Add Worker Space",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.upgrade})))),a.upgradedJobs||a.upgradedStorage||!c?null:i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(nn({buildingKey:a.key}))}},"\ud83d\udce6 Add Storage Space",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.upgrade})))),null!=a.dwellingKeys&&a.dwellingKeys.length?i.a.createElement(Li,{dwellingKeys:a.dwellingKeys}):null,a.upgradedLoft||!c?null:i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return l(rn({buildingKey:a.key}))}},"\ud83d\udecc Add Loft Housing",i.a.createElement(Gi,{cost:e.difficulty.cost.hex.add_loft})))),i.a.createElement(qi,{city:e.city.key,difficulty:e.difficulty,hex:e.hex}))},Ji=function(e){return"house"===e?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83d\udc2e Parochial subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in dense buildings")),i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83c\udf78 Cosmopolitan subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in small buildings"))):i.a.createElement("div",null)},Ui=function(e){var t=zn(),a=Fn((function(t){return e.building.employeeBeanKeys.map((function(e){return t.world.beans.byID[e]}))})),n=Fn((function(t){return t.world.enterprises.byID[e.building.key]}));return a.length<0?i.a.createElement("div",null,"No Workers"):i.a.createElement("div",null,i.a.createElement("strong",null,"Workers:"),a.map((function(a){return i.a.createElement("div",{key:a.key},Ee[e.building.type]," ",a.name," ",n&&"company"===n.enterpriseType&&a.key===n.ownerBeanKey?"\ud83c\udfa9":"",i.a.createElement("button",{title:"Fire",className:"callout marg-0",onClick:function(){return a?t(an({cityKey:e.cityKey,beanKey:a.key})):null}},"\ud83d\udd25"))})))},Zi=function(e){var t=Ai.map((function(t){return{icon:Pi[t],text:t[0].toUpperCase()+t.substring(1),value:t,onClick:function(){e.changeEnterprise(t)}}}));return i.a.createElement(ui,{active:e.enter.enterpriseType,options:t})},Vi=function(e){var t=Fn((function(t){return t.world.economy.market.listings[e.good]})),a=Fn((function(t){return t.world.buildings.byID[e.buildingKey]}));return i.a.createElement("div",{className:"horizontal"},t.filter((function(t){return t.sellerEnterpriseKey===e.enterpriseKey})).map((function(t,a){return i.a.createElement("div",{key:a},t.quantity," ",He[e.good]," @ $",t.price.toFixed(2))})),i.a.createElement("div",null,"\ud83d\udce6 Storage x",a.upgradedStorage?20:10))};a(34);var $i={2:0,0:1,4:2,1:3,5:4,3:5},Xi={farm:"\ud83e\ude95",house:"\ud83e\uddf9",hospital:"\ud83e\ude7a",church:"\ud83d\udcff",theater:"\ud83d\udc58",jail:"\ud83d\udea8",graveyard:"\ud83d\udcff",park:"\ud83c\udf92",nature:"\ud83c\udf92"},Yi=function(e){var t=Fn((function(t){return t.world.economy.market.listings[e.goodType].filter((function(t){return t.sellerEnterpriseKey===e.enterpriseKey})).reduce((function(e,t){return e+t.quantity}),0)}));if(t<1)return null;for(var a=[],n=0;n<t;n++)a.push({row:Math.floor(n/2),col:n%2});return i.a.createElement(i.a.Fragment,null,a.map((function(t,a){return i.a.createElement("text",{x:270+-12*t.col+"px",y:85+-12*t.row+"px",style:{fontSize:"11px"},key:a},He[e.goodType])})))},Qi=function(e){var t=Fn((function(t){return t.world.lots.byID[e.lotKey]})),a=Fn((function(e){return null!=t.buildingKey?e.world.buildings.byID[t.buildingKey]:void 0}));if(a){var n=ke[a.type],r=a.upgradedJobs||a.upgradedStorage,l={x:280,y:77.859};return i.a.createElement(i.a.Fragment,null,i.a.createElement("text",{x:l.x,y:l.y,style:{fontSize:"36px"}},r?ge[a.type]:ve[a.type]),a.employeeBeanKeys.map((function(e,t){return i.a.createElement("text",{x:"325px",y:85+-14*t+"px",style:{fontSize:"11px"},key:e},Xi[a.type])})),null!=a.enterpriseKey&&n?i.a.createElement(Yi,{enterpriseKey:a.enterpriseKey,goodType:n}):null,null!=a.interredBeanKeys?a.interredBeanKeys.map((function(e,t){var a=he({r:40,az:Math.PI/2+2*Math.PI*t/6});return i.a.createElement("text",{x:l.x+a.x+10,y:l.y+a.y-10,style:{fontSize:"11px"},key:e},"\u26b0\ufe0f")})):null)}return i.a.createElement("text",{x:"280.931px",y:"77.859px",style:{fontSize:"36px"}},"rural"===t.kind?"\ud83c\udf3c":"\ud83d\ude8f")},er=function(e){var t=e.building.upgradedJobs||e.building.upgradedStorage;return i.a.createElement("div",{key:e.building.type+e.building.key,style:e.style,className:"building "+e.building.type},t?ge[e.building.type]:ve[e.building.type],i.a.createElement(tr,{building:e.building,getStyle:e.getStyle}),e.children)},tr=function(e){return i.a.createElement(i.a.Fragment,null,X.map((function(t,a){var n=$i[a],r=null!=e.building.employeeBeanKeys[n];return i.a.createElement("span",{key:a,className:"slot",style:e.getStyle(t)},r?Ee[e.building.type]:null)})))},ar=function(e){var t=zn(),a=Fn((function(t){return t.selected.selectedLotKey===e.lotKey}));return i.a.createElement("g",{className:"lot "+e.className+(a?" selected":""),transform:"matrix(1.21104,0,0,0.901051,-221.832,-145.114)",onClick:function(a){return t(Xn({cityKey:e.cityKey,district:e.districtKey,lot:e.lotKey})),a.preventDefault(),!1}},i.a.createElement("path",{d:e.lotDrawn}))},nr=function(e){var t=zn(),a=Fn((function(t){return t.world.districts.byID[e.districtKey]})),n=Fn((function(t){return t.selected.selectedDistrictKey===e.districtKey}))?"hex-selected":"";return i.a.createElement("div",{className:"hex "+n,key:e.districtKey,style:Object(b.a)(Object(b.a)({},yr),be(a.point)),onMouseEnter:function(n){t(Za({cityKey:e.cityKey,px:a.point}))},onClick:function(a){if(!a.isDefaultPrevented())return t(Jn({cityKey:e.cityKey,district:e.districtKey})),a.stopPropagation(),!1}},i.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 104 120",version:"1.1",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",left:"0%",top:"0%",opacity:.5},className:"svg-hex"},i.a.createElement("g",{transform:"matrix(1,0,0,1,-233.288,0)"},"fallow"===a.kind?i.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},i.a.createElement("g",{id:"circle",transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},i.a.createElement("circle",{className:"district-circle",cx:"285.248",cy:"60.588",r:"17.271"})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},"\ud83c\udf33"))):"rural"===a.kind?i.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},i.a.createElement("g",{transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},i.a.createElement("path",{className:"district-circle",d:"M285.25,0L285.251,43.341M300.181,69.173L337.211,89.968L300.181,69.173ZM270.408,69.173L233.288,90.21M285.248,43.317C294.78,43.317 302.519,51.056 302.519,60.588C302.519,70.12 294.78,77.859 285.248,77.859C275.716,77.859 267.977,70.12 267.977,60.588C267.977,51.056 275.716,43.317 285.248,43.317Z"})),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_3",lotKey:a.lots[2],lotDrawn:"M43.3,112.51L43.301,142.954L43.3,142.954C35.334,142.954 28.868,149.421 28.868,157.387C28.868,160.061 29.596,162.566 30.866,164.714L6.474,178.584C2.37,171.965 0,164.162 0,155.81C0,131.912 19.402,112.51 43.3,112.51L43.3,112.51Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_2",lotKey:a.lots[1],lotDrawn:"M55.735,164.713L80.126,178.583C72.489,190.9 58.846,199.11 43.3,199.11C27.754,199.11 14.111,190.9 6.474,178.584L30.866,164.714C33.378,168.965 38.009,171.819 43.3,171.819C48.592,171.819 53.223,168.964 55.735,164.713ZM0,155.81C0,155.81 0,155.81 0,155.81Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"rural_1",lotKey:a.lots[0],lotDrawn:"M43.3,112.51C67.198,112.51 86.6,131.912 86.6,155.81C86.6,164.162 84.23,171.965 80.126,178.583L55.735,164.713C57.004,162.564 57.732,160.06 57.732,157.387C57.732,149.421 51.266,142.954 43.301,142.954L43.3,112.51Z"}),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,-46.211)"},i.a.createElement(Qi,{lotKey:a.lots[0]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,1.20645)"},i.a.createElement(Qi,{lotKey:a.lots[1]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-323.46,-21.9919)"},i.a.createElement(Qi,{lotKey:a.lots[2]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"36.631px"}},"\ud83d\udcea"))):"urban"===a.kind?i.a.createElement("g",{id:"rural-circle-120",transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,-46.211)"},i.a.createElement(Qi,{lotKey:a.lots[0]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-253.016,-21.9919)"},i.a.createElement(Qi,{lotKey:a.lots[1]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-271.444,1.20645)"},i.a.createElement(Qi,{lotKey:a.lots[2]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-306.821,1.20645)"},i.a.createElement(Qi,{lotKey:a.lots[3]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-323.46,-21.9919)"},i.a.createElement(Qi,{lotKey:a.lots[4]})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-306.821,-46.211)"},i.a.createElement(Qi,{lotKey:a.lots[5]})),i.a.createElement("g",{transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},i.a.createElement("path",{className:"district-circle",d:"M285.25,0L285.251,43.341M300.181,69.173L337.211,89.968L300.181,69.173ZM270.408,69.173L233.288,90.21M285.248,43.317C294.78,43.317 302.519,51.056 302.519,60.588C302.519,70.12 294.78,77.859 285.248,77.859C275.716,77.859 267.977,70.12 267.977,60.588C267.977,51.056 275.716,43.317 285.248,43.317Z"})),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_9",lotKey:a.lots[5],lotDrawn:"M5.135,135.352C12.441,121.76 26.798,112.51 43.3,112.51L43.3,112.51L43.301,142.954L43.3,142.954C37.962,142.954 33.298,145.858 30.801,150.17L5.135,135.352Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_8",lotKey:a.lots[4],lotDrawn:"M5.158,135.317L30.861,150.068C29.594,152.215 28.868,154.717 28.868,157.387C28.868,160.061 29.596,162.566 30.866,164.714L6.474,178.584C2.37,171.965 0,164.162 0,155.81C0,148.284 1.774,141.487 5.158,135.317Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_7",lotKey:a.lots[3],lotDrawn:"M43.3,171.819L43.3,199.11C27.754,199.11 14.111,190.9 6.474,178.584L30.866,164.714C33.378,168.965 38.009,171.819 43.3,171.819ZM0,155.81C0,155.81 0,155.81 0,155.81Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_6",lotKey:a.lots[2],lotDrawn:"M43.3,171.819C48.592,171.819 53.223,168.964 55.735,164.713L80.126,178.583C72.489,190.9 58.846,199.11 43.3,199.11L43.3,171.819Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_5",lotKey:a.lots[1],lotDrawn:"M81.453,135.317C84.837,141.487 86.6,148.284 86.6,155.81C86.6,164.162 84.23,171.965 80.126,178.583L55.735,164.713C57.004,162.564 57.732,160.06 57.732,157.387C57.732,154.717 57.006,152.215 55.739,150.068L81.453,135.317Z"}),i.a.createElement(ar,{cityKey:e.cityKey,districtKey:e.districtKey,className:"urban_4",lotKey:a.lots[0],lotDrawn:"M55.725,150.044C53.211,145.801 48.585,142.954 43.301,142.954L43.3,112.51C59.792,112.51 74.143,121.75 81.453,135.331L55.725,150.044Z"}),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},0===a.q&&0===a.r?"\ud83c\udfeb":"\u26f2"))):i.a.createElement("g",{transform:"matrix(0.990588,0,0,1.33139,453.063,64.7779)"},i.a.createElement("g",{id:"circle",transform:"matrix(1.0095,0,0,0.751097,-457.368,-48.6545)"},i.a.createElement("circle",{className:"district-circle",cx:"285.248",cy:"60.588",r:"17.271"})),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"265.931px",y:"77.859px",style:{fontSize:"46.631px"}},zi.nature)),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"270px",y:"-20px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f")),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"180.931px",y:"147.859px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f")),i.a.createElement("g",{transform:"matrix(0.402264,0,0,0.299296,-287.943,-23.1242)"},i.a.createElement("text",{x:"365.931px",y:"147.859px",style:{fontSize:"36.631px"}},"\ud83c\udfd5\ufe0f"))))),e.children)},ir=function(e){Fn((function(t){return t.world.cities.byID[e.cityKey]}));var t=Fn((function(t){var a;return null===(a=t.world.cities.byID[e.cityKey])||void 0===a?void 0:a.districtKeys}));return i.a.createElement(i.a.Fragment,null,t.map((function(t,a){return i.a.createElement(nr,{cityKey:e.cityKey,key:t,districtKey:t})})))},rr=function(e){var t=Fn((function(t){return function(e,t){return function(e,t){return e.cities.byID[t].buildingKeys}(e,t).reduce((function(t,a){return t.push(e.buildings.byID[a]),t}),[])}(t.world,e.city.key)}));return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement("div",{key:t.key,className:"building-node",onClick:function(){return e.onClickBuilding(t)}},i.a.createElement(er,{building:t,style:{},getStyle:function(){return{}}}))})))},lr=function(e){Object(n.useRef)(null);var t=Fn((function(t){return t.world.cities.byID[e.cityKey].pickupMagnetPoint}));return t?i.a.createElement("div",{className:"magnet",style:{transform:"translate(".concat(t.x,"px, ").concat(t.y,"px)")}},"\ud83e\uddf2"):null};function cr(e){return"buy"==e.actionData.act}var or=function(e){var t=Fn((function(t){return function(e,t){var a=e.world.beans.byID[t],n="work"===a.actionData.act;return{speech:Et(a),face:xt(a),good:cr(a)?He[a.actionData.good||"food"]:void 0,classes:[a.job,a.ethnicity,"travel"!=a.actionData.act||"dead"===a.lifecycle?"paused":""].join(" "),animationClasses:["bean-walker",n?"spin":""].join(" "),badge:a.badge,hat:a.hat}}(t,e.beanKey)})),a=Fn((function(t){return t.selected.selectedBeanKey===e.beanKey})),n=["bean interactable",t.classes,e.sitStill?"":t.animationClasses,a?"selected":""].join(" "),r=zn();return i.a.createElement("span",{className:n,onClick:function(t){t.stopPropagation(),r(Zn({cityKey:e.cityKey,beanKey:e.beanKey}))}},t.badge?i.a.createElement("span",{className:"badge "+t.badge},t.badge):null,t.face," ",t.good?i.a.createElement("span",{className:"purchase"},i.a.createElement("span",{className:"money"},"\ud83d\udcb8"),i.a.createElement("span",{className:"purchase-good"},t.good)):null," ",t.speech?i.a.createElement("span",{className:"speech"},i.a.createElement("span",{className:""},t.speech)):null,t.hat?i.a.createElement("span",{className:"hat "+t.hat},t.hat):null)},sr=function(e){var t=Object(n.useState)(!1),a=Object(qt.a)(t,2),r=a[0],l=a[1],c=Fn((function(t){return t.world.pickups.byID[e.pickupKey]})),o=i.a.useContext(Jr);return Object(n.useEffect)((function(){!r&&o&&(o.play("drop"),l(!0))})),i.a.createElement("span",{className:"pickup bob"},ze[c.type])},ur=function(e){var t=i.a.useContext(Ur),a=Object(n.useRef)(null),r=function(e){a.current&&e&&(a.current.style.transform="translate(".concat(e.point.x,"px, ").concat(e.point.y,"px)"))};return Object(n.useEffect)((function(){var a=t.Get(e.moverType,e.moverKey);return a.subscribe(r),a.current&&r(a.current),function(){return t.Get(e.moverType,e.moverKey).unsubscribe(r)}}),[]),i.a.createElement("div",{ref:a},e.children)},dr=function(e){var t=Fn((function(t){return qn(t.world,e.cityKey)}));return i.a.createElement(i.a.Fragment,null,t.map((function(t){return i.a.createElement(ur,{moverKey:t,key:t,moverType:"bean"},i.a.createElement(or,{cityKey:e.cityKey,beanKey:t}))})))},mr=function(e){var t=Fn((function(t){return t.world.cities.byID[e.cityKey].pickupKeys}));return i.a.createElement(i.a.Fragment,null,t.map((function(e){return i.a.createElement(ur,{moverKey:e,key:e,moverType:"pickup"},i.a.createElement(sr,{pickupKey:e}))})))},yr={width:"260px",height:"260px",top:"-130px",left:"-130px"},pr=function(e){for(var t=Fn((function(t){return t.world.cities.byID[e.cityKey]})),a=Fn((function(t){return t.world.cities.byID[e.cityKey].ufoKeys})),n=(Fn((function(e){return e.world.spotlightEvent})),Fn((function(e){if(e.world.spotlightEvent&&e.world.spotlightEvent.beanKey)return e.world.beans.byID[e.world.spotlightEvent.beanKey]})),zn()),r=[],l=t.petriRadius-20,c=0;c<72;c++){var o=he({r:l,az:5*c*Math.PI/180});o.x+=t.petriRadius,o.y+=t.petriRadius,r.push(be(o))}t.deadBeanKeys.map((function(e,t){return i.a.createElement("span",{key:t,className:"dead",style:{left:10*t+"px"}},"\u26b0\ufe0f")}));var s={height:2*t.petriRadius+"px",width:2*t.petriRadius+"px"};return i.a.createElement("div",{className:"tile",onClick:function(){return e.onClick()},onMouseLeave:function(){n(Za({cityKey:t.key}))},style:s},i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-base"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 1)"})),i.a.createElement(ir,{cityKey:t.key}),r.map((function(e,t){return i.a.createElement("span",{key:t,style:e,className:"mtn"},"\u26f0\ufe0f")})),i.a.createElement(mr,{cityKey:e.cityKey}),i.a.createElement(dr,{cityKey:e.cityKey}),a.map((function(e,a){return i.a.createElement(Ti,{ufoKey:e,key:e,cityKey:t.key})})),i.a.createElement(lr,{cityKey:e.cityKey}),i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-lid"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 0.2)"})))},fr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t="card button";return this.props.thin&&(t+=" thin"),this.props.singleLine&&(t+=" single"),i.a.createElement("button",{className:t,title:this.props.title,onClick:function(){e.props.onClick&&e.props.onClick()},type:"button",disabled:this.props.disabled},this.props.icon," ",this.props.name,null!=this.props.subtext?i.a.createElement("small",null,this.props.subtext):null)}}]),a}(i.a.Component);function hr(e,t,a){switch(t){case"trad":case"prog":case"ego":case"state":return i.a.createElement(fr,{icon:Pe[t],title:g[t].description,name:"",subtext:pi[t],thin:!0,singleLine:!0,onClick:a});case"fresh":case"sick":case"hungry":case"starving":case"stuffed":case"homeless":case"rested":case"circle":case"square":case"triangle":case"sane":case"disturbed":case"stressed":return i.a.createElement(fr,{icon:Pe[t],title:pi[t],name:"",subtext:pi[t],thin:!0,singleLine:!0,onClick:a});case"noFaith":case"rocket":case"dragon":case"music":return i.a.createElement(fr,{icon:Pe[t],title:E[t].description,name:"",subtext:pi[t],thin:!0,singleLine:!0,onClick:a});default:return null}}a(35);function br(e,t,a,n,r){if(!e)return i.a.createElement("div",{className:"width-100p text-center"},i.a.createElement("small",null,"Subject needs a Scan to reveal their thoughts"));switch(t){case"beliefs":return e?a.beliefs.map((function(e,t){var a,n="belief-name shadow text-left "+k[e].rarity;return i.a.createElement("table",{className:"width-100p",key:e+t},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",{className:n},k[e].icon," ",k[e].adj),i.a.createElement("td",{className:"text-right"},(k[e].idealPro||[]).map((function(e){return i.a.createElement("span",{key:e},"+",Pe[e])})),(k[e].idealCon||[]).map((function(e){return i.a.createElement("span",{key:e},"-",Pe[e])})))),i.a.createElement("tr",null,i.a.createElement("td",{className:"small text-center",colSpan:2},k[e].description?null===(a=k[e].description)||void 0===a?void 0:a.split(";").map((function(e,t){return i.a.createElement("div",{key:t},e)})):null))))})):null;case"feelings":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,e?function(e){return Object.keys(e.happiness.all).map((function(t,a){return i.a.createElement("tr",{key:a},i.a.createElement("td",{className:"small text-right"},e.happiness.all[t]," ",e.happiness.all[t]>=0?ze.happiness:ze.unhappiness," from "),i.a.createElement("td",{className:"small"},t))}))}(a):null));default:case"priorities":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Currently ",function(e){var t,a,n;switch(e.act){case"chat":return"chatting";case"crime":return"stealing ".concat(null===e||void 0===e?void 0:e.crimeGood);case"sleep":return"sleeping \ud83d\ude34";case"relax":return"relaxing";case"travel":return"travelling to "+(null===(t=e.intent)||void 0===t?void 0:t.act)||!1;case"chase":return"in a chase to "+(null===(a=e.chase)||void 0===a?void 0:a.type)||!1;case"assault":return"in the middle of a "+(null===e||void 0===e||null===(n=e.assault)||void 0===n?void 0:n.assaultType)||!1;case"work":return e.good?"working to make "+He[e.good]:"working";case"buy":return e.good?"buying "+He[e.good]:"buying"}return""}(a.actionData))),a.priorities.map((function(e){return i.a.createElement("tr",{key:"p-".concat(e.act,"-").concat(e.good)},i.a.createElement("td",null,e.priority.toFixed(2)," ",function(e){switch(e.act){case"sleep":return"\ud83d\ude34";case"work":return e.good?"\ud83d\udcaa "+He[e.good]:"\ud83d\udcaa";case"buy":return e.good?"\ud83d\udcb8 "+He[e.good]:"\ud83d\udcb8"}return""}(e)))})),function(e){var t=Object.keys(e.activity_duration).map((function(e){return e}));return t.sort((function(t,a){return e.activity_duration[a]-e.activity_duration[t]})),t}(a).filter((function(e){return a.activity_duration[e]>0})).map((function(e){var t=e;return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e),i.a.createElement("td",null,(a.activity_duration[t]/1e3).toFixed(1),"s"))}))))}}var vr=function(e){var t=Object(n.useState)("beliefs"),a=Object(qt.a)(t,2),r=a[0],l=a[1];return i.a.createElement("div",{className:"grow-1 pad-4 bean-panel-content"},i.a.createElement("div",{className:"cylinder blue-orange horizontal"},i.a.createElement("button",{type:"button",className:"beliefs"==r?"active":"",onClick:function(){return l("beliefs")}},"\ud83d\ude07 Traits"),i.a.createElement("button",{type:"button",className:"feelings"==r?"active":"",onClick:function(){return l("feelings")}},"\ud83d\ude10 Feelings"),i.a.createElement("button",{type:"button",className:"priorities"==r?"active":"",onClick:function(){return l("priorities")}},"\ud83d\udcaa Priorities")),br(e.alien.scanned_bean[e.bean.key],r,e.bean,e.city,e.alien))},gr=function(e){var t=zn(),a=Fn((function(e){return e.world.buildings.allIDs.find((function(t){var a=e.world.buildings.byID[t];return"graveyard"===a.type&&a.interredBeanKeys&&a.interredBeanKeys.length<6}))}));return i.a.createElement("div",{className:"bean-action-card-parent"},void 0===a?i.a.createElement("div",{className:"text-center"},"No \u26b1\ufe0f Graveyard"):null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){null!=a&&t(jn({bean:e.beanKey,graveyard:a}))},disabled:void 0===a,title:"Dispose of the body"},"\u26b0\ufe0f Dispose",i.a.createElement("small",null,"-Body"))))},Er=function(e){var t=zn(),a=Fn((function(e){return e.world.alien})),n=Fn(ei),r=Fn(Qn);if(!n||!r)return null;var l=n.job+" "+n.ethnicity;return i.a.createElement("div",{className:"vertical bean-panel"},i.a.createElement("div",{className:"bean-panel-header"},i.a.createElement("div",null,i.a.createElement("b",null,n.name,"\xa0",r?i.a.createElement("small",null," of ",r.name," "):null),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){t(Vn({cityKey:n.cityKey}))}},"\u274c")),i.a.createElement("div",{className:"bean-view"},i.a.createElement("span",{className:l+" bean"},xt(n))),null!=n.titleKey?i.a.createElement(wr,{titleKey:n.titleKey}):null,i.a.createElement("div",{className:"horizontal"},i.a.createElement("span",{className:"text-center"},"\ud83d\udcb0 $",n.cash.toFixed(2)),i.a.createElement("span",{className:"text-center"},"\ud83d\ude42 ",Math.round(n.lastHappiness),"%"),i.a.createElement("span",{className:"text-center"},Math.round(n.happiness.flatAverage)," ",ze.happiness," /day")),function(e,t,a,n,r){return e?i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},hr(0,t.ethnicity,void 0),hr(0,t.faith,n)),i.a.createElement("div",{className:"card-parent"},t.beliefs.map((function(e){return i.a.createElement(fr,{key:e,icon:k[e].icon,title:k[e].adj,name:"",thin:!0,singleLine:!0,onClick:function(){n()}})}))),i.a.createElement("div",{className:"card-parent"},hr(0,t.food,void 0),hr(0,t.stamina,void 0),hr(0,t.health,void 0),hr(0,t.housing,void 0))):i.a.createElement("div",{className:"card-parent"},i.a.createElement(fr,{icon:"\ud83d\udef0\ufe0f",name:"Scan",subtext:"-Energy +Info",onClick:r,disabled:!Tt(a,a.difficulty.cost.bean.scan)}))}(a.scanned_bean[n.key],n,a,(function(){"dead"!=n.lifecycle&&e.brainwash()}),(function(){t(sn({beanKey:n.key}))}))),"dead"===n.lifecycle?i.a.createElement("div",{className:"bean-panel-content"},i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"This subject has ceased biological functions. ",i.a.createElement("br",null)," The carbon shell requires disposal."))):i.a.createElement(vr,{bean:n,city:r,alien:a}),"dead"===n.lifecycle?i.a.createElement(gr,{beanKey:n.key}):i.a.createElement("div",{className:"bean-action-card-parent"},i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){e.brainwash()},title:"Rewrite one of this being's traits"},"\ud83d\ude35 Brainwash",i.a.createElement("small",null,"-Sanity +-Trait"))),i.a.createElement(kr,{beanKey:n.key,entitle:e.entitle}),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){t(un({beanKey:n.key}))},disabled:!Tt(a,a.difficulty.cost.bean.vaporize),title:"Delete this being from the experiment"},"\u2620\ufe0f Vaporize",i.a.createElement(Gi,{cost:a.difficulty.cost.bean.vaporize}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",disabled:"alive"!=n.lifecycle||!Tt(a,a.difficulty.cost.bean.abduct),onClick:function(){return t(cn({beanKey:n.key}))},title:"Remove this being for study"},"\ud83d\udc7e Abduct for Research",i.a.createElement(Gi,{cost:a.difficulty.cost.bean.abduct,rider:"+Tech"})))))},kr=function(e){return Fn((function(e){return e.world.titles.allIDs})).length>0?i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.entitle()},title:"Give this bean a title"},"\ud83d\udc51 Give Title",i.a.createElement(Gi,{cost:{},rider:"+Title"}))):null},wr=function(e){var t=Fn((function(t){return t.world.titles.byID[e.titleKey]}));return i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",null,t.headwear," ",t.name," ",t.badge))},xr=function(e){var t=Fn((function(t){return Hn(t.world,e.city.key)})),a=i.a.createElement("div",null,"Human Emotion Farm",i.a.createElement("div",null,i.a.createElement("small",null,"Part of the \ud83c\udf0c Galactic Xenosensation Federation")));e.city&&(a=i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("b",null,e.city.name),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.clearCity()}},"\u274c"))));var n=t.reduce((function(e,t){return e+t.lastHappiness}),0)/(t.length||1),r=t.reduce((function(e,t){return e+t.cash}),0)/(t.length||1);return i.a.createElement("div",null,a,i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"\ud83d\udc65 Subjects")),i.a.createElement("div",null,i.a.createElement("b",null,"Population"),"\xa0",i.a.createElement("span",null,t.length)),i.a.createElement(fi,{beans:t,need:function(e){return e.food},dire:"starving",abundant:"stuffed"},"Food Security"),i.a.createElement(fi,{beans:t,need:function(e){return e.stamina},dire:"homeless",abundant:"rested"},"Housing"),i.a.createElement(fi,{beans:t,need:function(e){return e.health},dire:"sick",abundant:"fresh"},"Healthcare"),i.a.createElement("b",null,"Avg. Money")," $",r.toFixed(2)," \xa0",i.a.createElement("b",null,"Avg. Happiness")," ",Math.round(n),"%",t&&t.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"\ud83e\udde0 Traits")),i.a.createElement("div",{className:"max-w-300"},function(e,t){return Array.from(t.reduce((function(t,a){return e[a.key]?a.beliefs.forEach((function(e){var a=t.get(e)||0;t.set(e,a+1)})):t.set("Unknown",(t.get("Unknown")||0)+1),t}),new Map).entries()).sort((function(e,t){var a=Object(qt.a)(e,2),n=(a[0],a[1]),i=Object(qt.a)(t,2);i[0];return i[1]-n})).map((function(e){var t=Object(qt.a)(e,2),a=t[0],n=t[1];return"Unknown"===a?{icon:"\u2754",noun:"Unknown",count:n}:{icon:k[a].icon,noun:k[a].noun,count:n}}))}(e.alien.scanned_bean,t).map((function(e){return i.a.createElement("span",{key:e.noun,className:"overview-belief"},e.icon,"\xa0",e.noun,"\xa0x",e.count)})))):null,t.length?i.a.createElement("div",{className:"card-parent"},i.a.createElement(fr,{icon:"\ud83d\udef0\ufe0f",name:"Scan All",disabled:!0,subtext:"-Energy +Info",onClick:function(){}})):null)},Kr=(i.a.Component,function(e){var t=Fn(Qn),a=Fn((function(e){return e.selected.selectedDistrictKey})),n=Fn((function(e){return null!=a?e.world.districts.byID[a]:void 0})),r=Fn(ei),l=Fn((function(e){return e.world.alien})),c=zn();return r&&t?i.a.createElement(Er,{bean:r,city:t,alien:l,brainwash:function(){return e.openBrainwash()},entitle:function(){return e.openEntitle()}}):n?i.a.createElement(Ri,{difficulty:l.difficulty}):t?i.a.createElement(xr,{city:t,clearCity:function(){return c(Un())},alien:l}):i.a.createElement("div",null)});var Dr=function(e){var t=Fn(ai),a=Fn((function(e){return t.slice().reverse().map((function(t){return e.world.events.byID[t]}))})),n=zn(),r=a.map((function(e,t){var a="\ud83d\udea8"===e.icon,r="nojobslots"===e.trigger||"persuasion"===e.trigger;return i.a.createElement("div",{key:t,className:a||r?"tall":""},i.a.createElement("span",{className:a?"police-siren":""},e.icon),"\xa0",function(e){return null!=e.beanKey&&("speechcrime"===e.trigger||"birth"===e.trigger)}(e)?i.a.createElement("a",{onClick:function(){e.beanKey&&e.cityKey&&n(Zn({beanKey:e.beanKey,cityKey:e.cityKey}))},href:"javascript:void(0)"},e.message):i.a.createElement("span",null,e.message))}));return 0===a.length&&(r=[i.a.createElement("div",{key:0},i.a.createElement("small",null,"No events yet"))]),i.a.createElement("div",{className:"events-panel"},i.a.createElement("div",null,i.a.createElement("b",null,"Events")),r)};function Nr(e,t){return i.a.createElement("li",null,(null===e||void 0===e?void 0:e.done)?"\u2611\ufe0f":"\u2b55\ufe0f",t.text,null!=t.tooltip?i.a.createElement("small",{title:t.tooltip},"\u2754"):null,(null===e||void 0===e?void 0:e.done)||null==t.reward?null:function(e){return i.a.createElement("div",null,i.a.createElement("small",null,"\ud83c\udf81 ",Ha(e.reward||{},"+")))}(t))}var Sr=function(){var e,t=Fn((function(e){return e.world.alien.goalProgress})),a=Fn((function(e){return e.world.alien.goals})),n=Fn((function(e){return e.world.alien.workingReportCard}));return i.a.createElement("div",{className:"goals"},i.a.createElement("div",null,i.a.createElement("b",null,"Goals")),i.a.createElement("ul",null,a.map((function(e){return Nr(t[e],Nt[e])}))),i.a.createElement("div",null,i.a.createElement("b",null,"Report Card")),i.a.createElement("p",{className:"horizontal"},i.a.createElement("span",null,"Last Grade: ",i.a.createElement("b",null,"D")),i.a.createElement("span",null,"Next Grade in: ",i.a.createElement("b",null,"2 mo."))),i.a.createElement("p",null),i.a.createElement("table",{style:{margin:"auto"}},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Happiness"),i.a.createElement("td",null,n.Happiness),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects happy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,St.RubricDescription.Happiness))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Prosperity"),i.a.createElement("td",null,n.Prosperity),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects fed and healthy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,St.RubricDescription.Prosperity))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Stability"),i.a.createElement("td",null,n.Stability),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects sane and civil?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,St.RubricDescription.Stability))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Dogma"),i.a.createElement("td",null,n.Dogma),i.a.createElement("td",null,i.a.createElement("small",{title:"Do your society's rules match your utopian ideals?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,St.RubricDescription.Dogma))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:3},i.a.createElement("hr",null))),i.a.createElement("tr",null,i.a.createElement("th",null,"Avg. Grade"),i.a.createElement("td",null,Ct((_t[(e=n).Happiness]+_t[e.Prosperity]+_t[e.Stability]+_t[e.Dogma])/20)),i.a.createElement("td",null)))))},jr=function(){var e=Fn((function(e){return e.world.alien})),t=zn();return i.a.createElement("div",null,i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market")),i.a.createElement("p",null,i.a.createElement("small",null,"The premier exchange for \u26a1\ufe0f, \ud83e\udd16,  and ",ze.happiness,"!")),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(Pn({amount:1}))},disabled:!Tt(e,e.difficulty.cost.market.resource.energy)},"+1 \u26a1\ufe0f Energy",i.a.createElement(Gi,{cost:e.difficulty.cost.market.resource.energy,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return t(Pn({amount:5}))},disabled:!Tt(e,e.difficulty.cost.market.resource.energy,5)},"+5 \u26a1\ufe0f Energy",i.a.createElement(Gi,{cost:e.difficulty.cost.market.resource.energy,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(An({amount:1}))},disabled:!Tt(e,e.difficulty.cost.market.resource.bots)},"+1 \ud83e\udd16 Bot",i.a.createElement(Gi,{cost:e.difficulty.cost.market.resource.bots,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return t(An({amount:5}))},disabled:!Tt(e,e.difficulty.cost.market.resource.bots,5)},"+5 \ud83e\udd16 Bots",i.a.createElement(Gi,{cost:e.difficulty.cost.market.resource.bots,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return t(Ln())},disabled:e.hedons.amount>=0||!Tt(e,e.difficulty.cost.market.scrubHedons)},"Remove \ud83d\udca2 Negative Hedons",i.a.createElement(Gi,{cost:e.difficulty.cost.market.scrubHedons,qty:1}))),i.a.createElement("div",null,i.a.createElement("small",null,i.a.createElement("i",null,"Current ",i.a.createElement("span",{className:"trait-gem"})," Trait Gems for sale:"))),i.a.createElement("div",{className:"short-scroll"},i.a.createElement(Ir,{hedons:e.hedons.amount})))},Ir=function(e){var t=Fn((function(e){return e.world.marketTraitsForSale})),a=zn();return i.a.createElement(i.a.Fragment,null,t.map((function(t,n){var r=k[t.trait],l="belief-name "+r.rarity;return i.a.createElement("div",{className:"card-parent",key:n},i.a.createElement("button",{className:"card button",onClick:function(){return a(Gn({l:t}))},disabled:e.hedons<(t.cost.hedons||0)},i.a.createElement("span",{className:l},r.icon," ",r.noun),i.a.createElement(Gi,{cost:t.cost})))})))},Cr=["able","acid","aged","also","area","army","away","baby","back","ball","band","bank","base","bath","bear","beat","been","beer","bell","belt","best","bill","bird","blow","blue","boat","body","bomb","bond","bone","book","boom","born","boss","both","bowl","bulk","burn","bush","busy","call","calm","came","camp","card","care","case","cash","cast","cell","chat","chip","city","club","coal","coat","code","cold","come","cook","cool","cope","copy","CORE","cost","crew","crop","dark","data","date","dawn","days","dead","deal","dean","dear","debt","deep","deny","desk","dial","dick","diet","disc","disk","does","done","door","dose","down","draw","drew","drop","drug","dual","duke","dust","duty","each","earn","ease","east","easy","edge","else","even","ever","evil","exit","face","fact","fail","fair","fall","farm","fast","fate","fear","feed","feel","feet","fell","felt","file","fill","film","find","fine","fire","firm","fish","five","flat","flow","food","foot","ford","form","fort","four","free","from","fuel","full","fund","gain","game","gate","gave","gear","gene","gift","girl","give","glad","goal","goes","gold","Golf","gone","good","gray","grew","grey","grow","gulf","hair","half","hall","hand","hang","hard","harm","hate","have","head","hear","heat","held","hell","help","here","hero","high","hill","hire","hold","hole","holy","home","hope","host","hour","huge","hung","hunt","hurt","idea","inch","into","iron","item","jack","jane","jean","john","join","jump","jury","just","keen","keep","kent","kept","kick","kill","kind","king","knee","knew","know","lack","lady","laid","lake","land","lane","last","late","lead","left","less","life","lift","like","line","link","list","live","load","loan","lock","logo","long","look","lord","lose","loss","lost","love","luck","made","mail","main","make","male","many","Mark","mass","matt","meal","mean","meat","meet","menu","mere","mike","mile","milk","mill","mind","mine","miss","mode","mood","moon","more","most","move","much","must","name","navy","near","neck","need","news","next","nice","nick","nine","none","nose","note","okay","once","only","onto","open","oral","over","pace","pack","page","paid","pain","pair","palm","park","part","pass","past","path","peak","pick","pink","pipe","plan","play","plot","plug","plus","poll","pool","poor","port","post","pull","pure","push","race","rail","rain","rank","rare","rate","read","real","rear","rely","rent","rest","rice","rich","ride","ring","rise","risk","road","rock","role","roll","roof","room","root","rose","rule","rush","ruth","safe","said","sake","sale","salt","same","sand","save","seat","seed","seek","seem","seen","self","sell","send","sent","sept","ship","shop","shot","show","shut","sick","side","sign","site","size","skin","slip","slow","snow","soft","soil","sold","sole","some","song","soon","sort","soul","spot","star","stay","step","stop","such","suit","sure","take","tale","talk","tall","tank","tape","task","team","tech","tell","tend","term","test","text","than","that","them","then","they","thin","this","thus","till","time","tiny","told","toll","tone","tony","took","tool","tour","town","tree","trip","true","tune","turn","twin","type","unit","upon","used","user","vary","vast","very","vice","view","vote","wage","wait","wake","walk","wall","want","ward","warm","wash","wave","ways","weak","wear","week","well","went","were","west","what","when","whom","wide","wife","wild","will","wind","wine","wing","wire","wise","wish","with","wood","word","wore","work","yard","yeah","year","your","zero","zone"];function _r(){for(var e="",t=0;t<4;t++){t>0&&(e+="-");var a=Math.random();e+=Cr[Math.floor(a*Cr.length)]}return e}var Mr=function(e){var t=Object(n.useState)(!1),a=Object(qt.a)(t,2),r=a[0],l=a[1],c=Object(n.useState)(!1),o=Object(qt.a)(c,2),s=o[0],u=o[1],d=zn(),m=function(e){l(e)},y=function(){u(!0),setTimeout((function(){return u(!1)}),500)};Object(n.useEffect)((function(){return f.Dirty.subscribe(m),function(){return f.Dirty.unsubscribe(m)}})),Object(n.useEffect)((function(){return f.Saving.subscribe(y),function(){return f.Saving.unsubscribe(y)}}));return i.a.createElement("button",{disabled:!r||s,onClick:function(){d(Nn())}},s?"\ud83d\udcbf":r?"\ud83d\udcbe":"\u2714\ufe0f")};var Or=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).bubbleSeed=0,n.onChange=function(e){var t=++n.bubbleSeed,a=e.change>0;n.setState({bubbles:n.state.bubbles.concat([{string:(a?"+":"")+e.change,id:t,className:a?"pos":"neg"}])}),setTimeout((function(){n.setState({bubbles:n.state.bubbles.filter((function(e){return e.id!=t}))})}),1500)},n.state={bubbles:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.props.changeEvent&&this.props.changeEvent.subscribe(this.onChange)}},{key:"componentWillUnmount",value:function(){this.props.changeEvent&&this.props.changeEvent.unsubscribe(this.onChange)}},{key:"render",value:function(){var e=this,t=this.state.bubbles.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.props.bubbleClass,"bubbler"].join(" ")},e.props.icon," ",t.string)}));return i.a.createElement("span",{className:"bubble-parent"},this.props.children,t)}}]),a}(i.a.Component),Br=function(e){var t=function(e,t){var a=Object(n.useState)([]),i=Object(qt.a)(a,2),r=i[0],l=i[1],c=0,o=function(e){var a=++c;l(r.concat([Object(b.a)({id:a},t(e))])),setTimeout((function(){l(r.filter((function(e){return e.id!=a})))}),1500)};return Object(n.useEffect)((function(){return e.subscribe(o),function(){return e.unsubscribe(o)}})),r}(e.changeEvent,(function(e){return{string:"Discovered ".concat(e.k,"!"),className:"seen-belief"}}));return i.a.createElement("span",{className:"bubble-parent"},e.children,t.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.bubbleClass,"bubbler"].join(" ")},e.icon," ",t.string)})))},Tr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(o.a)(a,[{key:"render",value:function(){var e="capsule-label "+this.props.label||!1;return i.a.createElement("span",{className:e},i.a.createElement("span",{className:"capsule-icon"},this.props.icon),i.a.createElement("span",{className:"capsule-text"},this.props.label,":"),i.a.createElement("span",{className:"capsule-value"},this.props.children))}}]),a}(i.a.Component),Ar=function(){var e=Fn((function(e){return e.world.alien.energy.amount}));return i.a.createElement("span",null,e.toFixed(1))},Pr=function(){var e=Fn((function(e){return e.world.alien.bots.amount}));return i.a.createElement("span",null,e.toFixed(1))},Gr=function(){var e=Fn((function(e){return e.world.alien.hedons.amount}));return i.a.createElement("span",null,e.toFixed(0))},Lr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={show:!1},n}return Object(o.a)(a,[{key:"getButton",value:function(){var e=this;return this.props.onClick?i.a.createElement("button",{type:"button",className:"done",onClick:function(){return e.props.onClick&&e.props.onClick()}},this.props.closeButtonText||"Done"):null}},{key:"render",value:function(){return this.props.show?i.a.createElement("div",{className:"modal "+(this.props.className||"")},this.props.children,this.getButton()):null}}]),a}(i.a.Component);var qr=function(){var e,t=Fn((function(e){return e.world.date}));return i.a.createElement("span",null,"\xa0Year ",t.year,",\xa0",ca[t.season]," ",t.day," ",(e=t.hour)<da.Morning?"\ud83c\udf19":e<da.Noon?"\ud83c\udf04":e<da.Evening?"\u2600\ufe0f":"\ud83c\udf07")},Hr=(a(36),function(e){var t=Fn((function(t){return qn(t.world,e.city.key)})),a=Fn((function(e){return e.world.alien.scanned_bean})),n=zn();return i.a.createElement("div",{className:"social-graph"},i.a.createElement("div",{className:"social-graph-row"},t.map((function(t){return i.a.createElement("div",{key:t,className:"bean-node",onClick:function(){return n(Zn({cityKey:e.city.key,beanKey:t}))}},i.a.createElement(or,{beanKey:t,static:!0,sitStill:!0,cityKey:e.city.key}),a[t]?null:i.a.createElement("span",{className:"social-graph-unscanned prohibited-emoji"},"\ud83d\udef0\ufe0f"))}))),i.a.createElement("div",{className:"social-graph-row"},i.a.createElement(rr,{city:e.city,onClickBuilding:e.onClickBuilding})))}),zr=(a(37),function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\u231b\ufe0f",i.a.createElement("button",{type:"button",className:0==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(0)}},"\u23f9"),i.a.createElement("button",{type:"button",className:1==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(1)}},"\u25b6\ufe0f"),i.a.createElement("button",{type:"button",className:2==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(2)}},"\u23e9"))}}]),a}(i.a.Component)),Fr=function(e){return i.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\ud83d\udc41\ufe0f",i.a.createElement("button",{type:"button",className:"geo"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("geo")}},"\ud83c\udf0e"),i.a.createElement("button",{type:"button",className:"network"==e.activeMain?"active":"",onClick:function(){return e.setActiveMain("network")}},"\ud83c\udf10"))},Rr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onEvent=function(e){n.setState({eventCount:n.state.eventCount+1}),window.setTimeout((function(){n.setState({eventCount:n.state.eventCount-1})}),3e3)},n.props.event.subscribe(n.onEvent),n.state={eventCount:0},n}return Object(o.a)(a,[{key:"render",value:function(){return i.a.createElement("span",null,this.state.eventCount<1?this.props.children:i.a.createElement("span",{className:this.props.eventClass},this.props.eventIcon))}}]),a}(i.a.Component),Wr=function(e){var t=Fn((function(e){return e.selected.selectedBeanKey})),a=Fn((function(e){return e.world.titles.allIDs.reduce((function(t,a){return t.push(e.world.titles.byID[a]),t}),[])})),n=zn();return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h1",null,"Award Title"),i.a.createElement("div",null,a.map((function(a,r){return i.a.createElement("div",{key:r,className:"card-parent"},i.a.createElement("button",{className:"button card",onClick:function(){null!=t&&(n(_n({beanKey:t,titleKey:a.key})),e.closeModal())}},a.headwear," ",a.name," ",a.badge))}))))},Jr=i.a.createContext(void 0),Ur=i.a.createContext(je),Zr=Yn,Vr=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).previousTimeMS=0,n.logicTickAccumulatorMS=0,n.millisecondsSinceLastSave=0,n.saveAccumulatorMS=0,n.tick=function(e){var t=e-n.previousTimeMS;if(n.previousTimeMS=e,t>0){var a=t*n.state.timeScale;(function(e,t){var a=[];return e.ufos.allIDs.forEach((function(n){e.ufos.byID[n];oa.Get("ufo",n).elapsed+=t,oa.Get("ufo",n).elapsed>4e3&&a.push($a({ufoKey:n}))})),a})(Zr.getState().world,t).map((function(e){return Zr.dispatch(e)})),a>0&&(n.logicTickAccumulatorMS+=t,function(e,t){for(var a=e.pickups.allIDs,n=e.cities.byID[0],i=[],r=a.length-1;r>=0;r--){var l=a[r],c=n.pickupMagnetPoint,o=Object(b.a)({},je.Get("pickup",l).current||ae);if(c)ie(o,n,c,Ce*t/1e3,_e,Me,Ie)&&i.push(dn({cityKey:n.key,pickupKey:l}));else re(o,Ie);je.Get("pickup",l).publish(o)}return i}(Zr.getState().world,t).map((function(e){return Zr.dispatch(e)})),function(e,t){var a=[];return e.beans.allIDs.forEach((function(n){var i=e.beans.byID[n];if("alive"==i.lifecycle){var r=oa.Get("bean",i.key);r.elapsed+=t;var l=Ut[i.action].act(i,e,r.elapsed,t);if(Array.isArray(l.action)?a.push.apply(a,Object(h.a)(l.action)):l.action&&a.push(l.action),l.newActivity){var c=Ut[i.action].exit(i,e.seed);c&&a.push(c),a.push(hn({beanKey:n,newState:l.newActivity}));var o=Ut[l.newActivity.act].enter(i);o&&a.push(o)}}})),a}(Zr.getState().world,t).map((function(e){return Zr.dispatch(e)})),n.logicTickAccumulatorMS>2e3&&(Zr.dispatch(Va()),n.logicTickAccumulatorMS=0)),n.millisecondsSinceLastSave+=t,f.Dirty.current&&n.millisecondsSinceLastSave>15e3&&(f.SaveGame(Zr.getState().world),n.millisecondsSinceLastSave=0)}window.requestAnimationFrame(n.tick)},n.cheatMode=!1,n.keyupHandler=function(e){" "===e.key?n.state.timeScale>0?n.setState({timeScale:0}):n.setState({timeScale:1}):"Escape"===e.key?("greeting"===n.state.activeModal&&Zr.dispatch(Ya({seed:n.state.newGameSeed})),n.setState({activeModal:null})):n.cheatMode&&"A"===e.key?Zr.dispatch(Dn()):n.cheatMode&&"Q"===e.key||n.cheatMode&&e.key,n.cheatMode=e.shiftKey&&"C"===e.key},n.onDeath=function(e){Ba.play("death"),n.startSpotlight(e)},n.timescaleBeforeSpotlight=1,n.state={activeMain:"geo",activeModal:"mainmenu",activeRightPanel:"overview",timeScale:0,spotlightEvent:void 0,newGameSeed:_r()},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this.keyupHandler,!1),window.requestAnimationFrame((function(t){e.previousTimeMS=t,window.requestAnimationFrame(e.tick)})),Zr.subscribe((function(){var t=Zr.getState();null==t.selected.selectedBeanKey&&null==t.selected.selectedBuildingKey&&null==t.selected.selectedDistrictKey||"overview"==e.state.activeRightPanel||e.setState({activeRightPanel:"overview"})}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyupHandler)}},{key:"startSpotlight",value:function(e){var t=this;this.timescaleBeforeSpotlight=this.state.timeScale,this.setState({spotlightEvent:e,timeScale:0},(function(){setTimeout((function(){return t.endSpotlight()}),5e3)}))}},{key:"endSpotlight",value:function(){this.setState({timeScale:this.timescaleBeforeSpotlight,spotlightEvent:void 0})}},{key:"getPanel",value:function(){var e=this;switch(this.state.activeRightPanel){case"overview":return i.a.createElement(Kr,{openBrainwash:function(){return e.setState({activeModal:"brainwash"})},openEntitle:function(){return e.setState({activeModal:"entitle"})}});case"goals":return i.a.createElement(Sr,null);case"events":return i.a.createElement(Dr,null);case"market":return i.a.createElement(jr,null)}}},{key:"render",value:function(){var e=this;return i.a.createElement(d.a,{store:Zr},i.a.createElement(Jr.Provider,{value:Ba},i.a.createElement(Ur.Provider,{value:je},i.a.createElement("div",{className:"canvas"},"network"===this.state.activeMain?i.a.createElement("div",{className:"canvas"},i.a.createElement(Hr,{city:Zr.getState().world.cities.byID[0],onClickBuilding:function(e){return Zr.dispatch($n({cityKey:Zr.getState().world.cities.allIDs[0],buildingKey:e.key}))},onClick:function(e){Zr.dispatch(Zn({cityKey:e.cityKey,beanKey:e.key}))}})):i.a.createElement(m.b,{minScale:.65,centerZoomedOut:!0,centerOnInit:!0,initialPositionX:5e3,limitToBounds:!1,alignmentAnimation:{disabled:!0},wheel:{step:.05}},i.a.createElement(m.a,null,i.a.createElement("div",{className:"world"},Zr.getState().world.cities.allIDs.map((function(e){return i.a.createElement(pr,{cityKey:e,key:e,onClick:function(){}})}))))),i.a.createElement("div",{className:"overlay"},i.a.createElement(Lr,{show:"mainmenu"==this.state.activeModal},i.a.createElement(Ii,{startGame:function(){return e.setState({activeModal:"greeting"})},loadGame:function(t){var a=f.GetGame(t);null!=a.game&&(Zr.dispatch(Qa({newState:a.game})),e.setState({activeModal:null}))}})),i.a.createElement(Lr,{show:"loadgame"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Zr.dispatch(Ya({seed:e.state.newGameSeed}))}},i.a.createElement(ji,null)),i.a.createElement(Lr,{show:"escapemenu"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Zr.dispatch(Ya({seed:e.state.newGameSeed}))}},i.a.createElement(vi,null)),i.a.createElement(Lr,{show:"greeting"==this.state.activeModal,onClick:function(){e.setState({activeModal:null}),Zr.dispatch(Ya({seed:e.state.newGameSeed}))}},i.a.createElement(Si,{seed:this.state.newGameSeed,changeSeed:function(t){return e.setState({newGameSeed:t})}})),i.a.createElement(Lr,{show:"gov"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ei,null)),i.a.createElement(Lr,{show:"polisci"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Oi,null)),i.a.createElement(Lr,{show:"society"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(mi,null)),i.a.createElement(Lr,{show:"economy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"economy"==this.state.activeModal?i.a.createElement(bi,null):""),i.a.createElement(Lr,{show:"traits"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Bi,null)),i.a.createElement(Lr,{show:"brainwash"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(si,null)),i.a.createElement(Lr,{show:"entitle"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})},className:"modal-tiny"},i.a.createElement(Wr,{closeModal:function(){return e.setState({activeModal:null})}})),i.a.createElement("div",{className:"left"},i.a.createElement("div",{className:"top"},i.a.createElement("span",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),i.a.createElement(qr,null),i.a.createElement(zr,{timeScale:this.state.timeScale,setTimeScale:function(t){e.setState({timeScale:t})}}),i.a.createElement(Fr,{setActiveMain:function(t){return e.setState({activeMain:t})},activeMain:this.state.activeMain}),i.a.createElement(Mr,null)),i.a.createElement("div",{className:"bottom"},i.a.createElement(Or,{changeEvent:Dt.alienEnergy,icon:"\u26a1\ufe0f"},i.a.createElement(Tr,{icon:"\u26a1\ufe0f",label:"Energy"},i.a.createElement(Ar,null))),i.a.createElement(Or,{changeEvent:Dt.alienBots,icon:"\ud83e\udd16"},i.a.createElement(Tr,{icon:"\ud83e\udd16",label:"Bots"},i.a.createElement(Pr,null))),i.a.createElement(Or,{changeEvent:Dt.alienHedons,icon:"\ud83d\udc4d"},i.a.createElement(Tr,{icon:"\ud83d\udc4d",label:"Hedons"},i.a.createElement(Gr,null))),i.a.createElement("span",null,i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"economy"})}},"\ud83d\udcca State of the Utopia"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"gov"})}},"\ud83d\uddf3\ufe0f Gov"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"polisci"})}},"\ud83e\uddea Research"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"society"})}},"\ud83d\udc51 Society"),i.a.createElement(Br,{changeEvent:Dt.newTraitSeen,icon:"\ud83e\udde0"},i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"traits"})}},"\ud83e\udde0 Traits"))))),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"full-width-tabs"},i.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"overview"})}},"\ud83d\udcc8 Info"),i.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"market"}),Zr.dispatch(Un())}},"\ud83d\udecd\ufe0f Market"),i.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"events"}),Zr.dispatch(Un())}},i.a.createElement(Rr,{event:Dt.events,eventIcon:"\ud83d\udea8",eventClass:"police-siren"},"\ud83d\udce3")," Events"),i.a.createElement("button",{onClick:function(){e.setState({activeRightPanel:"goals"}),Zr.dispatch(Un())}},"\ud83c\udfc6 Goals")),i.a.createElement("div",{className:"right-panel"},this.getPanel())))))))}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(Vr,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.0a347ad0.chunk.js.map