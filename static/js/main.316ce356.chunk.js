(this.webpackJsonpsocsim=this.webpackJsonpsocsim||[]).push([[0],[,,,,,,,,,,function(e,t,a){e.exports=a(26)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n,i,r=a(0),s=a.n(r),o=a(9),l=a.n(o),c=(a(15),a(1)),u=a(2),h=a(4),d=a(3),p=(a(16),a(17),a(5)),m=function(){function e(t){Object(c.a)(this,e),this.onPublish=t,this.callbacks=[]}return Object(u.a)(e,[{key:"publish",value:function(e){this.onPublish&&this.onPublish(e),this.callbacks.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e){this.callbacks.push(e)}},{key:"unsubscribe",value:function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)}}]),e}(),f=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return a}(m),y=function e(){var t=this;Object(c.a)(this,e),this.buffer=[],this.sendToBuffer=function(e){t.buffer.length>20&&t.buffer.pop(),t.buffer.unshift(e)},this.speechcrime=new m(this.sendToBuffer),this.nojobslots=new m(this.sendToBuffer),this.birth=new m(this.sendToBuffer),this.death=new m(this.sendToBuffer)};function b(e,t){return t.year>-1&&(t.year==e.year||t.year==e.year-1&&t.season>e.season)}!function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Fall=2]="Fall",e[e.Winter=3]="Winter"}(n||(n={})),function(e){e[e.Midnight=0]="Midnight",e[e.Morning=1]="Morning",e[e.Noon=2]="Noon",e[e.Evening=3]="Evening"}(i||(i={}));var v=a(6),g=function e(t,a){Object(c.a)(this,e),this.q=t,this.r=a},E=[new g(1,0),new g(1,-1),new g(0,-1),new g(-1,0),new g(-1,1),new g(0,1)];function k(e){return E[e]}function w(e,t){var a=k(t);return new g(e.q+a.q,e.r+a.r)}function j(e,t){for(var a,n,i=[],r=function(e,t){return new g(e.q+t.q,e.r+t.r)}(e,(a=k(4),n=t,new g(a.q*n,a.r*n))),s=0;s<6;s++)for(var o=0;o<t;o++)i.push(r),r=w(r,s);return i}function S(e,t,a){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return r<=a||0==r?t:{x:e.x+n/r*a,y:e.y+i/r*a}}function C(e,t,a){return e+(t-e)*a}function x(e,t,a){return{x:C(e.x,t.x,a),y:C(e.y,t.y,a),z:C(e.z,t.z,a)}}function N(e){var t=Math.round(e.x),a=Math.round(e.y),n=Math.round(e.z),i=Math.abs(t-e.x),r=Math.abs(a-e.y),s=Math.abs(n-e.z);return i>r&&i>s?t=-a-n:r>s?a=-t-n:n=-t-a,{x:t,y:a,z:n}}function O(e){var t=e.x,a=e.z;return new g(t,a)}function _(e){return{x:e.q,z:e.r,y:-e.q-e.r}}function B(e,t){for(var a=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z))/2}(e,t),n=[],i=0;i<=a;i++)n.push(O(N(x(e,t,1/a*i))));return n}var P=new function e(t,a,n,i,r,s,o,l,u){Object(c.a)(this,e),this.f0=t,this.f1=a,this.f2=n,this.f3=i,this.b0=r,this.b1=s,this.b2=o,this.b3=l,this.start_angle=u}(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0),M={x:0,y:0};function D(e,t,a){var n=P,i=(n.f0*a.q+n.f1*a.r)*e.x,r=(n.f2*a.q+n.f3*a.r)*e.y;return{x:i+t.x,y:r+t.y}}function T(e){return{x:e.r*Math.cos(e.az),y:e.r*Math.sin(e.az)}}function I(e,t,a){var n=e.byType[t].coordByID[a];return n?F(D(e.hex_size,e.petriOrigin,n)):{background:"red"}}function F(e){return{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}}var A,H=function(){function e(){Object(c.a)(this,e),this.key=0,this.type="farm",this.occupied_slots=[],this.empty_slots=[],this.upgraded=!1,this.job_slots={0:null,1:null,2:null,3:null,4:null,5:null}}return Object(u.a)(e,[{key:"openSlots",value:function(){var e=this;return Object.keys(this.job_slots).filter((function(t,a){return null===e.job_slots[+t]&&(a<3||e.upgraded)})).map((function(e){return+e}))}},{key:"usedSlots",value:function(){var e=this;return Object.keys(this.job_slots).filter((function(t){return null!=e.job_slots[+t]})).map((function(e){return+e}))}},{key:"tryFreeBean",value:function(e){for(var t=this.usedSlots(),a=0;a<t.length;a++){var n=t[a];if(this.job_slots[n]===e)return this.job_slots[n]=null,!0}return!1}}]),e}(),L={farm:"\ud83d\udc04",house:"\ud83c\udfe1",hospital:"\ud83c\udfe5",church:"\u26ea",theater:"\ud83c\udfaa",courthouse:"\ud83c\udfeb",park:"\u26f2\ufe0f",nature:"\ud83c\udfde\ufe0f"},R={farm:"\ud83d\ude9c",house:"\ud83c\udfd8\ufe0f",hospital:"\ud83c\udfd9\ufe0f",church:"\u26ea",theater:"\ud83c\udfdf\ufe0f",courthouse:"\ud83c\udfeb",park:"\ud83c\udfa1",nature:"\ud83c\udfde\ufe0f"},z={farm:"\ud83c\udf3e",house:"\ud83d\udcea",hospital:"\ud83d\udecf\ufe0f",church:"\u26ea",theater:"\ud83e\ude91",courthouse:"\ud83c\udfeb",park:"\ud83d\udc90",nature:"\u2668\ufe0f"},q={food:"farm",shelter:"house",medicine:"hospital",fun:"theater"},G={farmer:"farm",builder:"house",doc:"hospital",entertainer:"theater",cleric:"church",jobless:"house",polit:"house"},W=function(){function e(){Object(c.a)(this,e),this.byCoord={},this.byType={house:{coordByID:{},all:[]},farm:{coordByID:{},all:[]},hospital:{coordByID:{},all:[]},theater:{coordByID:{},all:[]},courthouse:{coordByID:{},all:[]},church:{coordByID:{},all:[]},park:{coordByID:{},all:[]},nature:{coordByID:{},all:[]}},this.movers={bean:{},ufo:{}},this.numberOfRings=5,this.hexes=function(e,t){for(var a=[e],n=0;n<t;n++)a=a.concat(j(e,n));return a}({q:0,r:0},this.numberOfRings),this.hex_size={x:70,y:70},this.petriRadius=550,this.petriOrigin={x:this.petriRadius,y:this.petriRadius}}return Object(u.a)(e,[{key:"numberOf",value:function(e){return this.byType[e].all.length}},{key:"lookupBuilding",value:function(e){return this.byCoord[e.q+","+e.r]}},{key:"addBuilding",value:function(e,t){return this.byType[t.type].all.push(t),this.byType[t.type].coordByID[t.key]=e,this.byCoord[e.q+","+e.r]=t,null}},{key:"removeBuilding",value:function(e,t){var a=this.byType[t.type].all.indexOf(t);return this.byType[t.type].all.splice(a,1),delete this.byType[t.type].coordByID[t.key],this.byCoord[e.q+","+e.r]=void 0,null}}]),e}();!function(e){e[e.first=0]="first",e[e.second=1]="second",e[e.third=2]="third",e[e.fourth=3]="fourth",e[e.fifth=4]="fifth",e[e.sixth=5]="sixth"}(A||(A={}));a(18);var V={x:25,y:25};function K(e){return D(V,M,e)}var U={2:A.first,0:A.second,4:A.third,1:A.fourth,5:A.fifth,3:A.sixth},J=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"slots",value:function(){var e=this;return E.map((function(t,a){var n=U[a],i=null!=e.props.building.job_slots[n];return s.a.createElement("span",{key:a,className:"slot",style:F(K(t))},i?z[e.props.building.type]:null)}))}},{key:"render",value:function(){return s.a.createElement("div",{key:this.props.building.type+this.props.building.key,style:I(this.props.city,this.props.building.type,this.props.building.key),className:"building "+this.props.building.type},this.props.building.upgraded?R[this.props.building.type]:L[this.props.building.type],this.slots(),"courthouse"===this.props.building.type?s.a.createElement("span",{className:"tile-label"},this.props.city.name):null)}}]),a}(s.a.Component),$=function e(t,a){Object(c.a)(this,e),this.value=t,this.priority=a},Q=function(){function e(t){Object(c.a)(this,e),this.values=[],this.values=t}return Object(u.a)(e,[{key:"enqueue",value:function(e){this.values.push(e),this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"enqueueMany",value:function(e){this.values=e,this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"dequeue",value:function(){return this.values.shift()}}]),e}(),Y=function(){function e(t){Object(c.a)(this,e),this.values=[],this.values=t}return Object(u.a)(e,[{key:"swap",value:function(e,t){var a=this.values[e];return this.values[e]=this.values[t],this.values[t]=a,this.values}},{key:"bubbleUp",value:function(){for(var e=this.values.length-1;e>0;){var t=Math.floor((e-1)/2);if(!(this.values[t].priority>this.values[e].priority))break;this.swap(e,t),e=t}return 0}},{key:"enqueue",value:function(e){return this.values.push(e),this.bubbleUp(),this.values}},{key:"bubbleDown",value:function(){for(var e=0,t=this.values.length,a=this.values[0].priority;;){var n=2*e+1,i=2*e+2,r=999,s=void 0,o=null;if(n<t&&(r=this.values[n].priority)<a&&(o=n),i<t&&((s=this.values[i].priority)<a&&null===o||s<r&&null!==o)&&(o=i),null===o)break;this.swap(e,o),e=o}}},{key:"dequeue",value:function(){this.swap(0,this.values.length-1);var e=this.values.pop();return this.values.length>1&&this.bubbleDown(),e}}]),e}();var Z=function(){function e(t){Object(c.a)(this,e),this.data=t}return Object(u.a)(e,[{key:"enter",value:function(e){this.data.elapsed=0}},{key:"act",value:function(e,t,a){var n=this._act(e,t,a);return this.data.elapsed=this.Elapsed+t,n}},{key:"exit",value:function(e){}},{key:"Elapsed",get:function(){return this.data.elapsed||0}}]),e}(),X=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,n){if(this.Elapsed<200)return this;if(e instanceof ke&&e.city)for(var i=de(e,n),r=i.dequeue(),s=null;r&&null==s;){if(a.substituteIntent(e,r.value)&&null!=(s=ee.createFromIntent(e,r.value)))return s;r=i.dequeue()}return this}}],[{key:"create",value:function(){return new a({act:"idle"})}},{key:"substituteIntent",value:function(e,t){if("buy"===t.act&&null!=t.good&&e instanceof ke){var a=e.canBuy(t.good);if("yes"!=a&&"fun"===t.good)t.act="relax";else if("pricedout"===a){if(!(e instanceof ke&&e.maybeCrime(t.good)))return null;t.act="crime"}else if("nosupply"===a)return null}return t}}]),a}(Z);var ee=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,a){var n=this;if(e instanceof ke&&e.city&&this.data.destinations&&this.data.destinations.length){var i=e.city.movers.bean[e.key],r=this.data.destinations[0],s=S(i,r,t/1e3*e.speed);e.city.movers.bean[e.key]=s,s.x==r.x&&s.y==r.y&&(this.data.location=s,this.data.destinations.shift())}if(null==this.data.destinations||0===this.data.destinations.length)return this.data.intent?se[this.data.intent.act](this.data.intent):X.create();if(e instanceof ke&&e.city){var o=e.city.getNearestNeighbors(e);if(o.length&&e.maybeChat()){var l=o.filter((function(e){return e.maybeChat()}));if(l.length<1)return this;var c=e.getRandomChat(l);return l.forEach((function(e){return e.state=ne.create(n.data.intent,Object(v.a)(Object(v.a)({},c),{},{participation:"listener"}))})),ne.create(this.data,c)}return this}return this}}],[{key:"createFromIntent",value:function(e,t){var a=function(e,t){if(!(e instanceof ke))return[];if(e.city){var a=e.city;switch(t.act){case"buy":if(t.good)return pe(a,e,q[t.good]);case"work":return pe(a,e,G[e.job]);case"relax":var n=tt(a.byType.park.all.concat(a.byType.nature.all));return e.destinationKey=n.key,me(a,e,n)}}return[]}(e,t);return a?this.createFromDestination(a,t):null}},{key:"createFromDestination",value:function(e,t){return new a({act:"travel",destinations:e,intent:t})}}]),a}(Z),te=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,a){var n,i;return this.Elapsed>2e3&&e instanceof ke&&this.data.good&&(null===(n=e.city)||void 0===n?void 0:n.economy)&&(null===(i=e.city)||void 0===i?void 0:i.law)?(e.work(e.city.law,e.city.economy),X.create()):this}}],[{key:"create",value:function(e){return new a({act:"work",good:e})}}]),a}(Z),ae=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).sinceLastAttemptMS=0,e.attempts=0,e._bought=!1,e}return Object(u.a)(a,[{key:"tryBuy",value:function(e){var t;e instanceof ke&&this.data.good&&(null===(t=e.city)||void 0===t?void 0:t.economy)&&(this._bought=e.buy[this.data.good](e.city.economy)),this.sinceLastAttemptMS=0,this.attempts++}},{key:"enter",value:function(e){this.tryBuy(e)}},{key:"_act",value:function(e,t,a){return this._bought||this.sinceLastAttemptMS>250&&this.tryBuy(e),this.Elapsed>1500?X.create():this}}],[{key:"create",value:function(e){return new a({act:"buy",good:e})}}]),a}(Z),ne=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,a){if(this.Elapsed>1e3&&this.data.intent){var n=ee.createFromIntent(e,this.data.intent);if(n)return n}return this}},{key:"exit",value:function(e){e instanceof ke&&this.data.chat&&(e.lastChatMS=Date.now())}}],[{key:"create",value:function(e,t){return new a({act:"chat",intent:e,chat:t})}}]),a}(Z),ie=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,a){var n=1e3;return e instanceof ke&&e.believesIn("Hedonism")&&(n*=3),this.Elapsed>n?X.create():this}},{key:"exit",value:function(e){e instanceof ke&&(e.discrete_fun+=1)}}],[{key:"create",value:function(e,t){return new a({act:"relax",intent:e,chat:t})}}]),a}(Z),re=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"_act",value:function(e,t,a){var n,i;return this.Elapsed>1500&&e instanceof ke&&(null===(n=e.city)||void 0===n?void 0:n.economy)&&("food"===this.data.good||"medicine"===this.data.good)?(e.steal(this.data.good,null===(i=e.city)||void 0===i?void 0:i.economy),X.create()):this}}],[{key:"create",value:function(e){return new a({act:"crime",good:e})}}]),a}(Z),se={idle:function(e){return new X(e)},work:function(e){return new te(e)},chat:function(e){return new ne(e)},travel:function(e){return new ee(e)},craze:function(e){return new ae(e)},buy:function(e){return new ae(e)},sleep:function(e){return new ae(e)},soapbox:function(e){return new ae(e)},crime:function(e){return new re(e)},relax:function(e){return new ie(e)}},oe=function(e){if("jobless"==e.job&&e.city)return 9;if(e.city){var t,a=99;if(e.city.economy)a=(null===(t=e.city.economy.market.getBeansListings(e.cityKey,e.key,Ue(e.job)))||void 0===t?void 0:t.quantity)||0;var n=e.cash/e.city.costOfLiving/2;return Math.min(a,n)}return 0},le=function(e,t){return.5+e.discrete_food/t.bean_life.vital_thresh.food.sufficient},ce=function(e,t){return 1+e.discrete_stamina/t.bean_life.vital_thresh.shelter.sufficient},ue=function(e,t){return.75+e.discrete_health/t.bean_life.vital_thresh.medicine.sufficient},he=function(e,t){return 2+e.lastHappiness/100*1.25};function de(e,t){var a=new Q([]),n=new $({act:"work",good:Ue(e.job)},oe(e));return a.enqueue(n),n=new $({act:"buy",good:"food"},le(e,t)),a.enqueue(n),n=new $({act:"buy",good:"shelter"},ce(e,t)),a.enqueue(n),n=new $({act:"buy",good:"medicine"},ue(e,t)),a.enqueue(n),n=new $({act:"buy",good:"fun"},he(e,t)),a.enqueue(n),a}function pe(e,t,a){var n=tt(e.byType[a].all);return void 0===n?null:(t.destinationKey=n.key,me(e,t,n))}function me(e,t,a){var n,i,r=e.byType[a.type].coordByID[a.key],s=e.movers.bean[t.key],o=function(e,t,a){var n=P,i=(a.x-t.x)/e.x,r=(a.y-t.y)/e.y,s=n.b0*i+n.b1*r,o=n.b2*i+n.b3*r;return new g(s,o)}(e.hex_size,e.petriOrigin,s);return(n=o,i=r,B(_(n),_(i))).map((function(t){return D(e.hex_size,e.petriOrigin,t)})).map((function(e,t,a){if(t===a.length-1){var n=K(tt(E));return{x:e.x+n.x,y:e.y+n.y}}return e}))}var fe={prog:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"Strives to help others"},trad:{noun:"Elitism",adj:"Elitist",icon:"\ud83d\udc51",description:"Strives for individual power"},state:{noun:"Collectivism",adj:"Collectivist",icon:"\ud83d\udd4a\ufe0f",description:"Trusts in the social group"},ego:{noun:"Independence",adj:"Independent",icon:"\ud83e\udd85",description:"Trusts only in oneself"}},ye={rocket:{noun:"Futurism",adj:"Futuristic",icon:"\ud83d\ude80",description:"Loves stories of the far future"},dragon:{noun:"Mythology",adj:"Mythical",icon:"\ud83d\udc32",description:"Loves stories of the legendary past"},music:{noun:"Drama",adj:"Dramatic",icon:"\ud83c\udfb5",description:"Loves stories of emotional bonding"},noFaith:{noun:"Nihilism",adj:"Nihilist",icon:"\u26ab\ufe0f",description:"Hates fairy tales"}},be={Diligence:{noun:"Diligence",adj:"Diligence",icon:"\ud83d\udcaa",description:"\ud83c\udfb2 to gain \ud83d\ude42 while working",idealCon:["trad"],idealPro:["state","ego"]},Greed:{noun:"Greed",adj:"Greedy",icon:"\ud83d\udcb0",description:"+25% theft Crime \ud83c\udfb2",idealCon:["prog"],idealPro:["trad"]},Neuroticism:{noun:"Neuroticism",adj:"Neurotic",icon:"\ud83d\ude31",description:"+100% \ud83e\udde0 damage",idealCon:["state"],idealPro:["ego"]},Anarchism:{noun:"Anarchism",adj:"Anarchist",icon:"\ud83d\udd95",description:"+33% Crime \ud83c\udfb2",idealCon:["state","prog"],idealPro:["ego","trad"]},Charity:{noun:"Charity",adj:"Charitable",icon:"\ud83d\ude07",description:"\ud83c\udfb2 to gift \ud83d\udcb0 to the penniless",idealCon:["trad"],idealPro:["prog"]},Natalism:{noun:"Natalism",adj:"Natalist",icon:"\ud83d\udc76",description:"+15% \ud83c\udfb2 for \ud83d\udc76"},Authority:{noun:"Authority",adj:"Authoritarian",icon:"\ud83d\udc62",description:"-25% Crime \ud83c\udfb2",idealCon:["ego"],idealPro:["state"]},Hedonism:{noun:"Hedonism",adj:"Hedonistic",icon:"\ud83d\udc8b",description:"Seeks \ud83d\ude42 often; \ud83d\ude0e 3x longer",idealCon:["prog"],idealPro:["ego","trad"]},Dogmatism:{noun:"Dogmatism",adj:"Dogmatic",icon:"\ud83d\udc36",description:"cannot be persuaded",idealCon:["ego"],idealPro:["state"]}};function ve(e,t,a){var n=be[e];return null!=n.idealCon&&n.idealCon.reduce((function(e,n){return e||function(e,t,a){switch(e){case"trad":case"prog":return e==t;case"state":case"ego":return e==a}}(n,t,a)}),!1)}var ge,Ee=Object.keys(be).map((function(e){return e})),ke=function(){function e(){var t=this;Object(c.a)(this,e),this.key=0,this.cityKey=0,this.dob={year:0,season:0,day:1,hour:0},this.bornInPetri=!1,this.name="Human Bean",this.sanity="sane",this.discrete_sanity=10,this.discrete_fun=0,this.lifecycle="alive",this.activity_queue=[],this.speed=60,this.direction={x:0,y:0},this.markers=[],this.destinationKey=0,this.city=null,this.ethnicity=tt(["circle","square","triangle"]),this.discrete_food=1,this.shelter="crowded",this.discrete_health=2,this.community="ego",this.ideals="trad",this.job="jobless",this.faith="noFaith",this.beliefs=[],this.cash=3,this.partyLoyalty=.2,this.lastHappiness=0,this.lastSentiment=0,this.lastPartySentiment=0,this.ticksSinceLastSale=0,this.ticksSinceLastRelax=0,this.discrete_stamina=7,this.lastApprovalDate={year:-1,season:0,day:0,hour:0},this.lastInsultDate={year:-1,season:0,day:0,hour:0},this.fairGoodPrice=1,this.lastChatMS=Date.now(),this.buy={food:function(e){return null!=t.buyFood(e)},medicine:function(e){return null!=t.buyMeds(e)},fun:function(e){return t.buyFun(e)},shelter:function(e){return t.buyHousing(e)}},this.state=X.create(),this.jobQueue=new Y([]),this.onAct=new m}return Object(u.a)(e,[{key:"believesIn",value:function(e){return-1!==this.beliefs.indexOf(e)}},{key:"loseSanity",value:function(e){var t=this.believesIn("Neuroticism")?2:1;this.discrete_sanity-=t*e}},{key:"getHappinessModifiers",value:function(e,t,a){var n=[Ve[this.food],Ve[this.shelter],Ve[this.health],{reason:"Entertainment",mod:.4*this.discrete_fun}];return"trad"==this.ideals&&this.ethnicity!=t.majorityEthnicity&&n.push({reason:"Xenophobic",mod:-.1}),this.cash<1?n.push({reason:"Penniless",mod:ze.Deficient}):this.cash>3*e.getCostOfLiving()?n.push({reason:"Upper Class",mod:.3}):this.cash>2*e.getCostOfLiving()&&n.push({reason:"Middle Class",mod:.15}),"jobless"==this.job&&n.push({reason:"Unemployed",mod:ze.Deficient}),n}},{key:"getSentimentModifiers",value:function(e,t,a,n){var i={party:[],law:[]};return this.community==n.community&&i.party.push({reason:"Same Community",mod:.15}),this.ideals==n.ideals?i.party.push({reason:"Same Ideals",mod:.15}):this.community!=n.community&&i.party.push({reason:"Incompatible Values",mod:-.15}),t.environment&&b(t.environment,this.lastApprovalDate)&&i.party.push({reason:"Public Endorsement",mod:.2}),i}},{key:"calculateBeliefs",value:function(e,t,a,n){this.lastHappiness=We(this.getHappinessModifiers(e,t,a));var i=this.getSentimentModifiers(e,t,a,n);if(this.lastSentiment=We(i.law),this.lastPartySentiment=We(i.party),"jobless"==this.job)this.fairGoodPrice=1;else{var r=Ue(this.job);this.fairGoodPrice=e.getFairGoodPrice(r)}}},{key:"getSentimentPolicies",value:function(e,t){var a=100;return t.forEach((function(t){t.fx.forEach((function(t){e[t.key]&&(a+=10*t.mag)}))})),a/100}},{key:"_getTraitMap",value:function(){var e,t=(e={},Object(p.a)(e,this.community,!0),Object(p.a)(e,this.ideals,!0),Object(p.a)(e,this.ethnicity,!0),e);return"noFaith"!=this.faith&&(t[this.faith]=!0),t}},{key:"getFace",value:function(){var e,t;if("buy"==this.state.data.act&&"shelter"==this.state.data.good)return"\ud83d\ude34";if("crime"==this.state.data.act)return"\ud83d\ude08";if("relax"==this.state.data.act)return"\ud83d\ude0e";if("chat"==this.state.data.act){var a;if("speaker"===(null===(a=this.state.data.chat)||void 0===a?void 0:a.participation))switch(null===(e=this.state.data)||void 0===e||null===(t=e.chat)||void 0===t?void 0:t.type){default:return"\ud83d\ude03";case"gift":return"\ud83d\ude07";case"praise":return"\ud83e\udd73";case"bully":return"\ud83d\ude08"}return"\ud83e\udd28"}return"hungry"==this.food?"\ud83d\ude2b":"sick"==this.health?"\ud83e\udd22":"podless"==this.shelter?"\ud83e\udd76":"jobless"==this.job?"\ud83d\ude27":this.lastHappiness<0?"\u2639\ufe0f":this.lastHappiness>=50?"\ud83d\ude42":"\ud83d\ude10"}},{key:"getIdea",value:function(e){return"hungry"==this.food?{bad:!0,idea:"\ud83c\udf57"}:"sick"==this.health?{bad:!0,idea:"\ud83d\udc8a"}:"podless"==this.shelter?{bad:!0,idea:"\ud83c\udfe0"}:this.canBaby(e)?{bad:!1,idea:"\ud83d\udc76"}:null}},{key:"getSpeech",value:function(){var e;if("chat"===this.state.data.act&&("speaker"===(null===(e=this.state.data.chat)||void 0===e?void 0:e.participation)&&this.state.data.chat.preachBelief))return"\ud83d\udcac"+be[this.state.data.chat.preachBelief].icon}},{key:"getCrimeDecision",value:function(e,t){var a=Math.random(),n=.05;return"ego"==this.community&&(n+=.1),("desperation"===t&&"sick"===this.health||"hungry"===this.food)&&(n+=.15),n<=a}},{key:"tryFindRandomJob",value:function(e){var t,a,n=tt(["builder","doc","farmer","entertainer"]);this.trySetJob(n)||(null===(t=this.city)||void 0===t||null===(a=t.eventBus)||void 0===a||a.nojobslots.publish({icon:"\ud83c\udfda\ufe0f",trigger:"nojobslots",message:"A subject cannot find a job; build or upgrade more buildings."}))}},{key:"trySetJob",value:function(e){var t;return!!(null===(t=this.city)||void 0===t?void 0:t.tryGetJob(this,e))&&(this.city.unsetJob(this),this.job=e,!0)}},{key:"canInsult",value:function(){return Boolean(this.city&&this.city.environment&&!b(this.city.environment,this.lastInsultDate))}},{key:"canSupport",value:function(){return Boolean(this.city&&this.city.environment&&!b(this.city.environment,this.lastApprovalDate))}},{key:"maybeChat",value:function(){return!(this.lastChatMS+4e3>Date.now())&&("chat"!==this.state.data.act&&Math.random()<("state"===this.community?.2:.1))}},{key:"getRandomChat",value:function(e){var t=this;if(this.beliefs.length){if(this.believesIn("Charity")&&this.cash>=2){var a=e.filter((function(e){return e.cash<=t.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),null);if(a)return this.cash-=.5,a.cash+=.5,{participation:"speaker",type:"gift",targetBeanKey:a.key}}return{participation:"speaker",type:"preach",preachBelief:tt(this.beliefs)}}return{participation:"speaker",type:"praise"}}},{key:"work",value:function(e,t){var a=this;if("jobless"==this.job);else{switch(this.job){case"farmer":this.discrete_food=Math.min(this.discrete_food+1,2*Ke.food.sufficient);break;case"doc":this.discrete_health=Math.min(this.discrete_health+1,2*Ke.medicine.sufficient);break;case"builder":this.shelter="crowded",this.discrete_stamina=7}if(this.believesIn("Diligence")&&Math.random()<=.5&&(this.discrete_fun+=.5),this.ticksSinceLastSale++,this.ticksSinceLastSale>7)if(!!this.city&&this.city.beans.filter((function(e){return e.job==a.job})).length>1&&Math.random()>.5){var n=t.mostInDemandJob();n&&this.trySetJob(n)}t.produceAndPrice(this,Ue(this.job),4,this.fairGoodPrice)}}},{key:"buyFood",value:function(e){var t=e.tryTransact(this,"food",.5,3);return t&&(this.discrete_food+=t.bought),t}},{key:"steal",value:function(e,t){var a=t.steal(e,3);if(null!=a)switch(e){case"food":this.discrete_food+=a;break;case"medicine":this.discrete_health+=a}}},{key:"buyHousing",value:function(e){var t=e.tryTransact(this,"shelter");return t?(this.discrete_stamina=10,this.shelter="crowded"):this.discrete_stamina<=0&&(this.shelter="podless"),null!=t}},{key:"buyFun",value:function(e){var t=e.tryTransact(this,"fun");return t&&(this.discrete_fun=1),null!=t}},{key:"age",value:function(e){if(!this.alive)return null;if(this.discrete_food-=1/7,this.discrete_food<0&&(this.discrete_health-=.2),this.maybeDie("starvation",.6))return null;if("podless"==this.shelter&&(this.discrete_health-=1/14),this.discrete_stamina--,this.maybeDie("exposure",.2))return null;this.discrete_health-=.05,this.discrete_health=Math.min(this.discrete_health,3);this.maybeDie("sickness",.4);return this.discrete_fun-=.1,this.discrete_fun=Math.max(0,this.discrete_fun),null}},{key:"buyMeds",value:function(e){var t=e.tryTransact(this,"medicine",.5,3);return t&&(this.discrete_health+=t.bought),t}},{key:"maybeBaby",value:function(e){if(this.canBaby(e.getCostOfLiving())&&Math.random()<=this.babyChance){if(!this.city)throw"bean does not have city object";return this.city.breedBean(this),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(this.name," has a baby!")}}return null}},{key:"canBaby",value:function(e){return this.alive&&this.cash>3*e&&!this.isInCrisis}},{key:"maybeCrime",value:function(e){if("shelter"===e)return!1;if("fun"===e)return!1;var t=Math.random(),a=.05;return"ego"==this.community&&(a+=.1),this.isInCrisis&&(a+=.1),this.believesIn("Greed")&&(a+=.25),this.believesIn("Anarchism")&&(a+=.33),this.believesIn("Authority")&&(a-=.25),("food"===e&&"hungry"===this.food||"medicine"===e&&"sick"===this.health)&&(a+=.25),a<=t}},{key:"canBuy",value:function(e){var t,a;return(null===(t=this.city)||void 0===t||null===(a=t.economy)||void 0===a?void 0:a.canBuy(this,e))||"nosupply"}},{key:"chanceToDonate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.cash>2*e.getCostOfLiving()&&!this.isInCrisis;if(a&&this.lastPartySentiment>.5){var n=t?.2:.5,i=this.lastPartySentiment-n;return i/2}return 0}},{key:"maybeDonate",value:function(e){return 0}},{key:"maybeDie",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return this.discrete_health<0&&Math.random()<=t&&(this.die(e),!0)}},{key:"die",value:function(e){var t,a,n;this.alive=!1,null===(t=this.city)||void 0===t||null===(a=t.eventBus)||void 0===a||a.death.publish({icon:"\u2620\ufe0f",trigger:"death",message:"".concat(this.name," died of ").concat(e,"!"),beanKey:this.key,cityKey:this.cityKey,point:null===(n=this.city)||void 0===n?void 0:n.movers.bean[this.key]})}},{key:"abduct",value:function(e){this.lifecycle="abducted",e.abductedBeans.push(this)}},{key:"alive",get:function(){return"alive"===this.lifecycle},set:function(e){this.lifecycle=!0===e?"alive":"dead"}},{key:"food",get:function(){return this.discrete_food>=Ke.food.abundant?"stuffed":this.discrete_food>=Ke.food.sufficient?"sated":"hungry"}},{key:"health",get:function(){return this.discrete_health>=Ke.medicine.abundant?"fresh":this.discrete_health>=Ke.medicine.sufficient?"bruised":"sick"}},{key:"isInCrisis",get:function(){return"hungry"==this.food||"podless"==this.shelter||"sick"==this.health}},{key:"babyChance",get:function(){return this.believesIn("Natalism")?.16:.01}}]),e}(),we=["food","shelter","medicine","fun"],je=function(){function e(t){Object(c.a)(this,e),this.eventBus=t,this.market=new Se,this.charity=new Se,this.unfulfilledSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalSupply={food:0,shelter:0,medicine:0,fun:0}}return Object(u.a)(e,[{key:"resetSeasonalDemand",value:function(){this.unfulfilledSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalSupply={food:0,shelter:0,medicine:0,fun:0}}},{key:"tryTransact",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.totalSeasonalDemand[t]+=n;var i=this.market.getLowestPriceListing(t,a);if(null==i)return this.unfulfilledSeasonalDemand[t]+=n,null;var r=Math.min(i.quantity,n);return i.price<=e.cash*r?this.market.transact(i,t,r,e):(this.unfulfilledSeasonalDemand[t]+=r,null)}},{key:"canBuy",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.market.getLowestPriceListing(t,a);if(null==i)return"nosupply";var r=Math.min(i.quantity,n);return i.price<=e.cash*r?"yes":"pricedout"}},{key:"steal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=tt(this.market.listings[e]);if(null==a)return null;var n=Math.min(a.quantity,t);return this.market.subtractFromListing(a,e,n),n}},{key:"produceAndPrice",value:function(e,t,a,n){this.totalSeasonalSupply[t]+=a;var i=this.market.getBeansListings(e.cityKey,e.key,t);i?(i.quantity+=a,i.price=n,i.quantity=Math.min(i.quantity,6)):this.market.addNewListing(t,a,n,e),this.market.sort(t)}},{key:"addCharity",value:function(e,t,a){var n=this.charity.getOrgsListings(e,t);n?(n.quantity+=a,n.quantity=Math.min(n.quantity,10),e.inventory=n.quantity):(this.charity.addNewOrgListing(t,a,0,e),e.inventory=a)}},{key:"mostInDemandJob",value:function(){var e=this;return we.reduce((function(t,a){return e.unfulfilledSeasonalDemand[a]>t.max&&(t.max=e.unfulfilledSeasonalDemand[a],t.job=function(e){switch(e){case"shelter":return"builder";case"medicine":return"doc";case"fun":return"entertainer";default:case"food":return"farmer"}}(a)),t}),{max:0,job:null}).job}},{key:"onBeanDie",value:function(e){var t=this;we.forEach((function(a){var n=t.market.getBeansListings(e.cityKey,e.key,a);if(n){var i,r=null===(i=e.city)||void 0===i?void 0:i.getRandomCitizen();r&&(n.sellerCityKey=r.cityKey,n.sellerBeanKey=r.key,n.seller=r)}}))}},{key:"getFairGoodPrice",value:function(e){var t=this.totalSeasonalSupply[e]||1,a=this.totalSeasonalDemand[e];return.25+.75*Math.min(a/t,1)}},{key:"getCostOfLiving",value:function(){return this.getFairGoodPrice("food")+this.getFairGoodPrice("shelter")+this.getFairGoodPrice("medicine")}}]),e}(),Se=function(){function e(){Object(c.a)(this,e),this.listings={food:[],shelter:[],medicine:[],fun:[]}}return Object(u.a)(e,[{key:"getLowestPriceListing",value:function(e,t){var a=this.listings[e].filter((function(e){return e.quantity>=t}));if(a.length>0){for(var n=1,i=a[0].price,r=1;r<a.length;r++){if(a[r].price>i)break;n++}var s=Math.floor(Math.random()*n);if(s>=a.length)throw"invalid index";return a[s]}return null}},{key:"getBeansListings",value:function(e,t,a){return this.listings[a].find((function(a){return a.sellerBeanKey==t&&a.sellerCityKey==e}))}},{key:"getOrgsListings",value:function(e,t){return this.listings[t].find((function(t){return t.sellerOrganizationKey==e.key}))}},{key:"transact",value:function(e,t,a,n){this.subtractFromListing(e,t,a);var i=e.price*a;return n.cash-=i,e.seller.cash+=i,e.seller.ticksSinceLastSale=0,{bought:a,price:i}}},{key:"subtractFromListing",value:function(e,t,a){e.quantity-=a,e.quantity<=0&&this.listings[t].splice(0,1)}},{key:"addNewListing",value:function(e,t,a,n){this.listings[e].push({sellerCityKey:n.cityKey,sellerBeanKey:n.key,price:a,seller:n,quantity:t})}},{key:"addNewOrgListing",value:function(e,t,a,n){this.listings[e].push({sellerOrganizationKey:n.key,price:a,seller:n,quantity:t})}},{key:"sort",value:function(e){this.listings[e].sort((function(e,t){return e.price-t.price}))}}]),e}(),Ce=function e(){Object(c.a)(this,e),this.key=1,this.playerKey=1,this.organizations=[],this.name="Citizen's Party",this.slogan="Vote for us!",this.community="state",this.ideals="trad",this.availablePolicies=[],this.proposedPolicy=void 0,this.availableCampaigns=[],this.activeCampaigns=[],this.leadership=10,this.activeHQs=[],this.platform={}},xe=function(){function e(){Object(c.a)(this,e),this.key=0,this.name="",this.institutionKey=1,this.cash=0,this.ticksSinceLastSale=0,this.seasonalBudget=0,this.good="food",this.parentInstitution=null,this.beansHelped=0,this.inventory=0}return Object(u.a)(e,[{key:"work",value:function(e,t){for(;this.cash>0&&this.inventory<10;){var a=t.tryTransact(this,this.good);if(!a)break;t.addCharity(this,this.good,a.bought)}}}]),e}(),Ne={wel_food:{name:"Food Welfare"},wel_house:{name:"Housing Welfare"},wel_health:{name:"Healthcare"},tax_basic:{name:"Taxation"},tax_second:{name:"Advanced Taxation"},econ_sub:{name:"Subsidies"},cul_rel:{name:"Culture"},cul_theo:{name:"State Narrative"},crime_theo:{name:"Persecution"}},Oe={eat_cake:{key:"eat_cake",group:"Welfare",name:"Let Them Eat Cake",idealPro:["trad","ego"],axis:"wel_food",description:"Hungry Subjects must go without any relief.",hint:"No state solution for hunger"},food_bank:{key:"food_bank",group:"Welfare",name:"Food Bank",idealPro:["prog","ego"],axis:"wel_food",description:"Hungry Subjects are provided food purchased by the government."},food_stamps:{key:"food_stamps",group:"Welfare",name:"Food Stamps",idealPro:["trad","state"],axis:"wel_food",description:"Hungry Subjects are provided money by the government to purchase food."},univ_rations:{key:"univ_rations",group:"Welfare",name:"Universal Rations",idealPro:["prog","state"],axis:"wel_food",description:"All Subjects are provided small amounts of food from the government."},outside:{key:"outside",group:"Welfare",name:"Sleep Outside",idealPro:["trad","ego"],axis:"wel_house",description:"Homeless Subjects must sleep in the cold."},homeless_shelters:{key:"homeless_shelters",group:"Welfare",name:"Homeless Shelters",idealPro:["prog","ego"],axis:"wel_house",description:"Homeless Subjects are provided shelter purchased by the government."},housing_subsidy:{key:"housing_subsidy",group:"Welfare",name:"Housing Subsidy",idealPro:["trad","state"],axis:"wel_house",description:"Homeless Subjects are provided money by the government to purchase shelter."},state_apartments:{key:"state_apartments",group:"Welfare",name:"State Apartments",idealPro:["prog","state"],axis:"wel_house"},stay_healthy:{key:"stay_healthy",group:"Welfare",name:"Stay Healthy",idealPro:["trad","ego"],axis:"wel_health",description:"Sick Subjects must pay for their own medical care."},clinics:{key:"clinics",group:"Welfare",name:"Charity Clinics",idealPro:["prog","ego"],axis:"wel_health",description:"Sick Subjects are provided medicine purchased by the government."},medical_aid:{key:"medical_aid",group:"Welfare",name:"Medical Aid",idealPro:["trad","state"],axis:"wel_health",description:"Sick Subjects are provided money by the government to pay for medical care."},univ_health:{key:"univ_health",group:"Welfare",name:"Universal Healthcare",idealPro:["prog","state"],axis:"wel_health",description:"All Subjects are provided medical care by the government."},hands_off:{key:"hands_off",group:"Economics",name:"Laissez-faire",idealPro:["ego","trad"],axis:"econ_sub",description:"No industries receive subsidies."},grain_sub:{key:"grain_sub",group:"Economics",name:"Grain Subsidy",idealPro:["state"],axis:"econ_sub",description:"Farmers are provided money."},arts:{key:"arts",group:"Economics",name:"Arts Patronage",idealPro:["prog","ego"],axis:"econ_sub"},theocracy:{key:"theocracy",group:"Crime",name:"Illegal Narratives",idealPro:["trad","state"],axis:"crime_theo",description:"It is illegal for subjects to speak about other universal narratives."},secularism:{key:"secularism",group:"Culture",name:"Secularism",idealPro:["ego"],axis:"cul_theo",description:"The government does not endorse a particular universal narrative."},atheism:{key:"atheism",group:"Culture",name:"State Nihilism",axis:"cul_theo"},mythology:{key:"mythology",group:"Culture",name:"State Mythology \ud83d\udc32",idealPro:["trad"],axis:"cul_theo"},futurism:{key:"futurism",group:"Culture",name:"State Futurism \ud83d\ude80",idealPro:["prog"],axis:"cul_theo"},drama:{key:"drama",group:"Culture",name:"State Drama \ud83c\udfb5",idealPro:["state"],axis:"cul_theo"},poll_tax:{key:"poll_tax",group:"Taxation",name:"Poll Tax",idealPro:["trad","state"],axis:"tax_basic",description:"Subjects must pay a flat tax every month."},sales_tax:{key:"sales_tax",group:"Taxation",name:"Sales Tax",idealPro:["ego"],axis:"tax_basic",description:"Subjects must pay a percentage tax for every transaction."},wealth_tax:{key:"wealth_tax",group:"Taxation",name:"Wealth Tax",idealPro:["prog","state"],axis:"tax_basic",description:"Rich subjects must pay a percentage tax on their excess cash."},vice_tax:{key:"vice_tax",group:"Taxation",name:"Vice Tax",idealPro:["trad"],axis:"tax_second",description:"Entertainment goods have a flat tax."},prop_tax:{key:"prop_tax",group:"Taxation",name:"Property Tax",idealPro:["prog"],axis:"tax_second",description:"Subjects must pay a tax on housing."},death_tax:{key:"death_tax",group:"Taxation",name:"Death Tax",idealPro:["prog"],axis:"tax_second",description:"Dead subjects pay a portion of their cash to the government."}},_e=function(){function e(){Object(c.a)(this,e),this.lawTree={}}return Object(u.a)(e,[{key:"getLawsByGroup",value:function(){return this.laws.reduce((function(e,t){return e[t.group].push(t),e}),{Taxation:[],Welfare:[],Economics:[],Crime:[],Culture:[]})}},{key:"laws",get:function(){return Object.values(this.lawTree)},set:function(e){var t=this;e.forEach((function(e){t.lawTree[e.axis]=e}))}}]),e}();function Be(e,t){var a=[];return e.energy&&a.push(t+e.energy+" Energy"),e.bots&&a.push(t+e.bots+" Bots"),e.psi&&a.push(t+e.psi+" Psi"),a.join(" ")}var Pe={cost:{emptyHex:{build:{house:{energy:1,bots:3},farm:{energy:1,bots:3},theater:{energy:1,bots:4},hospital:{energy:1,bots:4},church:{energy:1,bots:4},courthouse:{energy:999,bots:999},park:{energy:1,bots:4},nature:{energy:1,bots:4}}},hex:{beam:{energy:3},upgrade:{energy:1,bots:4}},bean:(ge={scan:{energy:1}},Object(p.a)(ge,"brainwash_ideal",{psi:4}),Object(p.a)(ge,"brainimplant_secondary",{psi:3}),Object(p.a)(ge,"brainwash_secondary",{psi:2}),Object(p.a)(ge,"abduct",{bots:3,psi:1}),Object(p.a)(ge,"gift",{}),Object(p.a)(ge,"empower",{}),Object(p.a)(ge,"vaporize",{energy:2,bots:4}),Object(p.a)(ge,"siphon",{}),ge)},bean_life:{vital_thresh:{food:{sufficient:1,abundant:3},shelter:{sufficient:1,abundant:3},medicine:{sufficient:1,abundant:3},fun:{sufficient:1,abundant:3}}},report_card_progression:[]},Me={found_utopia:{key:"found_utopia",text:"Found your Utopia",check:function(e){return"Goodplace"!=e.party.name}},build_house_n_farm:{key:"build_house_n_farm",text:"Build a house and farm",check:function(e){return e.cities[0].byType.house.all.length>0&&e.cities[0].byType.farm.all.length>0},reward:{energy:3,bots:3}},beam_3:{key:"beam_3",text:"Beam in 3 new beings",check:function(e){return e.beans.filter((function(e){return!e.bornInPetri})).length>=3+it}},scan:{key:"scan",text:"Scan a Subject",check:function(e){return Object.keys(e.alien.scanned_bean).length>0}},set_policy:{key:"set_policy",text:"Set a Gov Policy",check:function(e){return!1}},brainwash:{key:"brainwash",text:"Brainwash a Subject",check:function(e){return!1}},"c+_grade":{key:"c+_grade",text:"Receive a C+ Grade",check:function(e){return!1}}},De={GradeWorld:function(e){return{Happiness:Ie(e.beans,(function(e){return e.lastHappiness>-.2})),Prosperity:Ie(e.beans,(function(e){return"hungry"!=e.food})),Stability:Ie(e.beans,(function(e){return"sane"==e.sanity})),Dogma:Te(e.alien.speechcrimes[e.date.year]||0,10,10)}},RubricDescription:{Happiness:"Subjects are at least 20% happy",Prosperity:"Subjects are not hungry",Stability:"Subjects are all sane",Dogma:"Up to 10 Speechcrimes"}};function Te(e,t,a){return Fe(1-Math.min(1,Math.max(0,e-t)/a))}function Ie(e,t){return e.length<1?"F":Fe(e.filter(t).length/e.length)}function Fe(e){return e<.58?"F":e<.68?"D":e<.78?"C":e<.88?"B":"A"}var Ae={A:5,B:4,C:3,D:2,F:1};var He={halve_sanity:{tech:"halve_sanity",name:"Surgical Psychops",techPoints:30,description:"Brainwashing causes -1 \ud83e\udde0 sanity damage"},fast_resources:{tech:"fast_resources",name:"0 Dimensional Supersiphons",techPoints:30,description:"Faster \u26a1\ufe0f\ud83e\udde0\ud83e\udd16 accumulation"},trauma_nanobots:{tech:"trauma_nanobots",name:"Trauma Nanobots",techPoints:30,description:"Spend \ud83e\udd16 to stop Subject from dying"},fast_leadership:{tech:"fast_leadership",name:"Advanced Marketing",techPoints:30,description:"Faster \ud83d\uddf3\ufe0f Leadership accumulation"}},Le=function(){function e(){Object(c.a)(this,e),this.scanned_bean={},this.speechcrimes={},this.abductedBeans=[],this.energy={amount:29,income:2/30,change:new f},this.psi={amount:10,income:2/30,change:new f},this.bots={amount:10,income:2/30,change:new f},this.next_grade={year:1,season:3,day:1,hour:0},this.difficulty=Pe,this.goals=["found_utopia","build_house_n_farm","beam_3","scan","brainwash","set_policy","c+_grade"],this.goalProgress={},this.pastReportCards=[],this.workingReportCard={Happiness:"D",Prosperity:"D",Stability:"D",Dogma:"D"},this.techProgress={},this.currentlyResearchingTech=void 0}return Object(u.a)(e,[{key:"canAfford",value:function(e){return(void 0==e.bots||this.bots.amount>=e.bots)&&(void 0==e.energy||this.energy.amount>=e.energy)&&(void 0==e.psi||this.psi.amount>=e.psi)}},{key:"hasResearched",value:function(e){return null!=this.techProgress[e]&&this.techProgress[e].researchPoints>=He[e].techPoints}},{key:"purchase",value:function(e){e.bots&&(this.bots.amount-=e.bots,this.bots.change.publish({change:-e.bots})),e.energy&&(this.energy.amount-=e.energy,this.energy.change.publish({change:-e.energy})),e.psi&&(this.psi.amount-=e.psi,this.psi.change.publish({change:-e.psi}))}},{key:"tryPurchase",value:function(e){return!!this.canAfford(e)&&(this.purchase(e),!0)}},{key:"reward",value:function(e){e.bots&&(this.bots.amount+=e.bots,this.bots.change.publish({change:e.bots})),e.energy&&(this.energy.amount+=e.energy,this.energy.change.publish({change:e.energy})),e.psi&&(this.psi.amount+=e.psi,this.psi.change.publish({change:e.psi}))}},{key:"checkGoals",value:function(e){for(var t=0;t<this.goals.length;t++){var a=this.goals[t];if(null==this.goalProgress[a]&&(this.goalProgress[a]={done:!1,step:0}),!this.goalProgress[a].done){var n=Me[a].check(e),i=Me[a].reward;this.goalProgress[a].done=n,n&&null!=i&&this.reward(i)}}}},{key:"checkReportCard",value:function(e){this.workingReportCard=De.GradeWorld(e)}}]),e}();function Re(e){for(var t=e.length;t>0;){var a=Math.floor(Math.random()*t),n=e[--t];e[t]=e[a],e[a]=n}return e}var ze,qe=function(){function e(){var t=this;Object(c.a)(this,e),this.bus=new y,this.economy=new je(this.bus),this.cities=[],this.law=new _e,this.institutions=[],this.party=new Ce,this.date={year:1,season:n.Spring,day:1,hour:1},this.alien=new Le,this.onChat=function(e,a){t.party&&a.preachBelief&&ve(a.preachBelief,t.party.ideals,t.party.community)&&(t.publishEvent({icon:"\ud83d\udea8",trigger:"speechcrime",message:"Speechcrime! ".concat(e.name," is talking about ").concat(be[a.preachBelief].noun),beanKey:e.key}),null==t.alien.speechcrimes[t.date.year]?t.alien.speechcrimes[t.date.year]=1:t.alien.speechcrimes[t.date.year]++)},this.onBeanDie=function(e){var a=t.cities.find((function(t){return t.key===e.cityKey}));if(a){var n=a.historicalBeans.find((function(t){return t.key===e.beanKey}));n&&(a.onCitizenDie(n),t.economy.onBeanDie(n))}},this.bus.death.subscribe(this.onBeanDie)}return Object(u.a)(e,[{key:"beans",get:function(){return this.cities.reduce((function(e,t){return e.concat(t.beans)}),[])}},{key:"historicalBeans",get:function(){return this.cities.reduce((function(e,t){return e.concat(t.historicalBeans)}),[])}},{key:"organizations",get:function(){return this.institutions.reduce((function(e,t){return e.concat(t.organizations)}),[])}}]),Object(u.a)(e,[{key:"calculateComputedState",value:function(){var e=this;this.cities.forEach((function(t){t.calculate(e.economy,e.law),t.beans.forEach((function(a){return a.calculateBeliefs(e.economy,t,e.law,e.party)}))}))}},{key:"simulate_world",value:function(){var e=this;if(this.date.hour++,this.date.hour>i.Evening&&(this.date.hour=0,this.date.day++),this.date.day>30&&(this.date.day=1,this.date.season++),this.date.season>3&&(this.date.year++,this.inflate(),this.resetYearlyCounters(),this.date.season=0),this.alien.bots.amount+=this.alien.bots.income,this.alien.energy.amount+=this.alien.energy.income,this.alien.psi.amount+=this.alien.psi.income,this.alien.hasResearched("fast_resources")&&(this.alien.bots.amount+=.5*this.alien.bots.income,this.alien.energy.amount+=.5*this.alien.energy.income,this.alien.psi.amount+=.5*this.alien.psi.income),this.alien.currentlyResearchingTech){var t=this.alien.currentlyResearchingTech;null==this.alien.techProgress[t]&&(this.alien.techProgress[t]={researchPoints:0});var a=He[t].techPoints,n=this.alien.techProgress[t].researchPoints;n<a&&(this.alien.techProgress[t].researchPoints+=this.alien.abductedBeans.length),n>=a&&(this.alien.currentlyResearchingTech=void 0)}this.economy.resetSeasonalDemand(),this.organizations.forEach((function(t){return t.work(e.law,e.economy)})),Re(this.beans).forEach((function(t){t.age(e.economy);var a=t.maybeBaby(e.economy);a&&e.publishEvent(a),"jobless"===t.job&&t.tryFindRandomJob(e.law)})),this.cities.forEach((function(t){return t.getTaxesAndDonations(e.party,e.economy)})),this.calculateComputedState(),this.alien.checkGoals(this),this.alien.checkReportCard(this)}},{key:"simulate_beans",value:function(e){var t=this;this.beans.forEach((function(a){!function(e,t,a,n){var i,r=e.state.act(e,t,a);e.onAct&&e.onAct.publish(t),r!=e.state&&(!function(e,t){e.state.exit(e),e.state=t,e.state.enter(e)}(e,r),"chat"===r.data.act&&"speaker"===(null===(i=r.data.chat)||void 0===i?void 0:i.participation)&&n.onChat(e,r.data.chat))}(a,e,t.alien.difficulty,t)}))}},{key:"publishEvent",value:function(e){this.bus[e.trigger].publish(e)}},{key:"inflate",value:function(){var e=(this.beans.reduce((function(e,t){return e+t.cash}),0)+this.organizations.reduce((function(e,t){return e+t.cash}),0))/100,t=Math.round(1*e);if(t>0){var a=this.beans.reduce((function(e,t){return t.cash>e.max&&(e.winner=t,e.max=t.cash),e}),{max:0});a.winner&&(a.winner.cash+=t)}}},{key:"resetYearlyCounters",value:function(){this.cities.forEach((function(e){e.yearsPartyDonations=0}))}},{key:"addCharity",value:function(e,t,a){var n=new xe;n.name=t,n.good=e,n.seasonalBudget=a,this.party.organizations.push(n)}}]),e}(),Ge={state:"\ud83d\udd4a\ufe0f",ego:"\ud83e\udd85",prog:"\u2696\ufe0f",trad:"\ud83d\udc51",circle:"\ud83e\udd0e",square:"\ud83d\udc9b",triangle:"\ud83e\udde1",rocket:"\ud83d\ude80",music:"\ud83c\udfb5",dragon:"\ud83d\udc32",noFaith:"\u26ab\ufe0f",hungry:"\ud83c\udf7d\ufe0f",sated:"\ud83e\udd5c",stuffed:"\ud83e\udd69",podless:"\ud83c\udf28\ufe0f",crowded:"\ud83c\udfd8\ufe0f",homeowner:"\ud83c\udfe1",sick:"\ud83e\udd22",bruised:"\ud83e\ude79",fresh:"\ud83d\udcaa",mad:"\ud83e\udd2a",confused:"\ud83e\udd24",sane:"\ud83e\udde0"};function We(e){return 100*Math.min(1,Math.max(-1,e.reduce((function(e,t){return e+=t.mod}),0)))}!function(e){e[e.Deficient=-.25]="Deficient",e[e.Sufficient=0]="Sufficient",e[e.Abundant=.15]="Abundant"}(ze||(ze={}));var Ve={podless:{reason:"Homeless",mod:ze.Deficient},crowded:{reason:"Renting",mod:ze.Sufficient},homeowner:{reason:"Homeowner",mod:ze.Abundant},sick:{reason:"Sick",mod:ze.Deficient},bruised:{reason:"Bruised",mod:ze.Sufficient},fresh:{reason:"Healthy",mod:ze.Abundant},hungry:{reason:"Hungry",mod:ze.Deficient},sated:{reason:"Sated",mod:ze.Sufficient},stuffed:{reason:"Stuffed",mod:ze.Abundant}},Ke={food:{sufficient:1,abundant:3},shelter:{sufficient:1,abundant:7},medicine:{sufficient:1,abundant:3},fun:{sufficient:1,abundant:3}};function Ue(e){switch(e){case"builder":return"shelter";case"doc":return"medicine";case"entertainer":return"fun";default:case"farmer":return"food"}}var Je={food:"\ud83e\udd6a",shelter:"",medicine:"\ud83d\udc8a",fun:"\ud83d\udc4f"};function $e(e){return Ye(e,"ego",(function(e){return e.ideals}))}function Qe(e){return Ye(e,"state",(function(e){return e.community}))}function Ye(e,t,a){var n={avg:0,winner:t},i=e.reduce((function(e,t){var n=a(t);return null==e[n]?e[n]=1:e[n]++,e}),{});return Object.keys(i).forEach((function(e){i[e]>n.avg&&(n.avg=i[e],n.winner=e)})),n.avg/=e.length,n}var Ze=function e(t,a,n){Object(c.a)(this,e),this.key=t,this.point=a,this.action=n},Xe=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).name="",e.url="",e.type="",e.key=0,e.historicalBeans=[],e.ufos=[],e.houses=[],e.partyHQ=void 0,e.yearsPartyDonations=0,e.majorityEthnicity="circle",e.costOfLiving=1,e.economy=void 0,e.law=void 0,e.environment=void 0,e.eventBus=void 0,e}return Object(u.a)(a,[{key:"tryGetJob",value:function(e,t){if("jobless"===t)return!1;for(var a=G[t],n=this.byType[a].all,i=0;i<n.length;i++){var r=n[i],s=r.openSlots();if(s.length>0){var o=s.shift();return r.job_slots[o]=e.key,!0}}return!1}},{key:"unsetJob",value:function(e){if("jobless"!==e.job)for(var t=G[e.job],a=this.byType[t].all,n=0;n<a.length;n++){if(a[n].tryFreeBean(e.key))break}}},{key:"getRandomCitizen",value:function(){var e=Re(this.beans);return e.length>0?e[0]:null}},{key:"onCitizenDie",value:function(e){if(e.cash>0){var t=this.getRandomCitizen();t&&(t.cash=t.cash+e.cash,e.cash=0)}this.unsetJob(e)}},{key:"breedBean",value:function(e){var t,a,n,i,r=Math.random()<=.5?e.job:tt(["doc","farmer","builder","jobless"]),s=st(this,this.historicalBeans.length,void 0,r);s.ethnicity=e.ethnicity,s.name=s.name.split(" ")[0]+" "+e.name.split(" ")[1],s.cash=e.cash/2,e.cash/=2,s.bornInPetri=!0,this.environment&&(s.dob={year:null===(t=this.environment)||void 0===t?void 0:t.year,season:null===(a=this.environment)||void 0===a?void 0:a.season,day:null===(n=this.environment)||void 0===n?void 0:n.day,hour:null===(i=this.environment)||void 0===i?void 0:i.hour}),this.historicalBeans.push(s)}},{key:"getTaxesAndDonations",value:function(e,t){}},{key:"calculate",value:function(e,t){this.costOfLiving=e.getCostOfLiving();var a=this.beans.reduce((function(e,t){switch(t.ethnicity){case"circle":e.circle++;break;case"square":e.square++;break;case"triangle":e.triangle++}return e}),{circle:0,square:0,triangle:0});a.circle>a.square&&a.circle>a.triangle?this.majorityEthnicity="circle":a.square>a.circle&&a.square>a.triangle?this.majorityEthnicity="square":this.majorityEthnicity="triangle"}},{key:"getNearestNeighbors",value:function(e){var t=this;return this.beans.filter((function(a){if(a.key==e.key)return!1;var n=t.movers.bean[a.key],i=t.movers.bean[e.key],r=Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2);return r<1600&&r>600}))}},{key:"beans",get:function(){return this.historicalBeans.filter((function(e){return e.alive}))},set:function(e){throw"can't set city beans"}}]),a}(W);function et(e,t){var a=new Uint32Array(1);window.crypto.getRandomValues(a);var n=a[0]/4294967296;return e=Math.ceil(e),t=Math.floor(t),Math.floor(n*(t-e+1))+e}function tt(e){return 1==e.length?e[0]:e[et(0,e.length-1)]}Math.PI;function at(e,t,a){var n=new H;n.type=t,n.key=e.numberOf(t),e.addBuilding(a,n)}function nt(){var e=new qe;e.law.laws=[{group:"Welfare",key:"eat_cake",axis:"wel_food"},{group:"Welfare",key:"outside",axis:"wel_house"},{group:"Welfare",key:"stay_healthy",axis:"wel_health"},{group:"Culture",key:"secularism",axis:"cul_rel"}],e.party=new Ce,e.institutions.push(e.party);for(var t=0;t<1;t++){e.cities.push(rt(e.cities.length)),e.cities[t].eventBus=e.bus,e.cities[t].environment=e.date,e.cities[t].economy=e.economy,e.cities[t].law=e.law;for(var a=0;a<e.cities[t].beans.length;a++){var n=e.cities[t].beans[a];n.work(e.law,e.economy),"farmer"==n.job&&n.work(e.law,e.economy)}}return e.economy.totalSeasonalDemand.food=e.beans.length,e.economy.totalSeasonalDemand.shelter=e.beans.length,e.economy.totalSeasonalDemand.medicine=e.beans.length,e}var it=0;function rt(e){var t=new Xe;t.key=e,t.name=tt(["New ","Old ","Fort ","St. ","Mount ","Grand ","","","","","","","","","",""]),t.name+=tt(["Spring","Timber","Over","West","East","North","South","Rock","Sand","Clay","Iron","Ore","Coal","Liver","Hawk","Red","Yellow","Gold","Blue","Black","White","Sunny","Reed","Ox","Mill","Fern","Down","Bel","Bald","Ash"]),t.name+=tt(["water "," Springs","ville","dale","lane","peak","coast","beach","port","market","ton","brook"," Creek","land","burgh","bridge","ford","bury","chester","son","vale"," Valley","hill","more","wood"," Oaks"," Cove","mouth","way","crest"]),at(t,"courthouse",t.hexes[0]),at(t,"nature",t.hexes[et(15,20)]),at(t,"nature",t.hexes[et(21,25)]),at(t,"nature",t.hexes[et(26,60)]);for(var a=it;t.historicalBeans.length<a;)t.historicalBeans.push(st(t,t.historicalBeans.length));return t}function st(e,t,a,n){var i=new ke;i.key=t,i.cityKey=e.key,i.city=e,i.name=tt(["Joe","Frank","Jill","Jose","Johnny","Isabelle","Carmen","Ace","Carl","Zander","Jean","Anne","Leslie","Ben","Ron","Ellen","Dallas","Kane","Ash","Jim","James","Leonard","Nyota","Christine","Scotty","Tasha","Geordi","Beverly","Deanna","Wesley","Majel","Malcolm","River","Luke","Dana","Walter","Rick","Rose","Donna","Jack","Amy","Rory","Martha","Clara","Arnold","Dave","Holly","Kara","Gaius","William","Lee","Laura","Saul","Max","Edison","Theora","Bryce","Murray","Ned","Daniel","Samantha","Logan","Francis","Jessica"])+" ",i.name+=tt(["Ripley","Bishop","Hicks","Vasquez","Hudson","Rico","Flores","Ibanez","Levy","Jenkins","Barlow","Zim","Rasczak","Kirk","McCoy","Sulu","Uhura","Chekov","Chapel","Rand","Riker","Crusher","Barret","O'Brien","Reynolds","Tam","Scully","Mulder","Skinner","Connor","Thrace","Baltar","Smith","Adama","Roslin","Tigh","Song","Oswald","Deckard","Tyler","Harkness","Jones","Noble","Pond","Williams","Rimmer","Lister","Head","Carter","Lynch","McKenzie","Grossberg","O'Neil","Jackson","Carter"]),i.community=tt(["state","ego"]),i.ideals=tt(["prog","trad"]),i.faith=tt(["rocket","music","dragon","noFaith"]);for(var r=Math.ceil(2*Math.random()),s=0;s<r;s++)i.beliefs.push(tt(Ee));if(null==n)switch(t){case 0:n="farmer";break;case 1:n="builder";break;case 2:n="doc";break;default:n=tt(["farmer","builder","doc","entertainer"])}return i.trySetJob(n),i.cash=function(e){var t=4+Math.floor(3*Math.random());switch(e){case"doc":return t+2;default:return t}}(i.job),i.discrete_food=3,e.movers.bean[i.key]=D(e.hex_size,e.petriOrigin,a||e.byType.house.coordByID[tt(e.byType.house.all).key]),i}var ot=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={show:!1},n}return Object(u.a)(a,[{key:"getButton",value:function(){var e=this;return this.props.hideCloseButton?null:s.a.createElement("button",{type:"button",className:"done",onClick:function(){return e.props.onClick()}},this.props.closeButtonText||"Done")}},{key:"render",value:function(){return this.props.show?s.a.createElement("div",{className:"modal"},this.props.children,this.getButton()):null}}]),a}(s.a.Component),lt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"header",value:function(){return this.props.children?s.a.createElement("b",null,this.props.children):null}},{key:"render",value:function(){var e=this,t=this.props.beans.filter((function(t){return e.props.need(t)==e.props.dire})).length,a={width:Math.floor(t/this.props.beans.length*100)+"%"},n=this.props.beans.filter((function(t){return e.props.need(t)==e.props.abundant})).length,i={width:Math.floor(n/this.props.beans.length*100)+"%"};return s.a.createElement("div",{className:this.props.className},this.header(),s.a.createElement("div",{className:"bar"},s.a.createElement("div",{className:"bar-inner dire",style:a},t>0?"".concat(t," ").concat(Kt[this.props.dire]):""),s.a.createElement("div",{className:"bar-inner abundant",style:i},n>0?n:"")))}}]),a}(s.a.Component),ct=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=null;this.props.city&&(t=s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("b",null,this.props.city.name)," ",fe[this.props.utopia.community].icon," ",fe[this.props.utopia.ideals].icon,s.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearCity()}},"\u274c")),s.a.createElement("div",null," ",fe[this.props.utopia.community].adj," ",fe[this.props.utopia.ideals].adj," Utopia")));var a,n=this.props.beans.reduce((function(e,t){return e+t.lastHappiness}),0)/(this.props.beans.length||1),i=this.props.beans.reduce((function(e,t){return e+t.cash}),0)/(this.props.beans.length||1),r=this.props.beans.reduce((function(e,t){return e+t.lastPartySentiment}),0)/(this.props.beans.length||1);return s.a.createElement("div",null,t,s.a.createElement("div",{className:"header"},s.a.createElement("b",null,"Demographics")),s.a.createElement("div",null,s.a.createElement("b",null,"Population"),"\xa0",s.a.createElement("span",null,this.props.beans.length)),s.a.createElement(ut,{report:(a=this.props.beans,Ye(a,"circle",(function(e){return e.ethnicity})))},"Ethnicity"),s.a.createElement("div",{className:"header"},s.a.createElement("b",null,"Situation")),s.a.createElement(lt,{beans:this.props.beans,need:function(e){return e.food},dire:"hungry",abundant:"stuffed"},"Food Security"),s.a.createElement(lt,{beans:this.props.beans,need:function(e){return e.shelter},dire:"podless",abundant:"homeowner"},"Housing"),s.a.createElement(lt,{beans:this.props.beans,need:function(e){return e.health},dire:"sick",abundant:"fresh"},"Healthcare"),s.a.createElement("b",null,"Avg. Money")," $",i.toFixed(2)," \xa0",s.a.createElement("b",null,"Avg. Happiness")," ",Math.round(n),"%",s.a.createElement("div",{className:"header"},s.a.createElement("b",null,"Electorate")),s.a.createElement(ut,{report:Qe(this.props.beans)},"Community"),s.a.createElement(ut,{report:$e(this.props.beans)},"Ideals"),s.a.createElement("div",null,s.a.createElement("b",null,"Approval"),"\xa0",s.a.createElement("span",null,r.toFixed(0),"%")))}}]),a}(s.a.Component),ut=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e="Leaning";this.props.report.avg>=.51&&(e="Major"),this.props.report.avg>=.8&&(e="Extreme");var t=Math.floor(100*this.props.report.avg),a={width:t+"%"};return s.a.createElement("div",null,s.a.createElement("b",null,this.props.children),"\xa0\xa0",s.a.createElement("span",null,e," ",Kt[this.props.report.winner]),s.a.createElement("div",{className:"bar"},s.a.createElement("div",{className:"bar-inner",style:a},t,"%")))}}]),a}(s.a.Component);var ht=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).animate=function(e){var t;n.setState({point:n.props.bean.city?n.props.bean.city.movers.bean[n.props.bean.key]:{x:0,y:0},spin:"work"==n.props.bean.state.data.act,face:n.props.bean.getFace(),good:(t=n.props.bean,"buy"==t.state.data.act&&"shelter"!=t.state.data.good?Je[n.props.bean.state.data.good||"food"]:void 0),speech:n.props.bean.getSpeech()})},n.delaySeedSec=void 0,n.delaySeedSec=60*Math.random()+n.props.bean.key,n.state={paused:!1,point:e.static?M:e.bean.city?e.bean.city.movers.bean[e.bean.key]:{x:0,y:0},spin:!1,face:e.bean.getFace()},e.bean.onAct.subscribe(n.animate),n}return Object(u.a)(a,[{key:"getPurchase",value:function(){if(this.state.good)return s.a.createElement("span",{className:"purchase"},s.a.createElement("span",{className:"money"},"\ud83d\udcb8"),s.a.createElement("span",{className:"purchase-good"},this.state.good))}},{key:"getSpeech",value:function(){if(this.state.speech)return s.a.createElement("span",{className:"speech"},s.a.createElement("span",{className:""},this.state.speech))}},{key:"render",value:function(){var e=this,t=this.props.bean.job+" "+this.props.bean.ethnicity;t+=this.state.paused||!this.props.bean.alive?" paused":"",this.props.sitStill||(t+=" bean-walker",this.state.spin&&(t+=" spin"),this.props.selected&&(t+=" selected"),"travel"!=this.props.bean.state.data.act&&(t+=" paused"));var a=Object(v.a)(Object(v.a)({},F(this.state.point)),{},{animationDelay:"-"+this.delaySeedSec+"s"});a.animationDelay="";return s.a.createElement("span",{className:t+" bean interactable",style:a,title:"",onClick:function(t){t.stopPropagation(),e.props.onClick()}},this.state.face," ",this.getPurchase()," ",this.getSpeech())}}]),a}(s.a.Component),dt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={showBeam:!1},setTimeout((function(){n.setState({showBeam:!0}),setTimeout((function(){n.setState({showBeam:!1})}),1800)}),1800),n}return Object(u.a)(a,[{key:"render",value:function(){var e=Object(v.a)({},F(D(this.props.city.hex_size,this.props.city.petriOrigin,this.props.ufo.point)));return s.a.createElement("span",{style:e,className:"ufo"},"\ud83d\udef8",this.state.showBeam?s.a.createElement("span",{className:"beam"}):null)}}]),a}(s.a.Component),pt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).animations=[],n.finishedAnimationCount=0;for(var i=[],r=0;r<n.props.particleCount;r++)i.push(s.a.createRef());return n.state={active:!0,parts:i},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.animations=this.state.parts.map((function(t){if(t.current){var a=Math.floor(400*Math.random())-200,n=Math.floor(400*Math.random())-400;return t.current.animate([{transform:"translate(0px, 0px)",opacity:1},{transform:"translate(".concat(a,"px, ").concat(n,"px)"),opacity:0}],{duration:1500+1e3*Math.random(),easing:"ease-in-out",delay:e.props.delay+100*Math.random()})}return null})),this.animations.forEach((function(t){t&&(t.onfinish=function(){e.finishedAnimationCount++,e.finishedAnimationCount>=e.props.particleCount&&e.setState({active:!1,parts:[]})})}))}},{key:"render",value:function(){return s.a.createElement("div",{className:(this.props.className||"")+" particle-parent"},this.state.active?this.state.parts.map((function(e,t){return s.a.createElement("div",{key:t,className:"particle",ref:e})})):null)}}]),a}(s.a.Component),mt=(s.a.Component,a(19),{"death-exposure":[{start:0,name:"death-exposure",faceOV:"\ud83e\udd76",beanClasses:"drop-tool turn-blue",particles:[]},{start:2e3,name:"death-exposure",faceOV:"\ud83d\udc80",beanClasses:"drop-tool turn-blue",particles:[]}],"death-vaporization":[{start:0,name:"death-vaporization",beanClasses:"",particles:[]},{start:1e3,name:"death-vaporization",beanClasses:"drop-tool",particles:[]},{start:2e3,name:"death-vaporization",beanClasses:"drop-tool",faceOV:" ",particles:[{className:"head",delay:0}]},{start:3e3,name:"death-vaporization",beanClasses:"drop-tool hide-body",faceOV:" ",particles:[{className:"head",delay:0},{className:"body",delay:0}]}],"death-sickness":[{start:0,name:"death-sickness",faceOV:"\ud83e\udd22",beanClasses:"",particles:[]},{start:1e3,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83e\udd2e",particles:[{className:"head",delay:0}]},{start:1400,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83e\udd2e",particles:[{className:"head",delay:0},{className:"head",delay:0}]},{start:2e3,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83d\udc80",particles:[{className:"head",delay:0}]}],"death-starvation":[{start:0,name:"death-starvation",faceOV:"\ud83e\udd7a",beanClasses:"",particles:[]},{start:500,name:"death-starvation",faceOV:"\ud83d\ude16",beanClasses:"body-shrink",particles:[]},{start:1e3,name:"death-starvation",faceOV:"\ud83d\ude2b",beanClasses:"body-shrink drop-tool",particles:[]},{start:3e3,name:"death-starvation",faceOV:"\ud83d\udc80",beanClasses:"body-shrink drop-tool",particles:[]}]}),ft=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).lastTickMS=0,n.currentTime=0,n.tickHandle=0,n.tick=function(e){var t=e-n.lastTickMS;if(n.lastTickMS=e,t>0){n.currentTime+=t;var a="".concat(n.props.event.trigger,"-").concat(n.getSubtype(n.props.event.message));n.setState(mt[a].reduce((function(e,t){return n.currentTime>=t.start?t:e}),mt[a][0]))}n.tickHandle=window.requestAnimationFrame(n.tick)};var i="".concat(n.props.event.trigger,"-").concat(n.getSubtype(n.props.event.message));return n.state=mt[i][0],n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.requestAnimationFrame((function(t){e.lastTickMS=t,e.tickHandle=window.requestAnimationFrame(e.tick)}))}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.tickHandle)}},{key:"getSubtype",value:function(e){return e.includes("vaporiz")?"vaporization":e.includes("exposure")?"exposure":e.includes("sickness")?"sickness":"starvation"}},{key:"render",value:function(){var e,t,a=this;this.props.event.point&&(t=F(null===(e=this.props.event)||void 0===e?void 0:e.point));var n=[this.props.bean.job,this.props.bean.ethnicity,this.state.name,this.state.beanClasses].join(" ");return s.a.createElement("div",{className:"spotlight",style:t},s.a.createElement("div",{className:"bean-parent"},s.a.createElement("span",{className:n+" bean"},s.a.createElement("span",{className:"bean-face"},this.state.faceOV||this.props.bean.getFace())),this.state.particles.map((function(e,t){return s.a.createElement(pt,{key:t,className:a.state.name+" "+e.className,delay:e.delay,particleCount:30})}))),s.a.createElement("div",{className:"label"},this.props.event.message.replace("A subject",this.props.bean.name)),"death"===this.props.event.trigger?s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",disabled:!0},"Prevent Death",s.a.createElement("br",null),"-4 \ud83e\udd16")):null)}}]),a}(s.a.Component),yt=["farm","hospital","house","theater","courthouse","park","nature"],bt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).mtn_transforms=[],n.state={tile:null,city:null,activeTileID:null};for(var i=0;i<72;i++){var r=T({r:530,az:5*i*Math.PI/180});r.x+=550,r.y+=550,n.mtn_transforms.push(F(r))}return n}return Object(u.a)(a,[{key:"renderBuildings",value:function(e){var t=this;return this.props.city.byType[e].all.map((function(a,n){return s.a.createElement(J,{city:t.props.city,building:a,key:e+n})}))}},{key:"renderSpotlight",value:function(){var e=this;if(this.props.spotlightEvent){var t=this.props.city.historicalBeans.find((function(t){var a;return t.key===(null===(a=e.props.spotlightEvent)||void 0===a?void 0:a.beanKey)}));if(this.props.spotlightEvent.point&&t)return s.a.createElement(ft,{event:this.props.spotlightEvent,bean:t})}return null}},{key:"render",value:function(){var e=this,t=this.props.city.beans.map((function(t){return s.a.createElement(ht,{bean:t,key:t.key,selected:t.key===e.props.activeBeanID,onClick:function(){return e.props.onBeanClick(t)}})})),a=this.props.city.historicalBeans.filter((function(e){return!e.alive})).map((function(e,t){return s.a.createElement("span",{key:t,className:"dead",style:{left:10*t+"px"}},"\u26b0\ufe0f")})),n=this.props.city.ufos.map((function(t,a){return s.a.createElement(dt,{ufo:t,key:a,city:e.props.city})})),i=yt.reduce((function(t,a){return t.concat(e.renderBuildings(a))}),[]),r=this.props.city.hexes.map((function(t,a){var n=D(e.props.city.hex_size,e.props.city.petriOrigin,t);return s.a.createElement("div",{className:"hex",key:a,style:F(n),onClick:function(a){return e.props.onHexClick(t),a.stopPropagation(),!1}})})),o=this.mtn_transforms.map((function(e,t){return s.a.createElement("span",{key:t,style:e,className:"mtn"},"\u26f0\ufe0f")}));return s.a.createElement("div",{className:"tile",onClick:function(){return e.props.onClick()}},s.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-base"},s.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 1)"})),r,o,a,i,t,n,s.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-lid"},s.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 0.2)"})),this.renderSpotlight())}}]),a}(s.a.Component);function vt(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}var gt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={paused:!1},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.world.beans,t=vt(e.map((function(e){return e.discrete_food}))),a=vt(e.map((function(e){return e.discrete_health}))).toFixed(1),n=vt(e.map((function(e){return e.discrete_stamina}))).toFixed(1),i=e.reduce((function(e,t){return e+t.cash}),0),r=i/(e.length||1),o=vt(e.map((function(e){return e.cash}))),l=e.filter((function(e){return e.cash<1})).length,c=Math.max(r,o),u=e.filter((function(e){return e.cash>c})),h=u.length/(e.length||1)*100,d=u.reduce((function(e,t){return e+t.cash}),0)/i*100,p=e.reduce((function(e,t){return e[t.job]=(e[t.job]||0)+1,e}),{}),m=((p.jobless||0)/e.length*100).toFixed(1);function f(e,t){return e.supply+=t.quantity,e.price+=t.price,e.count++,e.avg=e.price/e.count,e}var y=this.props.world.economy.market.listings.food.reduce(f,{supply:0,price:0,avg:0,count:0}),b=this.props.world.economy.market.listings.medicine.reduce(f,{supply:0,price:0,avg:0,count:0}),v=this.props.world.economy.market.listings.shelter.reduce(f,{supply:0,price:0,avg:0,count:0});return s.a.createElement("div",null,s.a.createElement("div",{className:"pad-4p"},s.a.createElement("h2",null,"State of the Utopia")),s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,s.a.createElement("strong",null,"\ud83c\udf5e Food Security"),s.a.createElement(lt,{beans:this.props.world.beans,need:function(e){return e.food},dire:"hungry",abundant:"stuffed",className:"big"}),s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Median ",t.toFixed(1)," \ud83c\udf5e"),s.a.createElement("td",{className:"text-center"},"Supply: ",y.supply," \ud83c\udf5e @ $",y.avg.toFixed(2)),s.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.food," \ud83c\udf5e"))))),s.a.createElement("div",null,s.a.createElement("strong",null,"\ud83e\ude7a Healthcare"),s.a.createElement(lt,{beans:this.props.world.beans,need:function(e){return e.health},dire:"sick",abundant:"fresh",className:"big"}),s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Median ",a," \ud83e\ude7a"),s.a.createElement("td",{className:"text-center"},"Supply: ",b.supply," \ud83e\ude7a @ $",b.avg.toFixed(2)),s.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.medicine," \ud83e\ude7a")))))),s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,s.a.createElement("strong",null,"\ud83c\udfe1 Housing")," ",s.a.createElement("br",null),s.a.createElement(lt,{beans:this.props.world.beans,need:function(e){return e.shelter},dire:"podless",abundant:"homeowner",className:"big"}),s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Median ",n," \ud83c\udfe1"),s.a.createElement("td",{className:"text-center"},"Supply: ",v.supply," \ud83c\udfe1 @ $",v.avg.toFixed(2)),s.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.shelter," \ud83c\udfe1")))))),s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,s.a.createElement("strong",null,"\ud83d\udcb0 Wealth")," ",s.a.createElement("br",null),l," penniless citizens \xa0 \xa0 Cost of Living: $",this.props.world.economy.getCostOfLiving().toFixed(2)," ",s.a.createElement("br",null),s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"Total $",i.toFixed(2)),s.a.createElement("td",{className:"text-center"},"Median: $",o.toFixed(2)),s.a.createElement("td",{className:"text-right"},"Avg: $",r.toFixed(2))))),"Top ",h.toFixed(1),"% of subjects own ",d.toFixed(1),"% of the wealth"),s.a.createElement("span",null,s.a.createElement("strong",null,"Unemployment")," ",m,"% (",p.jobless,")",s.a.createElement("br",null),s.a.createElement("ul",{className:"boxes"},s.a.createElement("li",null,p.farmer||0," farmers"),s.a.createElement("li",null,p.builder||0," builders"),s.a.createElement("li",null,p.doc||0," doctors"),s.a.createElement("li",null,p.entertainer||0," entertainers")))))}}]),a}(s.a.Component);var Et=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.events.map((function(t,a){var n="\ud83d\udea8"===t.icon,i="nojobslots"===t.trigger;return s.a.createElement("div",{key:a,className:n||i?"tall":""},s.a.createElement("span",{className:n?"police-siren":""},t.icon),"\xa0",function(e){return null!=e.beanKey&&("speechcrime"===e.trigger||"birth"===e.trigger)}(t)?s.a.createElement("a",{onClick:function(){return e.props.selectBean(t.beanKey)},href:"javascript:void(0)"},t.message):s.a.createElement("span",null,t.message))}));return 0===this.props.events.length&&(t=[s.a.createElement("div",{key:0},s.a.createElement("small",null,"No events yet"))]),s.a.createElement("div",{className:"events-panel"},s.a.createElement("div",null,s.a.createElement("b",null,"Events")),t)}}]),a}(s.a.Component),kt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t="card button";return this.props.thin&&(t+=" thin"),this.props.singleLine&&(t+=" single"),s.a.createElement("button",{className:t,title:this.props.title,onClick:function(){e.props.onClick&&e.props.onClick()},type:"button"},this.props.icon," ",this.props.name,null!=this.props.subtext?s.a.createElement("small",null,this.props.subtext):null)}}]),a}(s.a.Component);function wt(e,t,a){switch(t){case"trad":case"prog":case"ego":case"state":return s.a.createElement(kt,{icon:Ge[t],title:fe[t].description,name:"",subtext:Kt[t],thin:!0,singleLine:!0,onClick:a});case"fresh":case"sick":case"hungry":case"stuffed":case"podless":case"homeowner":case"circle":case"square":case"triangle":case"sane":case"confused":case"mad":return s.a.createElement(kt,{icon:Ge[t],title:Kt[t],name:"",subtext:Kt[t],thin:!0,singleLine:!0,onClick:a});case"noFaith":case"rocket":case"dragon":case"music":return s.a.createElement(kt,{icon:Ge[t],title:ye[t].description,name:"",subtext:Kt[t],thin:!0,singleLine:!0,onClick:a});default:return null}}a(20);var jt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).scan=function(){n.props.scan(n.props.bean)&&(n.setState({faceOverride:"\ud83e\udd28"}),n._resetFace())},n.vaporize=function(){n.props.vaporize(n.props.bean),n.setState({faceOverride:"\ud83d\udc80"}),n._resetFace()},n.support=function(){n.setState({faceOverride:"\ud83e\udd29"}),n._resetFace()},n.abduct=function(){n.props.abduct(n.props.bean),n.setState({faceOverride:"\ud83d\ude28"}),n._resetFace()},n.state={innerView:"feelings"},n}return Object(u.a)(a,[{key:"_resetFace",value:function(){var e=this;setTimeout((function(){e.setState({faceOverride:void 0})}),5e3)}},{key:"happyTable",value:function(e){return e.filter((function(e){return 0!=e.mod})).map((function(e,t){return s.a.createElement("tr",{key:t},s.a.createElement("td",{className:"small text-right"},e.reason),s.a.createElement("td",{className:"small"},Math.round(100*e.mod),"%"))}))}},{key:"renderInner",value:function(){if(!this.scanned)return s.a.createElement("div",{className:"width-100p text-center"},s.a.createElement("small",null,"Subject needs a Scan to reveal their thoughts"));switch(this.state.innerView){case"beliefs":return this.scanned?this.beliefTable(this.props.bean.beliefs):null;case"feelings":return s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,this.scanned?this.happyTable(this.props.bean.getHappinessModifiers(this.props.economy,this.props.city,this.props.law)):null));case"priorities":return s.a.createElement("table",{className:"width-100p"},s.a.createElement("tbody",null,de(this.props.bean,this.props.alien.difficulty).values.map((function(e){return s.a.createElement("tr",null,s.a.createElement("td",null,e.priority.toFixed(1)," ",function(e){switch(e.act){case"work":return e.good?"\ud83d\udcaa "+Je[e.good]:"\ud83d\udcaa";case"buy":return"shelter"==e.good?"\ud83d\ude34":e.good?"\ud83d\udcb8 "+Je[e.good]:"\ud83d\udcb8"}return""}(e.value)))}))))}}},{key:"beliefTable",value:function(e){var t=this;return e.map((function(e){var a=ve(e,t.props.party.ideals,t.props.party.community);return s.a.createElement("table",{className:"width-100p",key:e},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("th",{className:a?"divergent text-left":"text-left"},be[e].icon," ",be[e].adj),s.a.createElement("td",{className:"text-right"},(be[e].idealPro||[]).map((function(e){return s.a.createElement("span",null,"+",Ge[e])})),(be[e].idealCon||[]).map((function(e){return s.a.createElement("span",null,"-",Ge[e])})))),s.a.createElement("tr",null,s.a.createElement("td",{className:"small text-center",colSpan:2},be[e].description))))}))}},{key:"renderTraits",value:function(){if(this.scanned){var e=this.props.brainwash.bind(this);return s.a.createElement("div",null,s.a.createElement("div",{className:"card-parent"},wt(this.props.bean,this.props.bean.ethnicity,void 0),wt(this.props.bean,this.props.bean.faith,e)),s.a.createElement("div",{className:"card-parent"},wt(this.props.bean,this.props.bean.ideals,e),wt(this.props.bean,this.props.bean.community,e)),s.a.createElement("div",{className:"card-parent"},wt(this.props.bean,this.props.bean.food,void 0),wt(this.props.bean,this.props.bean.shelter,void 0),wt(this.props.bean,this.props.bean.health,void 0)))}return s.a.createElement("div",{className:"card-parent"},s.a.createElement(kt,{icon:"\ud83d\udef0\ufe0f",name:"Scan",subtext:"-Energy +Info",onClick:this.scan}))}},{key:"render",value:function(){var e=this,t=this.props.bean.job+" "+this.props.bean.ethnicity;this.props.bean.chanceToDonate(this.props.economy,!0);return s.a.createElement("div",{className:"vertical bean-panel"},s.a.createElement("div",{className:"bean-panel-header"},s.a.createElement("div",null,s.a.createElement("b",null,this.props.bean.name,"\xa0",s.a.createElement("small",null,"of ",this.props.city.name)),s.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearCity()}},"\u274c")),s.a.createElement("div",{className:"bean-view"},s.a.createElement("span",{className:t+" bean"},void 0===this.state.faceOverride?this.props.bean.getFace():this.state.faceOverride)),s.a.createElement("div",{className:"horizontal"},s.a.createElement("span",{className:"text-center"},"\ud83d\udcb0 $",this.props.bean.cash.toFixed(2)),s.a.createElement("span",{className:"text-center"},"\ud83d\ude42 ",Math.round(this.props.bean.lastHappiness),"%"),s.a.createElement("span",{className:"text-center"},"\ud83d\udc4d ",Math.round(this.props.bean.lastPartySentiment),"%")),this.renderTraits()),s.a.createElement("div",{className:"grow-1 pad-4"},s.a.createElement("div",{className:"cylinder blue-orange horizontal"},s.a.createElement("button",{type:"button",className:"priorities"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"priorities"})}},"\ud83d\udcaa Priorities"),s.a.createElement("button",{type:"button",className:"feelings"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"feelings"})}},"\ud83d\ude10 Feelings"),s.a.createElement("button",{type:"button",className:"beliefs"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"beliefs"})}},"\ud83d\ude07 Beliefs")),this.renderInner()),s.a.createElement("div",{className:"bean-action-card-parent"},s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.props.brainwash()},title:"Rewrite one of this being's beliefs"},"\ud83d\ude35 Brainwash",s.a.createElement("small",null,"-Psi -Sanity +Belief"))),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.props.brainwash()},title:"Give this being food or meds or cash"},"\ud83c\udf81 Gift",s.a.createElement("small",null,"-Energy +Things"))),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"button card",onClick:this.scan,title:"Steal a bit of this being's mind"},"\ud83e\udd2a Braindrain",s.a.createElement("small",null,"-Energy -Sanity +Psi")),s.a.createElement("button",{type:"button",className:"button card",onClick:this.vaporize,title:"Delete this being from the experiment"},"\u2620\ufe0f Vaporize",s.a.createElement("small",null,"-Bots -Energy"))),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.abduct()},title:"Remove this being for study"},"\ud83d\udc7e Abduct for Research",s.a.createElement("small",null,"-Bots -Sanity +Tech")))))}},{key:"scanned",get:function(){return this.props.alien.scanned_bean[this.props.bean.key]}}]),a}(s.a.Component),St=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onName=function(e){n.setState({name:e.target.value})},n.onSlogan=function(e){n.setState({slogan:e.target.value})},n.onCity=function(e){n.setState({cityKey:+e})},n.state={community:null,ideal:null,name:"Goodplace",slogan:"Perfection is achievable.",members:"Citizens",goal:"Legislation",cityKey:0},n}return Object(u.a)(a,[{key:"onCommunity",value:function(e){var t=this;this.setState({community:e},(function(){t.onBigFourChange()}))}},{key:"onIdeal",value:function(e){var t=this;this.setState({ideal:e},(function(){t.onBigFourChange()}))}},{key:"onBigFourChange",value:function(){"ego"===this.state.community&&"trad"===this.state.ideal?this.setState({name:"Arcadia",slogan:"A man belongs on the farm.",members:"Farmers",goal:"Tariffs"}):"ego"===this.state.community&&"prog"===this.state.ideal?this.setState({name:"Libertaria",slogan:"Freedom for every being!",members:"Builders",goal:"Right to Strike"}):"state"===this.state.community&&"trad"===this.state.ideal?this.setState({name:"Ultimate Kingdom",slogan:"Honor to King and family.",members:"Homeowners",goal:"Repeal Property Tax"}):"state"===this.state.community&&"prog"===this.state.ideal&&this.setState({name:"Equus",slogan:"True equality is peace.",members:"Penniless",goal:"Food Welfare"})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"pad-4p"},s.a.createElement("h2",null,"Found your Utopia")),s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,"Perfect societies rely on the",s.a.createElement("div",null,s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"community",value:"state",checked:"state"===this.state.community,onChange:function(t){return e.onCommunity(t.currentTarget.value)}})," ",s.a.createElement("b",null,"Collective")," \ud83d\udd4a\ufe0f "),"\xa0\xa0or\xa0\xa0",s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"community",value:"ego",checked:"ego"===this.state.community,onChange:function(t){return e.onCommunity(t.currentTarget.value)}})," ",s.a.createElement("b",null,"Independent")," \ud83e\udd85 ")),"\xa0 to guarantee well-being."),s.a.createElement("div",null,"Perfect beings devote themselves to",s.a.createElement("div",null,s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"ideal",value:"trad",checked:"trad"===this.state.ideal,onChange:function(t){return e.onIdeal(t.currentTarget.value)}})," ",s.a.createElement("b",null,"Elitist")," "," \ud83d\udc51"),"\xa0\xa0or\xa0\xa0",s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"ideal",value:"prog",checked:"prog"===this.state.ideal,onChange:function(t){return e.onIdeal(t.currentTarget.value)}})," ",s.a.createElement("b",null,"Progressive")," "," \u2696\ufe0f")),"\xa0 social values.")),s.a.createElement("hr",null),s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,"My Utopia is named ",s.a.createElement("input",{type:"text",value:this.state.name,onChange:this.onName})),s.a.createElement("div",null,"My Utopia's mantra is ",s.a.createElement("input",{type:"text",value:this.state.slogan,onChange:this.onSlogan}))),s.a.createElement("hr",null),s.a.createElement("button",{type:"button",disabled:null==this.state.community||null==this.state.ideal,className:"important btn-found-party",onClick:function(){return e.props.onFound(e.state)}},"Found the ",this.state.name," Utopia"))}}]),a}(s.a.Component);function Ct(e,t){return e.map((function(e){return function(e,t){return function(e,t){var a="badge align-mid "+t,n="".concat("neg"===t?"-":"+").concat(e);return s.a.createElement("span",{className:a,key:n},n)}(Ge[e],t)}(e,t)}))}var xt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={overView:"laws",detailView:"none",collapsedGroups:{Crime:!1,Taxation:!1,Welfare:!1,Culture:!1,Economics:!1},collapsedAxis:{wel_food:!1,wel_house:!1,wel_health:!1,tax_basic:!1,tax_second:!1,econ_sub:!1,cul_rel:!1,cul_theo:!1,crime_theo:!1}},n}return Object(u.a)(a,[{key:"renderDetailLaw",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Oe[e],i=Object.values(Oe).filter((function(t){return t.key!=e&&t.axis===n.axis})),r="add"===t?"border-b-1 pad-bt-8":"";return s.a.createElement("div",{key:e,className:r+(a?" pad-l-40":"")},s.a.createElement("div",{className:"horizontal"},s.a.createElement("strong",{className:"f-size-15em"},n.name),s.a.createElement("span",null,Ct(n.idealPro||[],"pos")),"add"===t?s.a.createElement("button",{className:"callout marg-0"},"Adopt for 3 \ud83d\uddf3\ufe0f"):null),a?null:s.a.createElement("div",null,s.a.createElement("i",null,"Government Policy for\xa0",Ne[n.axis].name)),s.a.createElement("div",null,s.a.createElement("p",null,n.description),"edit"===t?s.a.createElement("div",{className:"horizontal"},s.a.createElement("span",null,s.a.createElement("strong",null,"Subjects Fed:")," 1"),s.a.createElement("span",null,s.a.createElement("strong",null,"Last Monthly Cost:")," $1")):null,s.a.createElement("div",{className:"horizontal"},s.a.createElement("span",null,s.a.createElement("strong",null,"Max. Monthly Cost:")," ",s.a.createElement("input",{type:"number"}))),s.a.createElement("strong",null,"Incompatible with"),i.map((function(e,t){return s.a.createElement("i",{key:e.name},t>0?s.a.createElement("span",null,","):null," ",e.name)}))))}},{key:"renderDetailGroup",value:function(e){var t=this,a=[];return function(e,t){var a=new Map;return e.forEach((function(e){var n=t(e),i=a.get(n);i?i.push(e):a.set(n,[e])})),a}(Object.values(Oe).filter((function(t){return t.group===e})),(function(e){return e.axis})).forEach((function(e){var n=e.length>1;n&&a.push(s.a.createElement("div",null,s.a.createElement("h3",null,Ne[e[0].axis].name,s.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){t.state.collapsedAxis[e[0].axis]=!t.state.collapsedAxis[e[0].axis],t.setState({collapsedAxis:t.state.collapsedAxis})}},"\ud83d\udcc1")))),n&&t.state.collapsedAxis[e[0].axis]||e.forEach((function(e){a.push(t.renderDetailLaw(e.key,"add",n))}))})),a}},{key:"toggleGroup",value:function(e){this.state.collapsedGroups[e]=!this.state.collapsedGroups[e],this.setState({collapsedGroups:this.state.collapsedGroups})}},{key:"renderHeader",value:function(e){var t=this;return s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement("strong",null,e)),s.a.createElement("td",null,s.a.createElement("button",{className:"callout marg-0",onClick:function(){return t.setState({detailView:"group_add",detailGroup:e})}},"Add \u2795"),s.a.createElement("button",{className:"callout marg-0",onClick:function(){return t.toggleGroup(e)}},"\ud83d\udcc1")))}},{key:"renderRows",value:function(e,t){var a=this;return this.state.collapsedGroups[e]?null:t.map((function(e){var t=Oe[e.key];return s.a.createElement("tr",{key:e.key},s.a.createElement("td",null,s.a.createElement("i",null,t.name),(t.idealPro||[]).map((function(e){return Ge[e]}))),s.a.createElement("td",null,s.a.createElement("button",{onClick:function(){return a.setState({detailView:"law_view",detailLaw:e})},className:"callout marg-0"},"View \ud83d\udd0d")))}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"col-2"},s.a.createElement("h2",{className:"marg-b-0"},"Utopia Government"),s.a.createElement("div",null,s.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"},s.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"laws"})},className:"laws"===this.state.overView?"active":""},"\ud83d\udcdc Laws"),s.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"leadership"})},className:"leadership"===this.state.overView?"active":""},this.props.world.party.leadership," \ud83d\uddf3\ufe0f Leadership"),s.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"finances"})},className:"finances"===this.state.overView?"active":""},"\ud83d\udcb0 Funding")))),s.a.createElement("div",{className:"pad-4p"},this.props.world.party.name," is a\xa0",fe[this.props.world.party.community].adj," ",fe[this.props.world.party.community].icon,"\xa0",fe[this.props.world.party.ideals].adj," ",fe[this.props.world.party.ideals].icon,"\xa0 Utopia"),this.renderOver())}},{key:"renderOver",value:function(){switch(this.state.overView){case"leadership":return this.renderLeadership();case"finances":return this.renderFinances();default:return this.renderLaws()}}},{key:"renderLaws",value:function(){var e=this.props.world.law.getLawsByGroup();return s.a.createElement("div",{className:"col-2-30-60"},s.a.createElement("div",{className:"max-h-365"},s.a.createElement("table",{className:"full"},s.a.createElement("tbody",null,this.renderHeader("Taxation"),this.renderRows("Taxation",e.Taxation),this.renderHeader("Welfare"),this.renderRows("Welfare",e.Welfare),this.renderHeader("Economics"),this.renderRows("Economics",e.Economics),this.renderHeader("Crime"),this.renderRows("Crime",e.Crime),this.renderHeader("Culture"),this.renderRows("Culture",e.Culture)))),s.a.createElement("div",{className:"border max-h-365"},this.renderLawDetail()))}},{key:"renderLawDetail",value:function(){return"group_add"===this.state.detailView&&this.state.detailGroup?this.renderDetailGroup(this.state.detailGroup):"law_view"===this.state.detailView&&this.state.detailLaw?this.renderDetailLaw(this.state.detailLaw.key,"edit"):s.a.createElement("div",{className:"text-center"},"Add \u2795 or View \ud83d\udd0d a Law")}},{key:"renderFinances",value:function(){return s.a.createElement("div",null)}},{key:"renderLeadership",value:function(){return s.a.createElement("div",null)}}]),a}(s.a.Component),Nt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){var t=+new Date,a=e.change>0;n.setState({bubbles:n.state.bubbles.concat([{s:(a?"+":"")+e.change,t:t,c:a?"pos":"neg"}])}),setTimeout((function(){n.setState({bubbles:n.state.bubbles.filter((function(e){return e.t!=t}))})}),1500)},n.state={bubbles:[]},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.props.changeEvent&&this.props.changeEvent.subscribe(this.onChange)}},{key:"componentWillUnmount",value:function(){this.props.changeEvent&&this.props.changeEvent.unsubscribe(this.onChange)}},{key:"render",value:function(){var e=this,t=this.state.bubbles.map((function(t){return s.a.createElement("span",{key:t.t,className:[t.c,e.props.bubbleClass,"bubbler"].join(" ")},e.props.icon," ",t.s)}));return s.a.createElement("span",{className:"bubble-parent"},this.props.children,t)}}]),a}(s.a.Component),Ot=(a(21),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"social-graph"},this.props.beans.map((function(t){return s.a.createElement("div",{className:"bean-node",onClick:function(){return e.props.onClick(t)}},s.a.createElement(ht,{bean:t,static:!0,sitStill:!0,onClick:function(){e.props.onClick(t)}}))})))}}]),a}(s.a.Component)),_t=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(u.a)(a,[{key:"render",value:function(){var e="capsule-label "+this.props.label||!1;return s.a.createElement("span",{className:e},s.a.createElement("span",{className:"capsule-icon"},this.props.icon),s.a.createElement("span",{className:"capsule-text"},this.props.label,":"),s.a.createElement("span",{className:"capsule-value"},this.props.children))}}]),a}(s.a.Component),Bt=a(7),Pt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"renderReward",value:function(e){return s.a.createElement("div",null,s.a.createElement("small",null,"\ud83c\udf81 ",Be(e.reward||{},"+")))}},{key:"renderGoal",value:function(e){var t=null!=this.props.progress.goalProgress[e.key]&&this.props.progress.goalProgress[e.key].done;return s.a.createElement("li",null,t?"\u2611\ufe0f":"\u2b55\ufe0f",e.text,null!=e.tooltip?s.a.createElement("small",{title:e.tooltip},"\u2754"):null,t||null==e.reward?null:this.renderReward(e))}},{key:"render",value:function(){var e,t=this;return s.a.createElement("div",{className:"goals"},s.a.createElement("div",null,s.a.createElement("b",null,"Goals")),s.a.createElement("ul",null,this.props.progress.goals.map((function(e){return t.renderGoal(Me[e])}))),s.a.createElement("div",null,s.a.createElement("b",null,"Report Card")),s.a.createElement("p",{className:"horizontal"},s.a.createElement("span",null,"Last Grade: ",s.a.createElement("b",null,"D")),s.a.createElement("span",null,"Next Grade in: ",s.a.createElement("b",null,"2 mo."))),s.a.createElement("p",null),s.a.createElement("table",{style:{margin:"auto"}},s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("th",null,"\ud83c\udfaf Happiness"),s.a.createElement("td",null,this.props.player.workingReportCard.Happiness),s.a.createElement("td",null,s.a.createElement("small",{title:"Are your subjects happy?"},"\u2754"))),s.a.createElement("tr",null,s.a.createElement("td",{className:"text-left",colSpan:3},s.a.createElement("small",null,De.RubricDescription.Happiness))),s.a.createElement("tr",null,s.a.createElement("th",null,"\ud83c\udfaf Prosperity"),s.a.createElement("td",null,this.props.player.workingReportCard.Prosperity),s.a.createElement("td",null,s.a.createElement("small",{title:"Are your subjects fed and healthy?"},"\u2754"))),s.a.createElement("tr",null,s.a.createElement("td",{className:"text-left",colSpan:3},s.a.createElement("small",null,De.RubricDescription.Prosperity))),s.a.createElement("tr",null,s.a.createElement("th",null,"\ud83c\udfaf Stability"),s.a.createElement("td",null,this.props.player.workingReportCard.Stability),s.a.createElement("td",null,s.a.createElement("small",{title:"Are your subjects sane and civil?"},"\u2754"))),s.a.createElement("tr",null,s.a.createElement("td",{className:"text-left",colSpan:3},s.a.createElement("small",null,De.RubricDescription.Stability))),s.a.createElement("tr",null,s.a.createElement("th",null,"\ud83c\udfaf Dogma"),s.a.createElement("td",null,this.props.player.workingReportCard.Dogma),s.a.createElement("td",null,s.a.createElement("small",{title:"Do your society's rules match your utopian ideals?"},"\u2754"))),s.a.createElement("tr",null,s.a.createElement("td",{className:"text-left",colSpan:3},s.a.createElement("small",null,De.RubricDescription.Dogma))),s.a.createElement("tr",null,s.a.createElement("td",{colSpan:3},s.a.createElement("hr",null))),s.a.createElement("tr",null,s.a.createElement("th",null,"Avg. Grade"),s.a.createElement("td",null,(e=this.props.player.workingReportCard,Fe((Ae[e.Happiness]+Ae[e.Prosperity]+Ae[e.Stability]+Ae[e.Dogma])/20))),s.a.createElement("td",null)))))}}]),a}(s.a.Component),Mt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"pad-4p"},s.a.createElement("div",{className:"subheader"},s.a.createElement("h3",null,"Propaganda"),s.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83c\udf99\ufe0f Buy Propaganda")),s.a.createElement("span",null,"Propaganda changes beans' feelings on a wide variety of topics."),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83d\udcfa Broadcast Campaign"),s.a.createElement("small",null,"Approval+ Cash-"),s.a.createElement("span",{className:"p"},"Small chance to increase Approval among all beans")),s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83d\udc4b Canvassing"),s.a.createElement("small",null,"Approval+ Labor-"),s.a.createElement("span",{className:"p"},"Chance to increase Approval on a few random beans")),s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83d\uddde\ufe0f Print Campaign"),s.a.createElement("small",null,"Approval+ Cash-"),s.a.createElement("span",{className:"p"},"Chance to increase Approval on wealthy beans"))),s.a.createElement("div",{className:"subheader"},s.a.createElement("h3",null,"Appearances"),s.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83d\udcac Schedule Appearance")),s.a.createElement("span",null,"Appearances have limited reach, but have powerful effects."),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83e\udd14 Debating"),s.a.createElement("small",null,"Labor-"),s.a.createElement("span",{className:"p"},"Chance to gain or lose Influence")),s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83d\udcf8 Photo Op"),s.a.createElement("small",null,"Labor-"),s.a.createElement("span",{className:"p"},"Increases Approval within one Social Group")),s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83c\udfa4 Speechmaking"),s.a.createElement("small",null,"Labor-"),s.a.createElement("span",{className:"p"},"Increases chance of Donations in a single City")),s.a.createElement("button",{type:"button",className:"card button"},s.a.createElement("span",{className:"h"},"\ud83d\ude4b Town Hall"),s.a.createElement("small",null,"Labor-"),s.a.createElement("span",{className:"p"},"Suppresses negative Approval in a single city"))))}}]),a}(s.a.Component),Dt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"col-2"},s.a.createElement("h2",null,"Government"),s.a.createElement("div",null)))}}]),a}(s.a.Component),Tt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={confirming:!1},n}return Object(u.a)(a,[{key:"click",value:function(){this.state.confirming?(this.props.onConfirm(),this.setState({confirming:!1})):this.setState({confirming:!0})}},{key:"render",value:function(){var e=this;return s.a.createElement("button",{className:this.props.className,onClick:function(){return e.click()},disabled:this.props.disabled},this.state.confirming?this.props.confirmText:this.props.children)}}]),a}(s.a.Component),It=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("svg",{width:"100",height:"300",xmlns:"http://www.w3.org/2000/svg",style:{},className:this.props.classN+" robot-arm"},s.a.createElement("g",null,s.a.createElement("title",null,"robotarm"),s.a.createElement("rect",{fill:"transparent",id:"canvas_background",height:"302",width:"102",y:"-1",x:"-1"}),s.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},s.a.createElement("rect",{fill:"url(#gridpattern)",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),s.a.createElement("g",null,s.a.createElement("title",null,"Layer 1"),s.a.createElement("rect",{id:"svg_2",height:"200",width:"48",y:"91.63545",x:"25",strokeWidth:"1.5",stroke:"#000",fill:"#BBBBBB"}),s.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_1",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),s.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_3",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"}),s.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_4",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),s.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_5",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"},this.props.tool)),s.a.createElement("text",{y:"250",x:"-20",fontSize:"4em"},this.props.tool))}}]),a}(s.a.Component),Ft=(a(22),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).tools=["\ud83d\udce1","\ud83d\udddc\ufe0f","\ud83d\udd2c","\ud83d\udc89","\ud83d\udd0e","\ud83e\uddfc","\ud83e\uddf2","\ud83c\udfa5","\ud83d\udd27"],n.interval=void 0,n.state={toolI:0,toolI2:2,toolI3:4,toolI4:1},n}return Object(u.a)(a,[{key:"loop",value:function(e){var t=e+1;return t===this.tools.length&&(t=0),t}},{key:"componentDidMount",value:function(){var e=this;this.interval=window.setInterval((function(){e.setState({toolI:e.loop(e.state.toolI),toolI2:e.loop(e.state.toolI2),toolI3:e.loop(e.state.toolI3),toolI4:e.loop(e.state.toolI4)})}),1e3)}},{key:"componentWillUnmount",value:function(){null!=this.interval&&window.clearInterval(this.interval)}},{key:"setResearch",value:function(e){this.props.setResearch(e)}},{key:"renderTech",value:function(e){var t=this,a=null==this.props.player.techProgress[e.tech]?0:this.props.player.techProgress[e.tech].researchPoints,n=e.techPoints,i={width:Math.min(a/n*100,100)+"%"},r=a>=n,o=this.props.player.currentlyResearchingTech===e.tech,l=r?"\u2705":o?"\ud83d\udd2c":"\u2b55\ufe0f",c=o?"active":"inactive";return s.a.createElement("div",{className:"card-parent "+c,key:e.tech},s.a.createElement("button",{className:"card button",onClick:function(){return t.setResearch(e.tech)}},s.a.createElement("strong",null,e.name),s.a.createElement("strong",{className:"pull-r f-size-125em"},l),s.a.createElement("div",null,e.description),s.a.createElement("div",{className:"bar f-size-12 h-12"},s.a.createElement("div",{className:"bar-inner text-center",style:i}),a,"/",n," tech")))}},{key:"render",value:function(){var e=this,t=Object.values(He);return s.a.createElement("div",null,s.a.createElement("div",{className:"col-2"},s.a.createElement("div",null,s.a.createElement("h2",null,"Research Lab"),s.a.createElement("div",{className:"vertical"},t.map((function(t){return e.renderTech(t)})))),s.a.createElement("div",{className:"vertical"},s.a.createElement("div",null,s.a.createElement("div",{className:"robot"},"\ud83e\udd16",s.a.createElement(It,{classN:"far-left",tool:this.tools[this.state.toolI]}),s.a.createElement(It,{classN:"left",tool:this.tools[this.state.toolI2]}),s.a.createElement(It,{classN:"near-right",tool:this.tools[this.state.toolI3]}),s.a.createElement(It,{classN:"far-right",tool:this.tools[this.state.toolI4]}))),s.a.createElement("div",{className:"h-42em"},this.props.player.abductedBeans.map((function(e){return s.a.createElement("span",{key:e.key,className:"victim bean triangle shake"},"\ud83d\ude28")}))),s.a.createElement("div",{className:"text-center"},"Currently probing ",this.props.player.abductedBeans.length," beings for ",this.props.player.abductedBeans.length," tech a day",s.a.createElement("p",null,s.a.createElement("small",null,"1 tech per research subject per day"))),this.props.player.abductedBeans.length>0?s.a.createElement("div",{className:"text-right"},s.a.createElement(Tt,{className:"callout",onConfirm:function(){e.props.release()},confirmText:"-1 Research Subject?"},"\ud83c\udf88 Release Research Subject")):null)),s.a.createElement("div",null))}}]),a}(s.a.Component)),At=(a(23),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\u231b\ufe0f",s.a.createElement("button",{type:"button",className:0==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(0)}},"\u23f9"),s.a.createElement("button",{type:"button",className:1==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(1)}},"\u25b6\ufe0f"),s.a.createElement("button",{type:"button",className:2==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(2)}},"\u23e9"))}}]),a}(s.a.Component)),Ht=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("small",null,Be(this.props.cost,"-"))}}]),a}(s.a.Component),Lt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"emptyPanel",value:function(){var e=this,t=this.props.difficulty.cost.emptyHex;return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("strong",null,"Empty Lot")," in ",s.a.createElement("strong",null,this.props.city.name),s.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearHex()}},"\u274c")),s.a.createElement("h3",null,"Build:"),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"house")}},L.house," House",s.a.createElement(Ht,{cost:t.build.house}))),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"farm")}},L.farm," Farm",s.a.createElement(Ht,{cost:t.build.farm})),s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"hospital")}},L.hospital," Hospital",s.a.createElement(Ht,{cost:t.build.hospital}))),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"theater")}},L.theater," Theater",s.a.createElement(Ht,{cost:t.build.theater})),s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"park")}},L.park," Park",s.a.createElement(Ht,{cost:t.build.park}))),s.a.createElement("h3",null,"Beings:"),s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.beam(e.props.hex)}},"\ud83d\udef8 Beam In New Subject",s.a.createElement(Ht,{cost:this.props.difficulty.cost.hex.beam}))))}},{key:"buildingPanel",value:function(e){var t=this,a=e.usedSlots(),n=e.openSlots(),i="park"!=e.type&&"nature"!=e.type;return s.a.createElement("div",null,s.a.createElement("strong",null,Kt[e.type])," in ",s.a.createElement("strong",null,this.props.city.name),0===a.length?null:s.a.createElement("div",null,s.a.createElement("strong",null,"Workers:"),a.map((function(a){var n;return s.a.createElement("div",null,z[e.type]," ",null===(n=t.props.city.beans.find((function(t){return t.key===e.job_slots[a]})))||void 0===n?void 0:n.name)}))),i?s.a.createElement("div",null,"This ",Kt[e.type]," can support ",n.length," more jobs.",e.upgraded?null:s.a.createElement("span",null,s.a.createElement("br",null),"Upgrade it to add 3 more job slots.")):null,e.upgraded||!i?null:s.a.createElement("div",{className:"card-parent"},s.a.createElement("button",{className:"card button",type:"button",onClick:function(){return t.props.upgrade(e)}},"\ud83d\udee0\ufe0f Upgrade",s.a.createElement(Ht,{cost:this.props.difficulty.cost.hex.upgrade}))))}},{key:"renderJobs",value:function(){}},{key:"render",value:function(){var e=this.props.city.lookupBuilding(this.props.hex);return e?this.buildingPanel(e):this.emptyPanel()}}]),a}(s.a.Component),Rt=(a(24),a(25),function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.props.onChange(e.target.value),n.setState({key:e.target.value})},n.state={key:e.value||null},n}return Object(u.a)(a,[{key:"hint",value:function(){if(this.props.hint)return s.a.createElement("option",{value:"",disabled:!0,selected:!0,hidden:!0},this.props.hint)}},{key:"getTextForOption",value:function(e){return this.props.titleCase&&(e=e[0].toUpperCase()+e.slice(1)),e}},{key:"options",value:function(){var e=this;return this.props.options.map((function(t){return s.a.createElement("option",{value:t,key:t,title:e.getTitleForOption(t)},e.getTextForOption(t))}))}},{key:"render",value:function(){return s.a.createElement("select",{onChange:this.onChange,value:this.state.key,required:null!=this.props.hint},this.hint(),this.options())}},{key:"getTitleForOption",value:function(e){}}]),a}(s.a.Component)),zt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("div",{className:"belief"},s.a.createElement("div",{className:"horizontal badger"},s.a.createElement("div",{className:"vertical"},s.a.createElement("div",{className:"circular"},this.props.data.icon),this.props.frozen?null:s.a.createElement(Tt,{className:"callout pad-4 marg-0",confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",disabled:this.props.available<this.props.cost,onConfirm:this.props.wash},"\ud83d\udebf ",s.a.createElement("small",null,"Wash"))),s.a.createElement("div",{className:"vertical"},s.a.createElement("div",{className:"text-center"},s.a.createElement("strong",{title:this.props.data.description,className:this.props.divergent?"divergent marg-r-6":"marg-r-6"},this.props.data.noun),s.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),s.a.createElement("small",{className:"marg-b-6"},this.props.data.description),s.a.createElement("div",{className:"grow-1 text-center"},Ct(this.props.data.idealPro||[],"pos"),Ct(this.props.data.idealCon||[],"neg")))))}}]),a}(s.a.Component),qt=Ee.slice().sort((function(e,t){return e.localeCompare(t)})),Gt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={belief:"Neuroticism"},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=be[this.state.belief];return s.a.createElement("div",{className:"belief"},s.a.createElement("div",{className:"horizontal badger add"},s.a.createElement("div",{className:"vertical"},s.a.createElement("div",{className:"circular"},t.icon),s.a.createElement(Tt,{className:"callout grow-0 pad-4 marg-0",disabled:this.props.available<this.props.cost,confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",onConfirm:function(){return e.props.add(e.state.belief)}},"\ud83d\udc89 ",s.a.createElement("small",null,"Implant"))),s.a.createElement("div",{className:"vertical"},s.a.createElement("div",{className:"text-center"},s.a.createElement(Rt,{titleCase:!0,options:qt,value:this.state.belief,onChange:function(t){console.log(t),e.setState({belief:t})}}),s.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),s.a.createElement("small",{className:"marg-b-6"},t.description),s.a.createElement("div",{className:"grow-1 text-center"},(t.idealPro||[]).map((function(e){return s.a.createElement("span",{className:"pos badge align-mid"},"+",Ge[e])})),(t.idealCon||[]).map((function(e){return s.a.createElement("span",{className:"neg badge align-mid"},"-",Ge[e])}))))))}}]),a}(s.a.Component),Wt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(c.a)(this,a),t.call(this,e)}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.world.beans.find((function(t){return t.key==e.props.beanID}));if(null!=t)return s.a.createElement("div",null,s.a.createElement("div",{className:"horizontal fancy-header"},s.a.createElement("div",null,"BRAIN"),s.a.createElement("div",{className:"emoji-3"},"\ud83d\udc89\ud83e\udde0\ud83d\udebf"),s.a.createElement("div",null,"WASH")),s.a.createElement("div",null,s.a.createElement("div",{className:"text-center"},s.a.createElement("strong",null,t.name)," has ",t.discrete_sanity," sanity \ud83e\udde0"),s.a.createElement("div",{className:"horizontal"},s.a.createElement("div",null,s.a.createElement(zt,{available:this.props.world.alien.psi.amount,wash:function(){return e.props.washCommunity(t,t.community)},cost:this.props.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0,data:fe[t.community]}),s.a.createElement(zt,{available:this.props.world.alien.psi.amount,wash:function(){return e.props.washMotive(t,t.ideals)},cost:this.props.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0,data:fe[t.ideals]}),s.a.createElement(zt,{available:this.props.world.alien.psi.amount,wash:function(){return e.props.washNarrative(t,t.faith)},cost:this.props.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0,data:ye[t.faith]}),t.beliefs.map((function(a){return s.a.createElement(zt,{available:e.props.world.alien.psi.amount,divergent:ve(a,e.props.world.party.ideals,e.props.world.party.community),wash:function(){return e.props.washBelief(t,a)},cost:e.props.world.alien.difficulty.cost.bean.brainwash_secondary.psi||0,data:be[a]})})),s.a.createElement(Gt,{available:this.props.world.alien.psi.amount,add:function(a){return e.props.implantBelief(t,a)},cost:this.props.world.alien.difficulty.cost.bean.brainimplant_secondary.psi||0})))))}}]),a}(s.a.Component),Vt=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onEvent=function(e){n.setState({eventCount:n.state.eventCount+1}),window.setTimeout((function(){n.setState({eventCount:n.state.eventCount-1})}),3e3)},n.props.event.subscribe(n.onEvent),n.state={eventCount:0},n}return Object(u.a)(a,[{key:"render",value:function(){return s.a.createElement("span",null,this.state.eventCount<1?this.props.children:s.a.createElement("span",{className:this.props.eventClass},this.props.eventIcon))}}]),a}(s.a.Component),Kt={state:"Collectivist",ego:"Independent",trad:"Elitist",prog:"Progressive",circle:"Brunette",square:"Blonde",triangle:"Redhead",rocket:"Futuristic",dragon:"Mythical",music:"Dramatic",noFaith:"Nihilistic",hungry:"Hungry",sated:"Sated",stuffed:"Stuffed",podless:"Homeless",crowded:"Crowded",homeowner:"Homeowner",sick:"Sick",bruised:"Bruised",fresh:"Robust",sane:"Sane",confused:"Confused",mad:"Mad",house:"House",hospital:"Hospital",farm:"Farm",theater:"Theater",church:"Church",courthouse:"Courthouse",park:"Park",nature:"Natural Scenery"},Ut=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).previousTimeMS=0,n.logicTickAccumulatorMS=0,n.tick=function(e){var t=(e-n.previousTimeMS)*n.state.timeScale;n.previousTimeMS=e,t>0&&(n.logicTickAccumulatorMS+=t,n.state.world.simulate_beans(t),n.logicTickAccumulatorMS>2e3&&(n.state.world.simulate_world(),n.setState({world:n.state.world}),n.logicTickAccumulatorMS=0)),window.requestAnimationFrame(n.tick)},n.keyupHandler=function(e){" "===e.key?n.state.timeScale>0?n.setState({timeScale:0}):n.setState({timeScale:1}):"Q"===e.key&&e.shiftKey&&(n.build(n.state.world.cities[0],{q:1,r:1},"farm"),n.build(n.state.world.cities[0],{q:1,r:0},"house"),n.build(n.state.world.cities[0],{q:0,r:1},"hospital"),n.beam(n.state.world.cities[0],{q:0,r:0}),n.beam(n.state.world.cities[0],{q:1,r:0}),n.beam(n.state.world.cities[0],{q:0,r:1}),n.beam(n.state.world.cities[0],{q:1,r:1}))},n.foundParty=function(e){n.state.world.party.name=e.name,n.state.world.party.slogan=e.slogan,n.state.world.cities[0].name=e.name,e.community&&(n.state.world.party.community=e.community),e.ideal&&(n.state.world.party.ideals=e.ideal);var t=n.state.world.cities.find((function(t){return t.key==e.cityKey}));t&&n.state.world.party,n.state.world.calculateComputedState(),n.setState({world:n.state.world,activeModal:null})},n.build=function(e,t,a){var i=n.difficulty.cost.emptyHex.build[a];n.state.world.alien.canAfford(i)&&(n.state.world.alien.purchase(i),at(e,a,t)),n.setState({world:n.state.world})},n.upgrade=function(e,t){var a=n.difficulty.cost.hex.upgrade;n.state.world.alien.tryPurchase(a)&&(t.upgraded=!0),n.setState({world:n.state.world})},n.beam=function(e,t){var a=n.difficulty.cost.hex.beam;if(n.state.world.alien.canAfford(a)){n.state.world.alien.purchase(a);var i=new Ze(e.ufos.length,t,"beam-in");e.ufos.push(i),window.setTimeout((function(){e.historicalBeans.push(st(e,e.historicalBeans.length,t)),n.setState({world:n.state.world})}),3e3),n.setState({world:n.state.world},(function(){n.removeUFO(e,i.key)}))}},n.foundCharity=function(e,t,a){n.state.world.addCharity(e,t,a),n.setState({world:n.state.world})},n.vaporize=function(e){n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.vaporize)&&(e.city&&e.die("vaporization"),n.setState({world:n.state.world}))},n.abduct=function(e){n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.abduct)&&(e.abduct(n.state.world.alien),n.setState({world:n.state.world}))},n.releaseBean=function(){if(n.state.world.alien.abductedBeans.length>0){var e=n.state.world.alien.abductedBeans.shift();e instanceof ke?e.lifecycle="alive":window.alert("releasing data beans is unimplemented")}},n.setResearch=function(e){n.state.world.alien.currentlyResearchingTech=e,n.setState({world:n.state.world})},n.support=function(e){var t;e.lastApprovalDate={year:(t=n.state.world).date.year,season:t.date.season,day:t.date.day,hour:t.date.hour},e.city&&e.calculateBeliefs(n.state.world.economy,e.city,n.state.world.law,n.state.world.party),n.setState({world:n.state.world})},n.scan=function(e){return!!n.state.world.alien.canAfford(n.state.world.alien.difficulty.cost.bean.scan)&&(n.state.world.alien.purchase(n.state.world.alien.difficulty.cost.bean.scan),n.state.world.alien.scanned_bean[e.key]=!0,n.setState({world:n.state.world}),!0)},n.washCommunity=function(e,t){if(e.discrete_sanity>0&&n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.brainwash_ideal))return e.loseSanity(n.state.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0),"ego"===e.community?e.community="state":e.community="ego",n.setState({world:n.state.world}),!0},n.washMotive=function(e,t){if(e.discrete_sanity>0&&n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.brainwash_ideal))return e.loseSanity(n.state.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0),"prog"===e.ideals?e.ideals="trad":e.ideals="prog",n.setState({world:n.state.world}),!0},n.washNarrative=function(e,t){if(e.discrete_sanity>0&&n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.brainwash_ideal)){e.loseSanity(n.state.world.alien.difficulty.cost.bean.brainwash_ideal.psi||0);for(var a=e.faith;e.faith===a;)e.faith=tt(["rocket","dragon","music","noFaith"]);return n.setState({world:n.state.world}),!0}},n.washBelief=function(e,t){if(e.discrete_sanity>0&&n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.brainwash_secondary))return e.beliefs.splice(e.beliefs.indexOf(t),1),e.loseSanity(n.state.world.alien.difficulty.cost.bean.brainwash_secondary.psi||0),n.setState({world:n.state.world}),!0},n.implantBelief=function(e,t){if(e.discrete_sanity>0&&n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.brainimplant_secondary))return e.beliefs.push(t),e.loseSanity(n.state.world.alien.difficulty.cost.bean.brainimplant_secondary.psi||0),n.setState({world:n.state.world}),!0},n.setPolicy=function(e,t){n.state.world.party.platform[e]=t,n.state.world.calculateComputedState(),n.setState({world:n.state.world})},n.onDeath=function(e){n.startSpotlight(e)},n.timescaleBeforeSpotlight=1,n.state={world:nt(),activeCityID:null,activeBeanID:null,activeHex:null,activeMain:"geo",activeModal:"party_creation",activeRightPanel:"overview",timeScale:0,spotlightEvent:void 0},n.state.world.calculateComputedState(),n.state.world.bus.death.subscribe(n.onDeath),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this.keyupHandler,!1),window.requestAnimationFrame((function(t){e.previousTimeMS=t,window.requestAnimationFrame(e.tick)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyupHandler)}},{key:"removeUFO",value:function(e,t){window.setTimeout((function(){var a=e.ufos.findIndex((function(e){return e.key===t}));a>-1&&e.ufos.splice(a,1)}),7e3)}},{key:"startSpotlight",value:function(e){var t=this;this.timescaleBeforeSpotlight=this.state.timeScale,this.setState({spotlightEvent:e,timeScale:0},(function(){setTimeout((function(){return t.endSpotlight()}),5e3)}))}},{key:"endSpotlight",value:function(){this.setState({timeScale:this.timescaleBeforeSpotlight,spotlightEvent:void 0})}},{key:"getPanel",value:function(){var e=this;switch(this.state.activeRightPanel){case"overview":if(null==this.state.activeCityID)return s.a.createElement(ct,{beans:this.state.world.beans,utopia:this.state.world.party,clearCity:function(){return e.setState({activeCityID:null})}});var t=this.state.world.cities.find((function(t){return t.key==e.state.activeCityID}));if(t){if(null!=this.state.activeHex)return s.a.createElement(Lt,{city:t,hex:this.state.activeHex,difficulty:this.state.world.alien.difficulty,clearHex:function(){return e.setState({activeHex:null})},beam:function(a){return e.beam(t,a)},upgrade:function(a){return e.upgrade(t,a)},build:function(a,n){e.build(t,a,n)}});if(null!=this.state.activeBeanID){var a=t.beans.find((function(t){return t.key==e.state.activeBeanID}));if(a)return s.a.createElement(jt,{bean:a,city:t,alien:this.state.world.alien,economy:this.state.world.economy,party:this.state.world.party,bus:this.state.world.bus,law:this.state.world.law,scan:this.scan,vaporize:this.vaporize,brainwash:function(){return e.setState({activeModal:"brainwash"})},abduct:this.abduct,gift:function(){return e.setState({activeModal:"brainwash"})},clearCity:function(){return e.setState({activeCityID:null,activeBeanID:null})}})}return s.a.createElement(ct,{beans:null===t||void 0===t?void 0:t.beans,utopia:this.state.world.party,city:t,clearCity:function(){return e.setState({activeCityID:null})}})}return s.a.createElement("div",null);case"goals":return s.a.createElement(Pt,{player:this.state.world.alien,progress:this.state.world.alien});case"events":return s.a.createElement(Et,{events:this.state.world.bus.buffer,selectBean:function(t){t&&e.setState({activeCityID:e.state.world.cities[0].key,activeBeanID:t,activeHex:null,activeRightPanel:"overview"})}})}}},{key:"renderGeo",value:function(){var e=this,t=this.state.world.economy.getCostOfLiving();return this.state.world.cities.map((function(a){return s.a.createElement(bt,{tile:a,city:a,costOfLiving:t,key:a.key,spotlightEvent:e.state.spotlightEvent,activeBeanID:e.state.activeBeanID,onClick:function(){return e.setState({activeCityID:a.key,activeRightPanel:"overview",activeHex:null,activeBeanID:null})},onBeanClick:function(t){return e.setState({activeCityID:a.key,activeRightPanel:"overview",activeHex:null,activeBeanID:t.key})},onHexClick:function(t){e.setState({activeCityID:a.key,activeHex:t,activeBeanID:null,activeRightPanel:"overview"})}})}))}},{key:"renderNetwork",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{className:"horizontal max-w-500 m-t-2em"},s.a.createElement("button",{type:"button"},"\ud83d\ude0e Influence"),s.a.createElement("button",{type:"button"},"\ud83d\udea9 Party Preference"),s.a.createElement("button",{type:"button"},"\ud83d\udcc8 Demographics")),s.a.createElement(Ot,{costOfLiving:this.state.world.economy.getCostOfLiving(),beans:this.state.world.beans,onClick:function(t){return e.setState({activeCityID:t.cityKey,activeRightPanel:"overview",activeBeanID:t.key})}}))}},{key:"main",value:function(){switch(this.state.activeMain){case"network":return this.renderNetwork();default:return this.renderGeo()}}},{key:"render",value:function(){var e=this,t=n[this.state.world.date.season];return s.a.createElement("div",{className:"canvas"},s.a.createElement(Bt.b,{defaultScale:1,wheel:{step:48}},s.a.createElement(Bt.a,null,s.a.createElement("div",{className:"world"},this.main()))),s.a.createElement("div",{className:"overlay"},s.a.createElement(ot,{show:"party_creation"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})},hideCloseButton:!0},s.a.createElement(St,{cities:this.state.world.cities,onFound:this.foundParty})),s.a.createElement(ot,{show:"party"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},s.a.createElement(xt,{world:this.state.world,setPolicy:this.setPolicy})),s.a.createElement(ot,{show:"polisci"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},s.a.createElement(Ft,{release:this.releaseBean,setResearch:this.setResearch,player:this.state.world.alien})),s.a.createElement(ot,{show:"policy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},s.a.createElement(Dt,{world:this.state.world})),s.a.createElement(ot,{show:"campaign"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},s.a.createElement(Mt,null)),s.a.createElement(ot,{show:"economy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"economy"==this.state.activeModal?s.a.createElement(gt,{world:this.state.world}):""),s.a.createElement(ot,{show:"brainwash"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"brainwash"==this.state.activeModal?s.a.createElement(Wt,{world:this.state.world,beanID:this.state.activeBeanID,washCommunity:this.washCommunity,washMotive:this.washMotive,washNarrative:this.washNarrative,washBelief:this.washBelief,implantBelief:this.implantBelief}):""),s.a.createElement("div",{className:"left"},s.a.createElement("div",{className:"top"},s.a.createElement("span",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),s.a.createElement("span",null,"\xa0 Year ",this.state.world.date.year,", \xa0",t," ",this.state.world.date.day," ",this.renderHour()),s.a.createElement("span",null,"6 mo 5 days til Grade"),s.a.createElement("button",{type:"button",onClick:function(){return e.setState({activeMain:"network"})}},"\ud83c\udf10"),s.a.createElement("button",{type:"button",onClick:function(){return e.setState({activeMain:"geo"})}},"\ud83c\udf0e"),s.a.createElement(At,{timeScale:this.state.timeScale,setTimeScale:function(t){e.setState({timeScale:t})}})),s.a.createElement("div",{className:"bottom"},s.a.createElement(Nt,{changeEvent:this.state.world.alien.energy.change,icon:"\u26a1\ufe0f"},s.a.createElement(_t,{icon:"\u26a1\ufe0f",label:"Energy"},this.state.world.alien.energy.amount.toFixed(1))),s.a.createElement(Nt,{changeEvent:this.state.world.alien.psi.change,icon:"\ud83e\udde0"},s.a.createElement(_t,{icon:"\ud83e\udde0",label:"Psi"},this.state.world.alien.psi.amount.toFixed(1))),s.a.createElement(Nt,{changeEvent:this.state.world.alien.bots.change,icon:"\ud83e\udd16"},s.a.createElement(_t,{icon:"\ud83e\udd16",label:"Bots"},this.state.world.alien.bots.amount.toFixed(1))),s.a.createElement("span",null,s.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"economy"})}},"State of the Utopia"),s.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"party"})}},"\ud83d\uddf3\ufe0f Gov"),s.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"polisci"})}},"\ud83e\uddea Research")))),s.a.createElement("div",{className:"right"},s.a.createElement("div",{className:"full-width-tabs"},s.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"overview"})}},"\ud83d\udcc8 Overview"),s.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"events"})}},s.a.createElement(Vt,{event:this.state.world.bus.speechcrime,eventIcon:"\ud83d\udea8",eventClass:"police-siren"},"\ud83d\udce3")," Events"),s.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"goals"})}},"\ud83c\udfc6 Goals")),s.a.createElement("div",{className:"right-panel"},this.getPanel()))))}},{key:"renderHour",value:function(){switch(this.state.world.date.hour){default:return"\u2600\ufe0f";case i.Evening:return"\ud83c\udf07";case i.Morning:return"\ud83c\udf04";case i.Midnight:return"\ud83c\udf19"}}},{key:"difficulty",get:function(){return this.state.world.alien.difficulty}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(Ut,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.316ce356.chunk.js.map