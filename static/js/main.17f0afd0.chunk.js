(this.webpackJsonpsocsim=this.webpackJsonpsocsim||[]).push([[0],[,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(32)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(14),s=a.n(r),o=(a(21),a(1)),l=a(2),c=a(4),u=a(3),h=(a(22),a(23),a(8)),d=a(12),m=function(){function e(t){Object(o.a)(this,e),this.onPublish=t,this.callbacks=[]}return Object(l.a)(e,[{key:"publish",value:function(e){this.onPublish&&this.onPublish(e),this.callbacks.forEach((function(t){return t(e)}))}},{key:"subscribe",value:function(e){this.callbacks.push(e)}},{key:"unsubscribe",value:function(e){this.callbacks.splice(this.callbacks.indexOf(e),1)}}]),e}(),p=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return a}(m),f=function e(){var t=this;Object(o.a)(this,e),this.buffer=[],this.sendToBuffer=function(e){t.buffer.length>20&&t.buffer.pop(),t.buffer.unshift(e)},this.speechcrime=new m(this.sendToBuffer),this.nojobslots=new m(this.sendToBuffer),this.birth=new m(this.sendToBuffer),this.death=new m(this.sendToBuffer)},y=function(){function e(t){Object(o.a)(this,e),this.current=t,this.onChange=new m}return Object(l.a)(e,[{key:"set",value:function(e){this.current=e,this.onChange.publish(e)}},{key:"get",get:function(){return this.current}}]),e}(),b=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onPush=new m,e}return Object(l.a)(a,[{key:"push",value:function(e){this.set([].concat(Object(d.a)(this.get),[e])),this.onPush.publish(e)}},{key:"remove",value:function(e){var t=this.get,a=t.indexOf(e);a>-1&&(t.splice(a,1),this.set(Object(d.a)(t)))}}]),a}(y),v=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).onAdd=new m,e}return Object(l.a)(a,[{key:"add",value:function(e,t){var a=new Map(this.current);a.set(e,t),this.set(a),this.onAdd.publish({k:e,v:t})}},{key:"at",value:function(e){return this.current.get(e)}}]),a}(y),g=a(5),E=a(15),k=a(6);function w(e){for(var t=e.length;t>0;){var a=Math.floor(Math.random()*t),n=e[--t];e[t]=e[a],e[a]=n}return e}function j(e,t,a){return Math.max(Math.min(e,a),t)}var x=function e(t,a){Object(o.a)(this,e),this.q=t,this.r=a},C=[new x(1,0),new x(1,-1),new x(0,-1),new x(-1,0),new x(-1,1),new x(0,1)];function S(e){return C[e]}function N(e,t){var a=S(t);return new x(e.q+a.q,e.r+a.r)}function O(e,t){for(var a,n,i=[],r=function(e,t){return new x(e.q+t.q,e.r+t.r)}(e,(a=S(4),n=t,new x(a.q*n,a.r*n))),s=0;s<6;s++)for(var o=0;o<t;o++)i.push(r),r=N(r,s);return i}function _(e,t,a){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return r<=a||0==r?t:{x:e.x+n/r*a,y:e.y+i/r*a}}function B(e,t,a,n,i,r){var s={x:t.x-e.point.x,y:t.y-e.point.y},o=Math.sqrt(s.x*s.x+s.y*s.y);return o<i||(s.x/=o,s.y/=o,e.velocity.x+=s.x*a,e.velocity.y+=s.y*a,e.velocity.x=j(e.velocity.x,-n,n),e.velocity.y=j(e.velocity.y,-n,n),M(e,r),!1)}function M(e,t){e.velocity.x*=t.x,e.velocity.y*=t.y,e.point.x+=e.velocity.x,e.point.y+=e.velocity.y}function P(e,t,a){return e+(t-e)*a}function D(e,t,a){return{x:P(e.x,t.x,a),y:P(e.y,t.y,a),z:P(e.z,t.z,a)}}function T(e){var t=Math.round(e.x),a=Math.round(e.y),n=Math.round(e.z),i=Math.abs(t-e.x),r=Math.abs(a-e.y),s=Math.abs(n-e.z);return i>r&&i>s?t=-a-n:r>s?a=-t-n:n=-t-a,{x:t,y:a,z:n}}function I(e){var t=e.x,a=e.z;return new x(t,a)}function A(e){return{x:e.q,z:e.r,y:-e.q-e.r}}function H(e,t){for(var a=function(e,t){return(Math.abs(e.x-t.x)+Math.abs(e.y-t.y)+Math.abs(e.z-t.z))/2}(e,t),n=[],i=0;i<=a;i++)n.push(I(T(D(e,t,1/a*i))));return n}var F=new function e(t,a,n,i,r,s,l,c,u){Object(o.a)(this,e),this.f0=t,this.f1=a,this.f2=n,this.f3=i,this.b0=r,this.b1=s,this.b2=l,this.b3=c,this.start_angle=u}(1.5,0,Math.sqrt(3)/2,Math.sqrt(3),2/3,0,-1/3,Math.sqrt(3)/3,0),L={x:0,y:0};function R(e,t,a){var n=F,i=(n.f0*a.q+n.f1*a.r)*e.x,r=(n.f2*a.q+n.f3*a.r)*e.y;return{x:i+t.x,y:r+t.y}}function q(e){return{x:e.r*Math.cos(e.az),y:e.r*Math.sin(e.az)}}function z(e,t,a){var n=e.byType[t].coordByID[a];return n?G(R(e.hex_size,e.petriOrigin,n)):{background:"red"}}function G(e){return{transform:"translate(".concat(e.x,"px, ").concat(e.y,"px)")}}var W,V=function(){function e(){Object(o.a)(this,e),this.key=0,this.type="farm",this.occupied_slots=[],this.empty_slots=[],this.upgraded=!1,this.job_slots={0:null,1:null,2:null,3:null,4:null,5:null}}return Object(l.a)(e,[{key:"openSlots",value:function(){var e=this;return Object.keys(this.job_slots).filter((function(t,a){return null===e.job_slots[+t]&&(a<3||e.upgraded)})).map((function(e){return+e}))}},{key:"usedSlots",value:function(){var e=this;return Object.keys(this.job_slots).filter((function(t){return null!=e.job_slots[+t]})).map((function(e){return+e}))}},{key:"tryFreeBean",value:function(e){for(var t=this.usedSlots(),a=0;a<t.length;a++){var n=t[a];if(this.job_slots[n]===e)return this.job_slots[n]=null,!0}return!1}}]),e}(),K={farm:"\ud83d\udc04",house:"\ud83c\udfe1",hospital:"\ud83c\udfe5",church:"\u26ea",theater:"\ud83c\udfaa",courthouse:"\ud83c\udfeb",park:"\u26f2\ufe0f",nature:"\ud83c\udfde\ufe0f"},U={farm:"\ud83d\ude9c",house:"\ud83c\udfd8\ufe0f",hospital:"\ud83c\udfd9\ufe0f",church:"\u26ea",theater:"\ud83c\udfdf\ufe0f",courthouse:"\ud83c\udfeb",park:"\ud83c\udfa1",nature:"\ud83c\udfde\ufe0f"},J={farm:"\ud83c\udf3e",house:"\ud83d\udcea",hospital:"\ud83d\udecf\ufe0f",church:"\u26ea",theater:"\ud83e\ude91",courthouse:"\ud83c\udfeb",park:"\ud83d\udc90",nature:"\u2668\ufe0f"},$={food:"farm",shelter:"house",medicine:"hospital",fun:"theater"},X={farmer:"farm",builder:"house",doc:"hospital",entertainer:"theater",cleric:"church",jobless:"house",polit:"house"},Y=function(){function e(){Object(o.a)(this,e),this.byCoord={},this.byType={house:{coordByID:{},all:[]},farm:{coordByID:{},all:[]},hospital:{coordByID:{},all:[]},theater:{coordByID:{},all:[]},courthouse:{coordByID:{},all:[]},church:{coordByID:{},all:[]},park:{coordByID:{},all:[]},nature:{coordByID:{},all:[]}},this.movers={bean:{},ufo:{},pickup:{}},this.numberOfRings=5,this.hexes=function(e,t){for(var a=[e],n=0;n<t;n++)a=a.concat(O(e,n));return a}({q:0,r:0},this.numberOfRings),this.hex_size={x:70,y:70},this.petriRadius=550,this.petriOrigin={x:this.petriRadius,y:this.petriRadius}}return Object(l.a)(e,[{key:"numberOf",value:function(e){return this.byType[e].all.length}},{key:"lookupBuilding",value:function(e){return this.byCoord[e.q+","+e.r]}},{key:"addBuilding",value:function(e,t){return this.byType[t.type].all.push(t),this.byType[t.type].coordByID[t.key]=e,this.byCoord[e.q+","+e.r]=t,null}},{key:"removeBuilding",value:function(e,t){var a=this.byType[t.type].all.indexOf(t);return this.byType[t.type].all.splice(a,1),delete this.byType[t.type].coordByID[t.key],this.byCoord[e.q+","+e.r]=void 0,null}}]),e}();!function(e){e[e.first=0]="first",e[e.second=1]="second",e[e.third=2]="third",e[e.fourth=3]="fourth",e[e.fifth=4]="fifth",e[e.sixth=5]="sixth"}(W||(W={}));a(24);var Q={x:25,y:25};function Z(e){return R(Q,L,e)}var ee={2:W.first,0:W.second,4:W.third,1:W.fourth,5:W.fifth,3:W.sixth},te=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"slots",value:function(){var e=this;return C.map((function(t,a){var n=ee[a],r=null!=e.props.building.job_slots[n];return i.a.createElement("span",{key:a,className:"slot",style:G(Z(t))},r?J[e.props.building.type]:null)}))}},{key:"render",value:function(){return i.a.createElement("div",{key:this.props.building.type+this.props.building.key,style:z(this.props.city,this.props.building.type,this.props.building.key),className:"building "+this.props.building.type},this.props.building.upgraded?U[this.props.building.type]:K[this.props.building.type],this.slots(),"courthouse"===this.props.building.type?i.a.createElement("span",{className:"tile-label"},this.props.city.name):null)}}]),a}(i.a.Component),ae=function e(t,a){Object(o.a)(this,e),this.value=t,this.priority=a},ne=function(){function e(t){Object(o.a)(this,e),this.values=[],this.values=t}return Object(l.a)(e,[{key:"enqueue",value:function(e){this.values.push(e),this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"enqueueMany",value:function(e){this.values=e,this.values=this.values.sort((function(e,t){return e.priority-t.priority}))}},{key:"dequeue",value:function(){return this.values.shift()}}]),e}(),ie=function(){function e(t){Object(o.a)(this,e),this.values=[],this.values=t}return Object(l.a)(e,[{key:"swap",value:function(e,t){var a=this.values[e];return this.values[e]=this.values[t],this.values[t]=a,this.values}},{key:"bubbleUp",value:function(){for(var e=this.values.length-1;e>0;){var t=Math.floor((e-1)/2);if(!(this.values[t].priority>this.values[e].priority))break;this.swap(e,t),e=t}return 0}},{key:"enqueue",value:function(e){return this.values.push(e),this.bubbleUp(),this.values}},{key:"bubbleDown",value:function(){for(var e=0,t=this.values.length,a=this.values[0].priority;;){var n=2*e+1,i=2*e+2,r=999,s=void 0,o=null;if(n<t&&(r=this.values[n].priority)<a&&(o=n),i<t&&((s=this.values[i].priority)<a&&null===o||s<r&&null!==o)&&(o=i),null===o)break;this.swap(e,o),e=o}}},{key:"dequeue",value:function(){this.swap(0,this.values.length-1);var e=this.values.pop();return this.values.length>1&&this.bubbleDown(),e}}]),e}();var re=function(){function e(t){Object(o.a)(this,e),this.data=t}return Object(l.a)(e,[{key:"enter",value:function(e){this.data.elapsed=0}},{key:"act",value:function(e,t,a){var n=this._act(e,t,a);return this.data.elapsed=this.Elapsed+t,n}},{key:"exit",value:function(e){}},{key:"Elapsed",get:function(){return this.data.elapsed||0}},{key:"display",get:function(){return function(e){var t;switch(e.act){case"chat":return"chatting";case"crime":return"commiting crime";case"relax":return"relaxing";case"travel":return"travelling to "+(null===(t=e.intent)||void 0===t?void 0:t.act)||!1;case"work":return e.good?"working to make "+ut[e.good]:"working";case"buy":return"shelter"==e.good?"sleeping \ud83d\ude34":e.good?"buying "+ut[e.good]:"buying"}return""}(this.data)}}]),e}(),se=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,n){if(this.Elapsed<200)return this;if(e instanceof _e&&e.city)for(var i=ge(e,n),r=i.dequeue(),s=null;r&&null==s;){if(a.substituteIntent(e,r.value)&&null!=(s=oe.createFromIntent(e,r.value)))return s;r=i.dequeue()}return this}},{key:"exit",value:function(e){Object(E.a)(Object(k.a)(a.prototype),"exit",this).call(this,e),e instanceof _e&&e.maybeParanoid()}}],[{key:"create",value:function(){return new a({act:"idle"})}},{key:"substituteIntent",value:function(e,t){if("buy"===t.act&&null!=t.good&&e instanceof _e){var a=e.canBuy(t.good);if("yes"!=a&&"fun"===t.good)t.act="relax";else if("pricedout"===a){if(!(e instanceof _e&&e.maybeCrime(t.good)))return null;t.act="crime"}else if("nosupply"===a)return null}return t}}]),a}(re);var oe=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,a){var n=this;if(e instanceof _e&&e.city&&this.data.destinations&&this.data.destinations.length){var i=e.city.movers.bean[e.key],r=this.data.destinations[0],s=_(i,r,t/1e3*e.speed);e.city.movers.bean[e.key]=s,s.x==r.x&&s.y==r.y&&(this.data.location=s,this.data.destinations.shift())}if(null==this.data.destinations||0===this.data.destinations.length)return this.data.intent?me[this.data.intent.act](this.data.intent):se.create();if(e instanceof _e&&e.city){var o=e.city.getNearestNeighbors(e);if(o.length&&e.maybeChat()){var l=o.filter((function(e){return e.maybeChat()}));if(l.length<1)return this;var c=e.getRandomChat(l);return l.forEach((function(e){return e.state=ue.create(n.data.intent,Object(g.a)(Object(g.a)({},c),{},{participation:"listener"}))})),ue.create(this.data,c)}return this}return this}}],[{key:"createFromIntent",value:function(e,t){var a=function(e,t){if(!(e instanceof _e))return[];if(e.city){var a=e.city;switch(t.act){case"buy":if(t.good)return Ee(a,e,$[t.good]);case"work":return Ee(a,e,X[e.job]);case"relax":var n=kt(a.byType.park.all.concat(a.byType.nature.all));return e.destinationKey=n.key,ke(a,e,n)}}return[]}(e,t);return a?this.createFromDestination(a,t):null}},{key:"createFromDestination",value:function(e,t){return new a({act:"travel",destinations:e,intent:t})}}]),a}(re),le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,a){var n,i;return this.Elapsed>2e3&&e instanceof _e&&this.data.good&&(null===(n=e.city)||void 0===n?void 0:n.economy)&&(null===(i=e.city)||void 0===i?void 0:i.law)?(e.work(e.city.law,e.city.economy),se.create()):this}}],[{key:"create",value:function(e){return new a({act:"work",good:e})}}]),a}(re),ce=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).sinceLastAttemptMS=0,e.attempts=0,e._bought=!1,e}return Object(l.a)(a,[{key:"tryBuy",value:function(e){var t;e instanceof _e&&this.data.good&&(null===(t=e.city)||void 0===t?void 0:t.economy)&&(this._bought=e.buy[this.data.good](e.city.economy)),this.sinceLastAttemptMS=0,this.attempts++}},{key:"enter",value:function(e){this.tryBuy(e)}},{key:"_act",value:function(e,t,a){return this._bought||this.sinceLastAttemptMS>250&&this.tryBuy(e),this.Elapsed>1500?se.create():this}}],[{key:"create",value:function(e){return new a({act:"buy",good:e})}}]),a}(re),ue=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,a){if(this.Elapsed>1e3&&this.data.intent){var n=oe.createFromIntent(e,this.data.intent);if(n)return n}return this}},{key:"exit",value:function(e){e instanceof _e&&this.data.chat&&(e.lastChatMS=Date.now(),"listener"===this.data.chat.participation&&("bully"===this.data.chat.type?e.maybeAntagonised():"praise"===this.data.chat.type&&e.maybeEnthused()))}}],[{key:"create",value:function(e,t){return new a({act:"chat",intent:e,chat:t})}}]),a}(re),he=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,a){var n=1e3;return e instanceof _e&&e.believesIn("Naturalism")&&(n*=3),this.Elapsed>n?se.create():this}},{key:"exit",value:function(e){e instanceof _e&&(e.discrete_fun+=1,e.emote("happiness"),e.believesIn("Naturalism")&&e.emote("happiness"))}}],[{key:"create",value:function(e,t){return new a({act:"relax",intent:e,chat:t})}}]),a}(re),de=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"_act",value:function(e,t,a){var n,i;return this.Elapsed>1500&&e instanceof _e&&(null===(n=e.city)||void 0===n?void 0:n.economy)&&("food"===this.data.good||"medicine"===this.data.good)?(e.steal(this.data.good,null===(i=e.city)||void 0===i?void 0:i.economy),se.create()):this}}],[{key:"create",value:function(e){return new a({act:"crime",good:e})}}]),a}(re),me={idle:function(e){return new se(e)},work:function(e){return new le(e)},chat:function(e){return new ue(e)},travel:function(e){return new oe(e)},craze:function(e){return new ce(e)},buy:function(e){return new ce(e)},sleep:function(e){return new ce(e)},soapbox:function(e){return new ce(e)},crime:function(e){return new de(e)},relax:function(e){return new he(e)}},pe=function(e){if("jobless"==e.job&&e.city)return 9;if(e.city){var t,a=99;if(e.city.economy)a=(null===(t=e.city.economy.market.getBeansListings(e.cityKey,e.key,ct(e.job)))||void 0===t?void 0:t.quantity)||0;var n=e.cash/e.city.costOfLiving/2;return Math.min(a,n)}return 0},fe=function(e,t){return.5+e.discrete_food/t.bean_life.vital_thresh.food.sufficient},ye=function(e,t){return 1+e.discrete_stamina/t.bean_life.vital_thresh.shelter.sufficient},be=function(e,t){return.75+e.discrete_health/t.bean_life.vital_thresh.medicine.sufficient},ve=function(e,t){return 2+e.lastHappiness/100*1.25};function ge(e,t){var a=new ne([]),n=new ae({act:"work",good:ct(e.job)},pe(e));return a.enqueue(n),n=new ae({act:"buy",good:"food"},fe(e,t)),a.enqueue(n),n=new ae({act:"buy",good:"shelter"},ye(e,t)),a.enqueue(n),n=new ae({act:"buy",good:"medicine"},be(e,t)),a.enqueue(n),n=new ae({act:"buy",good:"fun"},ve(e,t)),a.enqueue(n),a}function Ee(e,t,a){var n=kt(e.byType[a].all);return void 0===n?null:(t.destinationKey=n.key,ke(e,t,n))}function ke(e,t,a){var n,i,r=e.byType[a.type].coordByID[a.key],s=e.movers.bean[t.key],o=function(e,t,a){var n=F,i=(a.x-t.x)/e.x,r=(a.y-t.y)/e.y,s=n.b0*i+n.b1*r,o=n.b2*i+n.b3*r;return new x(s,o)}(e.hex_size,e.petriOrigin,s);return(n=o,i=r,H(A(n),A(i))).map((function(t){return R(e.hex_size,e.petriOrigin,t)})).map((function(e,t,a){if(t===a.length-1){var n=Z(kt(C));return{x:e.x+n.x,y:e.y+n.y}}return e}))}var we={prog:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"Strives to help others"},trad:{noun:"Elitism",adj:"Elitist",icon:"\ud83d\udc51",description:"Strives for individual power"},state:{noun:"Collectivism",adj:"Collectivist",icon:"\ud83d\udd4a\ufe0f",description:"Trusts in the social group"},ego:{noun:"Independence",adj:"Independent",icon:"\ud83e\udd85",description:"Trusts only in oneself"}},je={rocket:{noun:"Futurism",adj:"Futuristic",icon:"\ud83d\ude80",description:"Loves stories of the far future"},dragon:{noun:"Mythology",adj:"Mythical",icon:"\ud83d\udc32",description:"Loves stories of the legendary past"},music:{noun:"Drama",adj:"Dramatic",icon:"\ud83c\udfb5",description:"Loves stories of emotional bonding"},noFaith:{noun:"Nihilism",adj:"Nihilist",icon:"\u26ab\ufe0f",description:"Hates fairy tales"}},xe={Diligence:{noun:"Diligence",adj:"Diligence",icon:"\ud83d\udcaa",description:"\ud83c\udfb2 to \ud83d\udc4d while working"},Natalism:{noun:"Natalism",adj:"Natalist",icon:"\ud83d\udc76",description:"Extra \ud83c\udfb2 for \ud83d\udc76"},Charity:{noun:"Charity",adj:"Charitable",icon:"\ud83d\ude07",description:"\ud83c\udfb2 to gift \ud83d\udcb0 to the penniless"},Progressivism:{noun:"Progressivism",adj:"Progressive",icon:"\u2696\ufe0f",description:"\ud83c\udfb2 to \ud83d\udc4d when paying taxes"},Libertarianism:{noun:"Libertarianism",adj:"Libertarian",icon:"\ud83d\udd2b",description:"\ud83c\udfb2 to \ud83d\udc4e when paying taxes"},Parochialism:{noun:"Parochialism",adj:"Parochial",icon:"\ud83d\udc2e",description:"Extra \ud83d\udc4d working \ud83c\udf3e; \ud83d\udc4e from dense houses"},Cosmopolitanism:{noun:"Cosmopolitanism",adj:"Cosmopolitan",icon:"\ud83c\udf78",description:"Extra \ud83d\udc4d working \ud83c\udfbb; \ud83d\udc4e from rural houses"},Capitalism:{noun:"Capitalism",adj:"Capitalist",icon:"\ud83c\udfa9",description:"\ud83d\udc4e working in co-ops and communes"},Socialism:{noun:"Socialism",adj:"Socialist",icon:"\ud83e\udd1d",description:"Extra \ud83d\udc4d working in co-ops"},Communism:{noun:"Communism",adj:"Communist",icon:"\u2692\ufe0f",description:"\ud83d\udc4e working in companies"},Naturalism:{noun:"Naturalism",adj:"Naturalist",icon:"\ud83d\udef6",description:"Extra \ud83d\udc4d from \ud83d\ude0e; \ud83d\ude0e 3x longer"},Hedonism:{noun:"Hedonism",adj:"Hedonistic",icon:"\ud83d\udc8b",description:"\ud83c\udfb2 to emote extra \ud83d\udc4d;\ud83c\udfb2 to \ud83d\udc4e when working;"},Gluttony:{noun:"Gluttony",adj:"Glutton",icon:"\ud83c\udf83",description:"Extra \ud83d\udc4d when stuffed; Extra \ud83d\udc4e when hungry;"},Paranoia:{noun:"Paranoia",adj:"Paranoid",icon:"\ud83d\udc7d",description:"\ud83c\udfb2 to \ud83d\udc4e at any time"},Authority:{noun:"Authority",adj:"Authoritarian",icon:"\ud83d\udc62",description:"Less \ud83c\udfb2 for all \ud83d\ude08 Crime"},Anarchism:{noun:"Anarchism",adj:"Anarchist",icon:"\ud83d\udd95",description:"Extra \ud83c\udfb2 for all \ud83d\ude08 Crime"},Greed:{noun:"Greed",adj:"Greedy",icon:"\ud83e\udd11",description:"Extra \ud83c\udfb2 for theft \ud83d\ude08 Crime; Extra \ud83d\udc4d when rich"},Gossip:{noun:"Gossip",adj:"Gossipy",icon:"\ud83d\udcde",description:"Extra \ud83c\udfb2 to start a \ud83d\udde3\ufe0f"},Antagonism:{noun:"Antagonism",adj:"Antagonistic",icon:"\ud83e\udd2c",description:"\ud83c\udfb2 to spread \ud83d\udc4e in a \ud83d\udde3\ufe0f"},Enthusiasm:{noun:"Enthusiasm",adj:"Enthusiastic",icon:"\ud83e\udd73",description:"\ud83c\udfb2 to spread \ud83d\udc4d in a \ud83d\udde3\ufe0f"},Neuroticism:{noun:"Neuroticism",adj:"Neurotic",icon:"\ud83d\ude31",description:"+100% \ud83e\udde0 damage",idealCon:["state"],idealPro:["ego"]},Dogmatism:{noun:"Dogmatism",adj:"Dogmatic",icon:"\ud83d\udc36",description:"Cannot change beliefs",idealCon:["ego"],idealPro:["state"]}};function Ce(e,t,a){var n=xe[e];return null!=n.idealCon&&n.idealCon.reduce((function(e,n){return e||function(e,t,a){switch(e){case"trad":case"prog":return e==t;case"state":case"ego":return e==a}}(n,t,a)}),!1)}var Se,Ne,Oe=Object.keys(xe).map((function(e){return e})),_e=function(){function e(){var t=this;Object(o.a)(this,e),this.key=0,this.cityKey=0,this.dob={year:0,season:0,day:1,hour:0},this.bornInPetri=!1,this.name="Human Bean",this.sanity="sane",this.discrete_sanity=10,this.discrete_fun=0,this.lifecycle="alive",this.activity_queue=[],this.speed=60,this.direction={x:0,y:0},this.markers=[],this.destinationKey=0,this.city=null,this.ethnicity=kt(["circle","square","triangle"]),this.discrete_food=1,this.shelter="crowded",this.discrete_health=2,this.community="ego",this.ideals="trad",this.job="jobless",this.buildingKey=void 0,this.faith="noFaith",this.beliefs=[],this.cash=3,this.partyLoyalty=.2,this.lastHappiness=0,this.lastSentiment=0,this.lastPartySentiment=0,this.ticksSinceLastSale=0,this.ticksSinceLastRelax=0,this.ticksSinceLastEmote=0,this.discrete_stamina=7,this.fairGoodPrice=1,this.lastChatMS=Date.now(),this.buy={food:function(e){return null!=t.buyFood(e)},medicine:function(e){return null!=t.buyMeds(e)},fun:function(e){return t.buyFun(e)},shelter:function(e){return t.buyHousing(e)}},this.state=se.create(),this.jobQueue=new ie([]),this.onAct=new m}return Object(l.a)(e,[{key:"believesIn",value:function(e){return-1!==this.beliefs.indexOf(e)}},{key:"loseSanity",value:function(e){var t=this.believesIn("Neuroticism")?2:1;this.discrete_sanity-=t*e}},{key:"getHappinessModifiers",value:function(e,t,a){var n,i=this,r=[ot[this.food],ot[this.shelter],ot[this.health],{reason:"Entertainment",mod:.4*this.discrete_fun}];return"trad"===this.ideals&&this.ethnicity!=t.majorityEthnicity&&r.push({reason:"Xenophobic",mod:-.1}),"ego"===this.community&&"jobless"!=this.job&&(null===(n=t.byType[X[this.job]].all.find((function(e){return e.key===i.buildingKey})))||void 0===n?void 0:n.upgraded)&&r.push({reason:"Hates Building Density",mod:-.1}),this.cash<1?r.push({reason:"Penniless",mod:Ke.Deficient}):this.cash>3*e.getCostOfLiving()?r.push({reason:"Upper Class",mod:.3}):this.cash>2*e.getCostOfLiving()&&r.push({reason:"Middle Class",mod:.15}),"jobless"===this.job&&r.push({reason:"Unemployed",mod:Ke.Deficient}),r}},{key:"getSentimentModifiers",value:function(e,t,a,n){var i={party:[],law:[]};return this.community===n.community&&i.party.push({reason:"Same Community",mod:.15}),this.ideals===n.ideals?i.party.push({reason:"Same Ideals",mod:.15}):this.community!=n.community&&i.party.push({reason:"Incompatible Values",mod:-.15}),i}},{key:"calculateBeliefs",value:function(e,t,a,n){this.lastHappiness=st(this.getHappinessModifiers(e,t,a));var i=this.getSentimentModifiers(e,t,a,n);if(this.lastSentiment=st(i.law),this.lastPartySentiment=st(i.party),"jobless"===this.job)this.fairGoodPrice=1;else{var r=ct(this.job);this.fairGoodPrice=e.getFairGoodPrice(r)}}},{key:"getSentimentPolicies",value:function(e,t){var a=100;return t.forEach((function(t){t.fx.forEach((function(t){e[t.key]&&(a+=10*t.mag)}))})),a/100}},{key:"_getTraitMap",value:function(){var e,t=(e={},Object(h.a)(e,this.community,!0),Object(h.a)(e,this.ideals,!0),Object(h.a)(e,this.ethnicity,!0),e);return"noFaith"!=this.faith&&(t[this.faith]=!0),t}},{key:"getFace",value:function(){var e,t;if("buy"===this.state.data.act&&"shelter"===this.state.data.good)return"\ud83d\ude34";if("crime"===this.state.data.act)return"\ud83d\ude08";if("relax"===this.state.data.act)return"\ud83d\ude0e";if("chat"===this.state.data.act){var a;if("speaker"===(null===(a=this.state.data.chat)||void 0===a?void 0:a.participation))switch(null===(e=this.state.data)||void 0===e||null===(t=e.chat)||void 0===t?void 0:t.type){default:return"\ud83d\ude03";case"gift":return"\ud83d\ude07";case"praise":return"\ud83e\udd73";case"bully":return"\ud83d\ude08"}return"\ud83e\udd28"}return"hungry"===this.food?"\ud83d\ude2b":"sick"===this.health?"\ud83e\udd22":"podless"===this.shelter?"\ud83e\udd76":"jobless"===this.job?"\ud83d\ude27":this.lastHappiness<0?"\u2639\ufe0f":this.lastHappiness>=50?"\ud83d\ude42":"\ud83d\ude10"}},{key:"getIdea",value:function(e){return"hungry"===this.food?{bad:!0,idea:"\ud83c\udf57"}:"sick"===this.health?{bad:!0,idea:"\ud83d\udc8a"}:"podless"===this.shelter?{bad:!0,idea:"\ud83c\udfe0"}:this.canBaby(e)?{bad:!1,idea:"\ud83d\udc76"}:null}},{key:"getSpeech",value:function(){var e;if("chat"===this.state.data.act&&("speaker"===(null===(e=this.state.data.chat)||void 0===e?void 0:e.participation)&&this.state.data.chat.preachBelief))return"\ud83d\udcac"+xe[this.state.data.chat.preachBelief].icon}},{key:"getCrimeDecision",value:function(e,t){var a=Math.random(),n=.05;return"ego"===this.community&&(n+=.1),("desperation"===t&&"sick"===this.health||"hungry"===this.food)&&(n+=.15),n<=a}},{key:"tryFindRandomJob",value:function(e){var t,a,n=kt(["builder","doc","farmer","entertainer"]);this.trySetJob(n)||(null===(t=this.city)||void 0===t||null===(a=t.eventBus)||void 0===a||a.nojobslots.publish({icon:"\ud83c\udfda\ufe0f",trigger:"nojobslots",message:"A subject cannot find a job; build or upgrade more buildings."}))}},{key:"trySetJob",value:function(e){var t;return!!(null===(t=this.city)||void 0===t?void 0:t.tryGetJob(this,e))&&(this.city.unsetJob(this),this.job=e,!0)}},{key:"tryPurchase",value:function(e){return void 0===e.sanity||this.discrete_sanity>=e.sanity}},{key:"maybeParanoid",value:function(){this.believesIn("Paranoia")&&Math.random()<.05&&this.emote("unhappiness")}},{key:"maybeAntagonised",value:function(){this.emote("unhappiness")}},{key:"maybeEnthused",value:function(){this.emote("happiness")}},{key:"maybeChat",value:function(){if(this.lastChatMS+4e3>Date.now())return!1;if("chat"===this.state.data.act)return!1;var e=Math.random(),t="state"===this.community?.2:.1;return this.believesIn("Gossip")&&(t+=.25),e<t}},{key:"getRandomChat",value:function(e){var t=this;if(this.beliefs.length){if(this.believesIn("Charity")&&this.cash>=2){var a=e.filter((function(e){return e.cash<=t.cash-1})).reduce((function(e,t){return null==e||t.cash<e.cash?t:e}),null);if(a)return this.cash-=.5,a.cash+=.5,{participation:"speaker",type:"gift",targetBeanKey:a.key}}else{if(this.believesIn("Enthusiasm")&&Math.random()<.45)return{participation:"speaker",type:"praise",preachBelief:"Enthusiasm"};if(this.believesIn("Antagonism")&&Math.random()<.45)return{participation:"speaker",type:"bully",preachBelief:"Antagonism"}}return{participation:"speaker",type:"preach",preachBelief:kt(this.beliefs)}}return{participation:"speaker",type:"praise"}}},{key:"work",value:function(e,t){var a=this;if("jobless"===this.job);else{switch(this.job){case"farmer":this.discrete_food=Math.min(this.discrete_food+1,2*lt.food.sufficient),this.believesIn("Parochialism")&&Math.random()<=.25&&this.emote("happiness");break;case"doc":this.discrete_health=Math.min(this.discrete_health+1,2*lt.medicine.sufficient);break;case"builder":this.shelter="crowded",this.discrete_stamina=7;break;case"entertainer":this.believesIn("Cosmopolitanism")&&Math.random()<=.25&&this.emote("happiness")}if(this.believesIn("Diligence")&&Math.random()<=.25&&this.emote("happiness"),this.believesIn("Hedonism")&&Math.random()<=.15&&this.emote("unhappiness"),this.ticksSinceLastSale++,this.ticksSinceLastSale>7)if(!!this.city&&this.city.beans.filter((function(e){return e.job===a.job})).length>1&&Math.random()>.5){var n=t.mostInDemandJob();n&&this.trySetJob(n)}t.produceAndPrice(this,ct(this.job),4,this.fairGoodPrice)}}},{key:"buyFood",value:function(e){var t=e.tryTransact(this,"food",.5,3);return t&&(this.discrete_food+=t.bought),"stuffed"===this.food&&(this.emote("happiness"),this.believesIn("Gluttony")&&this.emote("happiness")),t}},{key:"steal",value:function(e,t){var a=t.steal(e,3);if(null!=a)switch(e){case"food":this.discrete_food+=a;break;case"medicine":this.discrete_health+=a}}},{key:"buyHousing",value:function(e){var t=e.tryTransact(this,"shelter");return t?(this.discrete_stamina=10,this.shelter="crowded"):this.discrete_stamina<=0&&(this.shelter="podless"),null!=t}},{key:"buyFun",value:function(e){var t=e.tryTransact(this,"fun");return t&&(this.discrete_fun=1,this.emote("happiness")),null!=t}},{key:"age",value:function(e){if(!this.alive)return null;var t="hungry"!==this.food,a="sick"!==this.health;return this.discrete_food-=1/7,this.discrete_food<0&&(this.discrete_health-=.2),this.maybeDie("starvation",.6)?null:("hungry"===this.food&&t&&(this.emote("unhappiness"),this.believesIn("Gluttony")&&(this.emote("unhappiness"),this.emote("unhappiness"))),"podless"===this.shelter&&(this.discrete_health-=1/14),this.discrete_stamina--,this.maybeDie("exposure",.2)||(this.discrete_health-=.05,this.discrete_health=Math.min(this.discrete_health,3),this.maybeDie("sickness",.4)||("sick"===this.health&&a&&this.emote("unhappiness"),this.discrete_fun-=.1,this.discrete_fun=Math.max(0,this.discrete_fun))),null)}},{key:"buyMeds",value:function(e){var t=e.tryTransact(this,"medicine",.5,3);return t&&(this.discrete_health+=t.bought),"fresh"===this.health&&this.emote("happiness"),t}},{key:"maybeBaby",value:function(e){if(this.canBaby(e.getCostOfLiving())&&Math.random()<=this.babyChance){if(!this.city)throw"bean does not have city object";return this.city.breedBean(this),{icon:"\ud83c\udf89",trigger:"birth",message:"".concat(this.name," has a baby!")}}return null}},{key:"canBaby",value:function(e){return this.alive&&this.cash>3*e&&!this.isInCrisis}},{key:"maybeEmote",value:function(){if("alive"===this.lifecycle){if(Math.random()<this.unhappyChance)return"unhappiness";if(Math.random()<this.happyChance)return"happiness"}return null}},{key:"maybeCrime",value:function(e){if("shelter"===e)return!1;if("fun"===e)return!1;var t=Math.random(),a=.05;return"ego"===this.community&&(a+=.1),this.isInCrisis&&(a+=.1),this.believesIn("Greed")&&(a+=.25),this.believesIn("Anarchism")&&(a+=.33),this.believesIn("Authority")&&(a-=.25),("food"===e&&"hungry"===this.food||"medicine"===e&&"sick"===this.health)&&(a+=.25),a<=t}},{key:"emote",value:function(e){var t,a;(this.ticksSinceLastEmote=0,this.discrete_sanity=j(this.discrete_sanity+mt[e],0,10),null===(t=this.city)||void 0===t||t.addEmotePickup(this.key,e),this.believesIn("Hedonism")&&("happiness"===e||"love"===e)&&Math.random()<.1)&&(null===(a=this.city)||void 0===a||a.addEmotePickup(this.key,e))}},{key:"canBuy",value:function(e){var t,a;return(null===(t=this.city)||void 0===t||null===(a=t.economy)||void 0===a?void 0:a.canBuy(this,e))||"nosupply"}},{key:"chanceToDonate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.cash>2*e.getCostOfLiving()&&!this.isInCrisis;if(a&&this.lastPartySentiment>.5){var n=t?.2:.5,i=this.lastPartySentiment-n;return i/2}return 0}},{key:"maybeDonate",value:function(e){return 0}},{key:"maybeDie",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return this.discrete_health<0&&Math.random()<=t&&(this.die(e),!0)}},{key:"die",value:function(e){var t,a,n;this.alive=!1;for(var i=Et(2,3),r=0;r<i;r++)this.emote("hate");null===(t=this.city)||void 0===t||null===(a=t.eventBus)||void 0===a||a.death.publish({icon:"\u2620\ufe0f",trigger:"death",message:"".concat(this.name," died of ").concat(e,"!"),beanKey:this.key,cityKey:this.cityKey,point:null===(n=this.city)||void 0===n?void 0:n.movers.bean[this.key]})}},{key:"abduct",value:function(e){this.lifecycle="abducted",e.abductedBeans.push(this)}},{key:"alive",get:function(){return"alive"===this.lifecycle},set:function(e){this.lifecycle=!0===e?"alive":"dead"}},{key:"food",get:function(){return this.discrete_food>=lt.food.abundant?"stuffed":this.discrete_food>=lt.food.sufficient?"sated":"hungry"}},{key:"health",get:function(){return this.discrete_health>=lt.medicine.abundant?"fresh":this.discrete_health>=lt.medicine.sufficient?"bruised":"sick"}},{key:"isInCrisis",get:function(){return"hungry"===this.food||"podless"===this.shelter||"sick"===this.health}},{key:"babyChance",get:function(){return this.believesIn("Natalism")?.16:.01}},{key:"unhappyChance",get:function(){var e=.01;return e-=Math.min(0,this.ticksSinceLastEmote/12),this.isInCrisis&&(e+=.1),e}},{key:"happyChance",get:function(){var e=.01;return(e-=Math.min(0,this.ticksSinceLastEmote/12))+this.lastHappiness/100/2}}]),e}(),Be=["food","shelter","medicine","fun"],Me=function(){function e(t){Object(o.a)(this,e),this.eventBus=t,this.market=new Pe,this.charity=new Pe,this.unfulfilledSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalSupply={food:0,shelter:0,medicine:0,fun:0}}return Object(l.a)(e,[{key:"resetSeasonalDemand",value:function(){this.unfulfilledSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalDemand={food:0,shelter:0,medicine:0,fun:0},this.totalSeasonalSupply={food:0,shelter:0,medicine:0,fun:0}}},{key:"tryTransact",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.totalSeasonalDemand[t]+=n;var i=this.market.getLowestPriceListing(t,a);if(null==i)return this.unfulfilledSeasonalDemand[t]+=n,null;var r=Math.min(i.quantity,n);return i.price<=e.cash*r?this.market.transact(i,t,r,e):(this.unfulfilledSeasonalDemand[t]+=r,null)}},{key:"canBuy",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.market.getLowestPriceListing(t,a);if(null==i)return"nosupply";var r=Math.min(i.quantity,n);return i.price<=e.cash*r?"yes":"pricedout"}},{key:"steal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=kt(this.market.listings[e]);if(null==a)return null;var n=Math.min(a.quantity,t);return this.market.subtractFromListing(a,e,n),n}},{key:"produceAndPrice",value:function(e,t,a,n){this.totalSeasonalSupply[t]+=a;var i=this.market.getBeansListings(e.cityKey,e.key,t);i?(i.quantity+=a,i.price=n,i.quantity=Math.min(i.quantity,6)):this.market.addNewListing(t,a,n,e),this.market.sort(t)}},{key:"addCharity",value:function(e,t,a){var n=this.charity.getOrgsListings(e,t);n?(n.quantity+=a,n.quantity=Math.min(n.quantity,10),e.inventory=n.quantity):(this.charity.addNewOrgListing(t,a,0,e),e.inventory=a)}},{key:"mostInDemandJob",value:function(){var e=this;return Be.reduce((function(t,a){return e.unfulfilledSeasonalDemand[a]>t.max&&(t.max=e.unfulfilledSeasonalDemand[a],t.job=function(e){switch(e){case"shelter":return"builder";case"medicine":return"doc";case"fun":return"entertainer";default:case"food":return"farmer"}}(a)),t}),{max:0,job:null}).job}},{key:"onBeanDie",value:function(e){var t=this;Be.forEach((function(a){var n=t.market.getBeansListings(e.cityKey,e.key,a);if(n){var i,r=null===(i=e.city)||void 0===i?void 0:i.getRandomCitizen();r&&(n.sellerCityKey=r.cityKey,n.sellerBeanKey=r.key,n.seller=r)}}))}},{key:"getFairGoodPrice",value:function(e){var t=this.totalSeasonalSupply[e]||1,a=this.totalSeasonalDemand[e];return.25+.75*Math.min(a/t,1)}},{key:"getCostOfLiving",value:function(){return this.getFairGoodPrice("food")+this.getFairGoodPrice("shelter")+this.getFairGoodPrice("medicine")}}]),e}(),Pe=function(){function e(){Object(o.a)(this,e),this.listings={food:[],shelter:[],medicine:[],fun:[]}}return Object(l.a)(e,[{key:"getLowestPriceListing",value:function(e,t){var a=this.listings[e].filter((function(e){return e.quantity>=t}));if(a.length>0){for(var n=1,i=a[0].price,r=1;r<a.length;r++){if(a[r].price>i)break;n++}var s=Math.floor(Math.random()*n);if(s>=a.length)throw"invalid index";return a[s]}return null}},{key:"getBeansListings",value:function(e,t,a){return this.listings[a].find((function(a){return a.sellerBeanKey==t&&a.sellerCityKey==e}))}},{key:"getOrgsListings",value:function(e,t){return this.listings[t].find((function(t){return t.sellerOrganizationKey==e.key}))}},{key:"transact",value:function(e,t,a,n){this.subtractFromListing(e,t,a);var i=e.price*a;return n.cash-=i,e.seller.cash+=i,e.seller.ticksSinceLastSale=0,{bought:a,price:i}}},{key:"subtractFromListing",value:function(e,t,a){e.quantity-=a,e.quantity<=0&&this.listings[t].splice(0,1)}},{key:"addNewListing",value:function(e,t,a,n){this.listings[e].push({sellerCityKey:n.cityKey,sellerBeanKey:n.key,price:a,seller:n,quantity:t})}},{key:"addNewOrgListing",value:function(e,t,a,n){this.listings[e].push({sellerOrganizationKey:n.key,price:a,seller:n,quantity:t})}},{key:"sort",value:function(e){this.listings[e].sort((function(e,t){return e.price-t.price}))}}]),e}(),De=function e(){Object(o.a)(this,e),this.key=1,this.playerKey=1,this.organizations=[],this.name="Citizen's Party",this.slogan="Vote for us!",this.community="state",this.ideals="trad",this.availablePolicies=[],this.proposedPolicy=void 0,this.availableCampaigns=[],this.activeCampaigns=[],this.leadership=10,this.activeHQs=[],this.platform={}},Te=function(){function e(){Object(o.a)(this,e),this.key=0,this.name="",this.institutionKey=1,this.cash=0,this.ticksSinceLastSale=0,this.seasonalBudget=0,this.good="food",this.parentInstitution=null,this.beansHelped=0,this.inventory=0}return Object(l.a)(e,[{key:"work",value:function(e,t){for(;this.cash>0&&this.inventory<10;){var a=t.tryTransact(this,this.good);if(!a)break;t.addCharity(this,this.good,a.bought)}}}]),e}();!function(e){e[e.Spring=0]="Spring",e[e.Summer=1]="Summer",e[e.Fall=2]="Fall",e[e.Winter=3]="Winter"}(Se||(Se={})),function(e){e[e.Midnight=0]="Midnight",e[e.Morning=1]="Morning",e[e.Noon=2]="Noon",e[e.Evening=3]="Evening"}(Ne||(Ne={}));var Ie={wel_food:{name:"Food Welfare"},wel_house:{name:"Housing Welfare"},wel_health:{name:"Healthcare"},tax_basic:{name:"Taxation"},tax_second:{name:"Advanced Taxation"},econ_sub:{name:"Subsidies"},cul_rel:{name:"Culture"},cul_theo:{name:"State Narrative"},crime_theo:{name:"Persecution"}},Ae={eat_cake:{key:"eat_cake",group:"Welfare",name:"Let Them Eat Cake",idealPro:["trad","ego"],axis:"wel_food",description:"Hungry Subjects must go without any relief.",hint:"No state solution for hunger"},food_bank:{key:"food_bank",group:"Welfare",name:"Food Bank",idealPro:["prog","ego"],axis:"wel_food",description:"Hungry Subjects are provided food purchased by the government."},food_stamps:{key:"food_stamps",group:"Welfare",name:"Food Stamps",idealPro:["trad","state"],axis:"wel_food",description:"Hungry Subjects are provided money by the government to purchase food."},univ_rations:{key:"univ_rations",group:"Welfare",name:"Universal Rations",idealPro:["prog","state"],axis:"wel_food",description:"All Subjects are provided small amounts of food from the government."},outside:{key:"outside",group:"Welfare",name:"Sleep Outside",idealPro:["trad","ego"],axis:"wel_house",description:"Homeless Subjects must sleep in the cold."},homeless_shelters:{key:"homeless_shelters",group:"Welfare",name:"Homeless Shelters",idealPro:["prog","ego"],axis:"wel_house",description:"Homeless Subjects are provided shelter purchased by the government."},housing_subsidy:{key:"housing_subsidy",group:"Welfare",name:"Housing Subsidy",idealPro:["trad","state"],axis:"wel_house",description:"Homeless Subjects are provided money by the government to purchase shelter."},state_apartments:{key:"state_apartments",group:"Welfare",name:"State Apartments",idealPro:["prog","state"],axis:"wel_house"},stay_healthy:{key:"stay_healthy",group:"Welfare",name:"Stay Healthy",idealPro:["trad","ego"],axis:"wel_health",description:"Sick Subjects must pay for their own medical care."},clinics:{key:"clinics",group:"Welfare",name:"Charity Clinics",idealPro:["prog","ego"],axis:"wel_health",description:"Sick Subjects are provided medicine purchased by the government."},medical_aid:{key:"medical_aid",group:"Welfare",name:"Medical Aid",idealPro:["trad","state"],axis:"wel_health",description:"Sick Subjects are provided money by the government to pay for medical care."},univ_health:{key:"univ_health",group:"Welfare",name:"Universal Healthcare",idealPro:["prog","state"],axis:"wel_health",description:"All Subjects are provided medical care by the government."},hands_off:{key:"hands_off",group:"Economics",name:"Laissez-faire",idealPro:["ego","trad"],axis:"econ_sub",description:"No industries receive subsidies."},grain_sub:{key:"grain_sub",group:"Economics",name:"Grain Subsidy",idealPro:["state"],axis:"econ_sub",description:"Farmers are provided money."},arts:{key:"arts",group:"Economics",name:"Arts Patronage",idealPro:["prog","ego"],axis:"econ_sub"},theocracy:{key:"theocracy",group:"Crime",name:"Illegal Narratives",idealPro:["trad","state"],axis:"crime_theo",description:"It is illegal for subjects to speak about other universal narratives."},secularism:{key:"secularism",group:"Culture",name:"Secularism",idealPro:["ego"],axis:"cul_theo",description:"The government does not endorse a particular universal narrative."},atheism:{key:"atheism",group:"Culture",name:"State Nihilism",axis:"cul_theo"},mythology:{key:"mythology",group:"Culture",name:"State Mythology \ud83d\udc32",idealPro:["trad"],axis:"cul_theo"},futurism:{key:"futurism",group:"Culture",name:"State Futurism \ud83d\ude80",idealPro:["prog"],axis:"cul_theo"},drama:{key:"drama",group:"Culture",name:"State Drama \ud83c\udfb5",idealPro:["state"],axis:"cul_theo"},poll_tax:{key:"poll_tax",group:"Taxation",name:"Poll Tax",idealPro:["trad","state"],axis:"tax_basic",description:"Subjects must pay a flat tax every month."},sales_tax:{key:"sales_tax",group:"Taxation",name:"Sales Tax",idealPro:["ego"],axis:"tax_basic",description:"Subjects must pay a percentage tax for every transaction."},wealth_tax:{key:"wealth_tax",group:"Taxation",name:"Wealth Tax",idealPro:["prog","state"],axis:"tax_basic",description:"Rich subjects must pay a percentage tax on their excess cash."},vice_tax:{key:"vice_tax",group:"Taxation",name:"Vice Tax",idealPro:["trad"],axis:"tax_second",description:"Entertainment goods have a flat tax."},prop_tax:{key:"prop_tax",group:"Taxation",name:"Property Tax",idealPro:["prog"],axis:"tax_second",description:"Subjects must pay a tax on housing."},death_tax:{key:"death_tax",group:"Taxation",name:"Death Tax",idealPro:["prog"],axis:"tax_second",description:"Dead subjects pay a portion of their cash to the government."}},He=function(){function e(){Object(o.a)(this,e),this.lawTree={}}return Object(l.a)(e,[{key:"getLawsByGroup",value:function(){return this.laws.reduce((function(e,t){return e[t.group].push(t),e}),{Taxation:[],Welfare:[],Economics:[],Crime:[],Culture:[]})}},{key:"laws",get:function(){return Object.values(this.lawTree)},set:function(e){var t=this;e.forEach((function(e){t.lawTree[e.axis]=e}))}}]),e}();function Fe(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=[];return e.energy&&n.push(t+e.energy*a+" Energy"),e.bots&&n.push(t+e.bots*a+" Bots"),e.hedons&&n.push(t+e.hedons*a+" Hedons"),e.tortrons&&n.push(t+e.tortrons*a+" Tortrons"),n.join(" ")}var Le={cost:{emptyHex:{build:{house:{energy:1,bots:3},farm:{energy:1,bots:3},theater:{energy:1,bots:4},hospital:{energy:1,bots:4},church:{energy:1,bots:4},courthouse:{energy:999,bots:999},park:{energy:1,bots:4},nature:{energy:1,bots:4}}},hex:{beam:{energy:3},upgrade:{energy:1,bots:4}},bean_brain:{brainwash_ideal:{sanity:4},brainimplant_secondary:{sanity:3},brainwash_secondary:{sanity:2}},bean:{scan:{energy:1},abduct:{bots:3},gift:{},empower:{},vaporize:{energy:2,bots:4},siphon:{}},market:{scrubHedons:{energy:5},resource:{bots:{hedons:6},energy:{hedons:5}},beliefs:{common:{},uncommon:{},rare:{}}}},bean_life:{vital_thresh:{food:{sufficient:1,abundant:3},shelter:{sufficient:1,abundant:3},medicine:{sufficient:1,abundant:3},fun:{sufficient:1,abundant:3}}},report_card_progression:[]},Re={found_utopia:{key:"found_utopia",text:"Found your Utopia",check:function(e){return"Goodplace"!=e.party.name}},build_house_n_farm:{key:"build_house_n_farm",text:"Build a house and farm",check:function(e){return e.cities[0].byType.house.all.length>0&&e.cities[0].byType.farm.all.length>0},reward:{energy:3,bots:3}},beam_3:{key:"beam_3",text:"Beam in 3 new beings",check:function(e){return e.beans.filter((function(e){return!e.bornInPetri})).length>=3+xt}},scan:{key:"scan",text:"Scan a Subject",check:function(e){return Object.keys(e.alien.scanned_bean).length>0}},set_policy:{key:"set_policy",text:"Set a Gov Policy",check:function(e){return!1}},brainwash:{key:"brainwash",text:"Brainwash a Subject",check:function(e){return!1}},"c+_grade":{key:"c+_grade",text:"Receive a C+ Grade",check:function(e){return!1}}},qe={GradeWorld:function(e){return{Happiness:Ge(e.beans,(function(e){return e.lastHappiness>-.2})),Prosperity:Ge(e.beans,(function(e){return"hungry"!=e.food})),Stability:Ge(e.beans,(function(e){return"sane"==e.sanity})),Dogma:ze(e.alien.speechcrimes[e.date.year]||0,10,10)}},RubricDescription:{Happiness:"Subjects are at least 20% happy",Prosperity:"Subjects are not hungry",Stability:"Subjects are all sane",Dogma:"Up to 10 Speechcrimes"}};function ze(e,t,a){return We(1-Math.min(1,Math.max(0,e-t)/a))}function Ge(e,t){return e.length<1?"F":We(e.filter(t).length/e.length)}function We(e){return e<.58?"F":e<.68?"D":e<.78?"C":e<.88?"B":"A"}var Ve={A:5,B:4,C:3,D:2,F:1};var Ke,Ue={halve_sanity:{tech:"halve_sanity",name:"Surgical Psychops",techPoints:30,description:"Brainwashing causes -1 \ud83e\udde0 sanity damage"},fast_resources:{tech:"fast_resources",name:"0 Dimensional Supersiphons",techPoints:30,description:"Faster \u26a1\ufe0f and \ud83e\udd16 accumulation"},trauma_nanobots:{tech:"trauma_nanobots",name:"Trauma Nanobots",techPoints:30,description:"Spend \ud83e\udd16 to stop Subject from dying"},fast_leadership:{tech:"fast_leadership",name:"Advanced Marketing",techPoints:30,description:"Faster \ud83d\uddf3\ufe0f Leadership accumulation"},neural_duplicator:{tech:"neural_duplicator",name:"Level 2 Neural Duplication",techPoints:30,description:"Copy Traits 1 additional time"}},Je=function(){function e(){Object(o.a)(this,e),this.scanned_bean={},this.seenBeliefs=new v(new Map),this.beliefInventory=new b([]),this.speechcrimes={},this.abductedBeans=[],this.energy={amount:29,income:2/30,change:new p},this.bots={amount:10,income:2/30,change:new p},this.hedons={amount:0,income:0,change:new p},this.tortrons={amount:0,income:0,change:new p},this.next_grade={year:1,season:3,day:1,hour:0},this.difficulty=Le,this.goals=["found_utopia","build_house_n_farm","beam_3","scan","brainwash","set_policy","c+_grade"],this.goalProgress={},this.pastReportCards=[],this.workingReportCard={Happiness:"D",Prosperity:"D",Stability:"D",Dogma:"D"},this.techProgress={},this.currentlyResearchingTech=void 0}return Object(l.a)(e,[{key:"canAfford",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(void 0==e.bots||this.bots.amount>=e.bots*t)&&(void 0==e.energy||this.energy.amount>=e.energy*t)&&(void 0==e.hedons||this.hedons.amount>=e.hedons*t)}},{key:"hasResearched",value:function(e){return null!=this.techProgress[e]&&this.techProgress[e].researchPoints>=Ue[e].techPoints}},{key:"purchase",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;e.bots&&(this.bots.amount-=e.bots*t,this.bots.change.publish({change:-e.bots*t})),e.energy&&(this.energy.amount-=e.energy*t,this.energy.change.publish({change:-e.energy*t})),e.hedons&&(this.hedons.amount-=e.hedons*t,this.hedons.change.publish({change:-e.hedons*t}))}},{key:"tryPurchase",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return!!this.canAfford(e,t)&&(this.purchase(e,t),!0)}},{key:"reward",value:function(e){e.bots&&(this.bots.amount+=e.bots,this.bots.change.publish({change:e.bots})),e.energy&&(this.energy.amount+=e.energy,this.energy.change.publish({change:e.energy})),e.hedons&&(this.hedons.amount+=e.hedons,this.hedons.change.publish({change:e.hedons}))}},{key:"checkGoals",value:function(e){for(var t=0;t<this.goals.length;t++){var a=this.goals[t];if(null==this.goalProgress[a]&&(this.goalProgress[a]={done:!1,step:0}),!this.goalProgress[a].done){var n=Re[a].check(e),i=Re[a].reward;this.goalProgress[a].done=n,n&&null!=i&&this.reward(i)}}}},{key:"checkReportCard",value:function(e){this.workingReportCard=qe.GradeWorld(e)}}]),e}(),$e="drop.mp3",Xe="ding_soft.mp3",Ye="ding_bad.wav",Qe=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(o.a)(this,e),this.file=t,this.volume=a,this.buffer=[]}return Object(l.a)(e,[{key:"play",value:function(){if(this.buffer.length>0&&this.buffer[0].ended){var e=this.buffer.shift();null===e||void 0===e||e.play(),e&&this.buffer.push(e)}else{var t=new Audio("/socsim/"+this.file);t.volume=this.volume,t.play(),this.buffer.push(t)}}}]),e}(),Ze=function(){function e(){Object(o.a)(this,e),this.lib={drop:new Qe($e,.2),love:new Qe(Xe),happiness:new Qe(Xe),unhappiness:new Qe(Ye),hate:new Qe(Ye)}}return Object(l.a)(e,[{key:"play",value:function(e){this.lib[e].play()}}]),e}(),et={x:.94,y:.94},tt=60,at=9,nt=10,it=function(){function e(){var t=this;Object(o.a)(this,e),this.bus=new f,this.economy=new Me(this.bus),this.cities=[],this.law=new He,this.institutions=[],this.party=new De,this.date={year:1,season:Se.Spring,day:1,hour:1},this.alien=new Je,this.sfx=new Ze,this.onChat=function(e,a){t.party&&a.preachBelief&&Ce(a.preachBelief,t.party.ideals,t.party.community)&&(t.publishEvent({icon:"\ud83d\udea8",trigger:"speechcrime",message:"Speechcrime! ".concat(e.name," is talking about ").concat(xe[a.preachBelief].noun),beanKey:e.key}),null==t.alien.speechcrimes[t.date.year]?t.alien.speechcrimes[t.date.year]=1:t.alien.speechcrimes[t.date.year]++)},this.onBeanDie=function(e){var a=t.cities.find((function(t){return t.key===e.cityKey}));if(a){var n=a.historicalBeans.find((function(t){return t.key===e.beanKey}));n&&(a.onCitizenDie(n),t.economy.onBeanDie(n))}},this.onEmote=function(e,t){},this.bus.death.subscribe(this.onBeanDie)}return Object(l.a)(e,[{key:"beans",get:function(){return this.cities.reduce((function(e,t){return e.concat(t.beans)}),[])}},{key:"historicalBeans",get:function(){return this.cities.reduce((function(e,t){return e.concat(t.historicalBeans)}),[])}},{key:"organizations",get:function(){return this.institutions.reduce((function(e,t){return e.concat(t.organizations)}),[])}}]),Object(l.a)(e,[{key:"calculateComputedState",value:function(){var e=this;this.cities.forEach((function(t){t.calculate(e.economy,e.law),t.beans.forEach((function(a){return a.calculateBeliefs(e.economy,t,e.law,e.party)}))}))}},{key:"simulate_world",value:function(){var e=this;if(this.date.hour++,this.date.hour>Ne.Evening&&(this.date.hour=0,this.date.day++),this.date.day>30&&(this.date.day=1,this.date.season++),this.date.season>3&&(this.date.year++,this.inflate(),this.resetYearlyCounters(),this.date.season=0),this.alien.bots.amount+=this.alien.bots.income,this.alien.energy.amount+=this.alien.energy.income,this.alien.hasResearched("fast_resources")&&(this.alien.bots.amount+=.5*this.alien.bots.income,this.alien.energy.amount+=.5*this.alien.energy.income),this.alien.currentlyResearchingTech){var t=this.alien.currentlyResearchingTech;null==this.alien.techProgress[t]&&(this.alien.techProgress[t]={researchPoints:0});var a=Ue[t].techPoints,n=this.alien.techProgress[t].researchPoints;n<a&&(this.alien.techProgress[t].researchPoints+=this.alien.abductedBeans.length),n>=a&&(this.alien.currentlyResearchingTech=void 0)}this.economy.resetSeasonalDemand(),this.organizations.forEach((function(t){return t.work(e.law,e.economy)}));w(this.beans).forEach((function(t,a){t.age(e.economy);var n=t.maybeBaby(e.economy);n&&e.publishEvent(n),"jobless"===t.job&&t.tryFindRandomJob(e.law),t.ticksSinceLastEmote++})),this.cities.forEach((function(t){return t.getTaxesAndDonations(e.party,e.economy)})),this.calculateComputedState(),this.alien.checkGoals(this),this.alien.checkReportCard(this)}},{key:"simulate_beans",value:function(e){var t=this;this.beans.forEach((function(a){!function(e,t,a,n){var i,r=e.state.act(e,t,a);e.onAct&&e.onAct.publish(t),r!=e.state&&(!function(e,t){e.state.exit(e),e.state=t,e.state.enter(e)}(e,r),"chat"===r.data.act&&"speaker"===(null===(i=r.data.chat)||void 0===i?void 0:i.participation)&&n.onChat(e,r.data.chat))}(a,e,t.alien.difficulty,t)}))}},{key:"simulate_pickups",value:function(e){for(var t=this.cities[0],a=t.pickups.get,n=a.length-1;n>=0;n--){var i=a[n],r=!1;if(t.pickupMagnetPoint?r=B(i,t.pickupMagnetPoint,tt*e/1e3,at,nt,et):M(i,et),r){var s=dt[i.type];this.alien.hedons.amount+=s,this.alien.hedons.change.publish({change:s}),t.pickups.remove(i),this.sfx.play(i.type)}else i.onAnimate.publish(i.point)}}},{key:"publishEvent",value:function(e){this.bus[e.trigger].publish(e)}},{key:"inflate",value:function(){var e=(this.beans.reduce((function(e,t){return e+t.cash}),0)+this.organizations.reduce((function(e,t){return e+t.cash}),0))/100,t=Math.round(1*e);if(t>0){var a=this.beans.reduce((function(e,t){return t.cash>e.max&&(e.winner=t,e.max=t.cash),e}),{max:0});a.winner&&(a.winner.cash+=t)}}},{key:"resetYearlyCounters",value:function(){this.cities.forEach((function(e){e.yearsPartyDonations=0}))}},{key:"addCharity",value:function(e,t,a){var n=new Te;n.name=t,n.good=e,n.seasonalBudget=a,this.party.organizations.push(n)}}]),e}(),rt={state:"\ud83d\udd4a\ufe0f",ego:"\ud83e\udd85",prog:"\u2696\ufe0f",trad:"\ud83d\udc51",circle:"\ud83e\udd0e",square:"\ud83d\udc9b",triangle:"\ud83e\udde1",rocket:"\ud83d\ude80",music:"\ud83c\udfb5",dragon:"\ud83d\udc32",noFaith:"\u26ab\ufe0f",hungry:"\ud83c\udf7d\ufe0f",sated:"\ud83e\udd5c",stuffed:"\ud83e\udd69",podless:"\ud83c\udf28\ufe0f",crowded:"\ud83c\udfd8\ufe0f",homeowner:"\ud83c\udfe1",sick:"\ud83e\udd22",bruised:"\ud83e\ude79",fresh:"\ud83d\udcaa",mad:"\ud83e\udd2a",confused:"\ud83e\udd24",sane:"\ud83e\udde0"};function st(e){return 100*Math.min(1,Math.max(-1,e.reduce((function(e,t){return e+=t.mod}),0)))}!function(e){e[e.Deficient=-.25]="Deficient",e[e.Sufficient=0]="Sufficient",e[e.Abundant=.15]="Abundant"}(Ke||(Ke={}));var ot={podless:{reason:"Homeless",mod:Ke.Deficient},crowded:{reason:"Renting",mod:Ke.Sufficient},homeowner:{reason:"Homeowner",mod:Ke.Abundant},sick:{reason:"Sick",mod:Ke.Deficient},bruised:{reason:"Bruised",mod:Ke.Sufficient},fresh:{reason:"Healthy",mod:Ke.Abundant},hungry:{reason:"Hungry",mod:Ke.Deficient},sated:{reason:"Sated",mod:Ke.Sufficient},stuffed:{reason:"Stuffed",mod:Ke.Abundant}},lt={food:{sufficient:1,abundant:3},shelter:{sufficient:1,abundant:7},medicine:{sufficient:1,abundant:3},fun:{sufficient:1,abundant:3}};function ct(e){switch(e){case"builder":return"shelter";case"doc":return"medicine";case"entertainer":return"fun";default:case"farmer":return"food"}}var ut={food:"\ud83e\udd6a",shelter:"\ud83c\udfe0",medicine:"\ud83d\udc8a",fun:"\ud83d\udc4f"},ht={love:"\ud83d\udc9b",happiness:"\ud83d\udc4d",unhappiness:"\ud83d\udca2",hate:"\ud83d\udc94"},dt={love:5,happiness:1,unhappiness:-1,hate:-5},mt={love:1,happiness:.2,unhappiness:0,hate:-1};function pt(e){return yt(e,"ego",(function(e){return e.ideals}))}function ft(e){return yt(e,"state",(function(e){return e.community}))}function yt(e,t,a){var n={avg:0,winner:t},i=e.reduce((function(e,t){var n=a(t);return null==e[n]?e[n]=1:e[n]++,e}),{});return Object.keys(i).forEach((function(e){i[e]>n.avg&&(n.avg=i[e],n.winner=e)})),n.avg/=e.length,n}var bt=function e(t,a,n){Object(o.a)(this,e),this.key=t,this.point=a,this.action=n},vt=function e(t,a,n){Object(o.a)(this,e),this.key=t,this.point=a,this.type=n,this.velocity={x:0,y:0},this.onAnimate=new m},gt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this)).sfx=e,n.name="",n.url="",n.type="",n.key=0,n.historicalBeans=[],n.ufos=[],n.pickups=new b([]),n.pickupSeed=0,n.houses=[],n.partyHQ=void 0,n.yearsPartyDonations=0,n.majorityEthnicity="circle",n.costOfLiving=1,n.economy=void 0,n.law=void 0,n.environment=void 0,n.eventBus=void 0,n.pickupMagnetPoint=void 0,n}return Object(l.a)(a,[{key:"beans",get:function(){return this.historicalBeans.filter((function(e){return e.alive}))},set:function(e){throw"can't set city beans"}}]),Object(l.a)(a,[{key:"tryGetJob",value:function(e,t){if("jobless"===t)return!1;for(var a=X[t],n=this.byType[a].all,i=0;i<n.length;i++){var r=n[i],s=r.openSlots();if(s.length>0){var o=s.shift();return r.job_slots[o]=e.key,e.buildingKey=r.key,!0}}return!1}},{key:"unsetJob",value:function(e){if("jobless"!==e.job)for(var t=X[e.job],a=this.byType[t].all,n=0;n<a.length;n++){if(a[n].tryFreeBean(e.key)){e.buildingKey=void 0;break}}}},{key:"addEmotePickup",value:function(e,t){var a=Object(g.a)({},this.movers.bean[e]);a.x+=Et(-10,10),a.y+=Et(-10,10);var n=++this.pickupSeed;this.movers.pickup[n]=a,this.pickups.push(new vt(n,a,t))}},{key:"getRandomCitizen",value:function(){var e=w(this.beans);return e.length>0?e[0]:null}},{key:"onCitizenDie",value:function(e){if(e.cash>0){var t=this.getRandomCitizen();t&&(t.cash=t.cash+e.cash,e.cash=0)}this.unsetJob(e)}},{key:"breedBean",value:function(e){var t,a,n,i,r=Math.random()<=.5?e.job:kt(["doc","farmer","builder","jobless"]),s=St(this,this.historicalBeans.length,void 0,r);s.ethnicity=e.ethnicity,s.name=s.name.split(" ")[0]+" "+e.name.split(" ")[1],s.cash=e.cash/2,e.cash/=2,s.bornInPetri=!0,this.environment&&(s.dob={year:null===(t=this.environment)||void 0===t?void 0:t.year,season:null===(a=this.environment)||void 0===a?void 0:a.season,day:null===(n=this.environment)||void 0===n?void 0:n.day,hour:null===(i=this.environment)||void 0===i?void 0:i.hour}),this.historicalBeans.push(s)}},{key:"getTaxesAndDonations",value:function(e,t){}},{key:"calculate",value:function(e,t){this.costOfLiving=e.getCostOfLiving();var a=this.beans.reduce((function(e,t){switch(t.ethnicity){case"circle":e.circle++;break;case"square":e.square++;break;case"triangle":e.triangle++}return e}),{circle:0,square:0,triangle:0});a.circle>a.square&&a.circle>a.triangle?this.majorityEthnicity="circle":a.square>a.circle&&a.square>a.triangle?this.majorityEthnicity="square":this.majorityEthnicity="triangle"}},{key:"getNearestNeighbors",value:function(e){var t=this;return this.beans.filter((function(a){if(a.key==e.key)return!1;var n=t.movers.bean[a.key],i=t.movers.bean[e.key],r=Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2);return r<1600&&r>600}))}}]),a}(Y);function Et(e,t){var a=new Uint32Array(1);window.crypto.getRandomValues(a);var n=a[0]/4294967296;return e=Math.ceil(e),t=Math.floor(t),Math.floor(n*(t-e+1))+e}function kt(e){return 1==e.length?e[0]:e[Et(0,e.length-1)]}Math.PI;function wt(e,t,a){var n=new V;n.type=t,n.key=e.numberOf(t),e.addBuilding(a,n)}function jt(){var e=new it;e.law.laws=[{group:"Welfare",key:"eat_cake",axis:"wel_food"},{group:"Welfare",key:"outside",axis:"wel_house"},{group:"Welfare",key:"stay_healthy",axis:"wel_health"},{group:"Culture",key:"secularism",axis:"cul_rel"}],e.party=new De,e.institutions.push(e.party);for(var t=0;t<1;t++){e.cities.push(Ct(e.cities.length,e.sfx)),e.cities[t].eventBus=e.bus,e.cities[t].environment=e.date,e.cities[t].economy=e.economy,e.cities[t].law=e.law;for(var a=0;a<e.cities[t].beans.length;a++){var n=e.cities[t].beans[a];n.work(e.law,e.economy),"farmer"==n.job&&n.work(e.law,e.economy)}}return e.economy.totalSeasonalDemand.food=e.beans.length,e.economy.totalSeasonalDemand.shelter=e.beans.length,e.economy.totalSeasonalDemand.medicine=e.beans.length,e}var xt=0;function Ct(e,t){var a=new gt(t);a.key=e,a.name=kt(["New ","Old ","Fort ","St. ","Mount ","Grand ","","","","","","","","","",""]),a.name+=kt(["Spring","Timber","Over","West","East","North","South","Rock","Sand","Clay","Iron","Ore","Coal","Liver","Hawk","Red","Yellow","Gold","Blue","Black","White","Sunny","Reed","Ox","Mill","Fern","Down","Bel","Bald","Ash"]),a.name+=kt(["water "," Springs","ville","dale","lane","peak","coast","beach","port","market","ton","brook"," Creek","land","burgh","bridge","ford","bury","chester","son","vale"," Valley","hill","more","wood"," Oaks"," Cove","mouth","way","crest"]),wt(a,"courthouse",a.hexes[0]),wt(a,"nature",a.hexes[Et(15,20)]),wt(a,"nature",a.hexes[Et(21,25)]),wt(a,"nature",a.hexes[Et(26,60)]);for(var n=xt;a.historicalBeans.length<n;)a.historicalBeans.push(St(a,a.historicalBeans.length));return a}function St(e,t,a,n){var i=new _e;i.key=t,i.cityKey=e.key,i.city=e,i.name=kt(["Joe","Frank","Jill","Jose","Johnny","Isabelle","Carmen","Ace","Carl","Zander","Jean","Anne","Leslie","Ben","Ron","Ellen","Dallas","Kane","Ash","Jim","James","Leonard","Nyota","Christine","Scotty","Tasha","Geordi","Beverly","Deanna","Wesley","Majel","Malcolm","River","Luke","Dana","Walter","Rick","Rose","Donna","Jack","Amy","Rory","Martha","Clara","Arnold","Dave","Holly","Kara","Gaius","William","Lee","Laura","Saul","Max","Edison","Theora","Bryce","Murray","Ned","Daniel","Samantha","Logan","Francis","Jessica"])+" ",i.name+=kt(["Ripley","Bishop","Hicks","Vasquez","Hudson","Rico","Flores","Ibanez","Levy","Jenkins","Barlow","Zim","Rasczak","Kirk","McCoy","Sulu","Uhura","Chekov","Chapel","Rand","Riker","Crusher","Barret","O'Brien","Reynolds","Tam","Scully","Mulder","Skinner","Connor","Thrace","Baltar","Smith","Adama","Roslin","Tigh","Song","Oswald","Deckard","Tyler","Harkness","Jones","Noble","Pond","Williams","Rimmer","Lister","Head","Carter","Lynch","McKenzie","Grossberg","O'Neil","Jackson","Carter"]),i.community=kt(["state","ego"]),i.ideals=kt(["prog","trad"]),i.faith=kt(["rocket","music","dragon","noFaith"]);for(var r=Math.ceil(2*Math.random()),s=0;s<r;s++)i.beliefs.push(kt(Oe));if(null==n)switch(t){case 0:n="farmer";break;case 1:n="builder";break;case 2:n="doc";break;default:n=kt(["farmer","builder","doc","entertainer"])}return i.trySetJob(n),i.cash=function(e){var t=4+Math.floor(3*Math.random());switch(e){case"doc":return t+2;default:return t}}(i.job),i.discrete_food=3,e.movers.bean[i.key]=R(e.hex_size,e.petriOrigin,a||function(e){var t=kt(e.byType.house.all);return t?e.byType.house.coordByID[t.key]:{q:0,r:0}}(e)),i}var Nt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={show:!1},n}return Object(l.a)(a,[{key:"getButton",value:function(){var e=this;return this.props.hideCloseButton?null:i.a.createElement("button",{type:"button",className:"done",onClick:function(){return e.props.onClick()}},this.props.closeButtonText||"Done")}},{key:"render",value:function(){return this.props.show?i.a.createElement("div",{className:"modal"},this.props.children,this.getButton()):null}}]),a}(i.a.Component),Ot=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"header",value:function(){return this.props.children?i.a.createElement("b",null,this.props.children):null}},{key:"render",value:function(){var e=this,t=this.props.beans.filter((function(t){return e.props.need(t)==e.props.dire})).length,a={width:Math.floor(t/this.props.beans.length*100)+"%"},n=this.props.beans.filter((function(t){return e.props.need(t)==e.props.abundant})).length,r={width:Math.floor(n/this.props.beans.length*100)+"%"};return i.a.createElement("div",{className:this.props.className},this.header(),i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"bar-inner dire",style:a},t>0?"".concat(t," ").concat(ka[this.props.dire]):""),i.a.createElement("div",{className:"bar-inner abundant",style:r},n>0?n:"")))}}]),a}(i.a.Component),_t=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=null;this.props.city&&(t=i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("b",null,this.props.city.name)," ",we[this.props.utopia.community].icon," ",we[this.props.utopia.ideals].icon,i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearCity()}},"\u274c")),i.a.createElement("div",null," ",we[this.props.utopia.community].adj," ",we[this.props.utopia.ideals].adj," Utopia")));var a,n=this.props.beans.reduce((function(e,t){return e+t.lastHappiness}),0)/(this.props.beans.length||1),r=this.props.beans.reduce((function(e,t){return e+t.cash}),0)/(this.props.beans.length||1),s=this.props.beans.reduce((function(e,t){return e+t.lastPartySentiment}),0)/(this.props.beans.length||1);return i.a.createElement("div",null,t,i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"Demographics")),i.a.createElement("div",null,i.a.createElement("b",null,"Population"),"\xa0",i.a.createElement("span",null,this.props.beans.length)),i.a.createElement(Bt,{report:(a=this.props.beans,yt(a,"circle",(function(e){return e.ethnicity})))},"Ethnicity"),i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"Situation")),i.a.createElement(Ot,{beans:this.props.beans,need:function(e){return e.food},dire:"hungry",abundant:"stuffed"},"Food Security"),i.a.createElement(Ot,{beans:this.props.beans,need:function(e){return e.shelter},dire:"podless",abundant:"homeowner"},"Housing"),i.a.createElement(Ot,{beans:this.props.beans,need:function(e){return e.health},dire:"sick",abundant:"fresh"},"Healthcare"),i.a.createElement("b",null,"Avg. Money")," $",r.toFixed(2)," \xa0",i.a.createElement("b",null,"Avg. Happiness")," ",Math.round(n),"%",i.a.createElement("div",{className:"header"},i.a.createElement("b",null,"Electorate")),i.a.createElement(Bt,{report:ft(this.props.beans)},"Community"),i.a.createElement(Bt,{report:pt(this.props.beans)},"Ideals"),i.a.createElement("div",null,i.a.createElement("b",null,"Approval"),"\xa0",i.a.createElement("span",null,s.toFixed(0),"%")))}}]),a}(i.a.Component),Bt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e="Leaning";this.props.report.avg>=.51&&(e="Major"),this.props.report.avg>=.8&&(e="Extreme");var t=Math.floor(100*this.props.report.avg),a={width:t+"%"};return i.a.createElement("div",null,i.a.createElement("b",null,this.props.children),"\xa0\xa0",i.a.createElement("span",null,e," ",ka[this.props.report.winner]),i.a.createElement("div",{className:"bar"},i.a.createElement("div",{className:"bar-inner",style:a},t,"%")))}}]),a}(i.a.Component);var Mt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).animate=function(e){var t;n.setState({point:n.props.bean.city?n.props.bean.city.movers.bean[n.props.bean.key]:{x:0,y:0},spin:"work"==n.props.bean.state.data.act,face:n.props.bean.getFace(),good:(t=n.props.bean,"buy"==t.state.data.act&&"shelter"!=t.state.data.good?ut[n.props.bean.state.data.good||"food"]:void 0),speech:n.props.bean.getSpeech()})},n.delaySeedSec=void 0,n.delaySeedSec=60*Math.random()+n.props.bean.key,n.state={paused:!1,point:e.static?L:e.bean.city?e.bean.city.movers.bean[e.bean.key]:{x:0,y:0},spin:!1,face:e.bean.getFace()},e.bean.onAct.subscribe(n.animate),n}return Object(l.a)(a,[{key:"getPurchase",value:function(){if(this.state.good)return i.a.createElement("span",{className:"purchase"},i.a.createElement("span",{className:"money"},"\ud83d\udcb8"),i.a.createElement("span",{className:"purchase-good"},this.state.good))}},{key:"getSpeech",value:function(){if(this.state.speech)return i.a.createElement("span",{className:"speech"},i.a.createElement("span",{className:""},this.state.speech))}},{key:"render",value:function(){var e=this,t=this.props.bean.job+" "+this.props.bean.ethnicity;t+=this.state.paused||!this.props.bean.alive?" paused":"",this.props.sitStill||(t+=" bean-walker",this.state.spin&&(t+=" spin"),this.props.selected&&(t+=" selected"),"travel"!=this.props.bean.state.data.act&&(t+=" paused"));var a=Object(g.a)(Object(g.a)({},G(this.state.point)),{},{animationDelay:"-"+this.delaySeedSec+"s"});a.animationDelay="";return i.a.createElement("span",{className:t+" bean interactable",style:a,title:"",onClick:function(t){t.stopPropagation(),e.props.onClick()}},this.state.face," ",this.getPurchase()," ",this.getSpeech())}}]),a}(i.a.Component),Pt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={showBeam:!1},setTimeout((function(){n.setState({showBeam:!0}),setTimeout((function(){n.setState({showBeam:!1})}),1800)}),1800),n}return Object(l.a)(a,[{key:"render",value:function(){var e=Object(g.a)({},G(R(this.props.city.hex_size,this.props.city.petriOrigin,this.props.ufo.point)));return i.a.createElement("span",{style:e,className:"ufo"},"\ud83d\udef8",this.state.showBeam?i.a.createElement("span",{className:"beam"}):null)}}]),a}(i.a.Component),Dt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).animations=[],n.finishedAnimationCount=0;for(var r=[],s=0;s<n.props.particleCount;s++)r.push(i.a.createRef());return n.state={active:!0,parts:r},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.animations=this.state.parts.map((function(t){if(t.current){var a=Math.floor(400*Math.random())-200,n=Math.floor(400*Math.random())-400;return t.current.animate([{transform:"translate(0px, 0px)",opacity:1},{transform:"translate(".concat(a,"px, ").concat(n,"px)"),opacity:0}],{duration:1500+1e3*Math.random(),easing:"ease-in-out",delay:e.props.delay+100*Math.random()})}return null})),this.animations.forEach((function(t){t&&(t.onfinish=function(){e.finishedAnimationCount++,e.finishedAnimationCount>=e.props.particleCount&&e.setState({active:!1,parts:[]})})}))}},{key:"render",value:function(){return i.a.createElement("div",{className:(this.props.className||"")+" particle-parent"},this.state.active?this.state.parts.map((function(e,t){return i.a.createElement("div",{key:t,className:"particle",ref:e})})):null)}}]),a}(i.a.Component),Tt=(i.a.Component,a(25),{"death-exposure":[{start:0,name:"death-exposure",faceOV:"\ud83e\udd76",beanClasses:"drop-tool turn-blue",particles:[]},{start:2e3,name:"death-exposure",faceOV:"\ud83d\udc80",beanClasses:"drop-tool turn-blue",particles:[]}],"death-vaporization":[{start:0,name:"death-vaporization",beanClasses:"",particles:[]},{start:1e3,name:"death-vaporization",beanClasses:"drop-tool",particles:[]},{start:2e3,name:"death-vaporization",beanClasses:"drop-tool",faceOV:" ",particles:[{className:"head",delay:0}]},{start:3e3,name:"death-vaporization",beanClasses:"drop-tool hide-body",faceOV:" ",particles:[{className:"head",delay:0},{className:"body",delay:0}]}],"death-sickness":[{start:0,name:"death-sickness",faceOV:"\ud83e\udd22",beanClasses:"",particles:[]},{start:1e3,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83e\udd2e",particles:[{className:"head",delay:0}]},{start:1400,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83e\udd2e",particles:[{className:"head",delay:0},{className:"head",delay:0}]},{start:2e3,name:"death-sickness",beanClasses:"drop-tool",faceOV:"\ud83d\udc80",particles:[{className:"head",delay:0}]}],"death-starvation":[{start:0,name:"death-starvation",faceOV:"\ud83e\udd7a",beanClasses:"",particles:[]},{start:500,name:"death-starvation",faceOV:"\ud83d\ude16",beanClasses:"body-shrink",particles:[]},{start:1e3,name:"death-starvation",faceOV:"\ud83d\ude2b",beanClasses:"body-shrink drop-tool",particles:[]},{start:3e3,name:"death-starvation",faceOV:"\ud83d\udc80",beanClasses:"body-shrink drop-tool",particles:[]}]}),It=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).lastTickMS=0,n.currentTime=0,n.tickHandle=0,n.tick=function(e){var t=e-n.lastTickMS;if(n.lastTickMS=e,t>0){n.currentTime+=t;var a="".concat(n.props.event.trigger,"-").concat(n.getSubtype(n.props.event.message));n.setState(Tt[a].reduce((function(e,t){return n.currentTime>=t.start?t:e}),Tt[a][0]))}n.tickHandle=window.requestAnimationFrame(n.tick)};var i="".concat(n.props.event.trigger,"-").concat(n.getSubtype(n.props.event.message));return n.state=Tt[i][0],n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.requestAnimationFrame((function(t){e.lastTickMS=t,e.tickHandle=window.requestAnimationFrame(e.tick)}))}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.tickHandle)}},{key:"getSubtype",value:function(e){return e.includes("vaporiz")?"vaporization":e.includes("exposure")?"exposure":e.includes("sickness")?"sickness":"starvation"}},{key:"render",value:function(){var e,t,a=this;this.props.event.point&&(t=G(null===(e=this.props.event)||void 0===e?void 0:e.point));var n=[this.props.bean.job,this.props.bean.ethnicity,this.state.name,this.state.beanClasses].join(" ");return i.a.createElement("div",{className:"spotlight",style:t},i.a.createElement("div",{className:"bean-parent"},i.a.createElement("span",{className:n+" bean"},i.a.createElement("span",{className:"bean-face"},this.state.faceOV||this.props.bean.getFace())),this.state.particles.map((function(e,t){return i.a.createElement(Dt,{key:t,className:a.state.name+" "+e.className,delay:e.delay,particleCount:30})}))),i.a.createElement("div",{className:"label"},this.props.event.message.replace("A subject",this.props.bean.name)),"death"===this.props.event.trigger?i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",disabled:!0},"Prevent Death",i.a.createElement("br",null),"-4 \ud83e\udd16")):null)}}]),a}(i.a.Component),At=a(7),Ht=function(e){var t=Object(n.useState)(!1),a=Object(At.a)(t,2),r=a[0],s=a[1],o=i.a.useContext(wa);return Object(n.useEffect)((function(){!r&&o&&(o.play("drop"),s(!0))})),i.a.createElement("span",{className:"pickup bob"},ht[e.pickup.type])},Ft=function(e){var t=Object(n.useRef)(null),a=function(e){t.current&&(t.current.style.transform="translate(".concat(e.x,"px, ").concat(e.y,"px)"))};return Object(n.useEffect)((function(){return e.onMove.subscribe(a),function(){return e.onMove.unsubscribe(a)}}),[]),i.a.createElement("div",{ref:t},e.children)},Lt=function(e){var t=Object(n.useState)(e.movers.get),a=Object(At.a)(t,2),r=a[0],s=a[1],o=function(e){s(e)};return Object(n.useEffect)((function(){return e.movers.onChange.subscribe(o),function(){return e.movers.onChange.unsubscribe(o)}}),[]),i.a.createElement(i.a.Fragment,null,r.map((function(e){return i.a.createElement(Ft,{onMove:e.onAnimate,key:e.key},i.a.createElement(Ht,{pickup:e}))})))},Rt=["farm","hospital","house","theater","courthouse","park","nature"],qt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).mtn_transforms=[],n.state={};for(var i=0;i<72;i++){var r=q({r:530,az:5*i*Math.PI/180});r.x+=550,r.y+=550,n.mtn_transforms.push(G(r))}return n}return Object(l.a)(a,[{key:"renderBuildings",value:function(e){var t=this;return this.props.city.byType[e].all.map((function(a,n){return i.a.createElement(te,{city:t.props.city,building:a,key:e+n})}))}},{key:"renderSpotlight",value:function(){var e=this;if(this.props.spotlightEvent){var t=this.props.city.historicalBeans.find((function(t){var a;return t.key===(null===(a=e.props.spotlightEvent)||void 0===a?void 0:a.beanKey)}));if(this.props.spotlightEvent.point&&t)return i.a.createElement(It,{event:this.props.spotlightEvent,bean:t})}return null}},{key:"renderHexes",value:function(){var e=this;return this.props.city.hexes.map((function(t,a){var n=R(e.props.city.hex_size,e.props.city.petriOrigin,t);return i.a.createElement("div",{className:"hex",key:a,style:G(n),onMouseEnter:function(t){e.props.city.pickupMagnetPoint=n},onClick:function(a){return e.props.onHexClick(t),a.stopPropagation(),!1}})}))}},{key:"render",value:function(){var e=this,t=this.props.city.beans.map((function(t){return i.a.createElement(Mt,{bean:t,key:t.key,selected:t.key===e.props.activeBeanID,onClick:function(){return e.props.onBeanClick(t)}})})),a=(this.props.city.historicalBeans.filter((function(e){return!e.alive})).map((function(e,t){return i.a.createElement("span",{key:t,className:"dead",style:{left:10*t+"px"}},"\u26b0\ufe0f")})),this.props.city.ufos.map((function(t,a){return i.a.createElement(Pt,{ufo:t,key:t.key,city:e.props.city})}))),n=Rt.reduce((function(t,a){return t.concat(e.renderBuildings(a))}),[]),r=this.mtn_transforms.map((function(e,t){return i.a.createElement("span",{key:t,style:e,className:"mtn"},"\u26f0\ufe0f")}));return i.a.createElement("div",{className:"tile",onClick:function(){return e.props.onClick()},onMouseLeave:function(){e.props.city.pickupMagnetPoint=void 0}},i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-base"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 1)"})),this.renderHexes(),r,n,i.a.createElement(Lt,{movers:this.props.city.pickups}),t,a,i.a.createElement("svg",{style:{width:"100%",height:"100%"},className:"petri-lid"},i.a.createElement("circle",{cx:"50%",cy:"50%",r:"50%",stroke:"grey",fill:"rgba(255, 255, 255, 0.2)"})),this.renderSpotlight())}}]),a}(i.a.Component);function zt(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}var Gt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={paused:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.world.beans,t=zt(e.map((function(e){return e.discrete_food}))),a=zt(e.map((function(e){return e.discrete_health}))).toFixed(1),n=zt(e.map((function(e){return e.discrete_stamina}))).toFixed(1),r=e.reduce((function(e,t){return e+t.cash}),0),s=r/(e.length||1),o=zt(e.map((function(e){return e.cash}))),l=e.filter((function(e){return e.cash<1})).length,c=Math.max(s,o),u=e.filter((function(e){return e.cash>c})),h=u.length/(e.length||1)*100,d=u.reduce((function(e,t){return e+t.cash}),0)/r*100,m=e.reduce((function(e,t){return e[t.job]=(e[t.job]||0)+1,e}),{}),p=((m.jobless||0)/e.length*100).toFixed(1);function f(e,t){return e.supply+=t.quantity,e.price+=t.price,e.count++,e.avg=e.price/e.count,e}var y=this.props.world.economy.market.listings.food.reduce(f,{supply:0,price:0,avg:0,count:0}),b=this.props.world.economy.market.listings.medicine.reduce(f,{supply:0,price:0,avg:0,count:0}),v=this.props.world.economy.market.listings.shelter.reduce(f,{supply:0,price:0,avg:0,count:0});return i.a.createElement("div",null,i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"State of the Utopia")),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udf5e Food Security"),i.a.createElement(Ot,{beans:this.props.world.beans,need:function(e){return e.food},dire:"hungry",abundant:"stuffed",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",t.toFixed(1)," \ud83c\udf5e"),i.a.createElement("td",{className:"text-center"},"Supply: ",y.supply," \ud83c\udf5e @ $",y.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.food," \ud83c\udf5e"))))),i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83e\ude7a Healthcare"),i.a.createElement(Ot,{beans:this.props.world.beans,need:function(e){return e.health},dire:"sick",abundant:"fresh",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",a," \ud83e\ude7a"),i.a.createElement("td",{className:"text-center"},"Supply: ",b.supply," \ud83e\ude7a @ $",b.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.medicine," \ud83e\ude7a")))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83c\udfe1 Housing")," ",i.a.createElement("br",null),i.a.createElement(Ot,{beans:this.props.world.beans,need:function(e){return e.shelter},dire:"podless",abundant:"homeowner",className:"big"}),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Median ",n," \ud83c\udfe1"),i.a.createElement("td",{className:"text-center"},"Supply: ",v.supply," \ud83c\udfe1 @ $",v.avg.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Deficit: ",this.props.world.economy.unfulfilledSeasonalDemand.shelter," \ud83c\udfe1")))))),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("strong",null,"\ud83d\udcb0 Wealth")," ",i.a.createElement("br",null),l," penniless citizens \xa0 \xa0 Cost of Living: $",this.props.world.economy.getCostOfLiving().toFixed(2)," ",i.a.createElement("br",null),i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Total $",r.toFixed(2)),i.a.createElement("td",{className:"text-center"},"Median: $",o.toFixed(2)),i.a.createElement("td",{className:"text-right"},"Avg: $",s.toFixed(2))))),"Top ",h.toFixed(1),"% of subjects own ",d.toFixed(1),"% of the wealth"),i.a.createElement("span",null,i.a.createElement("strong",null,"Unemployment")," ",p,"% (",m.jobless,")",i.a.createElement("br",null),i.a.createElement("ul",{className:"boxes"},i.a.createElement("li",null,m.farmer||0," farmers"),i.a.createElement("li",null,m.builder||0," builders"),i.a.createElement("li",null,m.doc||0," doctors"),i.a.createElement("li",null,m.entertainer||0," entertainers")))))}}]),a}(i.a.Component);var Wt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.events.map((function(t,a){var n="\ud83d\udea8"===t.icon,r="nojobslots"===t.trigger;return i.a.createElement("div",{key:a,className:n||r?"tall":""},i.a.createElement("span",{className:n?"police-siren":""},t.icon),"\xa0",function(e){return null!=e.beanKey&&("speechcrime"===e.trigger||"birth"===e.trigger)}(t)?i.a.createElement("a",{onClick:function(){return e.props.selectBean(t.beanKey)},href:"javascript:void(0)"},t.message):i.a.createElement("span",null,t.message))}));return 0===this.props.events.length&&(t=[i.a.createElement("div",{key:0},i.a.createElement("small",null,"No events yet"))]),i.a.createElement("div",{className:"events-panel"},i.a.createElement("div",null,i.a.createElement("b",null,"Events")),t)}}]),a}(i.a.Component),Vt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t="card button";return this.props.thin&&(t+=" thin"),this.props.singleLine&&(t+=" single"),i.a.createElement("button",{className:t,title:this.props.title,onClick:function(){e.props.onClick&&e.props.onClick()},type:"button"},this.props.icon," ",this.props.name,null!=this.props.subtext?i.a.createElement("small",null,this.props.subtext):null)}}]),a}(i.a.Component);function Kt(e,t,a){switch(t){case"trad":case"prog":case"ego":case"state":return i.a.createElement(Vt,{icon:rt[t],title:we[t].description,name:"",subtext:ka[t],thin:!0,singleLine:!0,onClick:a});case"fresh":case"sick":case"hungry":case"stuffed":case"podless":case"homeowner":case"circle":case"square":case"triangle":case"sane":case"confused":case"mad":return i.a.createElement(Vt,{icon:rt[t],title:ka[t],name:"",subtext:ka[t],thin:!0,singleLine:!0,onClick:a});case"noFaith":case"rocket":case"dragon":case"music":return i.a.createElement(Vt,{icon:rt[t],title:je[t].description,name:"",subtext:ka[t],thin:!0,singleLine:!0,onClick:a});default:return null}}a(26);var Ut=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).scan=function(){n.props.scan(n.props.bean)&&(n.setState({faceOverride:"\ud83e\udd28"}),n._resetFace())},n.vaporize=function(){n.props.vaporize(n.props.bean),n.setState({faceOverride:"\ud83d\udc80"}),n._resetFace()},n.support=function(){n.setState({faceOverride:"\ud83e\udd29"}),n._resetFace()},n.abduct=function(){n.props.abduct(n.props.bean),n.setState({faceOverride:"\ud83d\ude28"}),n._resetFace()},n.state={innerView:"beliefs"},n}return Object(l.a)(a,[{key:"_resetFace",value:function(){var e=this;setTimeout((function(){e.setState({faceOverride:void 0})}),5e3)}},{key:"happyTable",value:function(e){return e.filter((function(e){return 0!=e.mod})).map((function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",{className:"small text-right"},e.reason),i.a.createElement("td",{className:"small"},Math.round(100*e.mod),"%"))}))}},{key:"renderInner",value:function(){if(!this.scanned)return i.a.createElement("div",{className:"width-100p text-center"},i.a.createElement("small",null,"Subject needs a Scan to reveal their thoughts"));switch(this.state.innerView){case"beliefs":return this.scanned?this.beliefTable(this.props.bean.beliefs):null;case"feelings":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,this.scanned?this.happyTable(this.props.bean.getHappinessModifiers(this.props.economy,this.props.city,this.props.law)):null));case"priorities":return i.a.createElement("table",{className:"width-100p"},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",null,"Currently ",this.props.bean.state.display)),ge(this.props.bean,this.props.alien.difficulty).values.map((function(e){return i.a.createElement("tr",null,i.a.createElement("td",null,e.priority.toFixed(1)," ",function(e){switch(e.act){case"work":return e.good?"\ud83d\udcaa "+ut[e.good]:"\ud83d\udcaa";case"buy":return"shelter"==e.good?"\ud83d\ude34":e.good?"\ud83d\udcb8 "+ut[e.good]:"\ud83d\udcb8"}return""}(e.value)))}))))}}},{key:"beliefTable",value:function(e){var t=this;return e.map((function(e,a){var n=Ce(e,t.props.party.ideals,t.props.party.community);return i.a.createElement("table",{className:"width-100p",key:e+a},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",{className:n?"divergent text-left":"text-left"},xe[e].icon," ",xe[e].adj),i.a.createElement("td",{className:"text-right"},(xe[e].idealPro||[]).map((function(e){return i.a.createElement("span",null,"+",rt[e])})),(xe[e].idealCon||[]).map((function(e){return i.a.createElement("span",null,"-",rt[e])})))),i.a.createElement("tr",null,i.a.createElement("td",{className:"small text-center",colSpan:2},xe[e].description))))}))}},{key:"renderTraits",value:function(){if(this.scanned){var e=this.props.brainwash.bind(this);return i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},Kt(this.props.bean,this.props.bean.ethnicity,void 0),Kt(this.props.bean,this.props.bean.faith,e)),i.a.createElement("div",{className:"card-parent"},Kt(this.props.bean,this.props.bean.ideals,e),Kt(this.props.bean,this.props.bean.community,e)),i.a.createElement("div",{className:"card-parent"},Kt(this.props.bean,this.props.bean.food,void 0),Kt(this.props.bean,this.props.bean.shelter,void 0),Kt(this.props.bean,this.props.bean.health,void 0)))}return i.a.createElement("div",{className:"card-parent"},i.a.createElement(Vt,{icon:"\ud83d\udef0\ufe0f",name:"Scan",subtext:"-Energy +Info",onClick:this.scan}))}},{key:"render",value:function(){var e=this,t=this.props.bean.job+" "+this.props.bean.ethnicity;this.props.bean.chanceToDonate(this.props.economy,!0);return i.a.createElement("div",{className:"vertical bean-panel"},i.a.createElement("div",{className:"bean-panel-header"},i.a.createElement("div",null,i.a.createElement("b",null,this.props.bean.name,"\xa0",i.a.createElement("small",null,"of ",this.props.city.name)),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearCity()}},"\u274c")),i.a.createElement("div",{className:"bean-view"},i.a.createElement("span",{className:t+" bean"},void 0===this.state.faceOverride?this.props.bean.getFace():this.state.faceOverride)),i.a.createElement("div",{className:"horizontal"},i.a.createElement("span",{className:"text-center"},"\ud83d\udcb0 $",this.props.bean.cash.toFixed(2)),i.a.createElement("span",{className:"text-center"},"\ud83d\ude42 ",Math.round(this.props.bean.lastHappiness),"%"),i.a.createElement("span",{className:"text-center"},"\ud83d\udc4d ",Math.round(this.props.bean.lastPartySentiment),"%")),this.renderTraits()),i.a.createElement("div",{className:"grow-1 pad-4"},i.a.createElement("div",{className:"cylinder blue-orange horizontal"},i.a.createElement("button",{type:"button",className:"beliefs"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"beliefs"})}},"\ud83d\ude07 Beliefs"),i.a.createElement("button",{type:"button",className:"feelings"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"feelings"})}},"\ud83d\ude10 Feelings"),i.a.createElement("button",{type:"button",className:"priorities"==this.state.innerView?"active":"",onClick:function(){return e.setState({innerView:"priorities"})}},"\ud83d\udcaa Priorities")),this.renderInner()),i.a.createElement("div",{className:"bean-action-card-parent"},i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.props.brainwash()},title:"Rewrite one of this being's beliefs"},"\ud83d\ude35 Brainwash",i.a.createElement("small",null,"-Sanity +Belief"))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.props.brainwash()},title:"Give this being food or meds or cash"},"\ud83c\udf81 Gift",i.a.createElement("small",null,"-Energy +Things"))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:this.scan,title:"Steal a bit of this being's mind"},"\ud83e\udd2a Braindrain",i.a.createElement("small",null,"-Energy -Sanity")),i.a.createElement("button",{type:"button",className:"button card",onClick:this.vaporize,title:"Delete this being from the experiment"},"\u2620\ufe0f Vaporize",i.a.createElement("small",null,"-Bots -Energy"))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"button card",onClick:function(){return e.abduct()},title:"Remove this being for study"},"\ud83d\udc7e Abduct for Research",i.a.createElement("small",null,"-Bots -Sanity +Tech")))))}},{key:"scanned",get:function(){return this.props.alien.scanned_bean[this.props.bean.key]}}]),a}(i.a.Component),Jt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onName=function(e){n.setState({name:e.target.value})},n.onSlogan=function(e){n.setState({slogan:e.target.value})},n.onCity=function(e){n.setState({cityKey:+e})},n.state={community:null,ideal:null,name:"Goodplace",slogan:"Perfection is achievable.",members:"Citizens",goal:"Legislation",cityKey:0},n}return Object(l.a)(a,[{key:"onCommunity",value:function(e){var t=this;this.setState({community:e},(function(){t.onBigFourChange()}))}},{key:"onIdeal",value:function(e){var t=this;this.setState({ideal:e},(function(){t.onBigFourChange()}))}},{key:"onBigFourChange",value:function(){"ego"===this.state.community&&"trad"===this.state.ideal?this.setState({name:"Arcadia",slogan:"A man belongs on the farm.",members:"Farmers",goal:"Tariffs"}):"ego"===this.state.community&&"prog"===this.state.ideal?this.setState({name:"Libertaria",slogan:"Freedom for every being!",members:"Builders",goal:"Right to Strike"}):"state"===this.state.community&&"trad"===this.state.ideal?this.setState({name:"Ultimate Kingdom",slogan:"Honor to King and family.",members:"Homeowners",goal:"Repeal Property Tax"}):"state"===this.state.community&&"prog"===this.state.ideal&&this.setState({name:"Equus",slogan:"True equality is peace.",members:"Penniless",goal:"Food Welfare"})}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"Found your Utopia")),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,"Perfect societies rely on the",i.a.createElement("div",null,i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"community",value:"state",checked:"state"===this.state.community,onChange:function(t){return e.onCommunity(t.currentTarget.value)}})," ",i.a.createElement("b",null,"Collective")," \ud83d\udd4a\ufe0f "),"\xa0\xa0or\xa0\xa0",i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"community",value:"ego",checked:"ego"===this.state.community,onChange:function(t){return e.onCommunity(t.currentTarget.value)}})," ",i.a.createElement("b",null,"Independent")," \ud83e\udd85 ")),"\xa0 to guarantee well-being."),i.a.createElement("div",null,"Perfect beings devote themselves to",i.a.createElement("div",null,i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"ideal",value:"trad",checked:"trad"===this.state.ideal,onChange:function(t){return e.onIdeal(t.currentTarget.value)}})," ",i.a.createElement("b",null,"Elitist")," "," \ud83d\udc51"),"\xa0\xa0or\xa0\xa0",i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"ideal",value:"prog",checked:"prog"===this.state.ideal,onChange:function(t){return e.onIdeal(t.currentTarget.value)}})," ",i.a.createElement("b",null,"Progressive")," "," \u2696\ufe0f")),"\xa0 social values.")),i.a.createElement("hr",null),i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,"My Utopia is named ",i.a.createElement("input",{type:"text",value:this.state.name,onChange:this.onName})),i.a.createElement("div",null,"My Utopia's mantra is ",i.a.createElement("input",{type:"text",value:this.state.slogan,onChange:this.onSlogan}))),i.a.createElement("hr",null),i.a.createElement("button",{type:"button",disabled:null==this.state.community||null==this.state.ideal,className:"important btn-found-party",onClick:function(){return e.props.onFound(e.state)}},"Found the ",this.state.name," Utopia"))}}]),a}(i.a.Component);function $t(e,t){return e.map((function(e){return function(e,t){return function(e,t){var a="badge align-mid "+t,n="".concat("neg"===t?"-":"+").concat(e);return i.a.createElement("span",{className:a,key:n},n)}(rt[e],t)}(e,t)}))}var Xt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={overView:"laws",detailView:"none",collapsedGroups:{Crime:!1,Taxation:!1,Welfare:!1,Culture:!1,Economics:!1},collapsedAxis:{wel_food:!1,wel_house:!1,wel_health:!1,tax_basic:!1,tax_second:!1,econ_sub:!1,cul_rel:!1,cul_theo:!1,crime_theo:!1}},n}return Object(l.a)(a,[{key:"renderDetailLaw",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Ae[e],r=Object.values(Ae).filter((function(t){return t.key!=e&&t.axis===n.axis})),s="add"===t?"border-b-1 pad-bt-8":"";return i.a.createElement("div",{key:e,className:s+(a?" pad-l-40":"")},i.a.createElement("div",{className:"horizontal"},i.a.createElement("strong",{className:"f-size-15em"},n.name),i.a.createElement("span",null,$t(n.idealPro||[],"pos")),"add"===t?i.a.createElement("button",{className:"callout marg-0"},"Adopt for 3 \ud83d\uddf3\ufe0f"):null),a?null:i.a.createElement("div",null,i.a.createElement("i",null,"Government Policy for\xa0",Ie[n.axis].name)),i.a.createElement("div",null,i.a.createElement("p",null,n.description),"edit"===t?i.a.createElement("div",{className:"horizontal"},i.a.createElement("span",null,i.a.createElement("strong",null,"Subjects Fed:")," 1"),i.a.createElement("span",null,i.a.createElement("strong",null,"Last Monthly Cost:")," $1")):null,i.a.createElement("div",{className:"horizontal"},i.a.createElement("span",null,i.a.createElement("strong",null,"Max. Monthly Cost:")," ",i.a.createElement("input",{type:"number"}))),i.a.createElement("strong",null,"Incompatible with"),r.map((function(e,t){return i.a.createElement("i",{key:e.name},t>0?i.a.createElement("span",null,","):null," ",e.name)}))))}},{key:"renderDetailGroup",value:function(e){var t=this,a=[];return function(e,t){var a=new Map;return e.forEach((function(e){var n=t(e),i=a.get(n);i?i.push(e):a.set(n,[e])})),a}(Object.values(Ae).filter((function(t){return t.group===e})),(function(e){return e.axis})).forEach((function(e){var n=e.length>1;n&&a.push(i.a.createElement("div",null,i.a.createElement("h3",null,Ie[e[0].axis].name,i.a.createElement("button",{className:"callout marg-0 pull-r",onClick:function(){t.state.collapsedAxis[e[0].axis]=!t.state.collapsedAxis[e[0].axis],t.setState({collapsedAxis:t.state.collapsedAxis})}},"\ud83d\udcc1")))),n&&t.state.collapsedAxis[e[0].axis]||e.forEach((function(e){a.push(t.renderDetailLaw(e.key,"add",n))}))})),a}},{key:"toggleGroup",value:function(e){this.state.collapsedGroups[e]=!this.state.collapsedGroups[e],this.setState({collapsedGroups:this.state.collapsedGroups})}},{key:"renderHeader",value:function(e){var t=this;return i.a.createElement("tr",null,i.a.createElement("td",null,i.a.createElement("strong",null,e)),i.a.createElement("td",null,i.a.createElement("button",{className:"callout marg-0",onClick:function(){return t.setState({detailView:"group_add",detailGroup:e})}},"Add \u2795"),i.a.createElement("button",{className:"callout marg-0",onClick:function(){return t.toggleGroup(e)}},"\ud83d\udcc1")))}},{key:"renderRows",value:function(e,t){var a=this;return this.state.collapsedGroups[e]?null:t.map((function(e){var t=Ae[e.key];return i.a.createElement("tr",{key:e.key},i.a.createElement("td",null,i.a.createElement("i",null,t.name),(t.idealPro||[]).map((function(e){return rt[e]}))),i.a.createElement("td",null,i.a.createElement("button",{onClick:function(){return a.setState({detailView:"law_view",detailLaw:e})},className:"callout marg-0"},"View \ud83d\udd0d")))}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("h2",{className:"marg-b-0"},"Utopia Government"),i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal blue-orange cylinder f-size-125em marg-t-20"},i.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"laws"})},className:"laws"===this.state.overView?"active":""},"\ud83d\udcdc Laws"),i.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"leadership"})},className:"leadership"===this.state.overView?"active":""},this.props.world.party.leadership," \ud83d\uddf3\ufe0f Leadership"),i.a.createElement("button",{type:"button",onClick:function(){return e.setState({overView:"finances"})},className:"finances"===this.state.overView?"active":""},"\ud83d\udcb0 Funding")))),i.a.createElement("div",{className:"pad-4p"},this.props.world.party.name," is a\xa0",we[this.props.world.party.community].adj," ",we[this.props.world.party.community].icon,"\xa0",we[this.props.world.party.ideals].adj," ",we[this.props.world.party.ideals].icon,"\xa0 Utopia"),this.renderOver())}},{key:"renderOver",value:function(){switch(this.state.overView){case"leadership":return this.renderLeadership();case"finances":return this.renderFinances();default:return this.renderLaws()}}},{key:"renderLaws",value:function(){var e=this.props.world.law.getLawsByGroup();return i.a.createElement("div",{className:"col-2-30-60"},i.a.createElement("div",{className:"max-h-365"},i.a.createElement("table",{className:"full"},i.a.createElement("tbody",null,this.renderHeader("Taxation"),this.renderRows("Taxation",e.Taxation),this.renderHeader("Welfare"),this.renderRows("Welfare",e.Welfare),this.renderHeader("Economics"),this.renderRows("Economics",e.Economics),this.renderHeader("Crime"),this.renderRows("Crime",e.Crime),this.renderHeader("Culture"),this.renderRows("Culture",e.Culture)))),i.a.createElement("div",{className:"border max-h-365"},this.renderLawDetail()))}},{key:"renderLawDetail",value:function(){return"group_add"===this.state.detailView&&this.state.detailGroup?this.renderDetailGroup(this.state.detailGroup):"law_view"===this.state.detailView&&this.state.detailLaw?this.renderDetailLaw(this.state.detailLaw.key,"edit"):i.a.createElement("div",{className:"text-center"},"Add \u2795 or View \ud83d\udd0d a Law")}},{key:"renderFinances",value:function(){return i.a.createElement("div",null)}},{key:"renderLeadership",value:function(){return i.a.createElement("div",null)}}]),a}(i.a.Component);var Yt=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).bubbleSeed=0,n.onChange=function(e){var t=++n.bubbleSeed,a=e.change>0;n.setState({bubbles:n.state.bubbles.concat([{string:(a?"+":"")+e.change,id:t,className:a?"pos":"neg"}])}),setTimeout((function(){n.setState({bubbles:n.state.bubbles.filter((function(e){return e.id!=t}))})}),1500)},n.state={bubbles:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.changeEvent&&this.props.changeEvent.subscribe(this.onChange)}},{key:"componentWillUnmount",value:function(){this.props.changeEvent&&this.props.changeEvent.unsubscribe(this.onChange)}},{key:"render",value:function(){var e=this,t=this.state.bubbles.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.props.bubbleClass,"bubbler"].join(" ")},e.props.icon," ",t.string)}));return i.a.createElement("span",{className:"bubble-parent"},this.props.children,t)}}]),a}(i.a.Component),Qt=function(e){var t=function(e,t){var a=Object(n.useState)([]),i=Object(At.a)(a,2),r=i[0],s=i[1],o=0,l=function(e){var a=++o;s(r.concat([Object(g.a)({id:a},t(e))])),setTimeout((function(){s(r.filter((function(e){return e.id!=a})))}),1500)};return Object(n.useEffect)((function(){return e.subscribe(l),function(){return e.unsubscribe(l)}})),r}(e.changeEvent,(function(e){return{string:"Discovered ".concat(e.k,"!"),className:"seen-belief"}}));return i.a.createElement("span",{className:"bubble-parent"},e.children,t.map((function(t){return i.a.createElement("span",{key:t.id,className:[t.className,e.bubbleClass,"bubbler"].join(" ")},e.icon," ",t.string)})))},Zt=(a(27),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"social-graph"},this.props.beans.map((function(t){return i.a.createElement("div",{className:"bean-node",onClick:function(){return e.props.onClick(t)}},i.a.createElement(Mt,{bean:t,static:!0,sitStill:!0,onClick:function(){e.props.onClick(t)}}))})))}}]),a}(i.a.Component)),ea=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e="capsule-label "+this.props.label||!1;return i.a.createElement("span",{className:e},i.a.createElement("span",{className:"capsule-icon"},this.props.icon),i.a.createElement("span",{className:"capsule-text"},this.props.label,":"),i.a.createElement("span",{className:"capsule-value"},this.props.children))}}]),a}(i.a.Component),ta=a(11),aa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"renderReward",value:function(e){return i.a.createElement("div",null,i.a.createElement("small",null,"\ud83c\udf81 ",Fe(e.reward||{},"+")))}},{key:"renderGoal",value:function(e){var t=null!=this.props.progress.goalProgress[e.key]&&this.props.progress.goalProgress[e.key].done;return i.a.createElement("li",null,t?"\u2611\ufe0f":"\u2b55\ufe0f",e.text,null!=e.tooltip?i.a.createElement("small",{title:e.tooltip},"\u2754"):null,t||null==e.reward?null:this.renderReward(e))}},{key:"render",value:function(){var e,t=this;return i.a.createElement("div",{className:"goals"},i.a.createElement("div",null,i.a.createElement("b",null,"Goals")),i.a.createElement("ul",null,this.props.progress.goals.map((function(e){return t.renderGoal(Re[e])}))),i.a.createElement("div",null,i.a.createElement("b",null,"Report Card")),i.a.createElement("p",{className:"horizontal"},i.a.createElement("span",null,"Last Grade: ",i.a.createElement("b",null,"D")),i.a.createElement("span",null,"Next Grade in: ",i.a.createElement("b",null,"2 mo."))),i.a.createElement("p",null),i.a.createElement("table",{style:{margin:"auto"}},i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Happiness"),i.a.createElement("td",null,this.props.player.workingReportCard.Happiness),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects happy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,qe.RubricDescription.Happiness))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Prosperity"),i.a.createElement("td",null,this.props.player.workingReportCard.Prosperity),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects fed and healthy?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,qe.RubricDescription.Prosperity))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Stability"),i.a.createElement("td",null,this.props.player.workingReportCard.Stability),i.a.createElement("td",null,i.a.createElement("small",{title:"Are your subjects sane and civil?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,qe.RubricDescription.Stability))),i.a.createElement("tr",null,i.a.createElement("th",null,"\ud83c\udfaf Dogma"),i.a.createElement("td",null,this.props.player.workingReportCard.Dogma),i.a.createElement("td",null,i.a.createElement("small",{title:"Do your society's rules match your utopian ideals?"},"\u2754"))),i.a.createElement("tr",null,i.a.createElement("td",{className:"text-left",colSpan:3},i.a.createElement("small",null,qe.RubricDescription.Dogma))),i.a.createElement("tr",null,i.a.createElement("td",{colSpan:3},i.a.createElement("hr",null))),i.a.createElement("tr",null,i.a.createElement("th",null,"Avg. Grade"),i.a.createElement("td",null,(e=this.props.player.workingReportCard,We((Ve[e.Happiness]+Ve[e.Prosperity]+Ve[e.Stability]+Ve[e.Dogma])/20))),i.a.createElement("td",null)))))}}]),a}(i.a.Component),na=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"pad-4p"},i.a.createElement("div",{className:"subheader"},i.a.createElement("h3",null,"Propaganda"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83c\udf99\ufe0f Buy Propaganda")),i.a.createElement("span",null,"Propaganda changes beans' feelings on a wide variety of topics."),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udcfa Broadcast Campaign"),i.a.createElement("small",null,"Approval+ Cash-"),i.a.createElement("span",{className:"p"},"Small chance to increase Approval among all beans")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udc4b Canvassing"),i.a.createElement("small",null,"Approval+ Labor-"),i.a.createElement("span",{className:"p"},"Chance to increase Approval on a few random beans")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\uddde\ufe0f Print Campaign"),i.a.createElement("small",null,"Approval+ Cash-"),i.a.createElement("span",{className:"p"},"Chance to increase Approval on wealthy beans"))),i.a.createElement("div",{className:"subheader"},i.a.createElement("h3",null,"Appearances"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){}},"\ud83d\udcac Schedule Appearance")),i.a.createElement("span",null,"Appearances have limited reach, but have powerful effects."),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83e\udd14 Debating"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Chance to gain or lose Influence")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\udcf8 Photo Op"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Increases Approval within one Social Group")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83c\udfa4 Speechmaking"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Increases chance of Donations in a single City")),i.a.createElement("button",{type:"button",className:"card button"},i.a.createElement("span",{className:"h"},"\ud83d\ude4b Town Hall"),i.a.createElement("small",null,"Labor-"),i.a.createElement("span",{className:"p"},"Suppresses negative Approval in a single city"))))}}]),a}(i.a.Component),ia=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("h2",null,"Government"),i.a.createElement("div",null)))}}]),a}(i.a.Component),ra=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={confirming:!1},n}return Object(l.a)(a,[{key:"click",value:function(){this.state.confirming?(this.props.onConfirm(),this.setState({confirming:!1})):this.setState({confirming:!0})}},{key:"render",value:function(){var e=this;return i.a.createElement("button",{className:this.props.className,onClick:function(){return e.click()},disabled:this.props.disabled},this.state.confirming?this.props.confirmText:this.props.children)}}]),a}(i.a.Component),sa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("svg",{width:"100",height:"300",xmlns:"http://www.w3.org/2000/svg",style:{},className:this.props.classN+" robot-arm"},i.a.createElement("g",null,i.a.createElement("title",null,"robotarm"),i.a.createElement("rect",{fill:"transparent",id:"canvas_background",height:"302",width:"102",y:"-1",x:"-1"}),i.a.createElement("g",{display:"none",overflow:"visible",y:"0",x:"0",height:"100%",width:"100%",id:"canvasGrid"},i.a.createElement("rect",{fill:"url(#gridpattern)",strokeWidth:"0",y:"0",x:"0",height:"100%",width:"100%"}))),i.a.createElement("g",null,i.a.createElement("title",null,"Layer 1"),i.a.createElement("rect",{id:"svg_2",height:"200",width:"48",y:"91.63545",x:"25",strokeWidth:"1.5",stroke:"#000",fill:"#BBBBBB"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_1",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_3",cy:"50",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"}),i.a.createElement("ellipse",{ry:"48",rx:"48",id:"svg_4",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#999999"}),i.a.createElement("ellipse",{ry:"20",rx:"20",id:"svg_5",cy:"250",cx:"50",strokeWidth:"1.5",stroke:"#000",fill:"#444444"},this.props.tool)),i.a.createElement("text",{y:"250",x:"-20",fontSize:"4em"},this.props.tool))}}]),a}(i.a.Component),oa=(a(28),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).tools=["\ud83d\udce1","\ud83d\udddc\ufe0f","\ud83d\udd2c","\ud83d\udc89","\ud83d\udd0e","\ud83e\uddfc","\ud83e\uddf2","\ud83c\udfa5","\ud83d\udd27"],n.interval=void 0,n.state={toolI:0,toolI2:2,toolI3:4,toolI4:1},n}return Object(l.a)(a,[{key:"loop",value:function(e){var t=e+1;return t===this.tools.length&&(t=0),t}},{key:"componentDidMount",value:function(){var e=this;this.interval=window.setInterval((function(){e.setState({toolI:e.loop(e.state.toolI),toolI2:e.loop(e.state.toolI2),toolI3:e.loop(e.state.toolI3),toolI4:e.loop(e.state.toolI4)})}),1e3)}},{key:"componentWillUnmount",value:function(){null!=this.interval&&window.clearInterval(this.interval)}},{key:"setResearch",value:function(e){this.props.setResearch(e)}},{key:"renderTech",value:function(e){var t=this,a=null==this.props.player.techProgress[e.tech]?0:this.props.player.techProgress[e.tech].researchPoints,n=e.techPoints,r={width:Math.min(a/n*100,100)+"%"},s=a>=n,o=this.props.player.currentlyResearchingTech===e.tech,l=s?"\u2705":o?"\ud83d\udd2c":"\u2b55\ufe0f",c=o?"active":"inactive";return i.a.createElement("div",{className:"card-parent "+c,key:e.tech},i.a.createElement("button",{className:"card button",onClick:function(){return t.setResearch(e.tech)}},i.a.createElement("strong",null,e.name),i.a.createElement("strong",{className:"pull-r f-size-125em"},l),i.a.createElement("div",null,e.description),i.a.createElement("div",{className:"bar f-size-12 h-12"},i.a.createElement("div",{className:"bar-inner text-center",style:r}),a,"/",n," tech")))}},{key:"render",value:function(){var e=this,t=Object.values(Ue);return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h2",null,"Research \ud83e\uddea Lab"),i.a.createElement("div",{className:"vertical"},t.map((function(t){return e.renderTech(t)})))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",null,i.a.createElement("div",{className:"robot"},"\ud83e\udd16",i.a.createElement(sa,{classN:"far-left",tool:this.tools[this.state.toolI]}),i.a.createElement(sa,{classN:"left",tool:this.tools[this.state.toolI2]}),i.a.createElement(sa,{classN:"near-right",tool:this.tools[this.state.toolI3]}),i.a.createElement(sa,{classN:"far-right",tool:this.tools[this.state.toolI4]}))),i.a.createElement("div",{className:"h-42em"},this.props.player.abductedBeans.map((function(e){return i.a.createElement("span",{key:e.key,className:"victim bean triangle shake"},"\ud83d\ude28")}))),i.a.createElement("div",{className:"text-center"},"Currently probing ",this.props.player.abductedBeans.length," beings for ",this.props.player.abductedBeans.length," tech a day",i.a.createElement("p",null,i.a.createElement("small",null,"1 tech per research subject per day"))),this.props.player.abductedBeans.length>0?i.a.createElement("div",{className:"text-right"},i.a.createElement(ra,{className:"callout",onConfirm:function(){e.props.release()},confirmText:"-1 Research Subject?"},"\ud83c\udf88 Release Research Subject")):null)),i.a.createElement("div",null))}}]),a}(i.a.Component)),la=(a(29),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"s-p-f button-group cylinder blue-orange"},"\u231b\ufe0f",i.a.createElement("button",{type:"button",className:0==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(0)}},"\u23f9"),i.a.createElement("button",{type:"button",className:1==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(1)}},"\u25b6\ufe0f"),i.a.createElement("button",{type:"button",className:2==this.props.timeScale?"active":"",onClick:function(){return e.props.setTimeScale(2)}},"\u23e9"))}}]),a}(i.a.Component)),ca=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("small",null,Fe(this.props.cost,"-",this.props.qty))}}]),a}(i.a.Component),ua=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"emptyPanel",value:function(){var e=this,t=this.props.difficulty.cost.emptyHex;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement("strong",null,"Empty Lot")," in ",i.a.createElement("strong",null,this.props.city.name),i.a.createElement("button",{type:"button",className:"pull-r",onClick:function(){return e.props.clearHex()}},"\u274c")),i.a.createElement("h3",null,"Build:"),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"house")}},K.house," House",i.a.createElement(ca,{cost:t.build.house}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"farm")}},K.farm," Farm",i.a.createElement(ca,{cost:t.build.farm})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"hospital")}},K.hospital," Hospital",i.a.createElement(ca,{cost:t.build.hospital}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"theater")}},K.theater," Theater",i.a.createElement(ca,{cost:t.build.theater})),i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.build(e.props.hex,"park")}},K.park," Park",i.a.createElement(ca,{cost:t.build.park}))),i.a.createElement("h3",null,"Beings:"),this.renderBeamButton())}},{key:"renderBeamButton",value:function(){var e=this;return i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return e.props.beam(e.props.hex)}},"\ud83d\udef8 Beam In New Subject",i.a.createElement(ca,{cost:this.props.difficulty.cost.hex.beam})))}},{key:"buildingPanel",value:function(e){var t=this,a=e.usedSlots(),n=e.openSlots(),r="park"!=e.type&&"nature"!=e.type;return i.a.createElement("div",null,i.a.createElement("strong",null,e.upgraded&&r?"Dense ":"Small ",ka[e.type])," in ",i.a.createElement("strong",null,this.props.city.name),e.upgraded&&r?i.a.createElement("div",null,this.renderDensityWarning(e.type)):null,0===a.length?null:i.a.createElement("div",null,i.a.createElement("strong",null,"Workers:"),a.map((function(a){var n;return i.a.createElement("div",null,J[e.type]," ",null===(n=t.props.city.beans.find((function(t){return t.key===e.job_slots[a]})))||void 0===n?void 0:n.name)}))),r?i.a.createElement("div",null,"This ",ka[e.type]," can support ",n.length," more jobs.",e.upgraded?null:i.a.createElement("span",null,i.a.createElement("br",null),"Upgrade it to add 3 more job slots.")):null,e.upgraded||!r?null:i.a.createElement("div",null,i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",type:"button",onClick:function(){return t.props.upgrade(e)}},"\ud83d\udee0\ufe0f Upgrade",i.a.createElement(ca,{cost:this.props.difficulty.cost.hex.upgrade}))),this.renderDensityWarning(e.type)),this.renderBeamButton())}},{key:"renderDensityWarning",value:function(e){return"house"===e?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83d\udc2e Parochial subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in dense buildings")),i.a.createElement("div",{className:"text-center"},i.a.createElement("small",null,"\ud83c\udf78 Cosmopolitan subjects may emit \ud83d\udc4e",i.a.createElement("br",null),"when living in small buildings"))):i.a.createElement("div",null)}},{key:"renderJobs",value:function(){}},{key:"render",value:function(){var e=this.props.city.lookupBuilding(this.props.hex);return e?this.buildingPanel(e):this.emptyPanel()}}]),a}(i.a.Component),ha=(a(30),a(31),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.props.onChange(e.target.value),n.setState({key:e.target.value})},n.state={key:e.value||null},n}return Object(l.a)(a,[{key:"hint",value:function(){if(this.props.hint)return i.a.createElement("option",{value:"",disabled:!0,selected:!0,hidden:!0},this.props.hint)}},{key:"getTextForOption",value:function(e){return this.props.titleCase&&(e=e[0].toUpperCase()+e.slice(1)),e}},{key:"options",value:function(){var e=this;return this.props.options.map((function(t){return i.a.createElement("option",{value:t,key:t,title:e.getTitleForOption(t)},e.getTextForOption(t))}))}},{key:"render",value:function(){return i.a.createElement("select",{onChange:this.onChange,value:this.state.key,required:null!=this.props.hint},this.hint(),this.options())}},{key:"getTitleForOption",value:function(e){}}]),a}(i.a.Component)),da=function(e){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},e.data.icon),e.leftButton),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},e.titleView,i.a.createElement("span",{className:"pull-r"},e.cost,"\ud83e\udde0")),e.data.description?e.data.description.split(";").map((function(e){return i.a.createElement("small",{className:"marg-b-6"}," ",e)})):null,i.a.createElement("div",{className:"grow-1 text-center"},e.bottomView))))},ma=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},this.props.data.icon),this.props.frozen?null:i.a.createElement(ra,{className:"callout pad-4 marg-0",confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",disabled:this.props.available<this.props.cost,onConfirm:this.props.wash},"\ud83d\udebf ",i.a.createElement("small",null,"Wash"))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",{title:this.props.data.description,className:this.props.divergent?"divergent marg-r-6":"marg-r-6"},this.props.data.noun),i.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),i.a.createElement("small",{className:"marg-b-6"},this.props.data.description),i.a.createElement("div",{className:"grow-1 text-center"},$t(this.props.data.idealPro||[],"pos"),$t(this.props.data.idealCon||[],"neg")))))}}]),a}(i.a.Component),pa=Oe.slice().sort((function(e,t){return e.localeCompare(t)})),fa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={belief:"Neuroticism"},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=xe[this.state.belief];return i.a.createElement("div",{className:"belief"},i.a.createElement("div",{className:"horizontal badger add"},i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"circular"},t.icon),i.a.createElement(ra,{className:"callout grow-0 pad-4 marg-0",disabled:this.props.available<this.props.cost,confirmText:"-"+this.props.cost.toString()+"\ud83e\udde0?",onConfirm:function(){return e.props.add(e.state.belief)}},"\ud83d\udc89 ",i.a.createElement("small",null,"Implant"))),i.a.createElement("div",{className:"vertical"},i.a.createElement("div",{className:"text-center"},i.a.createElement(ha,{titleCase:!0,options:pa,value:this.state.belief,onChange:function(t){console.log(t),e.setState({belief:t})}}),i.a.createElement("span",{className:"pull-r"},this.props.cost,"\ud83e\udde0")),i.a.createElement("small",{className:"marg-b-6"},t.description),i.a.createElement("div",{className:"grow-1 text-center"},(t.idealPro||[]).map((function(e){return i.a.createElement("span",{className:"pos badge align-mid",key:e},"+",rt[e])})),(t.idealCon||[]).map((function(e){return i.a.createElement("span",{className:"neg badge align-mid",key:e},"-",rt[e])}))))))}}]),a}(i.a.Component),ya=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){return Object(o.a)(this,a),t.call(this,e)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.world.beans.find((function(t){return t.key==e.props.beanID}));if(null!=t){var a=t.believesIn("Dogmatism");return i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal fancy-header"},i.a.createElement("div",null,"BRAIN"),i.a.createElement("div",{className:"emoji-3"},"\ud83d\udc89\ud83e\udde0\ud83d\udebf"),i.a.createElement("div",null,"WASH")),i.a.createElement("div",null,i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",null,t.name)," has ",t.discrete_sanity.toFixed(0)," sanity \ud83e\udde0"),a?i.a.createElement("div",{className:"text-center"},"\ud83d\udc36 Dogmatic subjects cannot change their minds"):null,i.a.createElement("div",{className:"horizontal"},i.a.createElement("div",null,i.a.createElement(ma,{available:t.discrete_sanity,frozen:a,wash:function(){return e.props.washCommunity(t,t.community)},cost:this.props.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0,data:we[t.community]}),i.a.createElement(ma,{available:t.discrete_sanity,frozen:a,wash:function(){return e.props.washMotive(t,t.ideals)},cost:this.props.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0,data:we[t.ideals]}),i.a.createElement(ma,{available:t.discrete_sanity,frozen:a,wash:function(){return e.props.washNarrative(t,t.faith)},cost:this.props.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0,data:je[t.faith]}),t.beliefs.map((function(n){return i.a.createElement(ma,{available:t.discrete_sanity,frozen:a&&"Dogmatism"!=n,divergent:Ce(n,e.props.world.party.ideals,e.props.world.party.community),wash:function(){return e.props.washBelief(t,n)},cost:e.props.world.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0,data:xe[n]})})),a?null:i.a.createElement(fa,{available:t.discrete_sanity,add:function(a){return e.props.implantBelief(t,a)},cost:this.props.world.alien.difficulty.cost.bean_brain.brainimplant_secondary.sanity||0})))))}}}]),a}(i.a.Component),ba=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onEvent=function(e){n.setState({eventCount:n.state.eventCount+1}),window.setTimeout((function(){n.setState({eventCount:n.state.eventCount-1})}),3e3)},n.props.event.subscribe(n.onEvent),n.state={eventCount:0},n}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement("span",null,this.state.eventCount<1?this.props.children:i.a.createElement("span",{className:this.props.eventClass},this.props.eventIcon))}}]),a}(i.a.Component),va=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"text-center"},i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market")),i.a.createElement("p",null,i.a.createElement("small",null,"The premier exchange for \u26a1\ufe0f, \ud83e\udd16,  and \ud83d\udc4d!")),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return e.props.buyEnergy(1)},disabled:!this.props.player.canAfford(this.props.player.difficulty.cost.market.resource.energy)},"+1 \u26a1\ufe0f Energy",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.energy,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return e.props.buyEnergy(5)},disabled:!this.props.player.canAfford(this.props.player.difficulty.cost.market.resource.energy,5)},"+5 \u26a1\ufe0f Energy",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.energy,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return e.props.buyBots(1)},disabled:!this.props.player.canAfford(this.props.player.difficulty.cost.market.resource.bots)},"+1 \ud83e\udd16 Bot",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.bots,qty:1})),i.a.createElement("button",{className:"card button",onClick:function(){return e.props.buyBots(5)},disabled:!this.props.player.canAfford(this.props.player.difficulty.cost.market.resource.bots,5)},"+5 \ud83e\udd16 Bots",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.bots,qty:5}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button",onClick:function(){return e.props.scrubHedons()},disabled:this.props.player.hedons.amount>=0||!this.props.player.canAfford(this.props.player.difficulty.cost.market.scrubHedons)},"Remove \ud83d\udca2 Negative Hedons",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.scrubHedons,qty:1}))),i.a.createElement("div",null,i.a.createElement("small",null,i.a.createElement("i",null,"Current \ud83e\udde0 Traits for sale:"))),i.a.createElement("div",{className:"short-scroll"},i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button"},"\ud83c\udf78 Cosmopolitanism",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.bots}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button"},"\ud83d\udc7d Paranoia",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.bots}))),i.a.createElement("div",{className:"card-parent"},i.a.createElement("button",{className:"card button"},"\ud83e\udd2c Antagonism",i.a.createElement(ca,{cost:this.props.player.difficulty.cost.market.resource.bots})))))}}]),a}(i.a.Component),ga=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){var e=[];return this.props.seenBeliefs.get.forEach((function(t,a){null!=xe[a]&&e.push(xe[a])})),e.sort((function(e,t){return e.noun.localeCompare(t.noun)})),i.a.createElement("div",null,i.a.createElement("div",{className:"pad-4p"},i.a.createElement("h2",null,"Subject \ud83e\udde0 Traits")),i.a.createElement("div",{className:"col-2-30-60"},i.a.createElement("div",null,i.a.createElement("strong",null,"Trait Inventory")," ",i.a.createElement("br",null),this.props.beliefInventory.get.length<1?i.a.createElement("div",null,"No Traits! ",i.a.createElement("br",null),"\ud83d\ude35 Brainwash your subjects  ",i.a.createElement("br",null),"or buy from the \ud83d\udecd\ufe0f Market"):i.a.createElement("div",null,this.props.beliefInventory.get.map((function(e){return i.a.createElement("div",{key:e.trait},i.a.createElement("div",null,i.a.createElement("strong",null,xe[e.trait].icon," ",xe[e.trait].noun)),i.a.createElement("div",null,"This can be implanted ",e.charges," more times"))})))),i.a.createElement("div",null,i.a.createElement("strong",null,"Discovered Traits")," ",i.a.createElement("br",null),e.length<1?i.a.createElement("div",null,"No Traits! ",i.a.createElement("br",null),"\ud83d\udef0\ufe0f Scan some of your subjects."):e.map((function(e){return i.a.createElement(da,{key:e.noun,data:e,cost:0,titleView:i.a.createElement("strong",null,e.noun),bottomView:i.a.createElement("span",null)})})))))}}]),a}(i.a.Component),Ea=function(e){return i.a.createElement("div",null,i.a.createElement("div",{className:"col-2"},i.a.createElement("div",null,i.a.createElement("h3",null,"Welcome to the"),i.a.createElement("h2",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Laboratory"),i.a.createElement("div",null,"Thank you for joining the ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," Cultivation Division of the ",i.a.createElement("strong",null,"\ud83c\udf0c Galactic Xenosensation Federation!")," Your interdimensional petri dish is ready for farming."),i.a.createElement("p",null,"As a ",i.a.createElement("select",null,i.a.createElement("option",null,"Human Emotion Farmer")),", you are required to execute the following duties:"),i.a.createElement("ul",null,i.a.createElement("li",null,"Construct ",i.a.createElement("strong",null,"\ud83c\udfe0 Buildings")," for your ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef8 Beam In")," ",i.a.createElement("select",null,i.a.createElement("option",null,"Human"))," subjects for cultivation."),i.a.createElement("li",null,"Harvest your subject's positive ",i.a.createElement("strong",null,"\ud83d\udc4d Hedons"),"."),i.a.createElement("li",null,"Sell the Hedons on the ",i.a.createElement("br",null),i.a.createElement("strong",null,"\ud83c\udf0c Galactic \ud83d\ude28 Emotion \ud83d\udcb0 Market"),".")),i.a.createElement("div",null)),i.a.createElement("div",null,i.a.createElement("p",null,"The GXF's records indicate ",i.a.createElement("select",null,i.a.createElement("option",null,"Humans"))," are a",i.a.createElement("br",null),i.a.createElement("u",null,"mentally malleable")," and ",i.a.createElement("u",null,"physically fragile")," species. Try the following cultivation methods:"),i.a.createElement("ul",null,i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udef0\ufe0f Scan")," your subject's primitive minds for information on what pleases them."),i.a.createElement("li",null,i.a.createElement("strong",null,"\ud83d\udebf Brainwash")," subjects to change their ",i.a.createElement("strong",null,"\ud83e\udde0\xa0Traits"),". Try to add Traits that emit more ",i.a.createElement("strong",null,"\ud83d\udc4d\xa0Hedons"),"."),i.a.createElement("li",null,"Avoid letting your subjects die or endure pain; this makes ",i.a.createElement("strong",null,"\ud83d\udc4e\xa0Antihedons")," which are less profitable."),i.a.createElement("li",null,"Use your knowledge of Traits to modify the farm's ",i.a.createElement("strong",null,"\ud83d\uddf3\ufe0f\xa0Government")," to maximize Hedon generation."),i.a.createElement("li",null,"Use the GXF's ",i.a.createElement("strong",null,"\ud83e\uddea Research Lab")," to upgrade your farm, when stocked with ",i.a.createElement("strong",null,"\ud83d\udc7e Abducted")," subjects.")),i.a.createElement("h3",null,"\ud83c\udf0c Galactic Xenosensation Federation ",i.a.createElement("br",null),i.a.createElement("div",{className:"text-right"},i.a.createElement("small",null,i.a.createElement("i",null,"1 trillion sensations. 100% organic. 100% gourmet.")))))))},ka={state:"Collectivist",ego:"Independent",trad:"Elitist",prog:"Progressive",circle:"Brunette",square:"Blonde",triangle:"Redhead",rocket:"Futuristic",dragon:"Mythical",music:"Dramatic",noFaith:"Nihilistic",hungry:"Hungry",sated:"Sated",stuffed:"Stuffed",podless:"Homeless",crowded:"Crowded",homeowner:"Homeowner",sick:"Sick",bruised:"Bruised",fresh:"Robust",sane:"Sane",confused:"Confused",mad:"Mad",house:"House",hospital:"Hospital",farm:"Farm",theater:"Theater",church:"Church",courthouse:"Courthouse",park:"Park",nature:"Natural Scenery"},wa=i.a.createContext(void 0),ja=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).previousTimeMS=0,n.logicTickAccumulatorMS=0,n.tick=function(e){var t=(e-n.previousTimeMS)*n.state.timeScale;n.previousTimeMS=e,t>0&&(n.logicTickAccumulatorMS+=t,n.state.world.simulate_beans(t),n.state.world.simulate_pickups(t),n.logicTickAccumulatorMS>2e3&&(n.state.world.simulate_world(),n.setState({world:n.state.world}),n.logicTickAccumulatorMS=0)),window.requestAnimationFrame(n.tick)},n.keyupHandler=function(e){" "===e.key?n.state.timeScale>0?n.setState({timeScale:0}):n.setState({timeScale:1}):"Q"===e.key&&e.shiftKey&&(n.build(n.state.world.cities[0],{q:1,r:1},"farm"),n.build(n.state.world.cities[0],{q:1,r:0},"house"),n.build(n.state.world.cities[0],{q:0,r:1},"hospital"),n.beam(n.state.world.cities[0],{q:0,r:0}),n.beam(n.state.world.cities[0],{q:1,r:0}),n.beam(n.state.world.cities[0],{q:0,r:1}),n.beam(n.state.world.cities[0],{q:1,r:1}))},n.foundParty=function(e){n.state.world.party.name=e.name,n.state.world.party.slogan=e.slogan,n.state.world.cities[0].name=e.name,e.community&&(n.state.world.party.community=e.community),e.ideal&&(n.state.world.party.ideals=e.ideal);var t=n.state.world.cities.find((function(t){return t.key==e.cityKey}));t&&n.state.world.party,n.state.world.calculateComputedState(),n.setState({world:n.state.world,activeModal:null})},n.build=function(e,t,a){var i=n.difficulty.cost.emptyHex.build[a];n.state.world.alien.canAfford(i)&&(n.state.world.alien.purchase(i),wt(e,a,t)),n.setState({world:n.state.world})},n.upgrade=function(e,t){var a=n.difficulty.cost.hex.upgrade;n.state.world.alien.tryPurchase(a)&&(t.upgraded=!0),n.setState({world:n.state.world})},n.beam=function(e,t){var a=n.difficulty.cost.hex.beam;if(n.state.world.alien.canAfford(a)){n.state.world.alien.purchase(a);var i=new bt(e.ufos.length,t,"beam-in");e.ufos.push(i),window.setTimeout((function(){e.historicalBeans.push(St(e,e.historicalBeans.length,t)),n.setState({world:n.state.world})}),3e3),n.setState({world:n.state.world},(function(){n.removeUFO(e,i.key)}))}},n.buyBots=function(e){var t=n.difficulty.cost.market.resource.bots;n.state.world.alien.tryPurchase(t,e)&&(n.state.world.alien.bots.amount+=e,n.state.world.alien.bots.change.publish({change:e})),n.setState({world:n.state.world})},n.buyEnergy=function(e){var t=n.difficulty.cost.market.resource.bots;n.state.world.alien.tryPurchase(t,e)&&(n.state.world.alien.energy.amount+=e,n.state.world.alien.energy.change.publish({change:e})),n.setState({world:n.state.world})},n.scrubHedons=function(){var e=n.difficulty.cost.market.scrubHedons;if(n.state.world.alien.tryPurchase(e)){var t=n.state.world.alien.hedons.amount;n.state.world.alien.hedons.amount=0,n.state.world.alien.hedons.change.publish({change:-t})}n.setState({world:n.state.world})},n.foundCharity=function(e,t,a){n.state.world.addCharity(e,t,a),n.setState({world:n.state.world})},n.vaporize=function(e){n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.vaporize)&&(e.city&&e.die("vaporization"),n.setState({world:n.state.world}))},n.abduct=function(e){n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.abduct)&&(e.abduct(n.state.world.alien),n.setState({world:n.state.world}))},n.releaseBean=function(){if(n.state.world.alien.abductedBeans.length>0){var e=n.state.world.alien.abductedBeans.shift();e instanceof _e?e.lifecycle="alive":window.alert("releasing data beans is unimplemented")}},n.setResearch=function(e){n.state.world.alien.currentlyResearchingTech=e,n.setState({world:n.state.world})},n.scan=function(e){return!!n.state.world.alien.tryPurchase(n.state.world.alien.difficulty.cost.bean.scan)&&(n.state.world.alien.scanned_bean[e.key]=!0,e.beliefs.forEach((function(e){n.state.world.alien.seenBeliefs.get.has(e)||n.state.world.alien.seenBeliefs.add(e,!0)})),n.setState({world:n.state.world}),!0)},n.washCommunity=function(e,t){if(e.tryPurchase(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal))return e.loseSanity(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0),"ego"===e.community?e.community="state":e.community="ego",n.setState({world:n.state.world}),!0},n.washMotive=function(e,t){if(e.tryPurchase(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal))return e.loseSanity(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0),"prog"===e.ideals?e.ideals="trad":e.ideals="prog",n.setState({world:n.state.world}),!0},n.washNarrative=function(e,t){if(e.tryPurchase(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal)){e.loseSanity(n.state.world.alien.difficulty.cost.bean_brain.brainwash_ideal.sanity||0);for(var a=e.faith;e.faith===a;)e.faith=kt(["rocket","dragon","music","noFaith"]);return n.setState({world:n.state.world}),!0}},n.washBelief=function(e,t){if(e.tryPurchase(n.state.world.alien.difficulty.cost.bean_brain.brainwash_secondary))return e.beliefs.splice(e.beliefs.indexOf(t),1),e.loseSanity(n.state.world.alien.difficulty.cost.bean_brain.brainwash_secondary.sanity||0),n.state.world.alien.beliefInventory.push({trait:t,charges:3}),n.setState({world:n.state.world}),!0},n.implantBelief=function(e,t){if(e.tryPurchase(n.state.world.alien.difficulty.cost.bean_brain.brainimplant_secondary))return e.beliefs.push(t),e.loseSanity(n.state.world.alien.difficulty.cost.bean_brain.brainimplant_secondary.sanity||0),n.setState({world:n.state.world}),!0},n.setPolicy=function(e,t){n.state.world.party.platform[e]=t,n.state.world.calculateComputedState(),n.setState({world:n.state.world})},n.onDeath=function(e){n.startSpotlight(e)},n.timescaleBeforeSpotlight=1,n.state={world:jt(),activeCityID:null,activeBeanID:null,activeHex:null,activeMain:"geo",activeModal:"greeting",activeRightPanel:"overview",timeScale:0,spotlightEvent:void 0},n.state.world.calculateComputedState(),n.state.world.bus.death.subscribe(n.onDeath),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",this.keyupHandler,!1),window.requestAnimationFrame((function(t){e.previousTimeMS=t,window.requestAnimationFrame(e.tick)}))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keyup",this.keyupHandler)}},{key:"removeUFO",value:function(e,t){window.setTimeout((function(){var a=e.ufos.findIndex((function(e){return e.key===t}));a>-1&&e.ufos.splice(a,1)}),7e3)}},{key:"startSpotlight",value:function(e){var t=this;this.timescaleBeforeSpotlight=this.state.timeScale,this.setState({spotlightEvent:e,timeScale:0},(function(){setTimeout((function(){return t.endSpotlight()}),5e3)}))}},{key:"endSpotlight",value:function(){this.setState({timeScale:this.timescaleBeforeSpotlight,spotlightEvent:void 0})}},{key:"getPanel",value:function(){var e=this;switch(this.state.activeRightPanel){case"overview":if(null==this.state.activeCityID)return i.a.createElement(_t,{beans:this.state.world.beans,utopia:this.state.world.party,clearCity:function(){return e.setState({activeCityID:null})}});var t=this.state.world.cities.find((function(t){return t.key==e.state.activeCityID}));if(t){if(null!=this.state.activeHex)return i.a.createElement(ua,{city:t,hex:this.state.activeHex,difficulty:this.state.world.alien.difficulty,clearHex:function(){return e.setState({activeHex:null})},beam:function(a){return e.beam(t,a)},upgrade:function(a){return e.upgrade(t,a)},build:function(a,n){e.build(t,a,n)}});if(null!=this.state.activeBeanID){var a=t.beans.find((function(t){return t.key==e.state.activeBeanID}));if(a)return i.a.createElement(Ut,{bean:a,city:t,alien:this.state.world.alien,economy:this.state.world.economy,party:this.state.world.party,bus:this.state.world.bus,law:this.state.world.law,scan:this.scan,vaporize:this.vaporize,brainwash:function(){return e.setState({activeModal:"brainwash"})},abduct:this.abduct,gift:function(){return e.setState({activeModal:"brainwash"})},clearCity:function(){return e.setState({activeCityID:null,activeBeanID:null})}})}return i.a.createElement(_t,{beans:null===t||void 0===t?void 0:t.beans,utopia:this.state.world.party,city:t,clearCity:function(){return e.setState({activeCityID:null})}})}return i.a.createElement("div",null);case"goals":return i.a.createElement(aa,{player:this.state.world.alien,progress:this.state.world.alien});case"events":return i.a.createElement(Wt,{events:this.state.world.bus.buffer,selectBean:function(t){t&&e.setState({activeCityID:e.state.world.cities[0].key,activeBeanID:t,activeHex:null,activeRightPanel:"overview"})}});case"market":return i.a.createElement(va,{buyEnergy:this.buyEnergy,buyBots:this.buyBots,scrubHedons:this.scrubHedons,player:this.state.world.alien})}}},{key:"renderGeo",value:function(){var e=this,t=this.state.world.economy.getCostOfLiving();return this.state.world.cities.map((function(a){return i.a.createElement(qt,{tile:a,city:a,costOfLiving:t,key:a.key,spotlightEvent:e.state.spotlightEvent,activeBeanID:e.state.activeBeanID,onClick:function(){return e.setState({activeCityID:a.key,activeRightPanel:"overview",activeHex:null,activeBeanID:null})},onBeanClick:function(t){return e.setState({activeCityID:a.key,activeRightPanel:"overview",activeHex:null,activeBeanID:t.key})},onHexClick:function(t){e.setState({activeCityID:a.key,activeHex:t,activeBeanID:null,activeRightPanel:"overview"})}})}))}},{key:"renderNetwork",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement("div",{className:"horizontal max-w-500 m-t-2em"},i.a.createElement("button",{type:"button"},"\ud83d\ude0e Influence"),i.a.createElement("button",{type:"button"},"\ud83d\udea9 Party Preference"),i.a.createElement("button",{type:"button"},"\ud83d\udcc8 Demographics")),i.a.createElement(Zt,{costOfLiving:this.state.world.economy.getCostOfLiving(),beans:this.state.world.beans,onClick:function(t){return e.setState({activeCityID:t.cityKey,activeRightPanel:"overview",activeBeanID:t.key})}}))}},{key:"main",value:function(){switch(this.state.activeMain){case"network":return this.renderNetwork();default:return this.renderGeo()}}},{key:"render",value:function(){var e=this,t=Se[this.state.world.date.season];return i.a.createElement("div",{className:"canvas"},i.a.createElement(wa.Provider,{value:this.state.world.sfx},i.a.createElement(ta.b,{defaultScale:1,wheel:{step:48}},i.a.createElement(ta.a,null,i.a.createElement("div",{className:"world"},this.main()))),i.a.createElement("div",{className:"overlay"},i.a.createElement(Nt,{show:"greeting"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Ea,null)),i.a.createElement(Nt,{show:"party_creation"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})},hideCloseButton:!0},i.a.createElement(Jt,{cities:this.state.world.cities,onFound:this.foundParty})),i.a.createElement(Nt,{show:"party"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(Xt,{world:this.state.world,setPolicy:this.setPolicy})),i.a.createElement(Nt,{show:"polisci"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(oa,{release:this.releaseBean,setResearch:this.setResearch,player:this.state.world.alien})),i.a.createElement(Nt,{show:"policy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(ia,{world:this.state.world})),i.a.createElement(Nt,{show:"campaign"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(na,null)),i.a.createElement(Nt,{show:"economy"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"economy"==this.state.activeModal?i.a.createElement(Gt,{world:this.state.world}):""),i.a.createElement(Nt,{show:"traits"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},i.a.createElement(ga,{seenBeliefs:this.state.world.alien.seenBeliefs,beliefInventory:this.state.world.alien.beliefInventory})),i.a.createElement(Nt,{show:"brainwash"==this.state.activeModal,onClick:function(){return e.setState({activeModal:null})}},"brainwash"==this.state.activeModal?i.a.createElement(ya,{world:this.state.world,beanID:this.state.activeBeanID,washCommunity:this.washCommunity,washMotive:this.washMotive,washNarrative:this.washNarrative,washBelief:this.washBelief,implantBelief:this.implantBelief}):""),i.a.createElement("div",{className:"left"},i.a.createElement("div",{className:"top"},i.a.createElement("span",null,"\ud83d\udc7d Alien \ud83c\udf0d Utopia \ud83d\udd2c Lab"),i.a.createElement("span",null,"\xa0 Year ",this.state.world.date.year,", \xa0",t," ",this.state.world.date.day," ",this.renderHour()),i.a.createElement("span",null,"6 mo 5 days til Grade"),i.a.createElement("button",{type:"button",onClick:function(){return e.setState({activeMain:"network"})}},"\ud83c\udf10"),i.a.createElement("button",{type:"button",onClick:function(){return e.setState({activeMain:"geo"})}},"\ud83c\udf0e"),i.a.createElement(la,{timeScale:this.state.timeScale,setTimeScale:function(t){e.setState({timeScale:t})}})),i.a.createElement("div",{className:"bottom"},i.a.createElement(Yt,{changeEvent:this.state.world.alien.energy.change,icon:"\u26a1\ufe0f"},i.a.createElement(ea,{icon:"\u26a1\ufe0f",label:"Energy"},this.state.world.alien.energy.amount.toFixed(1))),i.a.createElement(Yt,{changeEvent:this.state.world.alien.bots.change,icon:"\ud83e\udd16"},i.a.createElement(ea,{icon:"\ud83e\udd16",label:"Bots"},this.state.world.alien.bots.amount.toFixed(1))),i.a.createElement(Yt,{changeEvent:this.state.world.alien.hedons.change,icon:"\ud83d\udc4d"},i.a.createElement(ea,{icon:"\ud83d\udc4d",label:"Hedons"},this.state.world.alien.hedons.amount.toFixed(0))),i.a.createElement("span",null,i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"economy"})}},"\ud83d\udcca State of the Utopia"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"party"})}},"\ud83d\uddf3\ufe0f Gov"),i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"polisci"})}},"\ud83e\uddea Research"),i.a.createElement(Qt,{changeEvent:this.state.world.alien.seenBeliefs.onAdd,icon:"\ud83e\udde0"},i.a.createElement("button",{type:"button",className:"callout",onClick:function(){return e.setState({activeModal:"traits"})}},"\ud83e\udde0 Traits"))))),i.a.createElement("div",{className:"right"},i.a.createElement("div",{className:"full-width-tabs"},i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"overview"})}},"\ud83d\udcc8 Info"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"market"})}},"\ud83d\udecd\ufe0f Market"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"events"})}},i.a.createElement(ba,{event:this.state.world.bus.speechcrime,eventIcon:"\ud83d\udea8",eventClass:"police-siren"},"\ud83d\udce3")," Events"),i.a.createElement("button",{onClick:function(){return e.setState({activeRightPanel:"goals"})}},"\ud83c\udfc6 Goals")),i.a.createElement("div",{className:"right-panel"},this.getPanel())))))}},{key:"renderHour",value:function(){switch(this.state.world.date.hour){default:return"\u2600\ufe0f";case Ne.Evening:return"\ud83c\udf07";case Ne.Morning:return"\ud83c\udf04";case Ne.Midnight:return"\ud83c\udf19"}}},{key:"difficulty",get:function(){return this.state.world.alien.difficulty}}]),a}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(ja,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[16,1,2]]]);
//# sourceMappingURL=main.17f0afd0.chunk.js.map